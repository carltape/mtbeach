(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    369343,       9312]
NotebookOptionsPosition[    349224,       9017]
NotebookOutlinePosition[    350530,       9061]
CellTagsIndexPosition[    350487,       9058]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Changed for Mathematica 7     07 - 27 - 2010\nApparently needed no changes \
for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10  11-21-2015"
}], "Text",
 CellChangeTimes->{{3.4892616449648027`*^9, 3.4892616872876763`*^9}, {
  3.4892635901517944`*^9, 3.4892635921953983`*^9}, {3.6571673188845243`*^9, 
  3.6571673455605707`*^9}},ExpressionUUID->"3817b8f8-e50a-4926-8ab2-\
f6cf2557c834"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DmatDmat", "=", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2"}], "}"}], 
     "]"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"For", " ", 
     RowBox[{"Voigt", ".", " ", 
      StyleBox[
       RowBox[{"C", 
        StyleBox["h",
         FontColor->RGBColor[1, 0, 0]]}]]}], "anged", " ", "from", " ", 
     "Hmat", " ", "Jan", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", 
      SqrtBox["2"], ",", 
      SqrtBox["2"], ",", 
      SqrtBox["2"]}], "}"}], "]"}]}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "from", " ", "SqRtH", " ", "Jan", " ", "2020."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.870451082653311*^9, 3.870451083629214*^9}, {
  3.89269316768466*^9, 3.8926931968474383`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b4d8257b-284b-4c93-8131-a54c506cfdab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsub\[CapitalSigma]\[CapitalPhi]", ":=", 
   RowBox[{"MatIsub\[CapitalSigma]B", ".", "MatIsubB\[CapitalPhi]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalPhi]\[CapitalSigma]", ":=", 
   RowBox[{"MatIsub\[CapitalPhi]B", ".", "MatIsubB\[CapitalSigma]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalPhi]\[CapitalUpsilon]", ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"MatIsub\[CapitalPhi]B", ".", "MatIsubB\[CapitalUpsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalUpsilon]\[CapitalPhi]", ":=", 
   RowBox[{"MatIsub\[CapitalUpsilon]B", ".", "MatIsubB\[CapitalPhi]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8672895583248796`*^9, 3.867289658587146*^9}, {
  3.8672897123365326`*^9, 3.8672897461094894`*^9}, {3.8672898864650307`*^9, 
  3.8672899043165655`*^9}, {3.867289940032301*^9, 3.8672899536198673`*^9}, {
  3.867508908545532*^9, 3.867508914852187*^9}, {3.8926935537412763`*^9, 
  3.8926935603816576`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"d711d3d1-d7cf-471b-9141-0f84658c4664"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAngle", "[", "U_", "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Tr", "[", "U", "]"}]}], "2"], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "March", " ", "of", " ", "2016"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"9085b0a0-c438-4028-bc5d-4925ef5d5345"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatM", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13"},
      {"m21", "m22", "m23"},
      {"m31", "m32", "m33"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DummyMatrixSYM", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13"},
      {"m12", "m22", "m23"},
      {"m13", "m23", "m33"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6340483684794474`*^9, 3.63404848657211*^9}, {
  3.7893278114069843`*^9, 3.7893278315839815`*^9}, {3.8678505231712728`*^9, 
  3.8678505312496414`*^9}, {3.8678505627133303`*^9, 3.867850568015712*^9}, {
  3.8680607981959457`*^9, 3.8680608147683*^9}, {3.868060864146146*^9, 
  3.868060864902273*^9}, {3.86819529995193*^9, 3.868195334760936*^9}, {
  3.905009591139743*^9, 3.905009591908168*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"44851fdf-221f-4a7b-9ba6-1cf3499946ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DummyMatrixSYM6x6", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"c11", "c12", "c13", "c14", "c15", "c16"},
      {"c12", "c22", "c23", "c24", "c25", "c26"},
      {"c13", "c23", "c33", "c34", "c35", "c36"},
      {"c14", "c24", "c34", "c44", "c45", "c46"},
      {"c15", "c25", "c35", "c45", "c55", "c56"},
      {"c16", "c26", "c36", "c46", "c56", "c66"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DummyMatrix6x6", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13", "m14", "m15", "m16"},
      {"m21", "m22", "m23", "m24", "m25", "m26"},
      {"m31", "m32", "m33", "m34", "m35", "m36"},
      {"m41", "m42", "m43", "m44", "m45", "m46"},
      {"m51", "m52", "m53", "m54", "m55", "m56"},
      {"m61", "m62", "m63", "m64", "m65", "m66"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.785356554575347*^9, 3.78535679026956*^9}, {
  3.7853568558996725`*^9, 3.7853570706785283`*^9}, {3.8024068228213253`*^9, 
  3.8024069253013043`*^9}, {3.802406979652315*^9, 3.802406984996315*^9}, {
  3.802438955335802*^9, 3.8024389695118017`*^9}, {3.802451116283245*^9, 
  3.802451118667241*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"88df79be-838b-451a-97be-f1356eb5da10"],

Cell[CellGroupData[{

Cell["\<\
Reference matrices.  
Logically goes later, with elastic map stuff, but needs to be evaluated now.\
\>", "Section",
 CellChangeTimes->{{3.840461964835967*^9, 3.8404619800509477`*^9}, {
  3.8695174148645554`*^9, 3.8695174166008625`*^9}, {3.892692013255378*^9, 
  3.8926920450910373`*^9}},ExpressionUUID->"b467ce18-47e3-4a09-b303-\
4718e38279d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlankSlate", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "m", "q", "t", "v"},
       {"g", "b", "h", "n", "r", "u"},
       {"m", "h", "c", "i", "o", "s"},
       {"q", "n", "i", "d", "j", "p"},
       {"t", "r", "o", "j", "e", "k"},
       {"v", "u", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlankSlatePrime", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ax", "gx", "mx", "qx", "tx", "vx"},
       {"gx", "bx", "hx", "nx", "rx", "ux"},
       {"mx", "hx", "cx", "ix", "ox", "sx"},
       {"qx", "nx", "ix", "dx", "jx", "px"},
       {"tx", "rx", "ox", "jx", "ex", "kx"},
       {"vx", "ux", "sx", "px", "kx", "fx"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8926919421726065`*^9, 3.8926919457655735`*^9}, {
  3.896276816376087*^9, 3.8962769188384495`*^9}, {3.896277140919383*^9, 
  3.8962772061741266`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"7fab8f80-722e-46a4-9c38-c31962a6e1ea"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "BlankSlatePrime", "]"}]], "Input",
 CellChangeTimes->{{3.896276926639326*^9, 3.896276931269787*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"236123d1-bfc6-4447-8999-cffd7c5bd413"],

Cell[CellGroupData[{

Cell[" Basis is \[DoubleStruckCapitalB]", "Subsubsection",
 CellChangeTimes->{
  3.8695303310658474`*^9, {3.8795189633854427`*^9, 
   3.8795189805213423`*^9}},ExpressionUUID->"7e0dc98e-474e-40bc-b804-\
5416fca6a754"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TmatForISO", "=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "0", "0", "0", "0", "0"},
        {"0", "a", "0", "0", "0", "0"},
        {"0", "0", "a", "0", "0", "0"},
        {"0", "0", "0", "a", "0", "0"},
        {"0", "0", "0", "0", "a", "0"},
        {"0", "0", "0", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "May", " ", "30"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForXISO", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "0", "0", "0", "0", "0"},
      {"0", "a", "0", "0", "0", "0"},
      {"0", "0", "c", "0", "0", "0"},
      {"0", "0", "0", "c", "0", "0"},
      {"0", "0", "0", "0", "e", "k"},
      {"0", "0", "0", "0", "k", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForTET", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "a", "0", "0", "0", "0"},
       {"0", "0", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "0", "0"},
       {"0", "0", "0", "0", "e", "k"},
       {"0", "0", "0", "0", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForORTH", "=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "0", "0", "0", "0", "0"},
        {"0", "b", "0", "0", "0", "0"},
        {"0", "0", "c", "0", "0", "0"},
        {"0", "0", "0", "d", "j", "p"},
        {"0", "0", "0", "j", "e", "k"},
        {"0", "0", "0", "p", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"TmatForMONO", "=", 
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "g", "0", "0", "0", "0"},
         {"g", "b", "0", "0", "0", "0"},
         {"0", "0", "c", "i", "o", "s"},
         {"0", "0", "i", "d", "j", "p"},
         {"0", "0", "o", "j", "e", "k"},
         {"0", "0", "s", "p", "k", "f"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmatForTRIG", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "m", "0", "0", "0"},
       {"0", "a", "0", "m", "0", "0"},
       {"m", "0", "c", "0", "0", "0"},
       {"0", "m", "0", "c", "0", "0"},
       {"0", "0", "0", "0", "e", "k"},
       {"0", "0", "0", "0", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForCUBE", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "a", "0", "0", "0", "0"},
       {"0", "0", "a", "0", "0", "0"},
       {"0", "0", "0", "d", "0", "0"},
       {"0", "0", "0", "0", "d", "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "May", " ", "30"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8695175115030165`*^9, 3.869517514087134*^9}, 
   3.8695175488134546`*^9, {3.8795188772226877`*^9, 3.8795189350919695`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"51502003-ee5b-4147-9d4a-fbeeb2653dfb"]
}, Open  ]]
}, Open  ]],

Cell["New section", "Section",
 CellChangeTimes->{{3.8926920869583063`*^9, 
  3.8926921034595504`*^9}},ExpressionUUID->"3c7f1f8b-81d6-4bee-a5ec-\
b0308a2dc161"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DateSequence", "[", 
    RowBox[{"date_", ",", "WantTime_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WantTime", "\[Equal]", "\"\<yes\>\""}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\"\< \>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
        "\"\<:\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"DateSequence", "[", 
  RowBox[{
   RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}]}], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"7172045e-43cd-4cd9-8f52-a59438ab2943"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "UU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sind", "[", "t_", "]"}], ":=", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cosd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tand", "[", "t_", "]"}], ":=", 
   RowBox[{"Tan", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"length", "[", "v_", "]"}], ":=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{"v", ".", "v"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], "                "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"u", ".", "v"}], 
      RowBox[{
       RowBox[{"length", "[", "u", "]"}], " ", 
       RowBox[{"length", "[", "v", "]"}]}]], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "used", " ", "to", " ", "be", " ", "AngleRad"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "   "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UU", "[", 
     RowBox[{"A_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"A", ",", 
       RowBox[{"Cross", "[", 
        RowBox[{"N", ",", "A"}], "]"}], ",", "N"}], "}"}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["The",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["frame",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["whose",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["first",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["third",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["vectors",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["are",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["A",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"N", "."}],
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox["A",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["N",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["must",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["be",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"orthonormal", ".", " ", "The"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["first",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["third",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["columns",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["of",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["UU",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["are",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["A",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"N", "."}],
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SignedAngle", "[", 
    RowBox[{"A_", ",", "B_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{"Theta", "[", 
    RowBox[{
     RowBox[{"Transpose", " ", "[", 
      RowBox[{"UU", "[", 
       RowBox[{
        RowBox[{"Unit", "[", "A", "]"}], ",", 
        RowBox[{"Unit", "[", "N", "]"}]}], "]"}], "]"}], ".", "B"}], "]"}]}], 
  " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "A", " ", "and", " ", "B", " ", "must", " ", "be", " ", "orthogonal", 
      " ", "to", " ", "N"}], ",", " ", 
     RowBox[{
     "and", " ", "N", " ", "must", " ", "be", " ", "a", " ", "unit", " ", 
      "vector", " ", "WORK", " ", "HERE"}], ",", " ", "REDO"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Theta", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"1.", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "=", "0.999"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Theta", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], " ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Theta", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"1.", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "=", "0.999"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.734628431840602*^9, 3.734628477450066*^9}, {
   3.734628913185296*^9, 3.734628918091556*^9}, {3.7346317198290963`*^9, 
   3.734631725641618*^9}, {3.7460429495891056`*^9, 3.7460429506773715`*^9}, 
   3.864152349189878*^9, {3.875484972852081*^9, 3.8754849785294704`*^9}, {
   3.875485482254735*^9, 3.8754854894004974`*^9}, 3.875485805686556*^9, {
   3.8754863775133533`*^9, 3.8754863855126796`*^9}, {3.875542837017194*^9, 
   3.8755428549486504`*^9}, {3.8755554503560205`*^9, 
   3.8755554509013157`*^9}, {3.8755562751363926`*^9, 3.87555630469481*^9}, {
   3.8755563389314737`*^9, 3.8755563435714965`*^9}, {3.899679074026461*^9, 
   3.8996791123485394`*^9}, {3.8996791720423737`*^9, 
   3.8996791765861464`*^9}, {3.8996792773419695`*^9, 
   3.8996792972129135`*^9}, {3.89967946367607*^9, 3.899679481965351*^9}, {
   3.8996795338039293`*^9, 3.8996795400117626`*^9}, {3.9049303020955887`*^9, 
   3.9049303226047835`*^9}, {3.904930357455589*^9, 3.904930358601302*^9}, 
   3.90500937406435*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"4030df4a-84d4-4a5e-af38-62de4a44eb8f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", ".", "b"}], "/", 
    RowBox[{"length", "[", "b", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VectorProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"a", ".", "b"}], 
     RowBox[{"b", ".", "b"}]], "b"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlaneProj", "[", 
    RowBox[{"a_", ",", "normal_"}], "]"}], ":=", 
   RowBox[{"a", "-", 
    RowBox[{"VectorProj", "[", 
     RowBox[{"a", ",", "normal"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"XRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0", "0"},
      {"0", 
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {"0", 
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"   ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0", 
       RowBox[{"Sin", "[", "t", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0", 
       RowBox[{"Cos", "[", "t", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0"},
      {"0", "0", "1"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rot111", "=", 
   RowBox[{"(", GridBox[{
      {"0", "0", "1"},
      {"1", "0", "0"},
      {"0", "1", "0"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["w", "2"], "+", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "-", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "+", 
           RowBox[{"w", " ", "y"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "+", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "-", 
           RowBox[{"w", " ", "x"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "-", 
           RowBox[{"w", " ", "y"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "+", 
           RowBox[{"w", " ", "x"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]}
      }], "\[NoBreak]", ")"}]}], " ", ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"RotMatrix2", ".", "  ", 
      StyleBox[
       RowBox[{"Q", 
        StyleBox["u",
         FontColor->RGBColor[1, 0, 0]]}]]}], "aternion", " ", 
     RowBox[{"{", 
      RowBox[{"w", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], " ", "must", " ", 
     "have", " ", "unit", " ", "length"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", "v_", "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"v", ".", "v"}]}]], ",", "v"}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "is", " ", 
     SubscriptBox["U", "B"], " ", "in", " ", "some", " ", "of", " ", "the", 
     " ", "tex", " ", "files"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ROT", "[", 
    RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"RotMatrixQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], 
       RowBox[{"unit", "[", "v", "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rot2D", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UswapVandK", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    TagBox[
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "+", "z"}]], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["y", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"x", " ", "y"}], 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", "y"}], 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "must", " ", "be", " ", 
     "unit", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UswapVandK", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"z", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", 
          RowBox[{"0", " "}]},
         {"0", 
          RowBox[{"-", "1"}], 
          RowBox[{"0", " "}]},
         {
          RowBox[{"0", " "}], 
          RowBox[{"0", " "}], 
          RowBox[{"-", "1", " "}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["y", "2"]}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}], "-", "z", " "}], 
           RowBox[{"x", " ", 
            RowBox[{"y", "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]}], 
           RowBox[{"x", " "}]},
          {
           RowBox[{"x", " ", 
            RowBox[{"y", "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}], "-", "z"}], 
           RowBox[{"y", " "}]},
          {
           RowBox[{"x", " "}], 
           RowBox[{"y", " "}], 
           RowBox[{"z", " "}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "must", " ", "be", " ", 
     "unit", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UsHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
     RowBox[{
      StyleBox["YRot",
       FontColor->RGBColor[1, 0, 0]], "[", "\[Phi]", "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "not", " ", "the", " ", "same", " ", "as", " ", "in", " ", "Section", " ",
      "S4", " ", "of", " ", "Supp", " ", "Info", " ", "for", " ", "TapeTape", 
     " ", "2015"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"yref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"id", "=", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sign", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "<", "0"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xyztp", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", " ", "Degree"}], ",", 
      RowBox[{"\[Phi]", " ", "Degree"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi", "[", "v_", "]"}], ":=", 
   RowBox[{"Angle", "[", 
    RowBox[{"v", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TPxyz", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Theta", "[", "v", "]"}], ",", 
     RowBox[{"Phi", "[", "v", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TPxyz", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"999", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TPxyz", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"999", ",", "\[Pi]"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CartesianProduct", "[", "ListOfSets_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "ListOfSets", "]"}], "==", "2"}], ",", "\t\t", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"ListOfSets", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"ListOfSets", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         "1"}], "]"}], "]"}], ",", "\n", 
      RowBox[{"MyFlatten", "/@", 
       RowBox[{"CartesianProduct", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"ListOfSets", ",", "1"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"CartesianProduct", "[", 
           RowBox[{"Drop", "[", 
            RowBox[{"ListOfSets", ",", "1"}], "]"}], "]"}]}], "}"}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentList", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"EquatorList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ZRot", "[", 
       RowBox[{"#", " ", "Degree"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "181"}], ",", "179", ",", "2"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapEyeward", "[", 
     RowBox[{"x_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"x", "+", 
     RowBox[{"distance", "*", 
      RowBox[{"unit", "[", "eye", "]"}]}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"usually", " ", "distance"}], " ", "=", " ", 
    RowBox[{".01", " ", "is", " ", "enough"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeReal", "[", "z_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "z", "]"}], "==", "0"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "z", "]"}], "]"}], "<", ".00001"}], ",", 
       RowBox[{"Re", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"MakeReal", "/@", "z"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPoly", "[", 
    RowBox[{"i_", ",", "j_", ",", "RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "       ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RangeX", "[", 
         RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
        RowBox[{"RangeY", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "*)"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPolys", "[", 
    RowBox[{"RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BasicPoly", "[", 
        RowBox[{"i", ",", "j", ",", "RangeX", ",", "RangeY"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeX", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeY", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintEye", ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<eye = \>\"", ",", 
     RowBox[{"Round", "[", 
      RowBox[{"eye", ",", ".01"}], "]"}], ",", 
     "\"\<;  (\[Theta], \[Phi]\!\(\*SubscriptBox[\()\), \(eye\)]\) = \>\"", 
     ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "[", "eye", "]"}], ",", 
        RowBox[{"phi", "[", "eye", "]"}]}], "}"}], "]"}], ",", 
     "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(eye\)]\) = \>\"", ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"length", "[", "eye", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomDirection", ":=", 
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomRotation", ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ttt", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppp", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sss", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RotMatrixQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"sss", "/", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"sss", "/", "2"}], "]"}], 
           RowBox[{
            RowBox[{"ZRot", "[", "ttt", "]"}], ".", 
            RowBox[{"YRot", "[", "ppp", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "}"}], "]"}], 
       ".", 
       RowBox[{"ZRot", "[", "ttt", "]"}], ".", 
       RowBox[{"YRot", "[", "ppp", "]"}]}]}], ")"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"arc", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RotMatrixQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"#", "/", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"#", "/", "2"}], "]"}], 
           RowBox[{"unit", "[", 
            RowBox[{"Cross", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "}"}], "]"}], ".", 
       "a"}], "&"}], "/@", 
     RowBox[{"myRange", "[", 
      RowBox[{
       RowBox[{"0", "+", 
        RowBox[{"0", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", 
       RowBox[{
        RowBox[{"Angle", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "-", 
        RowBox[{"1", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", "31"}], "]"}]}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Change", " ", "0", " ", "to", " ", "1", " ", "or", " ", "2", " ", "so", 
     " ", "endpoints", " ", "are", " ", "visible"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "M", "]"}], ".", 
    RowBox[{"Flatten", "[", "N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMatrix", "[", "M_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{"M", ",", "M"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitMatrix", "[", "M_", "]"}], ":=", 
   FractionBox["M", 
    RowBox[{"NormMatrix", "[", "M", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AngleMatrix", "[", 
     RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{"M", ",", "N"}], "]"}], 
      RowBox[{
       RowBox[{"NormMatrix", "[", "M", "]"}], 
       RowBox[{"NormMatrix", "[", "N", "]"}]}]], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox["radians",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpherePolyList", "[", 
     RowBox[{
     "\[Rho]_", ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "\[Phi]1_", ",", 
      "\[Phi]2_", ",", "\[CapitalDelta]\[Theta]_", ",", 
      "\[CapitalDelta]\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{"xyztp", "[", "#", "]"}]}], "&"}], ",", " ", 
      RowBox[{"BasicPolys", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
         "\[Theta]1", ",", "\[Theta]2", ",", "\[CapitalDelta]\[Theta]"}], 
         "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"\[Phi]1", ",", "\[Phi]2", ",", "\[CapitalDelta]\[Phi]"}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarText", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[GreaterEqual]", "0"}], ",", "x", ",", 
       OverscriptBox[
        RowBox[{"-", "x"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "y", ",", 
       OverscriptBox[
        RowBox[{"-", "y"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[GreaterEqual]", "0"}], ",", "z", ",", 
       OverscriptBox[
        RowBox[{"-", "z"}], "_"]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "AinRadians_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"AinRadians", "/", "Degree"}], ",", ".01"}], "]"}], ",", 
      "o"}], "]"}], "//", "DisplayForm"}]}], ";"}]}], "Input",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic,
 CellChangeTimes->{
  3.4892780789458637`*^9, 3.4892781537179947`*^9, 3.489278185963251*^9, {
   3.4950345922209835`*^9, 3.4950346018774004`*^9}, {3.5011818616296425`*^9, 
   3.5011818626904445`*^9}, {3.520005149614954*^9, 3.520005186743019*^9}, {
   3.5228787025265994`*^9, 3.522878716086618*^9}, {3.523572395586929*^9, 
   3.5235725065031223`*^9}, {3.5235726199309196`*^9, 
   3.5235726788522224`*^9}, {3.523573043268858*^9, 3.523573114982183*^9}, {
   3.523913723635171*^9, 3.5239137509196186`*^9}, {3.523913805878515*^9, 
   3.523913806065715*^9}, {3.52415771607572*^9, 3.5241577374165573`*^9}, {
   3.5245987606895313`*^9, 3.5245988112024193`*^9}, {3.5246041379147077`*^9, 
   3.524604143889518*^9}, {3.5275223122177277`*^9, 3.5275223131381297`*^9}, {
   3.5278961648661757`*^9, 3.5278961685761805`*^9}, {3.531153615164811*^9, 
   3.531153615984812*^9}, {3.5330552480452175`*^9, 3.533055281051276*^9}, {
   3.5359904583292646`*^9, 3.535990479217701*^9}, {3.536343561909086*^9, 
   3.5363435629386873`*^9}, {3.543292666839031*^9, 3.543292719379923*^9}, {
   3.5469924224625473`*^9, 3.5469924490318937`*^9}, {3.5519977604570932`*^9, 
   3.5519977614398947`*^9}, {3.557771274368308*^9, 3.5577712872851305`*^9}, {
   3.557771609737693*^9, 3.557771612483298*^9}, {3.55837231696457*^9, 
   3.558372325981386*^9}, {3.5583752865857487`*^9, 3.5583753000329723`*^9}, {
   3.558903374762436*^9, 3.5589033779604416`*^9}, {3.559264638214102*^9, 
   3.5592646392281036`*^9}, {3.56152558249544*^9, 3.5615255833378415`*^9}, {
   3.567712960903683*^9, 3.567712961808485*^9}, 3.57212065450091*^9, {
   3.5745725034873385`*^9, 3.5745725429211073`*^9}, {3.5745726368819714`*^9, 
   3.574572649926094*^9}, {3.5914556336639824`*^9, 3.5914556350939846`*^9}, {
   3.592708592645027*^9, 3.592708593975029*^9}, {3.5928584937596893`*^9, 
   3.592858725568514*^9}, {3.5940571577699823`*^9, 3.594057159789985*^9}, {
   3.5944926563063498`*^9, 3.5944926865583925`*^9}, {3.594492775988516*^9, 
   3.594492776368517*^9}, {3.594492837360602*^9, 3.594492837900603*^9}, {
   3.594492902030691*^9, 3.594492936992742*^9}, {3.594493034604878*^9, 
   3.594493069734926*^9}, {3.594493106114977*^9, 3.59449322455514*^9}, 
   3.59449358324364*^9, 3.594515431065692*^9, {3.5945158044122105`*^9, 
   3.594515805652213*^9}, {3.5947545896350193`*^9, 3.5947546197350607`*^9}, {
   3.594828417439077*^9, 3.594828449759122*^9}, {3.594926309197468*^9, 
   3.5949263218474855`*^9}, {3.594927514981152*^9, 3.5949275153411527`*^9}, {
   3.594929784751333*^9, 3.5949297858113346`*^9}, {3.59492992226153*^9, 
   3.594929926493537*^9}, {3.5949299683435946`*^9, 3.5949300347036858`*^9}, 
   3.5950188480312347`*^9, {3.595034990484455*^9, 3.5950349917844567`*^9}, {
   3.5956466336034193`*^9, 3.5956467549255886`*^9}, {3.5956470300339727`*^9, 
   3.5956470819260454`*^9}, {3.5956471788681808`*^9, 3.595647201638212*^9}, {
   3.595647312358365*^9, 3.5956473913904753`*^9}, {3.595715611870015*^9, 
   3.5957156407100554`*^9}, {3.5957156923101263`*^9, 3.595715708840149*^9}, 
   3.595716187234812*^9, {3.5957170337435017`*^9, 3.595717044763517*^9}, {
   3.597258178496549*^9, 3.5972581787265496`*^9}, {3.599261386127534*^9, 
   3.5992613871575356`*^9}, {3.5992772595141573`*^9, 
   3.5992772602741585`*^9}, {3.599277324544247*^9, 3.599277331914257*^9}, {
   3.603647041856326*^9, 3.603647081556381*^9}, {3.618611067270751*^9, 
   3.6186110728807583`*^9}, {3.6186111460108595`*^9, 3.618611158820877*^9}, {
   3.6186112106309485`*^9, 3.6186112148309546`*^9}, {3.6332226277838993`*^9, 
   3.6332226479739275`*^9}, {3.6332232680633373`*^9, 3.633223271203342*^9}, {
   3.6487904358208184`*^9, 3.648790525907971*^9}, {3.6684483212406683`*^9, 
   3.6684483397506933`*^9}, {3.668448371313237*^9, 3.6684483724032383`*^9}, {
   3.6833964238277674`*^9, 3.6833964249926825`*^9}, {3.6912539493321176`*^9, 
   3.6912539770821705`*^9}, 3.6921210127382526`*^9, {3.692498157175506*^9, 
   3.6924981572067585`*^9}, {3.692498188581808*^9, 3.6924982054881015`*^9}, {
   3.695618698451692*^9, 3.695618699407053*^9}, {3.6989476969098516`*^9, 
   3.6989477407249126`*^9}, {3.69894791067515*^9, 3.6989479132551003`*^9}, {
   3.698948249975572*^9, 3.6989482517006264`*^9}, 3.698948337170746*^9, 
   3.698948387285816*^9, {3.704659163921527*^9, 3.7046591660016465`*^9}, {
   3.7046603495084248`*^9, 3.704660372531743*^9}, {3.7110334365290008`*^9, 
   3.711033451294655*^9}, {3.711037659460438*^9, 3.711037663069871*^9}, {
   3.714850937910308*^9, 3.7148509695003376`*^9}, {3.7180645430460205`*^9, 
   3.718064570108611*^9}, {3.7180666054094276`*^9, 3.71806663069073*^9}, {
   3.722288161654131*^9, 3.7222881635447617`*^9}, {3.7222882068104715`*^9, 
   3.7222882083104744`*^9}, {3.722292009776352*^9, 3.7222920136513596`*^9}, {
   3.7262973003213577`*^9, 3.7262973017744856`*^9}, {3.731373845215251*^9, 
   3.7313738572602186`*^9}, {3.7323744228995304`*^9, 3.732374459087102*^9}, {
   3.734451137662434*^9, 3.7344511824145136`*^9}, {3.734451213118719*^9, 
   3.7344512199530644`*^9}, {3.7344512822894893`*^9, 3.734451306024126*^9}, {
   3.7346172811792326`*^9, 3.734617283601099*^9}, {3.7346177011331806`*^9, 
   3.7346177245082216`*^9}, {3.7346179000710773`*^9, 3.734617907211706*^9}, {
   3.7346179430399103`*^9, 3.734617955993041*^9}, {3.734628196652638*^9, 
   3.7346282214183187`*^9}, {3.734628275902807*^9, 3.734628299449718*^9}, {
   3.7346283505904465`*^9, 3.73462838573114*^9}, 3.734628420246833*^9, 
   3.7346284796375732`*^9, 3.734653704466226*^9, 3.7350941129877977`*^9, {
   3.7460429353723526`*^9, 3.7460429393171883`*^9}, {3.7576449198371625`*^9, 
   3.757644924040283*^9}, {3.7875080058443265`*^9, 3.787508006892823*^9}, {
   3.7875151727983875`*^9, 3.787515179298891*^9}, 3.7875944736793284`*^9, 
   3.7978629561501727`*^9, {3.79786348460015*^9, 3.7978634898001633`*^9}, 
   3.797972350692809*^9, 3.802206037420579*^9, 3.8022061516795697`*^9, 
   3.802301107500579*^9, {3.835511100274585*^9, 3.8355111363709936`*^9}, {
   3.8355114669365406`*^9, 3.8355114776833143`*^9}, {3.835706782705152*^9, 
   3.83570678393762*^9}, {3.840806924469942*^9, 3.8408069461340246`*^9}, {
   3.864832285885053*^9, 3.8648322869635344`*^9}, 3.8648323355424967`*^9, {
   3.864832405951236*^9, 3.864832412172256*^9}, 3.888332438264412*^9, {
   3.8898216396054487`*^9, 3.8898216732425184`*^9}, {3.89090179828717*^9, 
   3.8909018372980156`*^9}, 3.89117664149481*^9, {3.8911768756167774`*^9, 
   3.8911768991600065`*^9}, {3.891176929318083*^9, 3.891176998397329*^9}, {
   3.8911770453957224`*^9, 3.891177046571849*^9}, {3.8911773149290705`*^9, 
   3.8911773159271355`*^9}, {3.8911778590150237`*^9, 3.891177881687895*^9}, {
   3.8964718576248426`*^9, 3.896471905089773*^9}, {3.896472330503767*^9, 
   3.8964723986056166`*^9}, 3.8967444519956017`*^9, {3.8969232095478973`*^9, 
   3.8969232614482207`*^9}, {3.8996784181251864`*^9, 3.899678442047888*^9}, {
   3.8996786202701025`*^9, 3.899678729971366*^9}, {3.90493054837309*^9, 
   3.9049305623676844`*^9}, {3.9049306136326647`*^9, 3.904930643033536*^9}, {
   3.904930683365458*^9, 3.9049306845159473`*^9}, {3.904930721305232*^9, 
   3.9049307219961505`*^9}, 3.904930753060878*^9, {3.9049315333979225`*^9, 
   3.90493158800712*^9}, {3.9049316529918137`*^9, 3.9049316845130386`*^9}, {
   3.9049317272722816`*^9, 3.9049317309269624`*^9}, {3.904931784481529*^9, 
   3.904931805559223*^9}, {3.9049318662642803`*^9, 3.904931877822087*^9}, {
   3.9049319105784006`*^9, 3.9049320866590853`*^9}, {3.904932182893236*^9, 
   3.904932199440369*^9}, {3.9049322545038767`*^9, 3.9049322563934336`*^9}, {
   3.9049323550492973`*^9, 3.9049323562424707`*^9}, {3.905009264972822*^9, 
   3.9050092658983603`*^9}, {3.9050094973607416`*^9, 3.905009499207326*^9}, {
   3.905009754705778*^9, 3.9050097747515593`*^9}, {3.9050098070170994`*^9, 
   3.9050098079199257`*^9}, {3.905009872269308*^9, 3.905009906710833*^9}, {
   3.9050292053224773`*^9, 3.905029207409684*^9}, {3.9050292575538073`*^9, 
   3.9050292587623544`*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[39]:=",ExpressionUUID->"66a280ef-aad7-45d6-8b5f-36eee4baf726"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UnitRight", ":=", 
   RowBox[{"unit", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnitUp", ":=", 
   RowBox[{"unit", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"eye", ",", "UnitRight"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"ca6d63a4-c27c-46cf-bff5-60f21f23081d"],

Cell["\<\
For DiskOnSphere[v, AngRad, ShiftToEye, eye] you can substitute Point[v], but \
the point will look like a little pimple on the sphere.\
\>", "Subsubsection",
 CellChangeTimes->{{3.904930877808552*^9, 3.9049309785218353`*^9}, {
  3.9049314746421003`*^9, 
  3.9049314781642485`*^9}},ExpressionUUID->"44175958-b688-48f2-905f-\
93e778bd9548"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DiskOnSphere0", "[", 
    RowBox[{"v_", ",", "AngRad_"}], "]"}], ":=", "     ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"better", " ", "than", " ", "protruding", " ", "points"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"UswapVandK", "[", "v", "]"}], ".", "#"}], "&"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xyzTP", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", " ", 
             RowBox[{"\[Pi]", "/", "4"}]}], ",", "AngRad"}], "}"}], "]"}], 
         ",", 
         RowBox[{"xyzTP", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}], 
             RowBox[{"\[Pi]", "/", "4"}]}], ",", "AngRad"}], "}"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiskOnSphere", "[", 
     RowBox[{"v_", ",", "AngRad_", ",", "ShiftToEye_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MapEyeward", "[", 
        RowBox[{"#", ",", "ShiftToEye", ",", "eye"}], "]"}], "&"}], ",", 
      RowBox[{"DiskOnSphere0", "[", 
       RowBox[{"v", ",", "AngRad"}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"v", " ", "is", " ", "point", " ", "on", " ", "SPHERE"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"2655155d-1742-4162-9e36-c6180b922779"],

Cell[BoxData[{
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".85", "]"}], ",", 
     RowBox[{"Polygon", "/@", 
      RowBox[{"SpherePolyList", "[", 
       RowBox[{
       ".9", ",", "0", ",", "360", ",", "0", ",", "180", ",", "10", ",", 
        "10"}], "]"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"opaque", " ", "sphere"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".58", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1.05", "#"}], "&"}], ",", 
          RowBox[{"DiskOnSphere", "[", 
           RowBox[{
            RowBox[{"unit", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "0"}], "}"}], "]"}], ",", 
            RowBox[{"5", "Degree"}], ",", ".1", ",", 
            RowBox[{"5", 
             RowBox[{"xyztp", "[", 
              RowBox[{"{", 
               RowBox[{"20", ",", "70"}], "}"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"5", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"20", ",", "70"}], "}"}], "]"}]}]}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".85", "]"}], ",", 
     RowBox[{"Polygon", "/@", 
      RowBox[{"SpherePolyList", "[", 
       RowBox[{
       ".9", ",", "0", ",", "360", ",", "0", ",", "180", ",", "10", ",", 
        "10"}], "]"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"opaque", " ", "sphere"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".58", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1.05", "#"}], "&"}], ",", 
          RowBox[{"DiskOnSphere", "[", 
           RowBox[{
            RowBox[{"unit", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{"5", "Degree"}], ",", ".1", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"5", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"20", ",", "70"}], "}"}], "]"}]}]}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.904931115064953*^9, 3.904931164015501*^9}, {
  3.9049312830618167`*^9, 3.9049313090540795`*^9}, {3.9049314131701965`*^9, 
  3.9049314415097833`*^9}, {3.9049324351717453`*^9, 3.9049324539315925`*^9}, {
  3.904932520073948*^9, 3.9049325367200184`*^9}, {3.904932594101405*^9, 
  3.9049326078427477`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"80c12e6b-2deb-4903-aa8b-30b2012e5c64"],

Cell["\<\
Mathematica now has its own version of 3D arrows, but you might still want \
mine.\
\>", "Subsubsection",
 CellChangeTimes->{{3.905005754737446*^9, 
  3.905005813095949*^9}},ExpressionUUID->"43c7daae-7c7a-4a27-abec-\
d5c3ce52c7a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CirclePt", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], "+", 
     RowBox[{
      RowBox[{"xrot", "[", "i", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"1", "/", "3"}]}], "}"}]}]}]}], ";"}], "            ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Revised", " ", "July", " ", "2017"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePt", "[", "i", "]"}], ",", 
     RowBox[{"CirclePt", "[", 
      RowBox[{"i", "+", "30"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HalfDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "90"}], ",", "90", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WholeDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UofSN", "[", 
     RowBox[{"S_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"unit", "[", "S", "]"}], ",", 
       RowBox[{"unit", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"N", ",", "S"}], "]"}], "]"}], ",", 
       RowBox[{"unit", "[", "N", "]"}]}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Rotation", " ", "matrix", " ", "that", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}], " ", "to", " ", "S", " ", 
     "and", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}], " ", "to", " ", 
     RowBox[{"N", ".", "  ", "S"}], " ", "and", " ", "N", " ", "are", " ", 
     "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenForArrow", "[", 
    RowBox[{"vector_", ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"1.02", 
       FractionBox["ArrowScale", 
        RowBox[{"length", "[", "vector", "]"}]]}]}], ")"}], "vector"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenLineForArrow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"p2", "-", 
      RowBox[{"1.1", "ArrowScale", " ", 
       RowBox[{"unit", "[", 
        RowBox[{"p2", "-", "p1"}], "]"}]}]}]}], "}"}]}], ";", "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"maybe", " ", "change", " ", "1.28"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7107786899249983`*^9, 3.7107787639572253`*^9}, {
   3.7107788118280177`*^9, 3.7107788181643305`*^9}, {3.710778912245721*^9, 
   3.7107789321648617`*^9}, {3.7107789661808095`*^9, 3.7107790412041025`*^9}, 
   3.7107811120535154`*^9, {3.7107817359922495`*^9, 3.7107817406455126`*^9}, {
   3.71087483028846*^9, 3.710874838160901*^9}, {3.710874879680277*^9, 
   3.7108748932330556`*^9}, 3.7108756004805655`*^9, {3.736194997883952*^9, 
   3.7361950278057995`*^9}, {3.8250052839535685`*^9, 3.825005358245612*^9}, {
   3.8250053918168297`*^9, 3.8250054090252857`*^9}, {3.82500544572526*^9, 
   3.825005524949031*^9}, {3.825005688389964*^9, 3.8250056889926434`*^9}, {
   3.8250057325066743`*^9, 3.825005733949659*^9}, {3.825006716601698*^9, 
   3.8250067918226833`*^9}, {3.8250068912164707`*^9, 3.8250069090635386`*^9}, 
   3.8970688521193123`*^9, {3.8970688908843336`*^9, 3.8970689925358343`*^9}, 
   3.898878212778217*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"de0b5f7f-e736-4fc1-8228-3089283485d3"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "3"}]}], "}"}], "]"}]}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "WholeDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", ".02", "]"}], ",", "Green", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}]}],
        "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7108116645540957`*^9, 3.710811757531419*^9}, {
  3.710874044242437*^9, 3.710874146913313*^9}, {3.7108742293970375`*^9, 
  3.710874235408381*^9}, {3.7108742793288965`*^9, 3.7108743178241005`*^9}, {
  3.710874366080868*^9, 3.71087466840018*^9}, {3.7422518021341333`*^9, 
  3.7422518888995514`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"733597fd-1ba5-474b-9286-538a100de8a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3Dhalf", "[", 
     RowBox[{
     "TipPt_", ",", "Direction_", ",", "Normal_", ",", "ArrowScale_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"Polygon", "/@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TipPt", "+", 
           RowBox[{"ArrowScale", "*", 
            RowBox[{
             RowBox[{"UofSN", "[", 
              RowBox[{"Direction", ",", "Normal"}], "]"}], ".", "#"}]}]}], 
          "&"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Direction", " ", "and", " ", "Normal", " ", "vectors", " ", "must", " ", 
     "be", " ", "perpendicular"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"TipPt_", ",", "Direction_", ",", "ArrowScale_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"Direction", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sign", "[", 
                   RowBox[{"Direction", ".", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}]}]}], "&"}], 
           ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"ZRot", "[", 
                RowBox[{"Theta", "[", "Direction", "]"}], "]"}], ".", 
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "\[Pi]"}], "/", "2"}], "+", 
                 RowBox[{"Phi", "[", "Direction", "]"}]}], "]"}], ".", 
               "#"}]}]}], "&"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "}"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.710779889690693*^9, 3.710779919045374*^9}, {
   3.7107799708053384`*^9, 3.710779974964576*^9}, {3.710780028709654*^9, 
   3.7107800471567097`*^9}, {3.7107807853978124`*^9, 
   3.7107808081331143`*^9}, {3.710780838660859*^9, 3.710780839860928*^9}, {
   3.7107809423407965`*^9, 3.710780944388914*^9}, {3.7107811883588886`*^9, 
   3.7107811918130865`*^9}, 3.710781563014344*^9, {3.7107851253825755`*^9, 
   3.710785151318061*^9}, {3.7107862235734615`*^9, 3.7107862546782465`*^9}, {
   3.710786354039937*^9, 3.710786361413356*^9}, {3.7107864015606537`*^9, 
   3.7107864475902967`*^9}, 3.7107864923428593`*^9, {3.7108747054413085`*^9, 
   3.710874753537052*^9}, {3.7109019519823785`*^9, 3.7109019569566593`*^9}, 
   3.7422539345506487`*^9, {3.7447380617113123`*^9, 3.7447380638050575`*^9}, {
   3.744738109648678*^9, 3.7447381441486034`*^9}, 3.74473868850661*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"70dce430-050a-4e05-a98c-c397e9a18594"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArrowScale", "=", ".25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"Arrow3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "ArrowScale"}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".03", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"ShortenLineForArrow", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          "ArrowScale"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"10", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "90"}], ",", "70"}], "}"}], "]"}]}]}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8250048752904644`*^9, 3.825005150456607*^9}, {
   3.8250055882251663`*^9, 3.825005612758525*^9}, 3.8250057045144186`*^9, {
   3.8643334161124296`*^9, 3.8643334181389666`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"1df3a6f6-abbe-4db8-9ab4-c032f71f0168"],

Cell[TextData[{
 "POINT P ON THE SPHERE IS VISIBLE FROM THE VIEWPOINT ",
 StyleBox["EYE",
  FontSlant->"Italic"],
 " IFF ",
 StyleBox["SEE[P,EYE]",
  FontSlant->"Italic"],
 "."
}], "SmallText",
 Evaluatable->False,
 CellChangeTimes->{{3.905005928630127*^9, 3.9050059305861692`*^9}},
 AspectRatioFixed->True,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"e020a74d-ae6d-41a2-a720-3d523d7dc521"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SeeOnSphere", "[", 
    RowBox[{"p_", ",", "n_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ScalarProj", "[", 
     RowBox[{"p", ",", "eye"}], "]"}], ">", 
    FractionBox[
     SuperscriptBox["n", "2"], 
     RowBox[{"length", "[", "eye", "]"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.508994997710577*^9, 3.508995003140585*^9}, {
   3.508995045550643*^9, 3.5089950596506624`*^9}, {3.5089952524409285`*^9, 
   3.508995259730939*^9}, {3.5118744273638315`*^9, 3.5118744292046347`*^9}, {
   3.5118747205039425`*^9, 3.511874734590767*^9}, {3.5118748654593954`*^9, 
   3.511874892166642*^9}, {3.511874992084816*^9, 3.5118750118344507`*^9}, 
   3.511875082190573*^9, 3.51187521798881*^9, {3.511878399458357*^9, 
   3.511878404684366*^9}, {3.546998714978611*^9, 3.5469987978266563`*^9}, {
   3.5469988311471148`*^9, 3.546998862156869*^9}, {3.546999511237503*^9, 
   3.546999533795142*^9}, {3.546999695380224*^9, 3.5469997008090334`*^9}, {
   3.546999780493973*^9, 3.5469998116784267`*^9}, {3.8880663286692147`*^9, 
   3.8880664101525793`*^9}, {3.888067205368599*^9, 3.888067298310684*^9}, {
   3.905005962283085*^9, 3.905005964490736*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"7751bdd4-3aa5-4604-9684-4829d47aec5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Principal axes as vectors", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.7319457883590517`*^9}},ExpressionUUID->"71dcbe3a-4967-498d-850a-\
f3a229b31075"],

Cell["\<\
WantArrowColor can be \"TriColor\", \"Custom\", or \"Gray\".
   ArrowColor is some Hue, but only relevant if WantArrowColor = \"Custom\".\
\>", "Text",
 CellChangeTimes->{{3.715714996393337*^9, 3.7157150016902084`*^9}, {
  3.715715819423092*^9, 3.7157159643609123`*^9}},
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"d7ee5dad-6582-4143-8917-cc5fd9a2fd48"],

Cell[BoxData[
 RowBox[{"ShortenLineForArrow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.2", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   "ArrowScale"}], "]"}]], "Input",
 CellChangeTimes->{{3.8250073829437714`*^9, 3.825007394229742*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"8bed3c4d-a98b-4cdf-871b-85c6bc0e027c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Paxes", "[", 
   RowBox[{
   "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
    ",", "BBrad_", ",", "ArrowScale_", ",", "tkns_", ",", "WantArrowColor_", 
    ",", "ArrowColor_"}], "]"}], ":=", 
  RowBox[{"{", "      ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"changed", " ", "Sept", " ", "2017"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"t1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"BBrad", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".01", ",", ".8", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "BBrad", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".6", ",", ".9", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "BBrad"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", ".15", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.710884862433217*^9, 3.710885007042824*^9}, {
   3.710885057824211*^9, 3.710885080152393*^9}, {3.710885123496228*^9, 
   3.710885138761883*^9}, {3.710885295230939*^9, 3.710885325262247*^9}, {
   3.7148818954088717`*^9, 3.7148819325808067`*^9}, {3.7148820064247136`*^9, 
   3.7148820424560337`*^9}, {3.715712432333237*^9, 3.7157124636770716`*^9}, {
   3.715713383015217*^9, 3.715713383858967*^9}, {3.715713463359124*^9, 
   3.715713467265382*^9}, {3.715715040315297*^9, 3.7157150468622227`*^9}, 
   3.7157150782528715`*^9, {3.7157152995501757`*^9, 3.7157153238940125`*^9}, 
   3.7157154168004107`*^9, {3.7157155132068825`*^9, 3.7157155339725485`*^9}, {
   3.715715590832035*^9, 3.715715603816439*^9}, 3.7157157965324593`*^9, {
   3.825007157157131*^9, 3.825007194024397*^9}, {3.8250072260371356`*^9, 
   3.825007250068356*^9}, {3.8250072900112967`*^9, 3.8250073013836217`*^9}, {
   3.8250074433354797`*^9, 3.8250074816391563`*^9}, {3.8250075503475633`*^9, 
   3.8250075574354987`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"5a8bae42-1da8-4116-9e04-3372558b03d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Principal axes as lines, no arrows.", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.731945812149082*^9}},ExpressionUUID->"745e7fca-08d9-40c1-9a20-\
b63fb8a750ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalAxes", "[", 
    RowBox[{
    "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
     ",", "BBrad_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Thickness", "[", "tkns", "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"lines", ",", " ", 
        RowBox[{"no", " ", "arrows"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".01", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "lengthAxis"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".57", ",", "1", ",", "1"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "lengthAxis"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".15", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "lengthAxis"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504471849812714*^9, 3.5044718903327703`*^9}, {
   3.5044719323628283`*^9, 3.5044719941229134`*^9}, {3.5122275063263364`*^9, 
   3.5122275300227776`*^9}, {3.5122278033508544`*^9, 3.51222780634606*^9}, {
   3.512227916029851*^9, 3.51222798997398*^9}, {3.5122280516876874`*^9, 
   3.512228053700091*^9}, {3.512228085165346*^9, 3.5122281150705976`*^9}, {
   3.5123939753233414`*^9, 3.5123939753533416`*^9}, {3.5183042958838587`*^9, 
   3.518304332216322*^9}, {3.51830439414843*^9, 3.5183044095612564`*^9}, {
   3.522959570528062*^9, 3.522959584538081*^9}, {3.52295998940864*^9, 
   3.5229600030186586`*^9}, {3.5468753296470337`*^9, 
   3.5468753366358457`*^9}, {3.546875437568022*^9, 3.546875439268425*^9}, {
   3.546920669441621*^9, 3.5469206878652525`*^9}, {3.547069861331265*^9, 
   3.547069899816532*^9}, {3.5479172086508427`*^9, 3.547917209774045*^9}, {
   3.559264686152985*^9, 3.5592646885553894`*^9}, {3.5944937685858965`*^9, 
   3.594493777165909*^9}, {3.698767816765506*^9, 3.698767817358539*^9}, 
   3.6987687967186327`*^9, {3.698768832365678*^9, 3.6987688341737814`*^9}, 
   3.698777024974787*^9, {3.69877829283139*^9, 3.698778315407683*^9}, {
   3.7359402899442945`*^9, 3.7359403467568765`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"4551f1e7-eec6-461c-a4e0-c4aaa742526a"]
}, Open  ]],

Cell["Bases for \[DoubleStruckCapitalM]", "Section",
 CellChangeTimes->{{3.891271359057156*^9, 3.8912713842724495`*^9}, 
   3.8912714407128105`*^9},ExpressionUUID->"1b128147-da2e-4a38-894f-\
1e526c764389"],

Cell[CellGroupData[{

Cell["The basis PHI", "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 
   3.794684828874474*^9}},ExpressionUUID->"1a9ccdc1-5f09-49a4-bc14-\
cee4cd0314f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PHI", "=", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "1", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", 
          FractionBox["1", 
           SqrtBox["2"]]},
         {"0", 
          FractionBox["1", 
           SqrtBox["2"]], "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", 
          FractionBox["1", 
           SqrtBox["2"]]},
         {"0", "0", "0"},
         {
          FractionBox["1", 
           SqrtBox["2"]], "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", 
          FractionBox["1", 
           SqrtBox["2"]], "0"},
         {
          FractionBox["1", 
           SqrtBox["2"]], "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "}"}]}], ";", "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Added", " ", "March", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  RowBox[{
   RowBox[{"PHIcoords", "[", "matrix_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{"matrix", ",", 
       RowBox[{"PHI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixFromPHIcoords", "[", "SixTuple_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SixTuple", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{"PHI", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"PHIcoords", "[", 
   RowBox[{"MatrixFromPHIcoords", "[", 
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2", ",", "t3", ",", "t4", ",", "t5", ",", "t6"}], 
     "}"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PHIcoords", "[", 
  RowBox[{"MatrixFromPHIcoords", "[", 
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2", ",", "t3", ",", "t4", ",", "t5", ",", "t6"}], 
    "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixFromPHIcoords", "[", 
   RowBox[{"{", 
    RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
    "}"}], "]"}], "==", 
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"m1", 
      RowBox[{"m6", "/", 
       SqrtBox["2"]}], 
      RowBox[{"m5", "/", 
       SqrtBox["2"]}]},
     {
      RowBox[{"m6", "/", 
       SqrtBox["2"]}], "m2", 
      RowBox[{"m4", "/", 
       SqrtBox["2"]}]},
     {
      RowBox[{"m5", "/", 
       SqrtBox["2"]}], 
      RowBox[{"m4", "/", 
       SqrtBox["2"]}], "m3"}
    }], "\[NoBreak]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PHIcoords", "[", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m1", "m6", "m5"},
      {"m6", "m2", "m4"},
      {"m5", "m4", "m3"}
     }], "\[NoBreak]", ")"}], "]"}], "==", 
  RowBox[{"{", 
   RowBox[{"m1", ",", "m2", ",", "m3", ",", 
    RowBox[{"m4", 
     SqrtBox["2"]}], ",", 
    RowBox[{"m5", 
     SqrtBox["2"]}], ",", 
    RowBox[{"m6", 
     SqrtBox["2"]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{
      RowBox[{"PHI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"PHI", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ColumnForm", "[", 
  RowBox[{"PHIcoords", "/@", "PHI"}], "]"}]}], "Input",
 CellChangeTimes->{{3.792696902137858*^9, 3.792696996573308*^9}, {
   3.792697114729004*^9, 3.792697116525865*^9}, 3.792697236919984*^9, {
   3.7926974569058943`*^9, 3.792697457844887*^9}, {3.8672850308477755`*^9, 
   3.8672850420296764`*^9}, {3.86728519596425*^9, 3.867285232390198*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"b86605f1-b4a2-4b9c-afac-efe14e2c5c73"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The basis SIG", "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 3.794684828874474*^9}, {3.806339797064885*^9, 
   3.8063397985369205`*^9}},ExpressionUUID->"711d2f4f-b902-4860-bd96-\
e08a4a3b5b29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SIG", "=", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "1", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "1"},
         {"0", "1", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "1"},
         {"0", "0", "0"},
         {"1", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1", "0"},
         {"1", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SIGcoords", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"m1_", "m6_", "m5_"},
        {"dum6_", "m2_", "m4_"},
        {"dum5_", "dum4_", "m3_"}
       }], "\[NoBreak]", ")"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"ONLY", " ", "FOR", " ", "SYMMETRIC", " ", 
     RowBox[{"M", ".", " ", "Used"}], " ", "to", " ", "be", " ", 
     RowBox[{"SkewCoords", "."}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixFromSIGcoords", "[", 
     RowBox[{"{", 
      RowBox[{
      "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "m5_", ",", "m6_"}], 
      "}"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"m1", "m6", "m5"},
       {"m6", "m2", "m4"},
       {"m5", "m4", "m3"}
      }], "\[NoBreak]", ")"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"used", " ", "to", " ", "be", " ", "MatrixFromSkewCoords"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.806339821768931*^9, 3.8063398226979356`*^9}, {
  3.8063398678008013`*^9, 3.8063398699612007`*^9}, {3.8094786816006403`*^9, 
  3.80947880111825*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"3cd01cf2-75d9-43f5-9877-bff98d1d875b"],

Cell[BoxData[
 RowBox[{"ColumnForm", "[", 
  RowBox[{"SIGcoords", "/@", "SIG"}], "]"}]], "Input",
 CellChangeTimes->{{3.8672851578407345`*^9, 3.867285164467288*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"ecc053b9-8584-4c12-8e0b-1ec2ef4e2a84"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{
      RowBox[{"SIG", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"SIG", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8198424697390237`*^9, 3.819842476548627*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"b4ebb9e0-839b-459d-9daf-32c2a7f33569"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The basis UPSILON", "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 3.794684828874474*^9}, {3.806339797064885*^9, 
   3.8063397985369205`*^9}, {3.8063398400729437`*^9, 
   3.80633984421693*^9}},ExpressionUUID->"2cef4f1d-77d8-45ac-ab3f-\
daa8bd6d8aa4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UPSILON", "=", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "1", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", "1"},
          {"0", "1", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "1"},
          {"0", "0", "0"},
          {"1", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "1", "0"},
          {"1", "0", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UPSILONcoords", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"m1_", "m6_", "m5_"},
        {"dum6_", "m2_", "m4_"},
        {"dum5_", "dum4_", "m3_"}
       }], "\[NoBreak]", ")"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", 
      RowBox[{"2", "m4"}], ",", 
      RowBox[{"2", "m5"}], ",", 
      RowBox[{"2", "m6"}]}], "}"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"ONLY", " ", "FOR", " ", "SYMMETRIC", " ", 
     RowBox[{"M", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixFromUPSILONcoords", "[", 
     RowBox[{"{", 
      RowBox[{
      "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "m5_", ",", "m6_"}], 
      "}"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"m1", 
        RowBox[{"m6", "/", "2"}], 
        RowBox[{"m5", "/", "2"}]},
       {
        RowBox[{"m6", "/", "2"}], "m2", 
        RowBox[{"m4", "/", "2"}]},
       {
        RowBox[{"m5", "/", "2"}], 
        RowBox[{"m4", "/", "2"}], "m3"}
      }], "\[NoBreak]", ")"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.806339805708922*^9, 3.8063398652759295`*^9}, {
  3.809478857198679*^9, 3.80947888831868*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"fe0a8aed-94e5-439e-a7db-0402b85ab837"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{
      RowBox[{"UPSILON", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"UPSILON", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8198423744179425`*^9, 3.819842427109725*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"1cb0a168-28b7-4f71-acd7-0a70cd323b34"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The basis \[DoubleStruckCapitalB]", "Section",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 
   3.794684814362468*^9}},ExpressionUUID->"b44b81fd-8c91-4d94-8d4e-\
568fa1161213"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"basisBB", ",", "BB"}], "]"}]], "Input",
 CellChangeTimes->{{3.792968905277422*^9, 3.7929689145280447`*^9}, {
  3.7929727413930016`*^9, 3.7929727432679977`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"6091c588-60a0-400a-8b10-279617b84d4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "1", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eqs", ".", " ", "3"}], " ", "of", " ", "the", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "2", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", 
       FractionBox["1", 
        SqrtBox["2"]]},
      {"0", "0", "0"},
      {
       FractionBox["1", 
        SqrtBox["2"]], "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "3", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {
       FractionBox["1", 
        SqrtBox["2"]], "0", "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "4", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}], "0", "0"},
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "5", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], ";", 
   RowBox[{
    RowBox[{"BB", "[", "5", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["6"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", 
         RowBox[{"-", "2"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "May", " ", "30"}], ",", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "6", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", "0"},
       {"0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";", 
   RowBox[{
    RowBox[{"BB", "[", "6", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["3"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "May", " ", "30"}], ",", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basisBB", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BB", "[", "1", "]"}], ",", 
      RowBox[{"BB", "[", "2", "]"}], ",", 
      RowBox[{"BB", "[", "3", "]"}], ",", 
      RowBox[{"BB", "[", "4", "]"}], ",", 
      RowBox[{"BB", "[", "5", "]"}], ",", 
      RowBox[{"BB", "[", "6", "]"}]}], "}"}]}], ";"}], "    "}]}], "Input",
 CellChangeTimes->{{3.792971206733848*^9, 3.7929713022003465`*^9}, {
   3.792971408071004*^9, 3.792971440387087*^9}, {3.792971498549478*^9, 
   3.792971499440118*^9}, 3.792972692948264*^9, {3.7929727241080465`*^9, 
   3.7929727262955894`*^9}, {3.792972763426332*^9, 3.7929727864596667`*^9}, {
   3.793302127686242*^9, 3.793302210883026*^9}, {3.793452169745813*^9, 
   3.793452205234699*^9}, {3.7934534711802993`*^9, 3.793453503105508*^9}, {
   3.7934875097186317`*^9, 3.7934875184076557`*^9}, {3.7940628516347594`*^9, 
   3.794062915122757*^9}, 3.7940668797157593`*^9, {3.794303579755892*^9, 
   3.794303673207573*^9}, 3.7946837182844687`*^9, {3.794683831532472*^9, 
   3.7946838327474766`*^9}, {3.795368427569252*^9, 3.795368457449376*^9}, {
   3.7954159482798815`*^9, 3.7954159499048824`*^9}, {3.7998533351296206`*^9, 
   3.7998534017979136`*^9}, {3.7998594859163437`*^9, 
   3.7998594916854353`*^9}, {3.7998596087056255`*^9, 
   3.7998596116364765`*^9}, {3.7999471922765937`*^9, 
   3.7999472010435143`*^9}, {3.799947251311059*^9, 3.7999472826775537`*^9}, {
   3.7999474305174685`*^9, 3.79994753957263*^9}, {3.7999477903421464`*^9, 
   3.7999478574073067`*^9}, {3.8303041767764983`*^9, 3.83030423992684*^9}, {
   3.8303043151804295`*^9, 3.8303043233750134`*^9}, {3.905006144417451*^9, 
   3.905006145297263*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"43567a56-003c-4abb-91fb-35184cf44eef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "BBcoords", ",", "MatrixFromBBcoords", ",", "x1", ",", "x2", ",", "x3", 
    ",", "x4", ",", "x5", ",", "x6"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BBcoords", "[", "matrix_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{"matrix", ",", 
       RowBox[{"basisBB", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixFromBBcoords", "[", "SixTuple_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SixTuple", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{"basisBB", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791744000837245*^9, 3.7917441047052464`*^9}, {
   3.791744170018241*^9, 3.7917441740012484`*^9}, {3.79269657336189*^9, 
   3.7926965758462753`*^9}, {3.7926967056139927`*^9, 3.792696730803466*^9}, {
   3.7926968362379637`*^9, 3.7926968371442175`*^9}, {3.7929691933436403`*^9, 
   3.792969238024858*^9}, {3.7943216749122763`*^9, 3.7943216757247753`*^9}, {
   3.794684451692464*^9, 3.794684463274473*^9}, {3.8095322085676994`*^9, 
   3.8095322666638746`*^9}, 3.879349730898106*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"2fa51d89-bd88-4116-8147-c241cba48a60"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"BBcoords", "[", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"e11", "e12", "e13"},
      {"e12", "e22", "e23"},
      {"e13", "e23", "e33"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.795395417654133*^9, 3.795395512579124*^9}, {
  3.7998536197713404`*^9, 3.799853625162981*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"f408ea31-8984-4bfb-b415-013730651fa7"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"MatrixFromBBcoords", "[", 
    RowBox[{"BBcoords", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"e11", "e12", "e13"},
        {"e12", "e22", "e23"},
        {"e13", "e23", "e33"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}], 
    "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"BBcoords", "[", 
   RowBox[{"MatrixFromBBcoords", "[", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
     "}"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7953955639994907`*^9, 3.7953956976415105`*^9}, {
   3.7953959027489777`*^9, 3.7953959246432147`*^9}, {3.799853675615387*^9, 
   3.7998537243639565`*^9}, 3.8095321532103558`*^9, {3.809532253288416*^9, 
   3.809532254439828*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"3ed84df6-78dd-472b-8ffd-2ed3d6f41318"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<MatrixFromBBcoords[{x1,x2,x3,x4,x5,x6}] = \!\(\*FractionBox[\(1\), \
SqrtBox[\(6\)]]\)\>\"", ",", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      SqrtBox["6"], 
      RowBox[{"MatrixFromBBcoords", "[", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "}"}], "]"}]}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7953965719582186`*^9, 3.7953966179690533`*^9}, {
  3.799775510923004*^9, 3.799775574615201*^9}, {3.7998537655483413`*^9, 
  3.799853812332962*^9}, {3.799877756757416*^9, 3.7998777607886767`*^9}, {
  3.804280725885015*^9, 3.8042807564556875`*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"35409d7d-977c-4a90-b569-1554d2b7b1a3"],

Cell[BoxData[
 RowBox[{"ColumnForm", "[", 
  RowBox[{"BBcoords", "/@", "basisBB"}], "]"}]], "Input",
 CellChangeTimes->{{3.793386720482166*^9, 3.7933867515166516`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"0d99e1e4-4186-4d4e-98fe-6da82082c485"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "About",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SubscriptBox["I", 
     RowBox[{"basis2", ",", " ", "basis1"}]]}], TraditionalForm]],
  ExpressionUUID->"e315cb32-b09b-412a-af46-287a56ea5d95"]
}], "Section",
 CellChangeTimes->{{3.787197726442168*^9, 3.787197770686696*^9}, {
   3.795401347998807*^9, 3.795401349373804*^9}, {3.795401395854579*^9, 
   3.795401396917082*^9}, {3.8103239795180693`*^9, 3.810323986236885*^9}, 
   3.8228372108987193`*^9, {3.8303049300878143`*^9, 3.8303049392078156`*^9}, {
   3.830304980037236*^9, 3.830304986020372*^9}, {3.859817796177543*^9, 
   3.8598178007004504`*^9}, {3.867366385422104*^9, 3.8673664433153315`*^9}, 
   3.867371580977296*^9},ExpressionUUID->"00ec15e0-5def-4c91-9035-\
eb4cf1126735"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatIsubCAbasisCisON", "[", 
     RowBox[{"C_", ",", "A_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", "jj", "]"}], "]"}], ",", 
        RowBox[{"C", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"WATCH", " ", 
     RowBox[{"ORDER", "!"}], " ", "The", " ", "matrix", " ", "takes", " ", 
     "A", " ", "coords", " ", "to", " ", "C", " ", "coords"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatIsubBA", "[", "A_", "]"}], ":=", 
   RowBox[{"MatIsubCAbasisCisON", "[", 
    RowBox[{"basisBB", ",", "A"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795366787317892*^9, 3.7953667943027153`*^9}, {
   3.795366833447504*^9, 3.795366939628875*^9}, {3.7953673232631545`*^9, 
   3.795367324122529*^9}, {3.795919663676679*^9, 3.795919670739746*^9}, {
   3.802450546075781*^9, 3.8024506182744646`*^9}, {3.803754326680868*^9, 
   3.8037543353577757`*^9}, 3.8228366196756544`*^9, 3.822838989604717*^9, {
   3.822840724552447*^9, 3.8228407372844496`*^9}, 3.822841698660452*^9, {
   3.8228417817634478`*^9, 3.822841872708436*^9}, {3.8228419410124397`*^9, 
   3.822842021445455*^9}, {3.830312227032202*^9, 3.830312229200873*^9}, {
   3.8673666779686127`*^9, 3.867366692313542*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"d8c01912-bc97-4ee2-b918-9b1021693ac1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"CC", ",", "AA"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"CC", ",", "AA"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8672205594402385`*^9, 3.8672206241220703`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"de9405b0-2022-4786-9984-1e3c67503389"],

Cell[CellGroupData[{

Cell["About \[DoubleStruckCapitalB] and PHI", "Subsubsection",
 CellChangeTimes->{{3.867285596562114*^9, 
  3.8672856476990128`*^9}},ExpressionUUID->"dcb3bc63-b395-4b32-a26a-\
b1db5c803f14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsubB\[CapitalPhi]", "=", 
   RowBox[{"MatIsubBA", "[", "PHI", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalPhi]B", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "MatIsubB\[CapitalPhi]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalPhi]\)]\)\>\"", ",", "20"}], 
     "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsubB\[CapitalPhi]", "]"}], ",", 
    "\"\< = \!\(\*FractionBox[\(\(1\)\(\\\ \)\), SqrtBox[\(6\)]]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       SqrtBox["6"], "MatIsubB\[CapitalPhi]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalPhi]\[CapitalBeta]\)]\)\>\"", 
      ",", "20"}], "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsub\[CapitalPhi]B", "]"}], ",", 
    "\"\< = \!\(\*FractionBox[\(\(1\)\(\\\ \)\), SqrtBox[\(6\)]]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       SqrtBox["6"], "MatIsub\[CapitalPhi]B"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsubB\[CapitalPhi]", ".", 
      RowBox[{"Transpose", "[", "MatIsubB\[CapitalPhi]", "]"}]}], "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalPhi]\)]\)\>\"", ",", "20"}],
        "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalPhi]\)]\)\>\"", ",", "20"}],
        "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"basisBB", ",", "PHI"}], "]"}], "==", 
  "MatIsubB\[CapitalPhi]"}]}], "Input",
 CellChangeTimes->{{3.8674238775364203`*^9, 3.8674239012806163`*^9}, {
   3.867423966045786*^9, 3.8674239669779453`*^9}, {3.8675048395136385`*^9, 
   3.867504864822561*^9}, {3.86750499042251*^9, 3.8675049931585855`*^9}, 
   3.8675052805497017`*^9, {3.8675053367256155`*^9, 3.8675053496876936`*^9}, {
   3.867505898359041*^9, 3.8675059222292833`*^9}, {3.867537677814142*^9, 
   3.8675376813118553`*^9}, {3.8689909196809654`*^9, 3.868990983958818*^9}, {
   3.8689910155002775`*^9, 3.868991036874382*^9}, 3.868991085459549*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"a2f9ca27-8199-442c-8a19-be502a916d00"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   StyleBox[
    SqrtBox["6"],
    FontColor->RGBColor[1, 0, 0]], "MatIsub\[CapitalPhi]B"}], "]"}]], "Input",
 CellChangeTimes->{{3.86753761950867*^9, 3.867537686934974*^9}, 
   3.867537763024304*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"8824a290-3918-4294-a684-895b3df1ceac"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{"basisBB", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"PHI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det B vs PHI = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Det", "[", "%", "]"}], ",", "16", ",", "Bold"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7998539003260736`*^9, 3.799853907962598*^9}, {
  3.8675377480491495`*^9, 3.8675377584917784`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"7d76b291-5bdb-40e4-8562-a92db06af3d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["About \[DoubleStruckCapitalB] and UPSILON", "Subsubsection",
 CellChangeTimes->{{3.867285596562114*^9, 3.8672856476990128`*^9}, {
  3.867285756906685*^9, 
  3.867285760775693*^9}},ExpressionUUID->"cb7be0fd-c0a7-4fce-84d7-\
d4afbcf4e44c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatIsubBA", "[", "UPSILON", "]"}], "==", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{
      RowBox[{"UPSILON", "[", 
       RowBox[{"[", "jj", "]"}], "]"}], ",", 
      RowBox[{"basisBB", "[", 
       RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[151]:=",ExpressionUUID->"b736b1ae-90e9-41d8-8fd0-c956a2590faf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsubB\[CapitalUpsilon]", "=", 
   RowBox[{"MatIsubBA", "[", "UPSILON", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalUpsilon]\)]\)\>\"", ",", 
      "20"}], "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsubB\[CapitalUpsilon]", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsubB\[CapitalUpsilon]", ".", 
      RowBox[{"Transpose", "[", "MatIsubB\[CapitalUpsilon]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalUpsilon]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalUpsilon]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalUpsilon]B", "=", 
   RowBox[{"Inverse", "[", "MatIsubB\[CapitalUpsilon]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"UPSILON", ",", "basisBB"}], "]"}], "==", 
  "MatIsub\[CapitalUpsilon]B"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367560925995*^9, 
   3.867367563097133*^9}, {3.8673677650840683`*^9, 3.867367828773975*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"33d92b5c-bb0f-4ff1-8f5e-7ce847f787ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["About \[DoubleStruckCapitalB] and SIG", "Subsubsection",
 CellChangeTimes->{{3.867285596562114*^9, 3.8672856476990128`*^9}, {
  3.867285756906685*^9, 3.867285760775693*^9}, {3.867286937694174*^9, 
  3.8672869391817236`*^9}},ExpressionUUID->"1ce932aa-22da-4b69-8833-\
382cb1b195d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsubB\[CapitalSigma]", "=", 
   RowBox[{"MatIsubBA", "[", "SIG", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalSigma]\)]\)\>\"", ",", "20"}],
      "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsubB\[CapitalSigma]", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsubB\[CapitalSigma]", ".", 
      RowBox[{"Transpose", "[", "MatIsubB\[CapitalSigma]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalSigma]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalSigma]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalSigma]B", "=", 
   RowBox[{"Inverse", "[", "MatIsubB\[CapitalSigma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"SIG", ",", "basisBB"}], "]"}], "==", 
  "MatIsub\[CapitalSigma]B"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367426452508*^9, 
   3.8673674302558823`*^9}, {3.8673674854886894`*^9, 3.867367507069461*^9}, {
   3.8673675765083055`*^9, 3.867367577314044*^9}, {3.8673676634915085`*^9, 
   3.8673677143245993`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"98c37d55-4f2a-424a-bbae-ef80b1095416"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalSigma]\[CapitalPhi]\)]\)\>\"", 
      ",", "20"}], "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsub\[CapitalSigma]\[CapitalPhi]", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsub\[CapitalSigma]\[CapitalPhi]", ".", 
      RowBox[{
      "Transpose", "[", "MatIsub\[CapitalSigma]\[CapitalPhi]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \
\(\[CapitalSigma]\[CapitalPhi]\)]\)\>\"", ",", "20"}], "]"}], " ", ",", 
      "\"\< is orthogonal\>\""}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \
\(\[CapitalSigma]\[CapitalPhi]\)]\)\>\"", ",", "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367560925995*^9, 
   3.867367563097133*^9}, {3.8673677650840683`*^9, 3.867367828773975*^9}, {
   3.8673695037197523`*^9, 3.8673696463256173`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"92a78539-c391-49db-a4e3-4164305d788f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \
\(\[CapitalPhi]\[CapitalUpsilon]\)]\)\>\"", ",", "20"}], "]"}], ",", 
    "\"\< = \>\"", ",", 
    RowBox[{
    "MatrixForm", "[", "MatIsub\[CapitalPhi]\[CapitalUpsilon]", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsub\[CapitalPhi]\[CapitalUpsilon]", ".", 
      RowBox[{
      "Transpose", "[", "MatIsub\[CapitalPhi]\[CapitalUpsilon]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalPhi]\[CapitalUpsilon]\)]\)\>\
\"", ",", "20"}], "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalPhi]\[CapitalUpsilon]\)]\)\>\
\"", ",", "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367560925995*^9, 
   3.867367563097133*^9}, {3.8673677650840683`*^9, 3.867367828773975*^9}, {
   3.8673695037197523`*^9, 3.8673696463256173`*^9}, {3.867369730599429*^9, 
   3.867369772408881*^9}, {3.8675088656287785`*^9, 3.8675088780365252`*^9}, 
   3.8675089224212227`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"5c9a984c-e4bc-4876-a63a-482f6cd4ed90"],

Cell[BoxData[{
 RowBox[{"MatIsub\[CapitalSigma]\[CapitalPhi]", "==", 
  "MatIsub\[CapitalPhi]\[CapitalUpsilon]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SIGcoords", "[", 
   RowBox[{"MatrixFromPHIcoords", "[", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "}"}], "]"}], "]"}], "==", 
  RowBox[{"PHIcoords", "[", 
   RowBox[{"MatrixFromUPSILONcoords", "[", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "}"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.867370665212576*^9, 3.867370667602152*^9}, 
   3.8673707182018137`*^9, {3.8674224710242405`*^9, 3.8674224806918745`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"e233d384-b285-48c8-9332-643ee88ace45"],

Cell[CellGroupData[{

Cell[TextData[{
 "Cmat is the Voigt matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"[", "T", "]"}], "\[CapitalSigma]\[CapitalUpsilon]"], 
   TraditionalForm]],ExpressionUUID->"cd968672-7581-4a56-9cf0-4abfbb656320"]
}], "Section",
 CellChangeTimes->{{3.867286754560062*^9, 
  3.8672868398618746`*^9}},ExpressionUUID->"e1007a1c-1d78-4f36-bb90-\
0a7349b73c11"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Dmat", ".", "DummyMatrixSYM6x6", ".", "Dmat"}], "]"}]], "Input",
 CellChangeTimes->{{3.8024510451592445`*^9, 3.802451082315242*^9}, {
  3.8024511488112445`*^9, 3.8024511606672454`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"a83e8814-9cc0-4e06-a5c4-9df0a38caa78"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
   "MatIsub\[CapitalPhi]\[CapitalSigma]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalUpsilon]\[CapitalPhi]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8675054826094866`*^9, 3.867505528901866*^9}, {
   3.867505576450199*^9, 3.867505635786346*^9}, 3.8675059482551575`*^9, {
   3.8675064870282907`*^9, 3.867506504506162*^9}, {3.867506591525571*^9, 
   3.8675066040396967`*^9}, 3.8793839000463696`*^9, 3.8795209510822954`*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"269789bd-37d4-4739-8d23-8c5da283b95b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PHImatOfCmat", "[", "Cijkl_", "]"}], ":=", 
    RowBox[{"Dmat", ".", "Cijkl", ".", "Dmat"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["converts",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["Voigt",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["matrix",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["PHI",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"rep", ".", "  ", "Used"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["be",
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox["TmatPHIofCmat",
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CmatOfPHImat", "[", "PHImat_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", "Dmat", "]"}], ".", "PHImat", ".", 
     RowBox[{"Inverse", "[", "Dmat", "]"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"CmatOfTmatPHI", ".", " ", "PHImat"}], " ", "is", " ", "matrix", 
     " ", "of", " ", "T", " ", "wrt", " ", 
     RowBox[{"PHI", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TmatOfPHImat", "[", "PHImat_", "]"}], ":=", 
    RowBox[{
    "MatIsubB\[CapitalPhi]", ".", "PHImat", ".", "MatIsub\[CapitalPhi]B"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"TmatOfTmatPHI", ".", " ", "Converts"}], " ", "PHI", " ", "rep", 
     " ", "to", " ", "BB", " ", 
     RowBox[{"rep", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PHImatOfTmat", "[", "Tmat_", "]"}], "  ", ":=", 
    RowBox[{
    "MatIsub\[CapitalPhi]B", ".", "Tmat", ".", "MatIsubB\[CapitalPhi]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["Used",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["be",
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox[
     RowBox[{"TmatPHIofTmat", ".", " ", "Converts"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["BB",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["rep",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["PHI",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"rep", "."}],
     FontColor->RGBColor[1, 0, 0]]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TmatOfCmat", "[", "Cijkl_", "]"}], ":=", "   ", 
    RowBox[{"TmatOfPHImat", "[", 
     RowBox[{"PHImatOfCmat", "[", "Cijkl", "]"}], "]"}]}], " ", ";"}], 
  "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "Matrix", " ", "of", " ", "T", " ", "WITH", " ", "RESPECT", " ", "TO", 
      " ", "BB"}], ",", " ", 
     RowBox[{"not", " ", "PHI"}], ",", " ", 
     RowBox[{"as", " ", "of", " ", "April", " ", "2020"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmatOfTmat", "[", "Tmat_", "]"}], ":=", " ", 
   RowBox[{"CmatOfPHImat", "[", 
    RowBox[{"PHImatOfTmat", "[", "Tmat", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7953750044632454`*^9, 3.7953751328030357`*^9}, {
   3.7953889720337257`*^9, 3.7953889918172436`*^9}, {3.795389551262293*^9, 
   3.7953895524966764`*^9}, {3.795879415234042*^9, 3.795879435815293*^9}, 
   3.7958796612479677`*^9, {3.7958798492137775`*^9, 3.7958800140518255`*^9}, {
   3.7958996800892086`*^9, 3.795899704625201*^9}, {3.7958998731522045`*^9, 
   3.7958998747615805`*^9}, {3.7958999602850904`*^9, 
   3.7958999605194187`*^9}, {3.7959001336718845`*^9, 3.79590014014124*^9}, {
   3.795919502805686*^9, 3.795919534827535*^9}, {3.7959195650670433`*^9, 
   3.795919608042267*^9}, 3.7959199546424837`*^9, {3.795919990866382*^9, 
   3.7959199993669405`*^9}, {3.8005595408933063`*^9, 
   3.8005595416892996`*^9}, {3.802450569649781*^9, 3.8024505717617846`*^9}, {
   3.8024506113074613`*^9, 3.8024506138574615`*^9}, {3.8037544161090603`*^9, 
   3.8037544266315613`*^9}, {3.8225180564271407`*^9, 
   3.8225181226001234`*^9}, {3.822842177358448*^9, 3.8228421781044416`*^9}, {
   3.822842233556468*^9, 3.8228422353484793`*^9}, {3.867422569097678*^9, 
   3.8674225807551503`*^9}, {3.8674226529587946`*^9, 
   3.8674226956101046`*^9}, {3.867422741880661*^9, 3.867422771961698*^9}, {
   3.8674228099623847`*^9, 3.8674228559558897`*^9}, {3.8674229107406983`*^9, 
   3.8674229213865747`*^9}, {3.8674229614734364`*^9, 3.867422984702016*^9}, {
   3.8674230258095217`*^9, 3.867423147585737*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"19ea620f-3ad8-43f0-8a27-ae93bf5a8914"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"CmatOfPHImat", "[", "BlankSlate", "]"}], "==", 
   RowBox[{
   "MatIsub\[CapitalSigma]\[CapitalPhi]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalPhi]\[CapitalUpsilon]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"PHImatOfCmat", "[", "BlankSlate", "]"}], "==", 
   RowBox[{
   "MatIsub\[CapitalPhi]\[CapitalSigma]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalUpsilon]\[CapitalPhi]"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.8672894638798146`*^9, {3.867289499477764*^9, 3.867289523916507*^9}, {
   3.8672897884970455`*^9, 3.8672897977045193`*^9}, {3.867289839540888*^9, 
   3.867289877687159*^9}, {3.8672899831392703`*^9, 3.8672899853949924`*^9}, {
   3.8673686618243175`*^9, 3.867368666042246*^9}, {3.8673687079958086`*^9, 
   3.8673687356169786`*^9}, 3.8674226632605314`*^9, 3.8674227437856913`*^9, {
   3.8793838471067133`*^9, 3.879383857242484*^9}, 3.87938390163206*^9, {
   3.879520957229377*^9, 3.8795209605367355`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"b2cb6c96-553e-4593-95be-ee8341d575d4"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"PHImatOfCmat", "[", "BlankSlate", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8793492862496014`*^9, 3.8793493114218435`*^9}, 
   3.8793839008413453`*^9, 3.879520956163597*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"4e3bedd7-b2de-4b97-a13b-aa79ef0476fc"],

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"CmatOfTmat", "[", "BlankSlate", "]"}], "==", 
   RowBox[{
   "MatIsub\[CapitalSigma]B", ".", "BlankSlate", ".", 
    "MatIsubB\[CapitalUpsilon]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"TmatOfCmat", "[", "BlankSlate", "]"}], "==", 
   RowBox[{
   "MatIsubB\[CapitalSigma]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalUpsilon]B"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.867287404152894*^9, 3.8672875177876325`*^9}, {
   3.8672875634190907`*^9, 3.8672875675157566`*^9}, 3.8672876249631214`*^9, {
   3.8672876638039117`*^9, 3.867287664785139*^9}, {3.8672877078662415`*^9, 
   3.8672877201917753`*^9}, {3.867287752674364*^9, 3.8672877971554356`*^9}, {
   3.8672899759816413`*^9, 3.8672899785655437`*^9}, {3.8793838578401785`*^9, 
   3.8793838595097084`*^9}, {3.8795209612568874`*^9, 3.879520962852405*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"dda7dcd3-ca26-408e-9efd-afab01f5e362"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"CmatOfTmat", "[", "BlankSlate", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7959453635296783`*^9, 3.7959454164893646`*^9}, {
   3.7959454552629433`*^9, 3.7959454662796974`*^9}, {3.795961027299603*^9, 
   3.7959610273152227`*^9}, 3.795962412759187*^9, {3.867424174882802*^9, 
   3.8674241834478035`*^9}, {3.8793838601554785`*^9, 3.879383860747717*^9}, {
   3.8795209639663415`*^9, 3.879520964859394*^9}, {3.905009037792253*^9, 
   3.9050090383100033`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"31ed7463-85b8-497f-bc2b-20bb8123e94e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"TmatOfPHImat", "[", "BlankSlate", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"PHImatOfTmat", "[", "BlankSlate", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"TmatOfPHImat", "[", 
    RowBox[{"PHImatOfTmat", "[", "BlankSlate", "]"}], "]"}], "==", 
   "BlankSlate"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7953749033181624`*^9, 3.7953749341658196`*^9}, {
   3.7953751559926095`*^9, 3.795375247696466*^9}, {3.7953889565316896`*^9, 
   3.7953889937391214`*^9}, {3.7958795361596828`*^9, 3.795879559148263*^9}, 
   3.7958796107318354`*^9, {3.7958800755763187`*^9, 3.7958800888283515`*^9}, {
   3.795880274435199*^9, 3.7958803435734634`*^9}, {3.795961026986538*^9, 
   3.795961026986538*^9}, {3.867422815122315*^9, 3.867422819617917*^9}, {
   3.8674229122947893`*^9, 3.867422919156949*^9}, {3.879383861847763*^9, 
   3.8793838642525916`*^9}, {3.8795209658724985`*^9, 3.8795209679770184`*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"2c18e03c-20c4-4a20-9b89-1ab00ad2371e"],

Cell[CellGroupData[{

Cell["\<\
PHI ref matrix for TET. Agrees with Nye, if converted to a Voigt matrix. \
\>", "Subsubsection",
 CellChangeTimes->{{3.8799833765747557`*^9, 3.8799834026568413`*^9}, {
   3.8799853340089417`*^9, 3.8799853602540836`*^9}, 3.8799901034703074`*^9, {
   3.8799901806652436`*^9, 
   3.8799901884277353`*^9}},ExpressionUUID->"b27c0f34-7dd5-4fc1-9ef2-\
47b97317a51f"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"PHImatOfTmat", "[", "TmatForTET", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"PHImatOfTmat", "[", "TmatForTET", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "dp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "d"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "ap"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "e"}], "+", "f", "-", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "cp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "d"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "gp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "e"}], "+", 
         RowBox[{"2", " ", "f"}], "-", 
         RowBox[{
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "hp"}], ",", 
     RowBox[{"c", "\[Rule]", "fp"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8799829114662285`*^9, 3.8799829200118*^9}, {
  3.8799829600041866`*^9, 3.879983136564511*^9}, {3.8799832804990153`*^9, 
  3.8799833121638136`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"dc18b592-72e5-4012-9ef6-9317fccd6a16"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
PHI ref matrix for XISO. Agrees with Nye,  if converted to a Voigt matrix\
\>", "Subsubsection",
 CellChangeTimes->{{3.8799833765747557`*^9, 3.8799834026568413`*^9}, {
   3.8799853340089417`*^9, 3.8799853602540836`*^9}, 3.8799901034703074`*^9, {
   3.8799901464102473`*^9, 3.8799901485484657`*^9}, 
   3.8799902015422077`*^9},ExpressionUUID->"8677c3ad-a474-4770-8945-\
dbb9115271ff"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"PHImatOfTmat", "[", "TmatForXISO", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "c"}], "+", "e", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"f", "+", 
         RowBox[{
          SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "c"}], "+", "e", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"f", "+", 
          RowBox[{
           SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"PHImatOfTmat", "[", "TmatForXISO", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "dp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "c"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "ap"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "e"}], "+", "f", "-", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "cp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "gp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "e"}], "+", 
         RowBox[{"2", " ", "f"}], "-", 
         RowBox[{
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "hp"}], ",", 
     RowBox[{"c", "\[Rule]", 
      RowBox[{"ap", "-", "gp"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8799829114662285`*^9, 3.8799829200118*^9}, {
   3.8799829600041866`*^9, 3.879983136564511*^9}, {3.8799832804990153`*^9, 
   3.8799833121638136`*^9}, {3.8799902178776665`*^9, 3.879990228209791*^9}, {
   3.8799903062921405`*^9, 3.8799903065165663`*^9}, {3.8799904548009925`*^9, 
   3.8799904876858587`*^9}, 3.87999051985126*^9, {3.8799905550192986`*^9, 
   3.879990601510868*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"4f90263f-c847-4729-a119-60be9706fcee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
To make Tmat6x6 wrt BB with prescribed eigenvalues and eigenvectors.
TmatFromEigensystem is Eq 49 of TapeTape2021.\
\>", "Subsubsection",
 CellChangeTimes->{{3.787197726442168*^9, 3.787197770686696*^9}, {
   3.795401347998807*^9, 3.795401349373804*^9}, {3.795401395854579*^9, 
   3.795401396917082*^9}, {3.8103239795180693`*^9, 3.810323986236885*^9}, 
   3.8228372108987193`*^9, {3.8303049300878143`*^9, 3.8303049392078156`*^9}, {
   3.830304980037236*^9, 3.830304986020372*^9}, {3.859817796177543*^9, 
   3.8598178007004504`*^9}},ExpressionUUID->"d779590a-9846-4b75-a558-\
889ed560dc21"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TmatFromEigensystem", "[", 
     RowBox[{"eigenvalues_", ",", "ONeigenbasis_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MatIsubBA", "[", "ONeigenbasis", "]"}], ".", 
     RowBox[{"DiagonalMatrix", "[", "eigenvalues", "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"MatIsubBA", "[", "ONeigenbasis", "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "can", " ", "use", " ", "transpose", " ", "for", " ", "inverse", " ", 
     "since", " ", "both", " ", "bases", " ", "are", " ", "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7870791907239304`*^9, 3.7870792131643147`*^9}, {
   3.78707926612812*^9, 3.787079276628847*^9}, {3.78707931432423*^9, 
   3.7870793282170777`*^9}, {3.787079386915492*^9, 3.787079418174843*^9}, {
   3.787174157038745*^9, 3.7871741751208296`*^9}, {3.787197822014477*^9, 
   3.787197823093233*^9}, {3.7874211823027673`*^9, 3.7874211948918324`*^9}, {
   3.787421288287093*^9, 3.7874212994628763`*^9}, {3.7874213635202894`*^9, 
   3.787421401309622*^9}, 3.787421632737559*^9, {3.7876191608151164`*^9, 
   3.78761916184641*^9}, {3.787619198418244*^9, 3.7876192016690817`*^9}, {
   3.7899211567301893`*^9, 3.7899211818581886`*^9}, 3.793301249051502*^9, {
   3.7953665075680714`*^9, 3.7953665279919496`*^9}, 3.79536918243423*^9, {
   3.7954014306081686`*^9, 3.795401479369706*^9}, {3.795401565572303*^9, 
   3.7954015669004307`*^9}, {3.7959196932589183`*^9, 
   3.7959196995562644`*^9}, {3.822837531444727*^9, 3.822837554611735*^9}, {
   3.8228415596134377`*^9, 3.8228415829734592`*^9}, {3.822842420036468*^9, 
   3.8228424334594793`*^9}, {3.8228425034054985`*^9, 
   3.8228425042364845`*^9}, {3.822842639997469*^9, 3.822842650003476*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"315b8d79-b546-4bee-b223-24174bab699f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Next can also be verified by hand. See the pdf \
AdjointOfMatrixMultiplication in the folder moment_tensor_tex.\n",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " can handle the dim = 7 case, but it takes a minute or two."
}], "Subsubsection",
 CellChangeTimes->{{3.8680609006377597`*^9, 3.8680609192136903`*^9}, {
  3.8681964864711866`*^9, 3.868196521352729*^9}, {3.868196560982214*^9, 
  3.8681966251274524`*^9}, {3.9009490334176984`*^9, 
  3.9009490538427887`*^9}},ExpressionUUID->"43afa87f-2f58-4bd5-b699-\
2bc9a56da1d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatM", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mm", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "dim"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatN", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"nnn", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "dim"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatU", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uu", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "dim"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.900948177211215*^9, 3.9009482928557262`*^9}, 
   3.900948413062004*^9, {3.9009484875083623`*^9, 3.900948501868631*^9}, {
   3.9009485404841948`*^9, 3.90094857813116*^9}, 3.900948982127963*^9, 
   3.9009490615683813`*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"3554fe32-7c5c-4a15-aa98-b4523facb595"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "MatU", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MatM", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MatN", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{
     RowBox[{"MatU", ".", "MatM"}], ",", 
     "                                    ", "MatN"}], "]"}], "\[Equal]", 
   "\[IndentingNewLine]", "                ", 
   RowBox[{"InnerProductMatrix", "[", "           ", 
    RowBox[{"MatM", ",", 
     RowBox[{
      RowBox[{"Transpose", "[", "MatU", "]"}], ".", "MatN"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{
     RowBox[{"MatM", ".", "MatU"}], ",", 
     "                                    ", "MatN"}], "]"}], "\[Equal]", 
   "\[IndentingNewLine]", "                ", 
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"MatM", ",", 
     RowBox[{"MatN", ".", 
      RowBox[{"Transpose", "[", "MatU", "]"}]}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.86805713262674*^9, 3.8680571412503157`*^9}, {
  3.868060798180887*^9, 3.8680608147683*^9}, {3.86806089533572*^9, 
  3.8680608958985996`*^9}, {3.8680610137483387`*^9, 3.8680610226217976`*^9}, {
  3.8681954174180565`*^9, 3.8681955038344297`*^9}, {3.9009478442639537`*^9, 
  3.900947850309162*^9}, {3.9009478817240305`*^9, 3.900947882806374*^9}, {
  3.9009479153959417`*^9, 3.9009479713659973`*^9}, {3.900948303099861*^9, 
  3.900948313220337*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"c528e2db-7ac2-4f13-81a7-cc718404dfcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ubar", "Section",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.794683154123476*^9, 3.7946831576924734`*^9}, {3.7946833220424733`*^9, 
   3.7946833237544775`*^9}, {3.7946837462184734`*^9, 3.794683747483473*^9}, {
   3.794684746267477*^9, 
   3.7946847474664717`*^9}},ExpressionUUID->"90a20a87-5ad8-4a0d-bd30-\
118c996fcd22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matrixLwrtONbasis", "[", 
     RowBox[{"L_", ",", "OrthonormalBasis_"}], "]"}], ":=", "  ", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"OrthonormalBasis", "[", 
          RowBox[{"[", "jj", "]"}], "]"}], "]"}], ",", 
        RowBox[{"OrthonormalBasis", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "6", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", "arbitrary", " ", 
     "linear", " ", "transformation", " ", "L", " ", "wrt", " ", "an", " ", 
     "arbitrary", " ", "ORTHONORMAL", " ", "basis", "  ", "for", " ", 
     StyleBox[
      RowBox[{"\[DoubleStruckCapitalM]", ".", " ", "CHECK"}],
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox["ORDER",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox["OF",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox["I",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox["AND",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontSize->16], 
     StyleBox["J",
      FontFamily->"Courier New",
      FontSize->16]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UbarLT", "[", 
     RowBox[{"E_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"U", ".", "E", ".", 
     RowBox[{"Transpose", "[", "U", "]"}]}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"the", " ", "linear", " ", "transformation"}], ",", " ", 
     RowBox[{"not", " ", "the", " ", "matrix"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixUbar", "[", 
     RowBox[{"U_", ",", "OrthonormalBasis_"}], "]"}], ":=", 
    RowBox[{"matrixLwrtONbasis", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"U", ".", "#", ".", 
        RowBox[{"Transpose", "[", "U", "]"}]}], "&"}], ",", 
      "OrthonormalBasis"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "the", " ", "6", " ", "x", " ", "6", " ", "orthogonal", " ", "matrix", 
     " ", "determined", " ", "by", " ", "the", " ", "rotation", " ", "matrix",
      " ", "U", " ", "and", " ", "OrthonormalBasis"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixUbar", "[", "U_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"MatrixUbar", "[", 
     RowBox[{"U", ",", "basisBB"}], "]"}], "]"}]}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Now", " ", "April", " ", "8", " ", 
     RowBox[{"it", "'"}], "s", " ", "wrt", " ", "basis", " ", "BB"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7958791746946397`*^9, 3.7958791800076823`*^9}, {
   3.795879275619272*^9, 3.795879295717781*^9}, {3.7959197125426645`*^9, 
   3.7959197175431323`*^9}, {3.7959199222184706`*^9, 
   3.7959199404231796`*^9}, {3.804031233155677*^9, 3.8040312529706345`*^9}, {
   3.804031302296573*^9, 3.804031330476095*^9}, {3.804031369026539*^9, 
   3.804031378411557*^9}, 3.804640386652455*^9, {3.8103239236799192`*^9, 
   3.810323924442877*^9}, {3.867886130445979*^9, 3.8678861398496437`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"cb7b0ca7-40a3-4b39-b7f1-bad106e6c623"],

Cell["\<\
The file Mathematica file ES_Derivations has facts about Ubar\
\>", "Subsubsection",
 CellChangeTimes->{{3.8384731742339373`*^9, 
  3.838473247567941*^9}},ExpressionUUID->"bc17c575-14ba-49d1-ab99-\
e8df8268d63a"]
}, Open  ]],

Cell["Groups", "Section",
 CellChangeTimes->{{3.891270807831238*^9, 
  3.891270822166829*^9}},ExpressionUUID->"a64f0cda-e980-42d7-b29e-\
049a15af9e14"],

Cell[TextData[{
 StyleBox["GPGENBY",
  FontSlant->"Italic"],
 "[A] IS THE GROUP GENERATED BY THE GROUP ELEMENTS IN THE SET A."
}], "SmallText",
 CellMargins->{{Inherited, -120}, {Inherited, Inherited}},
 Evaluatable->False,
 CellChangeTimes->{3.6481670178008776`*^9},
 AspectRatioFixed->True,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"d70c9de8-6f2b-492a-a7ae-b5df96c0c668"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AllProducts", "[", "a_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ".", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ",", 
       RowBox[{"CartesianProduct", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "a"}], "}"}], "]"}]}], "]"}]}], "]"}]}], " ", 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GpGenBy", "[", "a_", "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{"AllProducts", ",", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GyroidGp", "         ", "=", 
    RowBox[{"GpGenBy", "[", 
     RowBox[{"{", 
      RowBox[{"rot111", ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}]}], "}"}], "]"}]}], ";"}], 
  "                                                     ", 
  RowBox[{"(*", "  ", 
   StyleBox["432",
    FontColor->RGBColor[1, 0, 0]], "     ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RhombohedralWithAxis111", "=", 
   RowBox[{"GpGenBy", "[", 
    RowBox[{"{", 
     RowBox[{"-", "rot111"}], "}"}], "]"}]}], 
  "                                                   ", 
  RowBox[{"(*", "  ", 
   OverscriptBox[
    StyleBox["3",
     FontColor->RGBColor[1, 0, 0]], "_"], "    ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.648165708751521*^9, 3.648165709741522*^9}, {
  3.648165806971656*^9, 3.6481658505517163`*^9}, {3.648166181349723*^9, 
  3.648166192669739*^9}, {3.6481670034308577`*^9, 3.648167052760926*^9}, {
  3.648167152391063*^9, 3.6481671593210726`*^9}, {3.6481672835312443`*^9, 
  3.6481672853812466`*^9}, {3.802218073317542*^9, 3.80221808757255*^9}, {
  3.8901806879380407`*^9, 3.8901806966381187`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"6351b295-8f98-498d-b21c-5088865219c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymGroup", "=", 
    RowBox[{"{", 
     RowBox[{"id", ",", "rot111", ",", 
      RowBox[{"rot111", ".", "rot111"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1", "0"},
         {"1", "0", "0"},
         {"0", "0", "1"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "1"},
         {"0", "1", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "1"},
         {"0", "1", "0"},
         {"1", "0", "0"}
        }], "\[NoBreak]", ")"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"the", " ", "six", " ", "permuation", " ", 
      RowBox[{"matrices", ".", " ", "Some"}], " ", "have", " ", "det"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"-", "1."}], " ", "SymmetricGroup", " ", "is", " ", "a", " ", 
      "built", " ", "in", " ", "function", " ", "in", " ", "Mathematica", " ",
       "9", " ", "but", " ", "does", " ", "not", " ", "consist", " ", "of", 
      " ", "matrices"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5943106282172747`*^9, 3.5943106401872916`*^9}, {
   3.594516111236637*^9, 3.5945161384566746`*^9}, {3.594740781706049*^9, 
   3.5947408108980904`*^9}, {3.5947408519681473`*^9, 3.594740863092165*^9}, {
   3.6404473398060217`*^9, 3.640447367056059*^9}, {3.6481657435815687`*^9, 
   3.648165757631588*^9}, 3.6481670178008776`*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"03b8872f-e1bc-47d1-8af9-a4c34ef9253c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GyroidImitation", "=", 
   RowBox[{"1.", 
    RowBox[{"{", 
     RowBox[{"id", ",", "rot111", ",", 
      RowBox[{"rot111", ".", "rot111"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", "rot111"}], ",", 
      RowBox[{
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", "rot111", ".", "rot111"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", "rot111"}], ",", 
      RowBox[{
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", "rot111", ".", "rot111"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ZRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{
       RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", "rot111"}], ",", 
      RowBox[{
       RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", "rot111", ".", "rot111"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurvilinearCube", "=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"SegmentList", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1.", 
             RowBox[{
              RowBox[{"GyroidImitation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ".", 
              RowBox[{"unit", "[", "#", "]"}]}]}], "&"}], "/@", 
           RowBox[{"arc", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "31", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "GyroidImitation", "]"}]}], "}"}]}], "]"}], 
     ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7983353825458164`*^9, 3.7983354258408175`*^9}, {
   3.7983355241938143`*^9, 3.798335530304815*^9}, {3.7983359133298144`*^9, 
   3.7983359255698147`*^9}, {3.7983362221248164`*^9, 3.798336235280817*^9}, {
   3.7983368251058135`*^9, 3.798336833424816*^9}, {3.7983369117308054`*^9, 
   3.7983369350408163`*^9}, {3.7983369656168137`*^9, 
   3.7983370262088056`*^9}, {3.7983938803303766`*^9, 3.798393881649962*^9}, 
   3.7984656310619216`*^9, {3.7984659968978586`*^9, 3.7984660182464657`*^9}, 
   3.802206127895568*^9},
 CellLabel->
  "In[211]:=",ExpressionUUID->"e01b9448-6141-4ce6-b516-55d0cdb1eaee"],

Cell["Another section", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 
  3.692743015099022*^9}},ExpressionUUID->"cbb8747a-b196-4752-85b9-\
222fdb03c8e5"],

Cell["This can be done better", "Subsection",
 CellChangeTimes->{{3.8912709526902437`*^9, 
  3.8912709665109525`*^9}},ExpressionUUID->"aff776e4-01bf-452a-a8f7-\
86140a13f22d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]vsAsPairs", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "v1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]2", ",", "v2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]3", ",", "v3"}], "}"}]}], "}"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxisCandidate", "[", "u_", "]"}], ":=", 
    RowBox[{"MakeReal", "[", 
     RowBox[{"unit", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"\[Lambda]vsAsPairs", "[", 
          RowBox[{"Eigensystem", "[", "u", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}],
        "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "the", " ", "eigenvector", " ", "with", " ", "eigenvalue", " ", "1.", " ",
      "MakeReal", " ", "added", " ", "July", " ", "2021"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wperp", "[", "u_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", "                            ", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "                            ", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnitRotationAxis", "[", "u_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RotationAngle", "[", "u", "]"}], "\[Equal]", "\[Pi]"}], ",", 
      RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Wperp", "[", "u", "]"}], ",", 
           RowBox[{"u", ".", 
            RowBox[{"Wperp", "[", "u", "]"}]}], ",", 
           RowBox[{"RotationAxisCandidate", "[", "u", "]"}]}], "}"}], "]"}], 
        "]"}], 
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}]}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"added", " ", "rot", " ", "angle"}], " ", "=", " ", 
     RowBox[{"\[Pi]", " ", "case", " ", "June", " ", "2022"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotationAxis", "[", "u_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"RotationAngle", "[", "u", "]"}], "/", "2"}], "]"}], 
    RowBox[{"UnitRotationAxis", "[", "u", "]"}]}]}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "Sept", " ", "2021"}], ",", " ", "CHECK"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.511625132793008*^9, 3.511625133666609*^9}, 
   3.511625437102738*^9, 3.511658711102789*^9, {3.5133060509992743`*^9, 
   3.513306053620079*^9}, {3.514402628816926*^9, 3.514402638551343*^9}, 
   3.514737096677024*^9, {3.52449593206017*^9, 3.5244959443061914`*^9}, {
   3.593024989853939*^9, 3.593024993383944*^9}, {3.5944959807015743`*^9, 
   3.594495981311575*^9}, {3.5944978762042255`*^9, 3.5944978908242455`*^9}, {
   3.5948752078132*^9, 3.594875251485263*^9}, {3.597341194101532*^9, 
   3.5973412871088943`*^9}, {3.668214368625022*^9, 3.6682143785850363`*^9}, {
   3.66821441045508*^9, 3.668214437855118*^9}, {3.668214532395248*^9, 
   3.668214560285287*^9}, 3.688343419048484*^9, 3.688343462925025*^9, 
   3.6924864795048723`*^9, {3.702399132582429*^9, 3.7023991392718105`*^9}, {
   3.7312525407227335`*^9, 3.7312526536292048`*^9}, {3.731252701098009*^9, 
   3.731252890067167*^9}, {3.7312529518172874`*^9, 3.7312530159111195`*^9}, {
   3.7312536726467733`*^9, 3.7312536828655915`*^9}, {3.731253811100219*^9, 
   3.731253819647109*^9}, {3.766956117792843*^9, 3.7669562337486477`*^9}, {
   3.809280661288514*^9, 3.8092806908727427`*^9}, {3.809281007866161*^9, 
   3.80928101514627*^9}, {3.8247782400753574`*^9, 3.8247782463973207`*^9}, 
   3.8247789673356752`*^9, 3.824795869716941*^9, {3.824796031161685*^9, 
   3.824796053196067*^9}, {3.8247961434888515`*^9, 3.8247961471154227`*^9}, 
   3.824796398181033*^9, {3.8365057024268017`*^9, 3.836505711427083*^9}, {
   3.8365057644941273`*^9, 3.836505803582756*^9}, {3.8408067473155355`*^9, 
   3.840806770631511*^9}, {3.8408070026593657`*^9, 3.840807004212391*^9}, {
   3.8408070351707993`*^9, 3.8408070849942217`*^9}, {3.8408077179280095`*^9, 
   3.8408077231244807`*^9}, {3.840808262612259*^9, 3.8408082845161905`*^9}, {
   3.8409094299917917`*^9, 3.840909447527794*^9}, {3.8409098942958803`*^9, 
   3.840909926484829*^9}, {3.840909976278035*^9, 3.8409099834446497`*^9}, {
   3.840986267359144*^9, 3.840986277377967*^9}, {3.8409863930701075`*^9, 
   3.840986503775838*^9}, {3.8409865565950923`*^9, 3.8409866075671387`*^9}, {
   3.8409866775203466`*^9, 3.840986689505313*^9}, {3.8409872109270697`*^9, 
   3.840987234591056*^9}, {3.84098735889954*^9, 3.8409873599344845`*^9}, {
   3.864340045229498*^9, 3.8643401643216968`*^9}, {3.8726106960254965`*^9, 
   3.87261071011981*^9}, {3.872610741487389*^9, 3.8726107570672193`*^9}, {
   3.8726108096031027`*^9, 3.872610814114208*^9}, {3.8726109727021885`*^9, 
   3.872610994322111*^9}, {3.8750228925887227`*^9, 3.8750229038793135`*^9}, {
   3.892692673266036*^9, 3.8926926806412*^9}, {3.892692717013853*^9, 
   3.892692737869045*^9}, {3.905007122939167*^9, 3.905007144025795*^9}, {
   3.905008651861617*^9, 3.9050086620926237`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"6b535fdb-7a26-448f-8445-08d4f0582aae"],

Cell["Elastic map stuff", "Section",
 CellChangeTimes->{{3.8912669075101666`*^9, 
  3.891266927159681*^9}},ExpressionUUID->"78e7a415-93b1-4cfb-b0fa-\
18ad18af2c9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u0", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"ArcTan", "[", 
     SqrtBox["8"], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[218]:=",ExpressionUUID->"c8fa405b-bd6e-44d4-8fb9-d775c5aa49be"],

Cell[CellGroupData[{

Cell["Reference matrices for Voigt", "Subsubsection",
 CellChangeTimes->{{3.8795185962277193`*^9, 
  3.8795186210359235`*^9}},ExpressionUUID->"06a63569-c86f-4398-8450-\
eebfa3af54ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmatForISO", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "g", "0", "0", "0"},
       {"g", "a", "g", "0", "0", "0"},
       {"g", "g", "a", "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"a", "-", "g"}], "2"], "0", "0"},
       {"0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "-", "g"}], "2"], "0"},
       {"0", "0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "-", "g"}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"from", " ", "Nye"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForXISO", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "g", "h", "0", "0", "0"},
      {"g", "a", "h", "0", "0", "0"},
      {"h", "h", "c", "0", "0", "0"},
      {"0", "0", "0", "d", "0", "0"},
      {"0", "0", "0", "0", "d", "0"},
      {"0", "0", "0", "0", "0", 
       FractionBox[
        RowBox[{"a", "-", "g"}], "2"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForTET", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "g", "h", "0", "0", "0"},
      {"g", "a", "h", "0", "0", "0"},
      {"h", "h", "c", "0", "0", "0"},
      {"0", "0", "0", "d", "0", "0"},
      {"0", "0", "0", "0", "d", "0"},
      {"0", "0", "0", "0", "0", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForTET", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "g", "h", "0", "0", "0"},
      {"g", "a", "h", "0", "0", "0"},
      {"h", "h", "c", "0", "0", "0"},
      {"0", "0", "0", "d", "0", "0"},
      {"0", "0", "0", "0", "d", "0"},
      {"0", "0", "0", "0", "0", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForORTH", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "m", "0", "0", "0"},
       {"g", "b", "h", "0", "0", "0"},
       {"m", "h", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "0", "0"},
       {"0", "0", "0", "0", "e", "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForMONO", "=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "g", "m", "0", "0", "v"},
        {"g", "b", "h", "0", "0", "u"},
        {"m", "h", "c", "0", "0", "s"},
        {"0", "0", "0", "d", "j", "0"},
        {"0", "0", "0", "j", "e", "0"},
        {"v", "u", "s", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879384909581035*^9, 3.879384917580553*^9}, {
   3.8793849982088284`*^9, 3.879385094369027*^9}, {3.879385152601957*^9, 
   3.879385262537035*^9}, {3.8793856206788435`*^9, 3.8793856277596006`*^9}, {
   3.879385703625926*^9, 3.879385720133737*^9}, 3.8793857530122814`*^9, {
   3.879385929975525*^9, 3.8793859871420965`*^9}, {3.8793861790705943`*^9, 
   3.8793862725383635`*^9}, {3.879386497097413*^9, 3.879386520308134*^9}, {
   3.8793865672130256`*^9, 3.8793866072223167`*^9}, {3.879387123461567*^9, 
   3.879387130245008*^9}, {3.892691990423703*^9, 3.8926919945327406`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"3ce187e2-a80c-4464-8bb0-8e09cb1b741b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reference groups", "Section",
 CellChangeTimes->{{3.840461964835967*^9, 
  3.8404619800509477`*^9}},ExpressionUUID->"fa7e0e95-0619-4a17-a107-\
a60a396055a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D6", "=", 
    RowBox[{"GpGenBy", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"ZRot", "[", 
          RowBox[{"\[Pi]", "/", "6"}], "]"}], ".", 
         RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
         RowBox[{"ZRot", "[", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}]}], "]"}]}], "}"}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"not", " ", "reference", " ", "groups"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D8", "=", 
   RowBox[{"GpGenBy", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "8"}], "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "8"}], "]"}]}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "D6", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "D8", "]"}]}], "Input",
 CellChangeTimes->{{3.8401441104581175`*^9, 3.8401441377511044`*^9}, {
  3.840144282135108*^9, 3.840144298919106*^9}, {3.8416713012861648`*^9, 
  3.8416713187262363`*^9}, {3.8416993803767624`*^9, 3.8416993909225245`*^9}, {
  3.841882447782524*^9, 3.8418824604691615`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"deaab54f-16c6-469e-8486-1d3d9f332fb2"],

Cell[BoxData[{
 RowBox[{"D6", "==", 
  RowBox[{"GpGenBy", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
     RowBox[{"ZRot", "[", 
      RowBox[{"\[Pi]", "/", "3"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"D8", "==", 
  RowBox[{"GpGenBy", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
     RowBox[{"ZRot", "[", 
      RowBox[{"\[Pi]", "/", "4"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.841882345534013*^9, 3.841882439446643*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"1aa6a68c-c25b-4f2c-9a6b-ef54de344113"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RefGpMONO", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"{", 
     RowBox[{"id", ",", 
      RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefGpORTH", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"{", 
     RowBox[{"id", ",", 
      RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefGpTET", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{"id", ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{"ZRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"3", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "4"}], "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}], ",", 
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "4"}], "]"}]}]}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefGpTRIG", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{"id", ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"4", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "]"}], ".", 
        RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "3"}], "]"}]}], ",", 
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "3"}], "]"}], ".", 
        RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "]"}]}]}], "}"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefGpCUBE", "=", "GyroidGp"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8228729599121466`*^9, 3.822873006340947*^9}, {
  3.8228730403927703`*^9, 3.8228730656584606`*^9}, {3.822873103335533*^9, 
  3.8228731394154854`*^9}, {3.8228734879765654`*^9, 3.822873495799737*^9}, {
  3.822960259767858*^9, 3.822960299615061*^9}, {3.823022640128541*^9, 
  3.823022654476619*^9}, {3.823031056844345*^9, 3.823031104937643*^9}, {
  3.823044936132269*^9, 3.823045038665047*^9}, {3.8230892123482857`*^9, 
  3.8230893603690815`*^9}, {3.8230894871835327`*^9, 3.823089487964769*^9}, {
  3.8231003744186*^9, 3.8231003909767714`*^9}, {3.823100528824229*^9, 
  3.823100561836717*^9}, {3.840462210542076*^9, 3.8404622304620776`*^9}, {
  3.840463402222063*^9, 3.8404634161260805`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"1ef4e780-fbbd-49a6-bc31-cf5fa260a5f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TwoFoldPts", "[", "TRIG", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ZRot", "[", 
        RowBox[{"j", " ", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "8"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Do", " ", "not", " ", "add", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", "or", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "CUBE", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
       "GyroidGp"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", ".", 
         RowBox[{"Unit", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "1"}], "}"}], "]"}]}], "&"}], "/@", 
       "GyroidGp"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "TET", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"j", " ", 
          RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "8"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "ORTH", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", "GyroidGp"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "MONO", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8908569024595046`*^9, 3.8908569243633738`*^9}, {
  3.890868930171404*^9, 3.890868996937446*^9}, {3.890899403547298*^9, 
  3.8908994320031805`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"dbf61928-cb93-4080-93f1-c46a7c4b99d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NfoldPts", "[", "Sigma_", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "Sigma", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NfoldPts", "[", "CUBE", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"unit", "/@", "CubeVertices"}], ",", 
     RowBox[{"TwoFoldPts", "[", "CUBE", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NfoldPts", "[", "TRIG", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"TwoFoldPts", "[", "TRIG", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.899396778508934*^9, 3.8993968187605324`*^9}, {
  3.899396849864477*^9, 3.8993968574003305`*^9}, {3.8993968899777756`*^9, 
  3.899396959785018*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"63af770b-fd12-46b7-8166-0470fc96da2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "Sigma_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "ORTH", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "ORTH", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "CUBE", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", "GyroidGp"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.899402732022479*^9, 3.8994028408693123`*^9}, {
  3.8994028908215237`*^9, 3.899402895060714*^9}, {3.899471478313981*^9, 
  3.8994714852100477`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"0229055f-59b8-427d-a2f8-69dd946f8d0b"],

Cell["TwoFoldGraphics", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
  3.898446061119554*^9, 
  3.8984460688078213`*^9}},ExpressionUUID->"e57364f9-866d-49e9-aaf9-\
5d78878402a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", 
     ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
         "]"}]}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "&"}], "/@", 
       RowBox[{"TwoFoldPts", "[", "\[CapitalSigma]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"SeeOnSphere", "[", 
        RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Green", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".01", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"U", ".", 
              RowBox[{"ZRot", "[", 
               RowBox[{"t", " ", 
                RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", 
              RowBox[{"unit", "[", 
               RowBox[{"Cross", "[", 
                RowBox[{"eye", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"-", "1"}], ",", "3", ",", ".005"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"SeeOnSphere", "[", 
             RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "]"}], ",", 
         RowBox[{"Polygon", "/@", 
          RowBox[{"DiskOnSphere", "[", 
           RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
           "]"}]}]}], "}"}], "&"}], "/@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", ".", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"SeeOnSphere", "[", 
          RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890899490390075*^9, 3.890899502954034*^9}, 
   3.8908995591774964`*^9, {3.8908997071597233`*^9, 3.8908997453863373`*^9}, {
   3.8908997811065435`*^9, 3.8908998022105646`*^9}, 3.8908998510077267`*^9, {
   3.8908999164420085`*^9, 3.8908999421866255`*^9}, {3.8909003981002264`*^9, 
   3.890900402179165*^9}, {3.890901022485944*^9, 3.8909010390562124`*^9}, 
   3.8909010858517847`*^9, 3.8909011806016836`*^9, {3.890901297154953*^9, 
   3.8909013056411057`*^9}, {3.890902344922923*^9, 3.890902378687098*^9}, 
   3.890902495482194*^9, 3.890902550492345*^9, {3.8909026366728916`*^9, 
   3.8909026546957426`*^9}, {3.890902722096571*^9, 3.89090278436241*^9}, 
   3.890902881059866*^9, {3.890902967555865*^9, 3.890902972473795*^9}, 
   3.890903038602707*^9, {3.890903162756205*^9, 3.8909031700523252`*^9}, {
   3.8909032133737907`*^9, 3.890903252090414*^9}, {3.8909034487289705`*^9, 
   3.8909034738781333`*^9}, 3.890903526620658*^9, {3.8909035625493526`*^9, 
   3.890903671063106*^9}, {3.890903776287823*^9, 3.890903780214381*^9}, {
   3.8909038545148315`*^9, 3.8909038714065056`*^9}, {3.891217032452718*^9, 
   3.8912170899402494`*^9}, {3.891217127226694*^9, 3.8912171492887955`*^9}, {
   3.8912171807010746`*^9, 3.891217183008232*^9}, {3.8912179993718243`*^9, 
   3.891218008792474*^9}, 3.891218417633298*^9, {3.8959338377555275`*^9, 
   3.895933902076391*^9}, {3.895935089867797*^9, 3.895935109322997*^9}, {
   3.895935468763073*^9, 3.89593549650836*^9}, {3.895935630556337*^9, 
   3.8959356742826347`*^9}, {3.8959357771308928`*^9, 
   3.8959357777875686`*^9}, {3.895935853642667*^9, 3.895935855240994*^9}, {
   3.8959369197205296`*^9, 3.8959369397848854`*^9}, {3.8959370432110496`*^9, 
   3.8959370795038967`*^9}, 3.8959371950658674`*^9, {3.895937229784996*^9, 
   3.895937235625312*^9}, {3.895937480681276*^9, 3.8959374874491243`*^9}, {
   3.8959375395453167`*^9, 3.89593756620135*^9}, {3.89593762581762*^9, 
   3.8959376559449635`*^9}, {3.8959377410170145`*^9, 3.895937741690278*^9}, {
   3.8959378143133492`*^9, 3.8959378278327293`*^9}, {3.8959379330507975`*^9, 
   3.8959379349861574`*^9}, {3.8959381221215353`*^9, 3.8959381918002725`*^9}, 
   3.895938222745496*^9, {3.8959382812741175`*^9, 3.89593828183339*^9}, {
   3.8959501380864735`*^9, 3.895950179943906*^9}, {3.89595021036965*^9, 
   3.8959502425473046`*^9}, {3.8960469853728423`*^9, 
   3.8960469942216854`*^9}, {3.896473147053547*^9, 3.896473155931282*^9}, {
   3.8964732359704037`*^9, 3.896473353675417*^9}, 3.896473384424013*^9, 
   3.896473481193104*^9, {3.896879443694662*^9, 3.8968794456409054`*^9}, 
   3.896879501065666*^9, {3.8975113735175643`*^9, 3.8975113764204564`*^9}, {
   3.8993870990048714`*^9, 3.8993871090680494`*^9}, 3.903039636078458*^9},
 CellLabel->
  "In[248]:=",ExpressionUUID->"971ee5ef-75f5-400a-8e68-0049a92cedde"],

Cell[CellGroupData[{

Cell["\<\
TwoFoldGraphics with center and radius.  The input tkns was added August 2023\
\>", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
   3.8993985004398685`*^9, 3.8993985398149786`*^9}, 3.8993986532867675`*^9, 
   3.8994279032052794`*^9, {3.900853420490844*^9, 
   3.9008534475667114`*^9}},ExpressionUUID->"108080df-9716-41c7-8c32-\
b723814b7a9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "center_", ",", "radius_", ",", 
     "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"HueForTwoFoldGraphics", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"center", "+", 
            RowBox[{"radius", "\[Times]", 
             RowBox[{"U", ".", "#"}]}]}], "&"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DiskOnSphere", "[", 
              RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}],
               "]"}], "&"}], "/@", 
            RowBox[{"TwoFoldPts", "[", "\[CapitalSigma]", "]"}]}], ")"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "center_", ",", "radius_", ",", "AngRadDisk_", 
     ",", "ShiftToEye_", ",", "eye_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"HueForTwoFoldGraphics", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"#", " ", "radius"}]}], ",", ".01", ",", "eye"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"U", ".", 
            RowBox[{"ZRot", "[", "t", " ", "]"}], ".", 
            RowBox[{"unit", "[", 
             RowBox[{"Cross", "[", 
              RowBox[{"eye", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
             RowBox[{"3", 
              RowBox[{"\[Pi]", "/", "2"}]}], ",", 
             RowBox[{".005", "\[Pi]"}]}], "}"}]}], "]"}]}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"center", "+", 
            RowBox[{"#", " ", "radius"}]}], "&"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DiskOnSphere", "[", 
              RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}],
               "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"U", ".", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"U", ".", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}]}], "}"}]}], ")"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.896923633673681*^9, 3.8969237081370544`*^9}, 
   3.8969237557071543`*^9, 3.896924329277*^9, 3.896924407230274*^9, {
   3.8969663241029897`*^9, 3.8969663279744196`*^9}, 3.8969664032576046`*^9, {
   3.898449335305853*^9, 3.898449339042554*^9}, {3.8985307641921387`*^9, 
   3.8985307695316443`*^9}, {3.898613949823719*^9, 3.8986139545794497`*^9}, {
   3.898640099334127*^9, 3.8986401429097567`*^9}, {3.8986496428018894`*^9, 
   3.8986496438836613`*^9}, {3.899386406441304*^9, 3.8993864113502884`*^9}, 
   3.8993867005043635`*^9, 3.899387133162531*^9, {3.899398559961319*^9, 
   3.899398561960492*^9}, 3.899398646248892*^9, {3.8994091066821976`*^9, 
   3.899409120343955*^9}, {3.8994278040398955`*^9, 3.8994278757502055`*^9}, {
   3.8994283655261693`*^9, 3.89942839269563*^9}, {3.8994284612715874`*^9, 
   3.8994284712059803`*^9}, 3.899767092985012*^9, 3.90051345460507*^9, 
   3.9008525646263585`*^9, 3.9008526682120905`*^9, {3.9008528205545053`*^9, 
   3.9008528211647263`*^9}, {3.9008534115686245`*^9, 3.90085341429609*^9}, {
   3.9008534584962406`*^9, 3.9008534610695105`*^9}, {3.900853985280548*^9, 
   3.9008539869890933`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"3bef2430-f3c2-4b53-b304-4cc3281b3bff"]
}, Open  ]],

Cell["Again, tkns was added as an input August 2023", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
   3.8993985004398685`*^9, 3.8993985398149786`*^9}, 3.8993986532867675`*^9, 
   3.8994279032052794`*^9, {3.900853420490844*^9, 3.9008534475667114`*^9}, {
   3.900962922763859*^9, 3.900962944348444*^9}, 
   3.902325382436557*^9},ExpressionUUID->"c5e0fde1-3542-4780-80f6-\
8db8017f44fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NfoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "center_", ",", "radius_", ",", 
     "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"HueForTwoFoldGraphics", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"center", "+", 
            RowBox[{"radius", "\[Times]", 
             RowBox[{"U", ".", "#"}]}]}], "&"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DiskOnSphere", "[", 
              RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}],
               "]"}], "&"}], "/@", 
            RowBox[{"NfoldPts", "[", "\[CapitalSigma]", "]"}]}], ")"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NfoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "center_", ",", "radius_", ",", "AngRadDisk_", 
     ",", "ShiftToEye_", ",", "eye_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U", ",", "center", ",", "radius", ",", "AngRadDisk", ",", 
     "ShiftToEye", ",", "eye", ",", "tkns"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.899475593028944*^9, 3.899475610854124*^9}, {
  3.8994756583400946`*^9, 3.899475707102071*^9}, {3.9008534831271477`*^9, 
  3.9008535276338453`*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"fa44ca41-2849-446d-ba11-48dd7259726b"],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", 
     SubscriptBox["U", "1"], ")"}], " ", "=", " "}], TraditionalForm]],
  ExpressionUUID->"4372f290-ed91-4cb1-b205-c71718d130b7"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", 
    SubscriptBox["U", "2"], ")"}], TraditionalForm]],ExpressionUUID->
  "6a3b43ed-a6c1-4034-8259-a8982237db6e"],
 "."
}], "Subsubsection",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 3.8667357799594383`*^9}, {
  3.896036615602913*^9, 
  3.8960366485895214`*^9}},ExpressionUUID->"f16fc37b-d82b-426c-b336-\
555a9ec7ab99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "XISO"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}], ")"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "||", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}], ")"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "TET"}], "]"}], "  ", ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"D8", ",", "              ", 
     RowBox[{
      RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "ORTH"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"GyroidGp", ",", 
     RowBox[{
      RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "CUBE"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"GyroidGp", ",", 
     RowBox[{
      RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8905072829496317`*^9, 3.890507397485277*^9}, {
  3.8905074780992627`*^9, 3.890507479088288*^9}, {3.890517409694439*^9, 
  3.890517526294508*^9}, {3.8905176167280684`*^9, 3.8905176185161695`*^9}, {
  3.8905182312955985`*^9, 3.890518239562536*^9}, {3.9023254182770863`*^9, 
  3.9023254236208177`*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"1095b4d9-2708-4807-a38f-5a16c2eee1ff"],

Cell["Example.", "Subsubsection",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 3.8667357799594383`*^9}, {
  3.896036615602913*^9, 3.8960366485895214`*^9}, {3.896036848620084*^9, 
  3.8960368535309277`*^9}},ExpressionUUID->"87510547-4631-4b35-afaa-\
631fd13f6c8f"],

Cell[BoxData[{
 RowBox[{"SameSigmaSubspace", "[", 
  RowBox[{"id", ",", "rot111", ",", "XISO"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SameSigmaSubspace", "[", 
  RowBox[{
   RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
   RowBox[{"ZRot", "[", "t", "]"}], ",", "XISO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8960367272269616`*^9, 3.8960367344237366`*^9}, {
  3.896036771653099*^9, 3.896036785319456*^9}, {3.8960368168904586`*^9, 
  3.896036829561874*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"9488106e-fb20-4ec4-928c-6a5b8d6dfff3"],

Cell[CellGroupData[{

Cell[TextData[{
 "The closest elastic map to Tmat in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "U", ")"}], 
   TraditionalForm]],ExpressionUUID->"7a27538e-b080-4add-b2c0-ab3a6f56c7e8"],
 "."
}], "Section",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 
  3.8667357799594383`*^9}},ExpressionUUID->"6c453d3b-e716-4067-9969-\
76126d16df78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"substitutions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "ap"}], ",", 
     RowBox[{"b", "\[Rule]", "bp"}], ",", "\[IndentingNewLine]", 
     RowBox[{"c", "\[Rule]", "cp"}], ",", 
     RowBox[{"d", "\[Rule]", "dp"}], ",", 
     RowBox[{"e", "\[Rule]", "ep"}], ",", 
     RowBox[{"f", "\[Rule]", "fp"}], ",", 
     RowBox[{"g", "\[Rule]", "gp"}], ",", 
     RowBox[{"h", "\[Rule]", "hp"}], ",", 
     RowBox[{"i", "\[Rule]", "ip"}], ",", 
     RowBox[{"j", "\[Rule]", "jp"}], ",", 
     RowBox[{"k", "\[Rule]", "kp"}], ",", 
     RowBox[{"m", "\[Rule]", "mp"}], ",", 
     RowBox[{"n", "\[Rule]", "np"}], ",", 
     RowBox[{"o", "\[Rule]", "op"}], ",", 
     RowBox[{"p", "\[Rule]", "pp"}], ",", 
     RowBox[{"q", "\[Rule]", "qp"}], ",", 
     RowBox[{"r", "\[Rule]", "rp"}], ",", 
     RowBox[{"s", "\[Rule]", "sp"}], ",", 
     RowBox[{"t", "\[Rule]", "tp"}], ",", 
     RowBox[{"u", "\[Rule]", "up"}], ",", 
     RowBox[{"v", "\[Rule]", "vp"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.869518280609372*^9},
 CellLabel->
  "In[260]:=",ExpressionUUID->"e70bc9d9-448d-4bab-8893-58fcaf18729f"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"BlankSlate", "/.", "substitutions"}], "]"}]], "Input",
 CellChangeTimes->{{3.869518234927585*^9, 3.8695182693431835`*^9}, 
   3.8793838653603854`*^9, 3.879520971029767*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"0c78bbf1-8db2-400b-bf3e-387754cdd8c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixUbar", "[", "U", "]"}], ".", 
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
       RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", "id", ",", 
      "\[CapitalSigma]"}], "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.837707973295394*^9, 3.837707999043233*^9}, {
  3.837708047967713*^9, 3.837708133270465*^9}, {3.8377081670288773`*^9, 
  3.837708182094732*^9}, {3.838315519596882*^9, 3.838315527532865*^9}, {
  3.8702365608069167`*^9, 3.8702365684027057`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"0bb34154-f51c-4c28-83f8-741e777254ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{"Tmat_", ",", 
      StyleBox["id",
       FontColor->RGBColor[1, 0, 0]], ",", "TRIV"}], "]"}], ":=", "Tmat"}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"These", " ", "are", " ", "the", " ", "P", 
     RowBox[{"(", 
      RowBox[{"T", ",", 
       RowBox[{
        SubscriptBox["V", "\[CapitalSigma]"], 
        RowBox[{"(", "I", ")"}]}]}], ")"}], " ", "in", " ", "the", " ", 
     "2022", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "0", "0", "0", "0"},
       {"g", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "i", "o", "s"},
       {"0", "0", "i", "d", "j", "p"},
       {"0", "0", "o", "j", "e", "k"},
       {"0", "0", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "ORTH"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "j", "p"},
       {"0", "0", "0", "j", "e", "k"},
       {"0", "0", "0", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "TRIG"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", "0"},
        {
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "TET"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0"},
        {"0", "0", "c", "0", "0", "0"},
        {"0", "0", "0", "d", "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "CUBE"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0", "0"},
        {"0", "0", 
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0"},
        {"0", "0", "0", 
         FractionBox[
          RowBox[{"d", "+", "e"}], "2"], "0", "0"},
        {"0", "0", "0", "0", 
         FractionBox[
          RowBox[{"d", "+", "e"}], "2"], "0"},
        {"0", "0", "0", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"a_", "g_", "m_", "q_", "t_", "v_"},
          {"gdum_", "b_", "h_", "n_", "r_", "u_"},
          {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
          {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
          {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
          {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      StyleBox["id",
       FontColor->RGBColor[1, 0, 0]], ",", "XISO"}], "]"}], ":=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0"},
        {"0", "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0", "0"},
        {"0", "0", "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";", 
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"a_", "g_", "m_", "q_", "t_", "v_"},
          {"gdum_", "b_", "h_", "n_", "r_", "u_"},
          {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
          {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
          {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
          {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      StyleBox["id",
       FontColor->RGBColor[1, 0, 0]], ",", "ISO"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0", "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0"},
       {"0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.8365909720971985`*^9, 3.83659100273319*^9}, {
   3.836591362316605*^9, 3.836591369832106*^9}, {3.837537582893462*^9, 
   3.8375376419816647`*^9}, {3.837537681816289*^9, 3.8375377605041833`*^9}, {
   3.8375381993641057`*^9, 3.837538212538134*^9}, {3.837538755170615*^9, 
   3.837538794523321*^9}, {3.8375388308072205`*^9, 3.8375389016620283`*^9}, {
   3.8375389425372505`*^9, 3.8375389432091637`*^9}, {3.837540045005973*^9, 
   3.8375400469122224`*^9}, {3.838315531679864*^9, 3.838315537160882*^9}, 
   3.838315656107436*^9, 3.843934250463087*^9, {3.8667358194495106`*^9, 
   3.8667358360281563`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"0b9e8228-f224-4c6b-80d9-b60ee3a36aa6"],

Cell[CellGroupData[{

Cell[TextData[{
 "Showing that T - P(T, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "I", ")"}], 
     ")"}], " ", "is", " ", "in", " ", "the", " ", "orthogonal", " ", 
    "complement", " ", "of", " "}], TraditionalForm]],ExpressionUUID->
  "f4e691a9-b289-4262-9f59-a50bc537bd13"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "I", ")"}], 
   TraditionalForm]],ExpressionUUID->"d8ffdaef-4648-4054-bd8a-348a23554e10"],
 "."
}], "Subsection",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 3.8667357799594383`*^9}, {
  3.8695305090838656`*^9, 3.8695305579811907`*^9}, {3.869530616652195*^9, 
  3.869530697665429*^9}},ExpressionUUID->"07bc8e91-0fcd-4cd8-b059-\
f835fbf74fb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "ap", ",", "bp", ",", "cp", ",", "dp", ",", "ep", ",", "fp", ",", "gp", 
    ",", "hp", ",", "ip", ",", "jp", ",", "kp", ",", "mp", ",", "np", ",", 
    "op", ",", "pp", ",", "qp", ",", "rp", ",", "sp", ",", "tp", ",", "up", 
    ",", "vp", ",", "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", 
    ",", "g", ",", "h", ",", "i", ",", "j", ",", "k", ",", "m", ",", "n", ",",
     "o", ",", "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", 
    "v"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"ap", "gp", "mp", "qp", "tp", "vp"},
         {"gp", "bp", "hp", "np", "rp", "up"},
         {"mp", "hp", "cp", "ip", "op", "sp"},
         {"qp", "np", "ip", "dp", "jp", "pp"},
         {"tp", "rp", "op", "jp", "ep", "kp"},
         {"vp", "up", "sp", "pp", "kp", "fp"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "TRIV"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "gp", "0", "0", "0", "0"},
        {"gp", "bp", "0", "0", "0", "0"},
        {"0", "0", "cp", "ip", "op", "sp"},
        {"0", "0", "ip", "dp", "jp", "pp"},
        {"0", "0", "op", "jp", "ep", "kp"},
        {"0", "0", "sp", "pp", "kp", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "0", "0", "0", "0", "0"},
        {"0", "bp", "0", "0", "0", "0"},
        {"0", "0", "cp", "0", "0", "0"},
        {"0", "0", "0", "dp", "jp", "pp"},
        {"0", "0", "0", "jp", "ep", "kp"},
        {"0", "0", "0", "pp", "kp", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "ORTH"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "0", "0", "0", "0", "0"},
        {"0", "ap", "0", "0", "0", "0"},
        {"0", "0", "cp", "0", "0", "0"},
        {"0", "0", "0", "dp", "0", "0"},
        {"0", "0", "0", "0", "ep", "kp"},
        {"0", "0", "0", "0", "kp", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "TET"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "0", "0", "0", "0", "0"},
        {"0", "ap", "0", "0", "0", "0"},
        {"0", "0", "ap", "0", "0", "0"},
        {"0", "0", "0", "dp", "0", "0"},
        {"0", "0", "0", "0", "dp", "0"},
        {"0", "0", "0", "0", "0", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
     RowBox[{"BlankSlate", "-", 
      RowBox[{"ProjToVSigOfU", "[", 
       RowBox[{
        TagBox["BlankSlate",
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]], ",", 
        StyleBox["id",
         FontColor->RGBColor[1, 0, 0]], ",", "CUBE"}], "]"}]}]}], "]"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ap", "0", "mp", "0", "0", "0"},
       {"0", "ap", "0", "mp", "0", "0"},
       {"mp", "0", "cp", "0", "0", "0"},
       {"0", "mp", "0", "cp", "0", "0"},
       {"0", "0", "0", "0", "ep", "kp"},
       {"0", "0", "0", "0", "kp", "fp"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "TRIG"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ap", "0", "0", "0", "0", "0"},
       {"0", "ap", "0", "0", "0", "0"},
       {"0", "0", "cp", "0", "0", "0"},
       {"0", "0", "0", "cp", "0", "0"},
       {"0", "0", "0", "0", "ep", "kp"},
       {"0", "0", "0", "0", "kp", "fp"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "XISO"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ap", "0", "0", "0", "0", "0"},
       {"0", "ap", "0", "0", "0", "0"},
       {"0", "0", "ap", "0", "0", "0"},
       {"0", "0", "0", "ap", "0", "0"},
       {"0", "0", "0", "0", "ap", "0"},
       {"0", "0", "0", "0", "0", "fp"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "ISO"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8357470335862246`*^9, 3.835747067090229*^9}, {
   3.835747115315954*^9, 3.8357471615552735`*^9}, {3.837538599934983*^9, 
   3.8375386539001265`*^9}, {3.837540159405265*^9, 3.83754016470214*^9}, {
   3.8375583418439856`*^9, 3.837558438579998*^9}, {3.837558501128033*^9, 
   3.8375586004360185`*^9}, {3.837558641252023*^9, 3.837558713524046*^9}, {
   3.837558745863897*^9, 3.8375587812040415`*^9}, {3.8383155413188667`*^9, 
   3.838315552789873*^9}, {3.866215101200475*^9, 3.866215102255923*^9}, {
   3.8694962599420996`*^9, 3.869496341514533*^9}, {3.869517940108182*^9, 
   3.869518209525943*^9}, {3.869518348948544*^9, 3.869518353996106*^9}, 
   3.8695183957165785`*^9, {3.8695184629823313`*^9, 3.86951847191269*^9}, {
   3.869518524624955*^9, 3.869518525001154*^9}, {3.879383866703079*^9, 
   3.8793838860420074`*^9}, {3.87952097209367*^9, 3.879520984119149*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"b60cb174-93c3-44de-8f1b-6e76113caeab"],

Cell[CellGroupData[{

Cell[TextData[{
 "DistToV\[CapitalSigma]ofU is  ",
 StyleBox["d",
  FontSlant->"Italic"],
 "(T, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["V", "\[CapitalSigma]"], "(", "U", ")"}], ")"}], "  ", 
    "in", "  ", "TapeTape2022"}], TraditionalForm]],ExpressionUUID->
  "0d3ab6f8-f6b5-4908-a93a-1c5c308eff18"]
}], "Subsubsection",
 CellChangeTimes->{{3.8694959455413094`*^9, 
  3.8694960529664993`*^9}},ExpressionUUID->"f97ad746-42f9-4d37-b46e-\
776fd49c6424"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "DistToV\[CapitalSigma]ofU", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "SymClass_"}], "]"}], ":=", "     ", 
   RowBox[{"NormMatrix", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
      RowBox[{"MatrixUbar", "[", "U", "]"}]}], "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
        RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "SymClass"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
     RowBox[{"Tmat_", ",", "U_", ",", "ISO"}], "]"}], ":=", 
    RowBox[{"NormMatrix", "[", 
     RowBox[{"Tmat", "-", 
      RowBox[{"ProjToVSigOfU", "[", 
       RowBox[{"Tmat", ",", 
        StyleBox["id",
         FontColor->RGBColor[1, 0, 0]], ",", "ISO"}], "]"}]}], "]"}]}], "   ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Independent", " ", "of", " ", "U", " ", "for", " ", "SymClass"}], " ", 
      "=", " ", 
      RowBox[{"ISO", "."}]}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], "*)"}], ";"}], "  "}]}], "Input",
 CellChangeTimes->{{3.8357448915238466`*^9, 3.835744967570093*^9}, {
   3.8357450479859734`*^9, 3.835745074145976*^9}, {3.835745147649985*^9, 
   3.8357451824179897`*^9}, {3.835745240369624*^9, 3.8357452601139994`*^9}, {
   3.835747326226262*^9, 3.835747327426262*^9}, {3.836493385688408*^9, 
   3.8364933907773094`*^9}, {3.8375211999204063`*^9, 3.837521299663314*^9}, {
   3.837521428127365*^9, 3.8375214513513784`*^9}, {3.837538288469763*^9, 
   3.837538328350992*^9}, {3.837538997078642*^9, 3.8375389982192793`*^9}, {
   3.8375390638392706`*^9, 3.8375390685423822`*^9}, {3.8375419187174435`*^9, 
   3.837541920311195*^9}, {3.8375419703826494`*^9, 3.8375419907156963`*^9}, {
   3.837543100696145*^9, 3.837543101758645*^9}, {3.8375432689255123`*^9, 
   3.8375432754895744`*^9}, 3.838315537907877*^9, {3.8383164982723083`*^9, 
   3.8383165307639246`*^9}, 3.8411596871528597`*^9, 3.8416739537202744`*^9, {
   3.858003176569495*^9, 3.8580031850152383`*^9}, {3.85800325373061*^9, 
   3.8580033334280252`*^9}, {3.8580034529027033`*^9, 3.858003501589068*^9}, {
   3.8580035433430667`*^9, 3.858003544484513*^9}, {3.8598424439287043`*^9, 
   3.859842457438259*^9}, {3.8599875005919046`*^9, 3.859987502181564*^9}, {
   3.869495810654622*^9, 3.8694958194467974`*^9}, 3.8694960878445487`*^9, 
   3.86953084944965*^9},
 CellLabel->
  "In[279]:=",ExpressionUUID->"98f74e60-f8d8-4ed4-9334-3241a45def0a"],

Cell["\<\
Remember PlotLegends are \[OpenCurlyDoubleQuote]Legended\
\[CloseCurlyDoubleQuote] things, not Graphics objects, so you cannot inset \
them, for example. 
But legends[contours, MaxForScaling] is a Graphics object.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.8958431062070265`*^9, {3.8958434312061357`*^9, 3.8958434379592533`*^9}, {
   3.895843469626789*^9, 3.8958435366898975`*^9}, 
   3.905007522958414*^9},ExpressionUUID->"5ce66c00-9431-45c7-93b4-\
da424809f0eb"],

Cell[BoxData[
 RowBox[{"Clear", "[", "legends", "]"}]], "Input",
 CellChangeTimes->{{3.8975825796242266`*^9, 3.8975825832793093`*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"188217e9-c842-4a16-9512-88d633110dc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"legends", "[", 
   RowBox[{"contours_", ",", "MaxForScaling_", ",", "heading_", ",", "hw_"}], 
   "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"WantRound", "==", "\"\<WantRound\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"SequenceForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SuperscriptBox", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"contours", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "0.01"}], "]"}], ",",
                    "15"}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<\[SmallCircle]\>\"", ",", "16"}], "]"}]}], 
                "]"}], "//", "DisplayForm"}], ",", "\"\< \>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2.5", ",", 
              RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             StyleBox["contours",
              FontWeight->"Plain"], "]"}], "-", "1"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"SequenceForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SuperscriptBox", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{"contours", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", "15"}], "]"}],
                  ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<\[SmallCircle]\>\"", ",", "16"}], "]"}]}], 
                "]"}], "//", "DisplayForm"}], ",", "\"\< \>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2.5", ",", 
              RowBox[{"#", " ", "hw"}]}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             StyleBox["contours",
              FontWeight->"Plain"], "]"}], "-", "1"}], ",", "2"}], "]"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"heading", ",", 
        RowBox[{"{", 
         RowBox[{".75", ",", 
          RowBox[{"hw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              StyleBox["contours",
               FontWeight->"Plain"], "]"}], "+", ".8"}], ")"}]}]}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".0005", "]"}], ",", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3.5", ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}]}], "}"}]}]}], "}"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"fake", " ", "points"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Thickness", "[", ".0004", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
             RowBox[{".5", 
              FractionBox[
               RowBox[{
                RowBox[{"contours", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "+", 
                RowBox[{"contours", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "MaxForScaling"]}],
              "]"}], ",", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}]}], "}"}], 
             "]"}]}], "}"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8957665925900593`*^9, 3.8957666328015494`*^9}, {
   3.895766720503864*^9, 3.8957667229476805`*^9}, 3.896021851266075*^9, {
   3.897508840884877*^9, 3.8975088705406156`*^9}, {3.897509797182927*^9, 
   3.897509815404682*^9}, 3.897512801412268*^9, 3.8975131086948013`*^9, 
   3.8975131811713133`*^9, {3.897580847326705*^9, 3.897580953168872*^9}, 
   3.8975809985456266`*^9, 3.8975810317296133`*^9, {3.897581404337429*^9, 
   3.8975814205751605`*^9}, {3.8975814616830807`*^9, 
   3.8975814632026844`*^9}, {3.897581736338208*^9, 3.897581848370181*^9}, {
   3.897581964401949*^9, 3.8975819945782967`*^9}, 3.8975820435215206`*^9, {
   3.897582403027783*^9, 3.8975824081625586`*^9}, {3.897582474019393*^9, 
   3.8975824941943007`*^9}, 3.897583439987341*^9, {3.8975835115875635`*^9, 
   3.897583518580078*^9}, {3.897583619559249*^9, 3.8975836243556747`*^9}, {
   3.8975836666002464`*^9, 3.897583668133355*^9}, {3.897583746018587*^9, 
   3.8975837894425354`*^9}, {3.897583837749117*^9, 3.897583839475986*^9}, {
   3.8975840162922897`*^9, 3.89758406683617*^9}, {3.8975841034613485`*^9, 
   3.8975841244834757`*^9}, {3.8975844753628516`*^9, 
   3.8975844755077996`*^9}, {3.898641376068971*^9, 3.8986413792224913`*^9}, {
   3.8986422710850525`*^9, 3.898642272059322*^9}, {3.8986423539178042`*^9, 
   3.8986423876685524`*^9}, {3.8997316943807287`*^9, 3.8997317195137496`*^9}, 
   3.8997319234367456`*^9, {3.8997319727973166`*^9, 3.899731990088535*^9}, {
   3.8997320383284993`*^9, 3.899732132635543*^9}, 3.899732281610573*^9, {
   3.9005274465521464`*^9, 3.9005274480524893`*^9}, {3.900527745453613*^9, 
   3.9005277549056926`*^9}, {3.903454314669953*^9, 3.903454315349551*^9}, {
   3.9046728455826025`*^9, 3.9046729341593313`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"63080a6a-2c2e-47a0-8031-96d52e32bf9c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "LegendsWithDefaultColors", "]"}]], "Input",
 CellChangeTimes->{{3.8997332819982443`*^9, 3.899733284136171*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"897c26f8-0d83-4f74-af4f-86c3e01a313e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendsWithDefaultColors", "[", 
   RowBox[{"contours_", ",", "heading_", ",", "hw_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"WantRound", "==", "\"\<WantRound\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"SequenceForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SuperscriptBox", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"contours", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "0.01"}], "]"}], ",",
                    "13"}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<\[SmallCircle]\>\"", ",", "16"}], "]"}]}], 
                "]"}], "//", "DisplayForm"}], ",", "\"\< \>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2.5", ",", 
              RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             StyleBox["contours",
              FontWeight->"Plain"], "]"}], "-", "1"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"SequenceForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SuperscriptBox", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{"contours", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", "13"}], "]"}],
                  ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<\[SmallCircle]\>\"", ",", "16"}], "]"}]}], 
                "]"}], "//", "DisplayForm"}], ",", "\"\< \>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2.5", ",", 
              RowBox[{"#", " ", "hw"}]}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             StyleBox["contours",
              FontWeight->"Plain"], "]"}], "-", "1"}], ",", "2"}], "]"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"heading", ",", 
        RowBox[{"{", 
         RowBox[{".75", ",", 
          RowBox[{"hw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              StyleBox["contours",
               FontWeight->"Plain"], "]"}], "+", ".8"}], ")"}]}]}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".0005", "]"}], ",", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", 
             RowBox[{"1.15", "hw", 
              RowBox[{"(", 
               RowBox[{"Length", "[", 
                StyleBox["contours",
                 FontWeight->"Plain"], "]"}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3.5", ",", 
             RowBox[{"1.15", "hw", 
              RowBox[{"(", 
               RowBox[{"Length", "[", 
                StyleBox["contours",
                 FontWeight->"Plain"], "]"}], ")"}]}]}], "}"}]}], "}"}]}]}], 
       "}"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"fake", " ", "points"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Thickness", "[", ".0004", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "ColorData", "[", "\"\<M10DefaultDensityGradient\>\"", "]"}], 
             "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], "+", 
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "-", 
                RowBox[{"contours", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{".5", 
                   RowBox[{"contours", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                  RowBox[{".5", 
                   RowBox[{"contours", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ")"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}]}], "}"}], 
             "]"}]}], "}"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8970650805922356`*^9, 3.8970650974931583`*^9}, {
   3.8970653527332544`*^9, 3.897065356942707*^9}, {3.897065496106089*^9, 
   3.897065528438134*^9}, {3.8970655761824694`*^9, 3.8970655844643636`*^9}, 
   3.897065741206607*^9, {3.8970664938602448`*^9, 3.8970665207146363`*^9}, {
   3.8970665887296133`*^9, 3.897066629189027*^9}, {3.8970667287203536`*^9, 
   3.8970667614330463`*^9}, {3.897067199185506*^9, 3.89706723727534*^9}, 
   3.8970672831868167`*^9, {3.8970673883400764`*^9, 3.897067428704113*^9}, 
   3.8970675207947364`*^9, {3.89706770104578*^9, 3.8970677050247726`*^9}, {
   3.8970677605783677`*^9, 3.8970677628095813`*^9}, {3.897067898179243*^9, 
   3.897067901620552*^9}, 3.8970759661329107`*^9, 3.8970760897288685`*^9, {
   3.8970762425640426`*^9, 3.8970762433950977`*^9}, {3.8975083284246607`*^9, 
   3.8975083654295435`*^9}, 3.89750841203564*^9, 3.897508442676783*^9, {
   3.8975084754090676`*^9, 3.8975084891417613`*^9}, {3.897508535332142*^9, 
   3.8975087429565883`*^9}, {3.8975087740699997`*^9, 3.8975087752313137`*^9}, 
   3.8975099707321353`*^9, {3.8975127744558115`*^9, 3.8975127799951615`*^9}, {
   3.897513259564858*^9, 3.8975132665830894`*^9}, {3.899655498023056*^9, 
   3.899655498501145*^9}, {3.8996555855390434`*^9, 3.899655591237478*^9}, {
   3.899655650517541*^9, 3.8996557103089933`*^9}, {3.89965587206988*^9, 
   3.8996558889344997`*^9}, {3.899655933750066*^9, 3.899655943845474*^9}, {
   3.899655976101471*^9, 3.899655978916907*^9}, {3.8996561930133677`*^9, 
   3.899656202806426*^9}, 3.8996565988220673`*^9, {3.899656685028875*^9, 
   3.899656685156464*^9}, 3.899732275802255*^9, 3.899732316619712*^9, {
   3.8997325966973934`*^9, 3.89973265117915*^9}, {3.8997327357877235`*^9, 
   3.8997327385716953`*^9}, {3.899732791243602*^9, 3.8997327925238876`*^9}, {
   3.8997328431165123`*^9, 3.8997328639474506`*^9}, {3.899732904604663*^9, 
   3.8997329243480535`*^9}, {3.899732975836596*^9, 3.8997329809864883`*^9}, {
   3.899733223051328*^9, 3.8997332251147103`*^9}, {3.899733415594942*^9, 
   3.8997334272922406`*^9}, {3.899733937962591*^9, 3.8997339387147245`*^9}, {
   3.899733973178096*^9, 3.8997340608091936`*^9}, {3.9032023956870794`*^9, 
   3.9032023965437136`*^9}, {3.9046729695777407`*^9, 
   3.9046729952845526`*^9}, {3.9046730967923517`*^9, 3.904673105846819*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"8b71e12b-b8ed-427d-8891-fc30d71aba89"],

Cell[BoxData[
 RowBox[{"hw", "=", "1.3"}]], "Input",
 CellChangeTimes->{{3.8997330405914*^9, 3.899733077817568*^9}, 
   3.899733161032676*^9, 3.899733264409441*^9, {3.899733302728598*^9, 
   3.899733303832593*^9}, {3.8997334453066945`*^9, 3.899733446504133*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"931fc293-b21a-4d8b-81f1-f1ca31bfd780"],

Cell[BoxData[
 RowBox[{"WantRound", "=", "\"\<WantRound\>\""}]], "Input",
 CellChangeTimes->{
  3.9046730451164713`*^9, {3.9046732086614685`*^9, 3.904673209390176*^9}, {
   3.9046732537967567`*^9, 3.90467325412621*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"4bac9ea1-d93c-47e0-bb6c-f40a05790b49"],

Cell[BoxData[
 RowBox[{"LegendsWithDefaultColors", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"12", ",", "20", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\[Alpha]\>\"", ",", "20"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<XISO\>\"", ",", "11"}], "]"}]}], "]"}], "//", 
    "DisplayForm"}], ",", "hw"}], "]"}]], "Input",
 CellChangeTimes->{{3.897065378804065*^9, 3.8970653818136663`*^9}, {
   3.8970654624854383`*^9, 3.8970654796377125`*^9}, 3.897066103814332*^9, 
   3.8970661660602*^9, {3.8970667715231476`*^9, 3.897066771946636*^9}, {
   3.897066806750881*^9, 3.897066819303035*^9}, {3.8970679563373704`*^9, 
   3.897067956822983*^9}, {3.8975087545788345`*^9, 3.897508755429982*^9}, {
   3.8975087979733477`*^9, 3.897508799872948*^9}, 3.8975098797375264`*^9, {
   3.897509913728053*^9, 3.897509915688051*^9}, {3.897513322338952*^9, 
   3.897513328678775*^9}, {3.8988661119513626`*^9, 3.898866122514305*^9}, {
   3.899732371626047*^9, 3.8997323979127307`*^9}, {3.8997332353373146`*^9, 
   3.8997332365858965`*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"af2585f2-da78-4728-aa80-ea08cb5f0040"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.897509412397808*^9, 3.897509414025237*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"378a42a0-2d2c-4477-a24a-21e9624a180d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hw", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"legends", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "20", ",", "4"}], "]"}], ",", "19", ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "20"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<MONO\>\"", ",", "11"}], "]"}]}], "]"}], "//", 
      "DisplayForm"}], ",", "hw"}], "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "100"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.897509443903418*^9, 3.897509452335904*^9}, 
   3.8975096166535206`*^9, 3.8975133074408684`*^9, {3.8975815103839397`*^9, 
   3.8975815395986648`*^9}, {3.8975816444157743`*^9, 
   3.8975816798233814`*^9}, {3.897581862926977*^9, 3.8975819475829816`*^9}, {
   3.898866218309831*^9, 3.8988662778051586`*^9}, {3.898866337817874*^9, 
   3.898866357125506*^9}, {3.8997331118339767`*^9, 3.8997331295293956`*^9}, 
   3.89973350426546*^9},
 CellLabel->
  "In[290]:=",ExpressionUUID->"e5266726-c8e0-4c15-a2a8-ed7176b8da61"],

Cell[CellGroupData[{

Cell["\<\
Crystallographic BarForm text for n-fold rotations. 
Not meant for arbitrary rotations or even n-fold rotations with arbitrary \
rotation axes.\
\>", "Subsubsection",
 CellChangeTimes->{{3.890060951285735*^9, 3.89006096360441*^9}, {
   3.8900646632339835`*^9, 3.890064697109466*^9}, {3.890064747735567*^9, 
   3.8900647588914742`*^9}, {3.8901807528034043`*^9, 3.89018078437807*^9}, 
   3.904312048704237*^9},ExpressionUUID->"57ecfdff-8168-4c02-a3d7-\
0a446ec3c86c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FirstNonZero", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_", ",", "p_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"m", "\[Equal]", "0"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "p", ",", "n"}], "]"}], ",", 
     "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PreAxis", "[", "U_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Eigenvectors", "[", "U", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "==", "#"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotAxisForNfoldU", "[", "U_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Vtest", "=", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"PreAxis", "[", "U", "]"}], ",", "RandomDirection"}], "]"}]}],
      ";", "    ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"needs", " ", "modification", " ", "for", " ", "identity"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{"Vtest", ",", 
           RowBox[{"U", ".", "Vtest"}], ",", 
           RowBox[{"PreAxis", "[", "U", "]"}]}], "}"}], "]"}], 
        "\[GreaterEqual]", 
        RowBox[{"-", ".000001"}]}], ",", 
       RowBox[{"PreAxisNew", "=", 
        RowBox[{"PreAxis", "[", "U", "]"}]}], ",", 
       RowBox[{"PreAxisNew", "=", 
        RowBox[{"-", 
         RowBox[{"PreAxis", "[", "U", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RotationAngle", "[", "U", "]"}], "\[Equal]", "\[Pi]"}], "&&", 
        RowBox[{
         RowBox[{"FirstNonZero", "[", "PreAxisNew", "]"}], "<", "0"}]}], ",", 
       RowBox[{"-", "PreAxisNew"}], ",", "PreAxisNew"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarForm", "[", "n_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[GreaterEqual]", "0"}], ",", "n", ",", 
     OverscriptBox[
      RowBox[{"-", "n"}], "_"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarFormText", "[", "U_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"U", "\[Equal]", "id"}], ",", "999", ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"SequenceForm", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BarForm", "[", 
           RowBox[{
            RowBox[{"RotAxisForNfoldU", "[", "U", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BarForm", "[", 
           RowBox[{
            RowBox[{"RotAxisForNfoldU", "[", "U", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BarForm", "[", 
           RowBox[{
            RowBox[{"RotAxisForNfoldU", "[", "U", "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"RotationAngle", "[", "U", "]"}], "]"}]}]}]}], "]"}], "//",
       "DisplayForm"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890060822177127*^9, 3.890060905734544*^9}, {
   3.890061070131735*^9, 3.890061124025692*^9}, {3.890061809476994*^9, 
   3.8900618098972015`*^9}, {3.89006189725653*^9, 3.8900618988869114`*^9}, {
   3.890062377448352*^9, 3.8900623928729734`*^9}, {3.8900645294556913`*^9, 
   3.8900645733812656`*^9}, {3.8900646137318573`*^9, 3.890064647099513*^9}, {
   3.8900647653891306`*^9, 3.8900647946275387`*^9}, {3.8900649132176647`*^9, 
   3.8900649634053707`*^9}, {3.890065016192517*^9, 3.890065021329948*^9}, {
   3.8901809822066135`*^9, 3.8901810141101522`*^9}, {3.8901811020425763`*^9, 
   3.8901811308223205`*^9}, {3.8901817573939457`*^9, 3.890181773912665*^9}, {
   3.8901874220427327`*^9, 3.8901874618596087`*^9}, {3.890502721256652*^9, 
   3.8905027311849575`*^9}, {3.890583970669634*^9, 3.890584143390314*^9}, {
   3.890584209194031*^9, 3.890584230078514*^9}, 3.890584555810692*^9, {
   3.89058509135993*^9, 3.8905851153370686`*^9}, {3.8905852603649883`*^9, 
   3.8905852613370314`*^9}, {3.890593340371934*^9, 3.890593350318657*^9}, {
   3.8990742017608433`*^9, 3.899074218226144*^9}, {3.8990742666023054`*^9, 
   3.8990742672144194`*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"8be36205-693d-47e3-97fe-1341f4197f82"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BarFormTextForTriples", "[", 
   RowBox[{"{", 
    RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], "]"}], ":=", 
  RowBox[{"SequenceForm", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BarForm", "[", "n1", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BarForm", "[", "n2", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BarForm", "[", "n3", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8990745286387105`*^9, 3.899074582563293*^9}, {
  3.8990747167713337`*^9, 3.8990747584504023`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"57d2feb4-eafb-424b-b51a-69ca44efd0c2"],

Cell[BoxData[{
 RowBox[{"BarFormText", "[", 
  RowBox[{"ZRot", "[", "\[Pi]", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BarFormTextForTriples", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", 
    RowBox[{"-", "3"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.899074425933503*^9, 3.8990744419598436`*^9}, {
  3.899074770236881*^9, 3.899074776510295*^9}, {3.8990748215222187`*^9, 
  3.899074833921664*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"b0d974ff-e6ef-4b82-afee-acb3a949d178"],

Cell[CellGroupData[{

Cell[TextData[{
 "Sort them. ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 13 seems to give an error message not seen in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10. The final output is still OK."
}], "Subsubsection",
 CellChangeTimes->{{3.890060951285735*^9, 3.89006096360441*^9}, {
  3.8900646632339835`*^9, 3.890064697109466*^9}, {3.890064747735567*^9, 
  3.8900647588914742`*^9}, {3.8901807528034043`*^9, 3.89018078437807*^9}, {
  3.8905036241170216`*^9, 3.8905036269409432`*^9}, {3.898866641861104*^9, 
  3.8988666987630453`*^9}},ExpressionUUID->"e2174c1a-e166-4931-810a-\
7573f8b84968"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberZeros", "[", "nTuple_", "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{"nTuple", ",", 
      RowBox[{
       RowBox[{"#", "\[Equal]", "0"}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderByRotAngleAndNumberZeros", "[", 
    RowBox[{"U1_", ",", "U2_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RotationAngle", "[", "U1", "]"}], "==", 
       RowBox[{"RotationAngle", "[", "U2", "]"}]}], "&&", 
      RowBox[{
       RowBox[{"NumberZeros", "[", 
        RowBox[{"RotationAxis", "[", "U1", "]"}], "]"}], "==", 
       RowBox[{"NumberZeros", "[", 
        RowBox[{"RotationAxis", "[", "U2", "]"}], "]"}]}]}], ",", 
     RowBox[{"OrderedQ", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RotationAxis", "[", "U2", "]"}], ",", 
        RowBox[{"RotationAxis", "[", "U1", "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RotationAngle", "[", "U1", "]"}], "==", 
        RowBox[{"RotationAngle", "[", "U2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"NumberZeros", "[", 
         RowBox[{"RotationAxis", "[", "U1", "]"}], "]"}], ">", 
        RowBox[{"NumberZeros", "[", 
         RowBox[{"RotationAxis", "[", "U2", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RotationAngle", "[", "U1", "]"}], "<", 
        RowBox[{"RotationAngle", "[", "U2", "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortByRotAngleAndNumberZeros", "[", "xxx_", "]"}], ":=", 
  RowBox[{"Sort", "[", 
   RowBox[{"xxx", ",", "OrderByRotAngleAndNumberZeros"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.8905028226065288`*^9, {3.8905083066495075`*^9, 3.8905083076525497`*^9}, {
   3.890578433434654*^9, 3.890578457108817*^9}, {3.8905785005151176`*^9, 
   3.890578515826677*^9}, {3.8905787216674757`*^9, 3.890578727508812*^9}, {
   3.8905788058763084`*^9, 3.8905788092017508`*^9}, {3.890579122213084*^9, 
   3.8905791399086814`*^9}, {3.890579191520915*^9, 3.890579230640934*^9}, {
   3.8905793463478966`*^9, 3.8905793541777787`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"e09eb74d-cc42-4d01-b5c0-dc0ea8b1e82b"],

Cell[BoxData[
 RowBox[{"BarFormText", "/@", 
  RowBox[{"SortByRotAngleAndNumberZeros", "[", "RefGpTET", "]"}]}]], "Input",
 CellChangeTimes->{{3.823089382184165*^9, 3.823089438787176*^9}, {
   3.890502695633837*^9, 3.890502709898342*^9}, {3.890502746123519*^9, 
   3.890502761892523*^9}, 3.8905028292749147`*^9, {3.8905083367717595`*^9, 
   3.890508342608862*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"9aa74ff1-338b-498b-9fdc-8fe2c20f9023"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Probably you will not want to put this into Python, but I will leave it in.
MDFgraphics. Now has eye as an input, may have to change elsewhere. And \
contours is now an input.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.8860948209432187`*^9, {3.8986117678823757`*^9, 3.8986117871377277`*^9}, {
   3.8986968593547497`*^9, 3.8986968820779495`*^9}, {3.898699725567361*^9, 
   3.898699729113715*^9}, {3.9050083946434608`*^9, 
   3.9050083958688726`*^9}},ExpressionUUID->"4c91271c-8a79-4eaf-9e57-\
9fea58124f22"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"MDFgraphics", ",", "MDFgraphicsNoPaxes"}], "]"}]], "Input",
 CellChangeTimes->{{3.8986963731075125`*^9, 3.898696391741488*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"16422a44-5778-4cb9-b1aa-4060b8f45631"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MDFgraphics", "[", 
   RowBox[{
   "center_", ",", "BBrad_", ",", "Tmat_", ",", "eye_", ",", "contours_", ",",
     "MaxForScaling_", ",", "plotpoints_", ",", "ExtraGraphics_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["   ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{"cpMONOcontoursOnly", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Paxes", "[", 
        RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", "1", 
         ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
        "]"}], ",", "\[IndentingNewLine]", "ExtraGraphics"}], "}"}], "]"}], 
    ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    StyleBox[
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
     FontColor->RGBColor[1, 0, 0]], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8851130046436377`*^9, 3.885113029467578*^9}, 
   3.885113071091058*^9, {3.8851427806277375`*^9, 3.885142859592553*^9}, {
   3.8851696758949347`*^9, 3.885169713106724*^9}, {3.885169824632389*^9, 
   3.885169846741619*^9}, 3.8854201253006244`*^9, {3.885420196984582*^9, 
   3.8854202029236393`*^9}, {3.8854323702369146`*^9, 
   3.8854323710867767`*^9}, {3.8854334715048485`*^9, 
   3.8854334757449474`*^9}, {3.8854335238750005`*^9, 3.885433526120186*^9}, {
   3.885435357095127*^9, 3.885435362553445*^9}, {3.885485539549903*^9, 
   3.885485545409445*^9}, {3.8854866209302807`*^9, 3.8854866320250435`*^9}, {
   3.885487092590778*^9, 3.8854871060984097`*^9}, 3.88548978959958*^9, 
   3.885963705931657*^9, {3.8859641677072287`*^9, 3.885964215615703*^9}, {
   3.8860278739617176`*^9, 3.8860278884586177`*^9}, 3.886027931203431*^9, {
   3.8860281069937754`*^9, 3.886028108241293*^9}, {3.8860374453201227`*^9, 
   3.8860374627705936`*^9}, 3.88603910858936*^9, {3.8866277901139927`*^9, 
   3.886627843137542*^9}, {3.8866410850966964`*^9, 3.886641090780578*^9}, {
   3.890871258935702*^9, 3.890871263702645*^9}, {3.8949280868131747`*^9, 
   3.894928103341728*^9}, 3.8949282290544357`*^9, {3.8949402884834194`*^9, 
   3.8949402897688866`*^9}, 3.8949416484621196`*^9, {3.895037883178206*^9, 
   3.895037886975437*^9}, {3.8968772274846735`*^9, 3.8968772369325905`*^9}, {
   3.8986963990343323`*^9, 3.8986964025868983`*^9}, {3.89869659937827*^9, 
   3.8986966334252195`*^9}, {3.89869970917429*^9, 3.8986997548811836`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"eccd6900-7537-4cfe-a476-d617dc738bb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MDFgraphicsNoPaxes", "[", 
   RowBox[{
   "center_", ",", "BBrad_", ",", "Tmat_", ",", "eye_", ",", "contours_", ",",
     "MaxForScaling_", ",", "plotpoints_", ",", "ExtraGraphics_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["    ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{"cpMONOcontoursOnly", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "ExtraGraphics", "}"}], "]"}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    StyleBox[
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
     FontColor->RGBColor[1, 0, 0]], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8866280429900775`*^9, 3.886628077464938*^9}, 
   3.886641105360939*^9, 3.8949278678856893`*^9, {3.89492825897311*^9, 
   3.8949282658376236`*^9}, {3.894940291745882*^9, 3.894940292436223*^9}, 
   3.8949416499861116`*^9, {3.895037897675191*^9, 3.8950379032433944`*^9}, {
   3.8968772555989647`*^9, 3.8968772609645295`*^9}, {3.898696413113826*^9, 
   3.8986964184044905`*^9}, {3.898696673598717*^9, 3.8986967038999023`*^9}, {
   3.8986996295716*^9, 3.8986996807888985`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"6278a201-30bd-4b0b-a57a-be3f5a654234"]
}, Open  ]],

Cell["\<\
A closest elastic map to Tmat with symmetry Sigma.  Need to run \
OutputFor[Tmat, Sigma].\
\>", "Subsection",
 CellChangeTimes->{{3.8907786087333384`*^9, 3.890778664734527*^9}, {
  3.8907787034397345`*^9, 3.890778726087556*^9}, {3.8907787802484007`*^9, 
  3.890778798221364*^9}},ExpressionUUID->"b06b7a86-100c-4045-b3eb-\
97057647383f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Closest", "[", 
   RowBox[{"Tmat_", ",", "Sigma_"}], "]"}], ":=", 
  RowBox[{"ProjToVSigOfU", "[", 
   RowBox[{"Tmat", ",", 
    RowBox[{"UT", "[", 
     RowBox[{"Tmat", ",", "Sigma"}], "]"}], ",", "Sigma"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9034719338544135`*^9, 3.903471955381024*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"3f5410e8-d2ce-427a-b601-575760f1e768"],

Cell[CellGroupData[{

Cell["Amat", "Subsection",
 CellChangeTimes->{{3.8866146094398575`*^9, 3.8866146380919123`*^9}, {
  3.8940569521219397`*^9, 3.894057047956857*^9}, {3.895338190757129*^9, 
  3.8953381928613205`*^9}, {3.8960508471197867`*^9, 3.8960508476789317`*^9}, {
  3.9050081858594956`*^9, 
  3.9050081904437447`*^9}},ExpressionUUID->"f18063b2-9719-4728-9afe-\
1de09a8ca156"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Amat", "[", 
    RowBox[{"Tmat_", ",", "U_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
    RowBox[{"MatrixUbar", "[", "U", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.886003382199541*^9, 3.8860034341666803`*^9}, {
  3.8860043270164623`*^9, 3.8860043839411793`*^9}, {3.8866124515391707`*^9, 
  3.886612465266702*^9}, {3.895338233578861*^9, 3.8953382477651696`*^9}, {
  3.905008180863168*^9, 3.905008181413252*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"96d20b94-ac35-4da6-ba2e-fe34a2546438"]
}, Open  ]],

Cell["The angular version of the monoclinic distance function :", \
"Subsubsection",
 CellChangeTimes->{{3.894975366356778*^9, 
  3.8949753938899574`*^9}},ExpressionUUID->"810ae591-64c5-4be1-acdc-\
ee2f8d23e644"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Phi]"}], "}"}], "]"}], "==", 
   RowBox[{
    RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
    RowBox[{"YRot", "[", "\[Phi]", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.903078293152074*^9, 3.903078377432186*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"c79bfb50-95b3-4283-ba92-0e83ae5bdbda"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Alpha", "[", 
    RowBox[{"Tmat_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "MONOorXISO_"}], 
    "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    FractionBox[
     RowBox[{"NormMatrix", "[", 
      RowBox[{"ProjToVSigOfU", "[", 
       RowBox[{"Tmat", ",", 
        RowBox[{
         RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
         RowBox[{"YRot", "[", "\[Phi]", "]"}]}], ",", "MONOorXISO"}], "]"}], 
      "]"}], 
     RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895071633568805*^9, 3.8950716671685653`*^9}, {
  3.8950717236841736`*^9, 3.8950717451846266`*^9}, {3.895074000188815*^9, 
  3.895074037390315*^9}, {3.895089916119768*^9, 3.8950899178789697`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"869df752-3ea6-4237-83d4-6120cde64699"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "9"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "\[Pi]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tmat", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
    "]"}]}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Alpha", "[", 
     RowBox[{"Tmat", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
      StyleBox["MONO",
       FontColor->RGBColor[1, 0, 0]]}], "]"}], "-", 
    RowBox[{"ArcSin", "[", 
     FractionBox[
      RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
       RowBox[{"Tmat", ",", 
        StyleBox[
         RowBox[{"UsHat", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}],
         FontColor->RGBColor[1, 0, 0]], ",", 
        StyleBox["MONO",
         FontColor->RGBColor[1, 0, 0]]}], "]"}], 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"Alpha", "[", 
    RowBox[{"Tmat", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     StyleBox["XISO",
      FontColor->RGBColor[1, 0, 0]]}], "]"}], "-", 
   RowBox[{"ArcSin", "[", 
    FractionBox[
     RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
      RowBox[{"Tmat", ",", 
       StyleBox[
        RowBox[{"UsHat", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}],
        FontColor->RGBColor[1, 0, 0]], ",", 
       StyleBox["XISO",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], 
     RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]", ",", "Tmat"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8949874910307713`*^9, 3.8949875189306345`*^9}, {
   3.8949877030612693`*^9, 3.8949877828366904`*^9}, {3.894987825895295*^9, 
   3.8949878411108084`*^9}, 3.8949879200800667`*^9, {3.8949879676313243`*^9, 
   3.894988006134962*^9}, {3.8949880449013405`*^9, 3.8949880587720985`*^9}, {
   3.894988198949004*^9, 3.894988215446542*^9}, {3.8950893959711065`*^9, 
   3.895089411265255*^9}, {3.895089495937982*^9, 3.8950895294476624`*^9}, {
   3.8950895734147344`*^9, 3.8950895872482543`*^9}, {3.8952036526641283`*^9, 
   3.895203690853992*^9}, {3.8952037302880383`*^9, 3.895203731406397*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"112aaa40-1de0-4b83-aaef-96876da17cdd"],

Cell[CellGroupData[{

Cell["\<\
For contours and contour shading together, and getting the whole sphere, not \
just the hemisphere seen by the eye.\
\>", "Section",
 CellChangeTimes->{{3.8860023119635935`*^9, 
  3.8860024029850483`*^9}},ExpressionUUID->"ebb0d7e8-06da-4f73-91e1-\
46313e748919"],

Cell["legends = None or Automatic", "Subsubsection",
 CellChangeTimes->{{3.885064375810918*^9, 3.8850644132321053`*^9}, 
   3.8850645303019347`*^9},ExpressionUUID->"76093659-6523-4e20-bb09-\
18ae2ebee9bd"]
}, Open  ]],

Cell["\"TemperatureMap\"", "Subsubsection",
 CellChangeTimes->{
  3.8855064529650173`*^9},ExpressionUUID->"1fd45754-841f-4655-8948-\
01cc6ae18522"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ContourStyle", "\[Rule]", 
   RowBox[{"Thickness", "[", ".004", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895204217491829*^9, 3.8952042246160216`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"d36be0ff-d3d4-4890-8f88-cdb6a5189d5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpMONO", " ", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cpMONOprelim", "[", 
    RowBox[{
    "Tmat_", ",", "contours_", ",", "legends_", ",", "MaxForScaling_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"cpMONOprelim", "[", 
     RowBox[{"Tmat", ",", "contours", ",", "legends", ",", "MaxForScaling"}], 
     "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Alpha", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "MONO"}], "]"}], 
       "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Thickness", "[", 
        StyleBox[".002",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", "14", "}"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          FractionBox["#", "MaxForScaling"], "]"}], "&"}], ")"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "legends"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.885491519278527*^9, {3.885517351689567*^9, 3.88551736224787*^9}, {
   3.885518802074421*^9, 3.8855188105031214`*^9}, 3.8855198319881215`*^9, {
   3.885519988582488*^9, 3.8855199895391755`*^9}, {3.8855200303621006`*^9, 
   3.8855200311542788`*^9}, {3.8856789591458263`*^9, 3.885678961879509*^9}, 
   3.885679437884448*^9, {3.8860840227751923`*^9, 3.8860840237202635`*^9}, 
   3.8860840736680617`*^9, {3.888273270915325*^9, 3.888273276331218*^9}, {
   3.894911640706896*^9, 3.8949116538058243`*^9}, 3.894911797007156*^9, {
   3.894912073230709*^9, 3.8949121116579204`*^9}, {3.8949121494519463`*^9, 
   3.8949121542357144`*^9}, {3.894912274012048*^9, 3.8949122972302265`*^9}, {
   3.894913253469407*^9, 3.894913263581702*^9}, {3.8949137564651413`*^9, 
   3.894913756872761*^9}, {3.8949402181388016`*^9, 3.8949402210540886`*^9}, {
   3.8950376386991415`*^9, 3.8950376468508587`*^9}, 3.895037927887331*^9, {
   3.895089634439132*^9, 3.895089647383175*^9}, {3.895172227696951*^9, 
   3.89517222851226*^9}, 3.904416364370385*^9},
 CellLabel->
  "In[318]:=",ExpressionUUID->"0e25a2ad-9317-4cc3-875d-4dc5ecfa74e9"],

Cell["Plot on sphere.", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}, {3.8951052220789804`*^9, 
  3.8951052273421803`*^9}},ExpressionUUID->"17dc6528-2fb0-4376-8231-\
edba26444a44"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyzTP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"30", "Degree"}], ",", 
       RowBox[{"75", "Degree"}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "cpMONO", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "12"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONO", "[", 
      RowBox[{"Tmat_", ",", "contours_", ",", "MaxForScaling_"}], "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{"xyzTP", "/@", 
         RowBox[{
          RowBox[{"cpMONOprelim", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling"}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
     ", 
        RowBox[{
         RowBox[{"cpMONOprelim", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling"}], "]"}],
          "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONO", "[", 
      RowBox[{"Tmat_", ",", "contours_", ",", "MaxForScaling_"}], "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{"xyzTP", "/@", 
         RowBox[{
          RowBox[{"cpMONOprelim", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling"}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
     ", 
        RowBox[{
         RowBox[{"cpMONOprelim", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling"}], "]"}],
          "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.885065026515605*^9, 3.885065075887166*^9}, {
   3.8850651201639624`*^9, 3.8850651605670357`*^9}, {3.885065457633642*^9, 
   3.8850654664634924`*^9}, {3.8850654965373335`*^9, 
   3.8850655019802127`*^9}, {3.885065558894891*^9, 3.88506556492274*^9}, {
   3.8850656149609056`*^9, 3.885065644431052*^9}, {3.885431737816759*^9, 
   3.885431738586269*^9}, {3.88543202051521*^9, 3.8854320372732325`*^9}, {
   3.8854330694119525`*^9, 3.8854330980682106`*^9}, {3.885433158015278*^9, 
   3.8854331731006274`*^9}, {3.8854917102138357`*^9, 
   3.8854917185446835`*^9}, {3.894914897276678*^9, 3.8949149238556747`*^9}, {
   3.8949402245252185`*^9, 3.8949402350506907`*^9}, {3.8950376801934676`*^9, 
   3.89503768355378*^9}, {3.895585298112316*^9, 3.8955853097868013`*^9}, {
   3.895585451889635*^9, 3.895585478307047*^9}, 3.895586926214321*^9, 
   3.8955871198766365`*^9, 3.896274896174975*^9},
 CellLabel->
  "In[320]:=",ExpressionUUID->"5a152657-e571-4183-9edd-072d3b05edcc"],

Cell["For XISO, not MONO.", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}},ExpressionUUID->"dbc9db37-295e-4742-9606-\
efdf03a942c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpXISOprelim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cpXISOprelim", "[", 
    RowBox[{
    "Tmat_", ",", "contours_", ",", "legends_", ",", "MaxForScaling_", ",", 
     "MinForScaling_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cpXISOprelim", "[", 
     RowBox[{
     "Tmat", ",", "contours", ",", "legends", ",", "MaxForScaling", ",", 
      "MinForScaling"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Alpha", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "XISO"}], "]"}], 
       "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Thickness", "[", 
        StyleBox[
         RowBox[{".", 
          StyleBox["0015",
           FontColor->RGBColor[1, 0, 0]]}]], "]"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", "14", "}"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ColorData", "[", "\"\<M10DefaultDensityGradient\>\"", "]"}], "[", 
          FractionBox[
           RowBox[{"#", "-", "MinForScaling"}], 
           RowBox[{"MaxForScaling", "-", "MinForScaling"}]], "]"}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "20"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.885491519278527*^9, {3.885517351689567*^9, 3.88551736224787*^9}, {
   3.885518802074421*^9, 3.8855188105031214`*^9}, 3.8855198319881215`*^9, {
   3.885519988582488*^9, 3.8855199895391755`*^9}, {3.8855200303621006`*^9, 
   3.8855200311542788`*^9}, {3.8856789591458263`*^9, 3.885678961879509*^9}, 
   3.885679437884448*^9, {3.8860840227751923`*^9, 3.8860840237202635`*^9}, 
   3.8860840736680617`*^9, {3.888273270915325*^9, 3.888273276331218*^9}, {
   3.894911640706896*^9, 3.8949116538058243`*^9}, 3.894911797007156*^9, {
   3.894912073230709*^9, 3.8949121116579204`*^9}, {3.8949121494519463`*^9, 
   3.8949121542357144`*^9}, {3.894912274012048*^9, 3.8949122972302265`*^9}, {
   3.894913253469407*^9, 3.894913263581702*^9}, {3.8949137564651413`*^9, 
   3.894913756872761*^9}, {3.8949402181388016`*^9, 3.8949402210540886`*^9}, {
   3.8949756908960943`*^9, 3.894975710495762*^9}, {3.894975802359126*^9, 
   3.894975831930721*^9}, {3.894975964412275*^9, 3.8949759794944077`*^9}, {
   3.8950377407196407`*^9, 3.895037746238251*^9}, {3.895090007454508*^9, 
   3.8950900156056423`*^9}, 3.8951722552009344`*^9, {3.8951724723862267`*^9, 
   3.8951724750999126`*^9}, 3.8951725468114896`*^9, {3.899658942274934*^9, 
   3.899658952545788*^9}, {3.899658992930045*^9, 3.899658995953479*^9}, {
   3.8996590299877863`*^9, 3.899659072129091*^9}, {3.899659179108532*^9, 
   3.8996591858267007`*^9}, {3.8996597245177197`*^9, 3.899659738019331*^9}, {
   3.8996597802588453`*^9, 3.899659790209667*^9}, 3.899682964873596*^9, {
   3.9032022829315395`*^9, 3.9032022889144735`*^9}, {3.903202490033887*^9, 
   3.903202492584711*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"e7f18188-5bb3-41ac-8fc9-93fbc6beb268"],

Cell["Plot on sphere.", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}, {3.8951052220789804`*^9, 
  3.8951052273421803`*^9}},ExpressionUUID->"736c9bac-4701-41b1-b611-\
6c114f4ab501"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyzTP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"30", "Degree"}], ",", 
       RowBox[{"75", "Degree"}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "cpXISO", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "12"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpXISO", "[", 
      RowBox[{
      "Tmat_", ",", "contours_", ",", "MaxForScaling_", ",", 
       "MinForScaling_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{"xyzTP", "/@", 
         RowBox[{
          RowBox[{"cpXISOprelim", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "MinForScaling"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
     ", 
        RowBox[{
         RowBox[{"cpXISOprelim", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "MinForScaling"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpXISO", "[", 
      RowBox[{
      "Tmat_", ",", "contours_", ",", "MaxForScaling_", ",", 
       "MinForScaling_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{"xyzTP", "/@", 
         RowBox[{
          RowBox[{"cpXISOprelim", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "MinForScaling"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
     ", 
        RowBox[{
         RowBox[{"cpXISOprelim", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "MinForScaling"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.885065026515605*^9, 3.885065075887166*^9}, {
   3.8850651201639624`*^9, 3.8850651605670357`*^9}, {3.885065457633642*^9, 
   3.8850654664634924`*^9}, {3.8850654965373335`*^9, 
   3.8850655019802127`*^9}, {3.885065558894891*^9, 3.88506556492274*^9}, {
   3.8850656149609056`*^9, 3.885065644431052*^9}, {3.885431737816759*^9, 
   3.885431738586269*^9}, {3.88543202051521*^9, 3.8854320372732325`*^9}, {
   3.8854330694119525`*^9, 3.8854330980682106`*^9}, {3.885433158015278*^9, 
   3.8854331731006274`*^9}, {3.8854917102138357`*^9, 
   3.8854917185446835`*^9}, {3.8947554623020077`*^9, 
   3.8947554781040397`*^9}, {3.8947567697804146`*^9, 3.894756808659077*^9}, {
   3.8947572600084314`*^9, 3.8947572604314704`*^9}, {3.8947573073670273`*^9, 
   3.894757308068256*^9}, {3.894757341017459*^9, 3.8947573428368936`*^9}, {
   3.8948889083699045`*^9, 3.8948889232785845`*^9}, {3.894975896321293*^9, 
   3.89497592043546*^9}, {3.895037764504057*^9, 3.895037775498732*^9}, {
   3.89558552398689*^9, 3.8955855796939793`*^9}, 3.895586962641261*^9, 
   3.8955870974074078`*^9, 3.8962749116976624`*^9, {3.899660031299085*^9, 
   3.899660036339898*^9}, {3.8996600677947965`*^9, 3.899660090866314*^9}, {
   3.8996601473290887`*^9, 3.899660209489391*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"87cd9b8e-3b31-4396-ac86-0f0763bb2c17"],

Cell["Plot on sphere with center and radius.", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}, {3.8951052220789804`*^9, 3.8951052273421803`*^9}, {
  3.903208875246393*^9, 
  3.9032088831960983`*^9}},ExpressionUUID->"18daad0b-fa7d-46f2-ac79-\
248468b194c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "12"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpXISO", "[", 
      RowBox[{
      "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
       "MaxForScaling_", ",", "MinForScaling_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"center", "+", 
           RowBox[{"BBrad", "\[Times]", 
            RowBox[{"xyzTP", "[", "#", "]"}]}]}], "&"}], "/@", 
         RowBox[{
          RowBox[{"cpXISOprelim", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "MinForScaling"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
                          ", 
        RowBox[{
         RowBox[{"cpXISOprelim", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "MinForScaling"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpXISO", "[", 
      RowBox[{
      "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
       "MaxForScaling_", ",", "MinForScaling_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{"xyzTP", "/@", 
         RowBox[{
          RowBox[{"cpXISOprelim", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "MinForScaling"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
     ", 
        RowBox[{
         RowBox[{"cpXISOprelim", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "MinForScaling"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
    "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9032090031365347`*^9, 3.9032090103964543`*^9}, {
  3.903209096513342*^9, 3.9032091634430532`*^9}, {3.9032091995296583`*^9, 
  3.9032092237594786`*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"c9a9d3cc-f529-47db-adc6-cff5a1db4b5a"],

Cell[CellGroupData[{

Cell["\<\
Probably you will not want to put this into Python, but I will leave it in.
Only hemisphere seen by Eye is plotted. Contour curves and shaded regions are \
separate.\
\>", "Subsection",
 CellChangeTimes->{{3.885961143764316*^9, 3.885961154064952*^9}, {
  3.886002435794151*^9, 3.886002462886235*^9}, {3.9050078004232283`*^9, 
  3.9050078688846526`*^9}, {3.9050080889099207`*^9, 
  3.905008110511459*^9}},ExpressionUUID->"b2a4a426-41c2-4853-9e0e-\
646ac282d674"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotpoints", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.8860028689898715`*^9, 3.8860028760245957`*^9}, {
  3.886034142527599*^9, 3.886034142997729*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"b8a11c1c-6258-414e-adde-a29880743825"],

Cell[CellGroupData[{

Cell["Plot in the plane.  Contour curves only, no shading.", "Subsection",
 CellChangeTimes->{{3.886002493649895*^9, 3.8860025132899227`*^9}, {
  3.886002558281393*^9, 3.8860025610154934`*^9}, {3.8910727403001275`*^9, 
  3.8910727501788845`*^9}, {3.891072834282278*^9, 
  3.891072836967948*^9}},ExpressionUUID->"3891dd18-4580-46a3-b404-\
0af6ad2003e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpMONOprelimContoursOnly", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cpMONOprelimContoursOnly", "[", 
    RowBox[{
    "Tmat_", ",", "contours_", ",", "legends_", ",", "MaxForScaling_", ",", 
     "plotpoints_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cpMONOprelimContoursOnly", "[", 
     RowBox[{
     "Tmat", ",", "contours", ",", "legends", ",", "MaxForScaling", ",", 
      "plotpoints", ",", "eye"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Alpha", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"TPxyz", "[", 
          RowBox[{
           RowBox[{"UswapVandK", "[", 
            RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
           RowBox[{"xyzTP", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}]}], "]"}], ",", 
         "MONO"}], "]"}], "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "plotpoints"}], ",", 
      RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Thickness", "[", ".001", "]"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", "14", "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "legends"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8859562083066835`*^9, 3.88595621172054*^9}, 
   3.8859562566298513`*^9, {3.885956300006212*^9, 3.8859563307018814`*^9}, {
   3.8859563915558505`*^9, 3.885956495633483*^9}, 3.8859565307006783`*^9, {
   3.8859565934356446`*^9, 3.8859566115604954`*^9}, {3.8859573112173414`*^9, 
   3.8859573165730777`*^9}, 3.88595836847047*^9, {3.8859611289367266`*^9, 
   3.885961130274398*^9}, 3.885961292750573*^9, 3.8859622583582277`*^9, {
   3.8859632418821173`*^9, 3.885963242833989*^9}, 3.885963434302593*^9, 
   3.8860840689623466`*^9, {3.894926959925556*^9, 3.894926973311346*^9}, {
   3.8949270705431767`*^9, 3.8949270881257553`*^9}, {3.894940258742958*^9, 
   3.894940262419608*^9}, {3.8950377995495863`*^9, 3.895037808412391*^9}, {
   3.895089705161729*^9, 3.895089711467634*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"d306af56-dff7-411b-89d1-e2857631e2b8"],

Cell[CellGroupData[{

Cell["\<\
Plot on sphere.  Contour curves only, no shading  With center and BBrad. \
\>", "Subsubsection",
 CellChangeTimes->{{3.886358569989128*^9, 3.886358589908553*^9}, {
  3.886626732560613*^9, 3.8866267656880274`*^9}, {3.891072755700938*^9, 
  3.8910727745206475`*^9}, {3.895585873648364*^9, 
  3.895585877759326*^9}},ExpressionUUID->"95b9067b-3e2e-4d3a-9cc2-\
fc4618d3e5d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyzTP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"30", "Degree"}], ",", 
       RowBox[{"75", "Degree"}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "cpMONOcontoursOnly", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "12"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONOcontoursOnly", "[", 
      RowBox[{
      "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
       "MaxForScaling_", ",", "plotpoints_", ",", "eye_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"BBrad", "\[Times]", 
              RowBox[{
               RowBox[{"UswapVandK", "[", 
                RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
               RowBox[{"xyzTP", "[", "#", "]"}]}]}]}], ",", ".005", ",", 
            "eye"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"cpMONOprelimContoursOnly", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "plotpoints", ",", "eye"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{"cpMONOprelimContoursOnly", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "plotpoints", ",", "eye"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONOcontoursOnly", "[", 
      RowBox[{
      "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
       "MaxForScaling_", ",", "plotpoints_", ",", "eye_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"BBrad", "\[Times]", 
              RowBox[{
               RowBox[{"UswapVandK", "[", 
                RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
               RowBox[{"xyzTP", "[", "#", "]"}]}]}]}], ",", ".005", ",", 
            "eye"}], "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"cpMONOprelimContoursOnly", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "plotpoints", ",", "eye"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{"cpMONOprelimContoursOnly", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "plotpoints", ",", "eye"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8866143666249704`*^9, 3.8866143775597053`*^9}, {
   3.8866265941947336`*^9, 3.886626634836912*^9}, {3.8866266723131514`*^9, 
   3.8866266765032053`*^9}, {3.8866273260275145`*^9, 3.886627326560748*^9}, {
   3.8866273586032085`*^9, 3.8866273648520937`*^9}, {3.8866275093428373`*^9, 
   3.8866275128034573`*^9}, {3.8949271651349545`*^9, 
   3.8949272010551476`*^9}, {3.8949402642248755`*^9, 3.894940268696163*^9}, {
   3.8950378160620203`*^9, 3.8950378310606422`*^9}, {3.895585919091553*^9, 
   3.895585954556057*^9}, 3.8955869839236236`*^9, 3.895587038717184*^9, 
   3.89627492382339*^9},
 CellLabel->
  "In[332]:=",ExpressionUUID->"02da9008-818e-490b-bb0f-ebb7608df7e3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot in the plane.  No contour curves, just shading.", "Subsection",
 CellChangeTimes->{{3.886002493649895*^9, 3.8860025132899227`*^9}, {
  3.886002543642397*^9, 3.886002555187973*^9}, {3.89107278698429*^9, 
  3.891072825355384*^9}, {3.891072890203988*^9, 
  3.8910729105547695`*^9}},ExpressionUUID->"b0f9828c-4aaf-4b68-b8db-\
94e955a29dd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpMONOprelimNoContours", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpMONOprelimNoContours", "[", 
   RowBox[{
   "Tmat_", ",", "contours_", ",", "legends_", ",", "MaxForScaling_", ",", 
    "plotpoints_", ",", "eye_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"cpMONOprelimNoContours", "[", 
    RowBox[{
    "Tmat", ",", "contours", ",", "legends", ",", "MaxForScaling", ",", 
     "plotpoints", ",", "eye"}], "]"}], "=", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Alpha", "[", 
       RowBox[{"Tmat", ",", 
        RowBox[{"TPxyz", "[", 
         RowBox[{
          RowBox[{"UswapVandK", "[", 
           RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
          RowBox[{"xyzTP", "[", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}]}], "]"}], ",", 
        "MONO"}], "]"}], "/", "Degree"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "plotpoints"}], ",", 
     RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", "14", "}"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
         FractionBox["#", "MaxForScaling"], "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "legends"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8859583526312027`*^9, 3.8859583557353306`*^9}, {
   3.885958534389454*^9, 3.8859586070447407`*^9}, {3.885959220291354*^9, 
   3.885959223316024*^9}, {3.8859592586854973`*^9, 3.885959265216959*^9}, {
   3.8859604761817617`*^9, 3.885960518228833*^9}, 3.885960602627922*^9, {
   3.885961575587738*^9, 3.88596157686726*^9}, 3.8860840703370757`*^9, {
   3.8866267993875427`*^9, 3.886626831470846*^9}, {3.894927319085534*^9, 
   3.894927330782979*^9}, 3.894927456960102*^9, {3.894940274096534*^9, 
   3.8949402785689745`*^9}, {3.895037836896423*^9, 3.89503784702415*^9}, {
   3.895089784984622*^9, 3.89508979388361*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"96244ccf-853c-4cc7-a47f-3887e41129db"],

Cell[CellGroupData[{

Cell["\<\
Plot on sphere.  No contour curves, just shading.  With center and BBrad. \
\>", "Subsubsection",
 CellChangeTimes->{{3.886358569989128*^9, 3.886358589908553*^9}, {
  3.886626732560613*^9, 3.8866267656880274`*^9}, {3.891072859680832*^9, 
  3.8910728800856123`*^9}, {3.8910729154329967`*^9, 
  3.891072918869138*^9}},ExpressionUUID->"359c8b96-e53a-4997-b284-\
bef9022fa65a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpMONOnoContours", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"$VersionNumber", "<", "12"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
      "MaxForScaling_", ",", "plotpoints_", ",", "eye_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONOnoContours", "[", 
      RowBox[{
      "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
       "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"center", "+", 
           RowBox[{"BBrad", "\[Times]", 
            RowBox[{
             RowBox[{"UswapVandK", "[", 
              RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
             RowBox[{"xyzTP", "[", "#", "]"}]}]}]}], "&"}], "/@", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cpMONOprelimNoContours", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "plotpoints", ",", "eye"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{"cpMONOprelimNoContours", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "plotpoints", ",", "eye"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
      "MaxForScaling_", ",", "plotpoints_", ",", "eye_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONOnoContours", "[", 
      RowBox[{
      "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
       "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"center", "+", 
           RowBox[{"BBrad", "\[Times]", 
            RowBox[{
             RowBox[{"UswapVandK", "[", 
              RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
             RowBox[{"xyzTP", "[", "#", "]"}]}]}]}], "&"}], "/@", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cpMONOprelimNoContours", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "plotpoints", ",", "eye"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{"cpMONOprelimNoContours", "[", 
          RowBox[{
          "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
           "plotpoints", ",", "eye"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
      "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885958750165271*^9, 3.885958826847686*^9}, {
   3.885960046027501*^9, 3.8859600569789133`*^9}, {3.885960376817364*^9, 
   3.8859603894677954`*^9}, {3.8866268405566406`*^9, 3.886626848861638*^9}, {
   3.886629263025786*^9, 3.886629265676588*^9}, {3.88662988804177*^9, 
   3.886629898618249*^9}, {3.894927490910722*^9, 3.8949275864946356`*^9}, 
   3.894927617182643*^9, {3.8949280170380616`*^9, 3.894928039212759*^9}, {
   3.894940279918464*^9, 3.894940284138661*^9}, {3.8949416424997377`*^9, 
   3.894941644145235*^9}, {3.8950378561447616`*^9, 3.895037861956321*^9}, 
   3.895586019111898*^9, {3.8955860506477966`*^9, 3.895586086605731*^9}, {
   3.895587015309971*^9, 3.8955870202730064`*^9}, {3.895952112781618*^9, 
   3.8959521548881807`*^9}, 3.8962749339317417`*^9},
 CellLabel->
  "In[337]:=",ExpressionUUID->"3ca51ad2-abe1-42fd-9d3b-ca2b052b7516"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plot on sphere.  Contour curves only, no shading.  With center and BBrad. \
\>", "Subsubsection",
 CellChangeTimes->{{3.886358569989128*^9, 3.886358589908553*^9}, {
  3.886626732560613*^9, 3.8866267656880274`*^9}, {3.891072755700938*^9, 
  3.8910727745206475`*^9}, {3.8955860019329863`*^9, 
  3.895586004661228*^9}},ExpressionUUID->"10832ed7-ed15-4d83-9fe9-\
c5690e05b4ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyzTP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"30", "Degree"}], ",", 
       RowBox[{"75", "Degree"}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "cpMONOcontoursOnly", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "12"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONOcontoursOnly", "[", 
      RowBox[{
      "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
       "MaxForScaling_", ",", "plotpoints_", ",", "eye_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cpMONOcontoursOnly", "[", 
       RowBox[{
       "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
        "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], "=", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"GraphicsComplex", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MapEyeward", "[", 
            RowBox[{
             RowBox[{"center", "+", 
              RowBox[{"BBrad", "\[Times]", 
               RowBox[{
                RowBox[{"UswapVandK", "[", 
                 RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
                RowBox[{"xyzTP", "[", "#", "]"}]}]}]}], ",", ".005", ",", 
             "eye"}], "]"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"cpMONOprelimContoursOnly", "[", 
            RowBox[{
            "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
             "plotpoints", ",", "eye"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", "   ", 
         RowBox[{
          RowBox[{"cpMONOprelimContoursOnly", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "plotpoints", ",", "eye"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONOcontoursOnly", "[", 
      RowBox[{
      "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
       "MaxForScaling_", ",", "plotpoints_", ",", "eye_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cpMONOcontoursOnly", "[", 
       RowBox[{
       "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
        "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], "=", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"GraphicsComplex", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MapEyeward", "[", 
            RowBox[{
             RowBox[{"center", "+", 
              RowBox[{"BBrad", "\[Times]", 
               RowBox[{
                RowBox[{"UswapVandK", "[", 
                 RowBox[{"unit", "[", "eye", "]"}], "]"}], ".", 
                RowBox[{"xyzTP", "[", "#", "]"}]}]}]}], ",", ".005", ",", 
             "eye"}], "]"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"cpMONOprelimContoursOnly", "[", 
            RowBox[{
            "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
             "plotpoints", ",", "eye"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", "   ", 
         RowBox[{
          RowBox[{"cpMONOprelimContoursOnly", "[", 
           RowBox[{
           "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
            "plotpoints", ",", "eye"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
       "]"}]}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8866143666249704`*^9, 3.8866143775597053`*^9}, {
   3.8866265941947336`*^9, 3.886626634836912*^9}, {3.8866266723131514`*^9, 
   3.8866266765032053`*^9}, {3.8866273260275145`*^9, 3.886627326560748*^9}, {
   3.8866273586032085`*^9, 3.8866273648520937`*^9}, {3.8866275093428373`*^9, 
   3.8866275128034573`*^9}, {3.8949271651349545`*^9, 
   3.8949272010551476`*^9}, {3.8949402642248755`*^9, 3.894940268696163*^9}, {
   3.8950378160620203`*^9, 3.8950378310606422`*^9}, {3.895586111336794*^9, 
   3.895586116437872*^9}, {3.895586211813142*^9, 3.8955862239272814`*^9}, {
   3.8955862721159434`*^9, 3.8955862985890884`*^9}, {3.895587223501709*^9, 
   3.8955872293221636`*^9}, {3.8959518765258055`*^9, 
   3.8959518962436934`*^9}, {3.895951928027789*^9, 3.8959519508062034`*^9}, 
   3.8962749434409323`*^9},
 CellLabel->
  "In[339]:=",ExpressionUUID->"95a6cd28-62e9-486c-bb8d-df746da0f6d4"]
}, Open  ]]
},
WindowToolbars->"RulerBar",
CellGrouping->Manual,
WindowSize->{1138, 724},
WindowMargins->{{Automatic, 49}, {Automatic, 38}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}, {
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
PageHeaderLines->{False, Inherited},
PrintingOptions->{"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{21.5625, 21.5625}, {7.1875, 36}}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowCellLabel->True,
ShowCellTags->False,
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {"ColorPalette" -> {RGBColor, -1}},
RenderingOptions -> {"ObjectDithering" -> True},
RenderingOptions -> {"RasterDithering" -> False},
ExpressionUUID->"4d3c97fe-596a-48a7-a7d7-ed0befcee4dd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 414, 10, 58, "Text",ExpressionUUID->"3817b8f8-e50a-4926-8ab2-f6cf2557c834"],
Cell[962, 32, 1170, 32, 58, "Input",ExpressionUUID->"b4d8257b-284b-4c93-8131-a54c506cfdab"],
Cell[2135, 66, 1138, 23, 94, "Input",ExpressionUUID->"d711d3d1-d7cf-471b-9141-0f84658c4664"],
Cell[3276, 91, 500, 14, 46, "Input",ExpressionUUID->"9085b0a0-c438-4028-bc5d-4925ef5d5345"],
Cell[3779, 107, 948, 21, 119, "Input",ExpressionUUID->"44851fdf-221f-4a7b-9ba6-1cf3499946ea"],
Cell[4730, 130, 1292, 26, 235, "Input",ExpressionUUID->"88df79be-838b-451a-97be-f1356eb5da10"],
Cell[CellGroupData[{
Cell[6047, 160, 354, 7, 105, "Section",ExpressionUUID->"b467ce18-47e3-4a09-b303-4718e38279d4"],
Cell[6404, 169, 2339, 57, 278, "Input",ExpressionUUID->"7fab8f80-722e-46a4-9c38-c31962a6e1ea"],
Cell[8746, 228, 222, 3, 30, "Input",ExpressionUUID->"236123d1-bfc6-4447-8999-cffd7c5bd413"],
Cell[CellGroupData[{
Cell[8993, 235, 216, 4, 45, "Subsubsection",ExpressionUUID->"7e0dc98e-474e-40bc-b804-5416fca6a754"],
Cell[9212, 241, 6695, 177, 869, "Input",ExpressionUUID->"51502003-ee5b-4147-9d4a-fbeeb2653dfb"]
}, Open  ]]
}, Open  ]],
Cell[15934, 422, 160, 3, 67, "Section",ExpressionUUID->"3c7f1f8b-81d6-4bee-a5ec-b0308a2dc161"],
Cell[16097, 427, 1527, 41, 69, "Input",ExpressionUUID->"7172045e-43cd-4cd9-8f52-a59438ab2943"],
Cell[17627, 470, 9077, 286, 387, "Input",ExpressionUUID->"4030df4a-84d4-4a5e-af38-62de4a44eb8f"],
Cell[CellGroupData[{
Cell[26729, 760, 34524, 930, 1704, "Input",ExpressionUUID->"66a280ef-aad7-45d6-8b5f-36eee4baf726",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic],
Cell[61256, 1692, 495, 14, 52, "Input",ExpressionUUID->"ca6d63a4-c27c-46cf-bff5-60f21f23081d"],
Cell[61754, 1708, 349, 7, 45, "Subsubsection",ExpressionUUID->"44175958-b688-48f2-905f-93e778bd9548"],
Cell[62106, 1717, 1904, 54, 90, "Input",ExpressionUUID->"2655155d-1742-4162-9e36-c6180b922779"],
Cell[64013, 1773, 3393, 86, 136, "Input",ExpressionUUID->"80c12e6b-2deb-4903-aa8b-30b2012e5c64"],
Cell[67409, 1861, 241, 6, 45, "Subsubsection",ExpressionUUID->"43c7daae-7c7a-4a27-abec-d5c3ce52c7a9"],
Cell[67653, 1869, 4048, 106, 218, "Input",ExpressionUUID->"de0b5f7f-e736-4fc1-8228-3089283485d3"],
Cell[71704, 1977, 3941, 109, 136, "Input",ExpressionUUID->"733597fd-1ba5-474b-9286-538a100de8a2"],
Cell[75648, 2088, 4637, 114, 199, "Input",ExpressionUUID->"70dce430-050a-4e05-a98c-c397e9a18594"],
Cell[80288, 2204, 1485, 39, 94, "Input",ExpressionUUID->"1df3a6f6-abbe-4db8-9ab4-c032f71f0168"],
Cell[81776, 2245, 396, 13, 30, "SmallText",ExpressionUUID->"e020a74d-ae6d-41a2-a720-3d523d7dc521",
 Evaluatable->False],
Cell[82175, 2260, 1278, 24, 53, "Input",ExpressionUUID->"7751bdd4-3aa5-4604-9684-4829d47aec5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83490, 2289, 278, 4, 54, "Subsection",ExpressionUUID->"71dcbe3a-4967-498d-850a-f3a229b31075"],
Cell[83771, 2295, 369, 7, 58, "Text",ExpressionUUID->"d7ee5dad-6582-4143-8917-cc5fd9a2fd48"],
Cell[84143, 2304, 436, 12, 30, "Input",ExpressionUUID->"8bed3c4d-a98b-4cdf-871b-85c6bc0e027c"],
Cell[84582, 2318, 7543, 178, 409, "Input",ExpressionUUID->"5a8bae42-1da8-4116-9e04-3372558b03d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92162, 2501, 286, 4, 54, "Subsection",ExpressionUUID->"745e7fca-08d9-40c1-9a20-b63fb8a750ae"],
Cell[92451, 2507, 3831, 90, 94, "Input",ExpressionUUID->"4551f1e7-eec6-461c-a4e0-c4aaa742526a"]
}, Open  ]],
Cell[96297, 2600, 205, 3, 67, "Section",ExpressionUUID->"1b128147-da2e-4a38-894f-1e526c764389"],
Cell[CellGroupData[{
Cell[96527, 2607, 597, 9, 37, "Subsubsection",ExpressionUUID->"1a9ccdc1-5f09-49a4-bc14-cee4cd0314f8"],
Cell[97127, 2618, 7664, 219, 371, "Input",ExpressionUUID->"b86605f1-b4a2-4b9c-afac-efe14e2c5c73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104828, 2842, 645, 9, 45, "Subsubsection",ExpressionUUID->"711d2f4f-b902-4860-bd96-e08a4a3b5b29"],
Cell[105476, 2853, 5676, 156, 206, "Input",ExpressionUUID->"3cd01cf2-75d9-43f5-9877-bff98d1d875b"],
Cell[111155, 3011, 248, 5, 30, "Input",ExpressionUUID->"ecc053b9-8584-4c12-8e0b-1ec2ef4e2a84"],
Cell[111406, 3018, 579, 16, 30, "Input",ExpressionUUID->"b4ebb9e0-839b-459d-9daf-32c2a7f33569"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112022, 3039, 700, 10, 45, "Subsubsection",ExpressionUUID->"2cef4f1d-77d8-45ac-ab3f-daa8bd6d8aa4"],
Cell[112725, 3051, 5733, 160, 181, "Input",ExpressionUUID->"fe0a8aed-94e5-439e-a7db-0402b85ab837"],
Cell[118461, 3213, 587, 16, 30, "Input",ExpressionUUID->"1cb0a168-28b7-4f71-acd7-0a70cd323b34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119085, 3234, 611, 9, 67, "Section",ExpressionUUID->"b44b81fd-8c91-4d94-8d4e-568fa1161213"],
Cell[119699, 3245, 292, 6, 30, "Input",ExpressionUUID->"6091c588-60a0-400a-8b10-279617b84d4a"],
Cell[119994, 3253, 8167, 226, 494, "Input",ExpressionUUID->"43567a56-003c-4abb-91fb-35184cf44eef"],
Cell[128164, 3481, 1541, 37, 73, "Input",ExpressionUUID->"2fa51d89-bd88-4116-8147-c241cba48a60"],
Cell[129708, 3520, 859, 22, 61, "Input",ExpressionUUID->"f408ea31-8984-4bfb-b415-013730651fa7"],
Cell[130570, 3544, 1357, 32, 86, "Input",ExpressionUUID->"3ed84df6-78dd-472b-8ffd-2ed3d6f41318"],
Cell[131930, 3578, 806, 18, 52, "Input",ExpressionUUID->"35409d7d-977c-4a90-b569-1554d2b7b1a3"],
Cell[132739, 3598, 251, 5, 30, "Input",ExpressionUUID->"0d99e1e4-4186-4d4e-98fe-6da82082c485"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133027, 3608, 756, 16, 70, "Section",ExpressionUUID->"00ec15e0-5def-4c91-9035-eb4cf1126735"],
Cell[133786, 3626, 1715, 39, 73, "Input",ExpressionUUID->"d8c01912-bc97-4ee2-b918-9b1021693ac1"],
Cell[135504, 3667, 393, 9, 52, "Input",ExpressionUUID->"de9405b0-2022-4786-9984-1e3c67503389"],
Cell[CellGroupData[{
Cell[135922, 3680, 190, 3, 39, "Subsubsection",ExpressionUUID->"dcb3bc63-b395-4b32-a26a-b1db5c803f14"],
Cell[136115, 3685, 3002, 71, 230, "Input",ExpressionUUID->"a2f9ca27-8199-442c-8a19-be502a916d00"],
Cell[139120, 3758, 337, 9, 38, "Input",ExpressionUUID->"8824a290-3918-4294-a684-895b3df1ceac"],
Cell[139460, 3769, 900, 25, 52, "Input",ExpressionUUID->"7d76b291-5bdb-40e4-8562-a92db06af3d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140397, 3799, 243, 4, 39, "Subsubsection",ExpressionUUID->"cb7be0fd-c0a7-4fce-84d7-d4afbcf4e44c"],
Cell[140643, 3805, 552, 16, 30, "Input",ExpressionUUID->"b736b1ae-90e9-41d8-8fd0-c956a2590faf"],
Cell[141198, 3823, 2931, 61, 157, "Input",ExpressionUUID->"33d92b5c-bb0f-4ff1-8f5e-7ce847f787ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144166, 3889, 287, 4, 39, "Subsubsection",ExpressionUUID->"1ce932aa-22da-4b69-8833-382cb1b195d5"],
Cell[144456, 3895, 3010, 63, 157, "Input",ExpressionUUID->"98c37d55-4f2a-424a-bbae-ef80b1095416"]
}, Open  ]]
}, Open  ]],
Cell[147493, 3962, 2592, 52, 94, "Input",ExpressionUUID->"92a78539-c391-49db-a4e3-4164305d788f"],
Cell[150088, 4016, 2735, 56, 94, "Input",ExpressionUUID->"5c9a984c-e4bc-4876-a63a-482f6cd4ed90"],
Cell[152826, 4074, 779, 17, 52, "Input",ExpressionUUID->"e233d384-b285-48c8-9332-643ee88ace45"],
Cell[CellGroupData[{
Cell[153630, 4095, 375, 10, 70, "Section",ExpressionUUID->"e1007a1c-1d78-4f36-bb90-0a7349b73c11"],
Cell[154008, 4107, 322, 6, 30, "Input",ExpressionUUID->"a83e8814-9cc0-4e06-a5c4-9df0a38caa78"],
Cell[154333, 4115, 597, 11, 30, "Input",ExpressionUUID->"269789bd-37d4-4739-8d23-8c5da283b95b"]
}, Open  ]],
Cell[154945, 4129, 5720, 154, 132, "Input",ExpressionUUID->"19ea620f-3ad8-43f0-8a27-ae93bf5a8914"],
Cell[160668, 4285, 1442, 29, 73, "Input",ExpressionUUID->"b2cb6c96-553e-4593-95be-ee8341d575d4"],
Cell[162113, 4316, 314, 6, 30, "Input",ExpressionUUID->"4e3bedd7-b2de-4b97-a13b-aa79ef0476fc"],
Cell[162430, 4324, 1002, 20, 52, "Input",ExpressionUUID->"dda7dcd3-ca26-408e-9efd-afab01f5e362"],
Cell[163435, 4346, 630, 11, 30, "Input",ExpressionUUID->"31ed7463-85b8-497f-bc2b-20bb8123e94e"],
Cell[164068, 4359, 1497, 30, 94, "Input",ExpressionUUID->"2c18e03c-20c4-4a20-9b89-1ab00ad2371e"],
Cell[CellGroupData[{
Cell[165590, 4393, 369, 7, 39, "Subsubsection",ExpressionUUID->"b27c0f34-7dd5-4fc1-9ef2-47b97317a51f"],
Cell[165962, 4402, 1970, 60, 97, "Input",ExpressionUUID->"dc18b592-72e5-4012-9ef6-9317fccd6a16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167969, 4467, 393, 7, 39, "Subsubsection",ExpressionUUID->"8677c3ad-a474-4770-8945-dbb9115271ff"],
Cell[168365, 4476, 2915, 89, 136, "Input",ExpressionUUID->"4f90263f-c847-4729-a119-60be9706fcee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171317, 4570, 598, 10, 67, "Subsubsection",ExpressionUUID->"d779590a-9846-4b75-a558-889ed560dc21"],
Cell[171918, 4582, 1897, 34, 72, "Input",ExpressionUUID->"315b8d79-b546-4bee-b223-24174bab699f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173852, 4621, 548, 11, 67, "Subsubsection",ExpressionUUID->"43afa87f-2f58-4bd5-b699-2bc9a56da1d0"],
Cell[174403, 4634, 1328, 40, 92, "Input",ExpressionUUID->"3554fe32-7c5c-4a15-aa98-b4523facb595"],
Cell[175734, 4676, 1645, 35, 157, "Input",ExpressionUUID->"c528e2db-7ac2-4f13-81a7-cc718404dfcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177416, 4716, 736, 11, 70, "Section",ExpressionUUID->"90a20a87-5ad8-4a0d-bd30-118c996fcd22"],
Cell[178155, 4729, 4000, 111, 172, "Input",ExpressionUUID->"cb7b0ca7-40a3-4b39-b7f1-bad106e6c623"],
Cell[182158, 4842, 222, 5, 39, "Subsubsection",ExpressionUUID->"bc17c575-14ba-49d1-ab99-e8df8268d63a"]
}, Open  ]],
Cell[182395, 4850, 151, 3, 70, "Section",ExpressionUUID->"a64f0cda-e980-42d7-b29e-049a15af9e14"],
Cell[182549, 4855, 381, 10, 26, "SmallText",ExpressionUUID->"d70c9de8-6f2b-492a-a7ae-b5df96c0c668",
 Evaluatable->False],
Cell[182933, 4867, 1964, 52, 94, "Input",ExpressionUUID->"6351b295-8f98-498d-b21c-5088865219c6"],
Cell[184900, 4921, 1678, 42, 100, "Input",ExpressionUUID->"03b8872f-e1bc-47d1-8af9-a4c34ef9253c"],
Cell[186581, 4965, 2691, 65, 157, "Input",ExpressionUUID->"e01b9448-6141-4ce6-b516-55d0cdb1eaee"],
Cell[189275, 5032, 218, 4, 49, "Subsection",ExpressionUUID->"cbb8747a-b196-4752-85b9-222fdb03c8e5"],
Cell[189496, 5038, 175, 3, 41, "Subsection",ExpressionUUID->"aff776e4-01bf-452a-a8f7-86140a13f22d"],
Cell[189674, 5043, 6696, 150, 206, "Input",ExpressionUUID->"6b535fdb-7a26-448f-8445-08d4f0582aae"],
Cell[196373, 5195, 164, 3, 70, "Section",ExpressionUUID->"78e7a415-93b1-4cfb-b0fa-18ad18af2c9e"],
Cell[196540, 5200, 243, 8, 47, "Input",ExpressionUUID->"c8fa405b-bd6e-44d4-8fb9-d775c5aa49be"],
Cell[CellGroupData[{
Cell[196808, 5212, 183, 3, 39, "Subsubsection",ExpressionUUID->"06a63569-c86f-4398-8450-eebfa3af54ab"],
Cell[196994, 5217, 6267, 162, 720, "Input",ExpressionUUID->"3ce187e2-a80c-4464-8bb0-8e09cb1b741b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203298, 5384, 163, 3, 70, "Section",ExpressionUUID->"fa7e0e95-0619-4a17-a107-a60a396055a0"],
Cell[203464, 5389, 1621, 43, 94, "Input",ExpressionUUID->"deaab54f-16c6-469e-8486-1d3d9f332fb2"],
Cell[205088, 5434, 630, 18, 52, "Input",ExpressionUUID->"1aa6a68c-c25b-4f2c-9a6b-ef54de344113"],
Cell[205721, 5454, 3384, 87, 172, "Input",ExpressionUUID->"1ef4e780-fbbd-49a6-bc31-cf5fa260a5f8"],
Cell[209108, 5543, 2878, 90, 112, "Input",ExpressionUUID->"dbf61928-cb93-4080-93f1-c46a7c4b99d7"],
Cell[211989, 5635, 1076, 30, 72, "Input",ExpressionUUID->"63af770b-fd12-46b7-8166-0470fc96da2e"],
Cell[213068, 5667, 1020, 29, 72, "Input",ExpressionUUID->"0229055f-59b8-427d-a2f8-69dd946f8d0b"],
Cell[214091, 5698, 221, 4, 39, "Subsubsection",ExpressionUUID->"e57364f9-866d-49e9-aaf9-5d78878402a9"],
Cell[214315, 5704, 5841, 127, 206, "Input",ExpressionUUID->"971ee5ef-75f5-400a-8e68-0049a92cedde"],
Cell[CellGroupData[{
Cell[220181, 5835, 395, 7, 39, "Subsubsection",ExpressionUUID->"108080df-9716-41c7-8c32-b723814b7a9a"],
Cell[220579, 5844, 4564, 108, 192, "Input",ExpressionUUID->"3bef2430-f3c2-4b53-b304-4cc3281b3bff"]
}, Open  ]],
Cell[225158, 5955, 427, 6, 39, "Subsubsection",ExpressionUUID->"c5e0fde1-3542-4780-80f6-8db8017f44fb"],
Cell[225588, 5963, 1720, 42, 106, "Input",ExpressionUUID->"fa44ca41-2849-446d-ba11-48dd7259726b"],
Cell[227311, 6007, 990, 24, 39, "Subsubsection",ExpressionUUID->"f16fc37b-d82b-426c-b336-555a9ec7ab99"],
Cell[228304, 6033, 2067, 58, 86, "Input",ExpressionUUID->"1095b4d9-2708-4807-a38f-5a16c2eee1ff"],
Cell[230374, 6093, 558, 8, 39, "Subsubsection",ExpressionUUID->"87510547-4631-4b35-afaa-631fd13f6c8f"],
Cell[230935, 6103, 542, 11, 48, "Input",ExpressionUUID->"9488106e-fb20-4ec4-928c-6a5b8d6dfff3"],
Cell[CellGroupData[{
Cell[231502, 6118, 693, 15, 70, "Section",ExpressionUUID->"6c453d3b-e716-4067-9969-76126d16df78"],
Cell[232198, 6135, 1159, 28, 72, "Input",ExpressionUUID->"e70bc9d9-448d-4bab-8893-58fcaf18729f"],
Cell[233360, 6165, 309, 6, 30, "Input",ExpressionUUID->"0c78bbf1-8db2-400b-bf3e-387754cdd8c9"],
Cell[233672, 6173, 929, 21, 52, "Input",ExpressionUUID->"0bb34154-f51c-4c28-83f8-741e777254ef"],
Cell[234604, 6196, 16457, 424, 1089, "Input",ExpressionUUID->"0b9e8228-f224-4c6b-80d9-b60ee3a36aa6"],
Cell[CellGroupData[{
Cell[251086, 6624, 1110, 25, 49, "Subsection",ExpressionUUID->"07bc8e91-0fcd-4cd8-b059-f835fbf74fb9"],
Cell[252199, 6651, 11097, 280, 1126, "Input",ExpressionUUID->"b60cb174-93c3-44de-8f1b-6e76113caeab"],
Cell[CellGroupData[{
Cell[263321, 6935, 500, 16, 39, "Subsubsection",ExpressionUUID->"f97ad746-42f9-4d37-b46e-776fd49c6424"],
Cell[263824, 6953, 2916, 63, 112, "Input",ExpressionUUID->"98f74e60-f8d8-4ed4-9334-3241a45def0a"],
Cell[266743, 7018, 478, 10, 67, "Subsubsection",ExpressionUUID->"5ce66c00-9431-45c7-93b4-da424809f0eb"],
Cell[267224, 7030, 217, 4, 25, "Input",ExpressionUUID->"188217e9-c842-4a16-9512-88d633110dc4"],
Cell[267444, 7036, 7591, 182, 257, "Input",ExpressionUUID->"63080a6a-2c2e-47a0-8031-96d52e32bf9c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[275074, 7223, 232, 4, 31, "Input",ExpressionUUID->"897c26f8-0d83-4f74-af4f-86c3e01a313e"],
Cell[275309, 7229, 9036, 210, 272, "Input",ExpressionUUID->"8b71e12b-b8ed-427d-8891-fc30d71aba89"],
Cell[284348, 7441, 345, 6, 30, "Input",ExpressionUUID->"931fc293-b21a-4d8b-81f1-f1ca31bfd780"],
Cell[284696, 7449, 302, 6, 30, "Input",ExpressionUUID->"4bac9ea1-d93c-47e0-bb6c-f40a05790b49"],
Cell[285001, 7457, 1223, 24, 30, "Input",ExpressionUUID->"af2585f2-da78-4728-aa80-ea08cb5f0040"],
Cell[286227, 7483, 175, 3, 31, "Input",ExpressionUUID->"378a42a0-2d2c-4477-a24a-21e9624a180d"],
Cell[286405, 7488, 1211, 27, 73, "Input",ExpressionUUID->"e5266726-c8e0-4c15-a2a8-ed7176b8da61"],
Cell[CellGroupData[{
Cell[287641, 7519, 475, 9, 67, "Subsubsection",ExpressionUUID->"57ecfdff-8168-4c02-a3d7-0a446ec3c86c"],
Cell[288119, 7530, 4742, 116, 212, "Input",ExpressionUUID->"8be36205-693d-47e3-97fe-1341f4197f82"]
}, Open  ]],
Cell[292876, 7649, 620, 13, 92, "Input",ExpressionUUID->"57d2feb4-eafb-424b-b51a-69ca44efd0c2"],
Cell[293499, 7664, 504, 11, 52, "Input",ExpressionUUID->"b0d974ff-e6ef-4b82-afee-acb3a949d178"],
Cell[CellGroupData[{
Cell[294028, 7679, 615, 14, 39, "Subsubsection",ExpressionUUID->"e2174c1a-e166-4931-810a-7573f8b84968"],
Cell[294646, 7695, 2319, 57, 152, "Input",ExpressionUUID->"e09eb74d-cc42-4d01-b5c0-dc0ea8b1e82b"],
Cell[296968, 7754, 447, 8, 30, "Input",ExpressionUUID->"9aa74ff1-338b-498b-9fdc-8fe2c20f9023"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[297464, 7768, 520, 10, 67, "Subsubsection",ExpressionUUID->"4c91271c-8a79-4eaf-9e57-9fea58124f22"],
Cell[297987, 7780, 259, 5, 31, "Input",ExpressionUUID->"16422a44-5778-4cb9-b1aa-4060b8f45631"],
Cell[298249, 7787, 3152, 61, 112, "Input",ExpressionUUID->"eccd6900-7537-4cfe-a476-d617dc738bb1"],
Cell[301404, 7850, 1807, 39, 112, "Input",ExpressionUUID->"6278a201-30bd-4b0b-a57a-be3f5a654234"]
}, Open  ]],
Cell[303226, 7892, 346, 7, 49, "Subsection",ExpressionUUID->"b06b7a86-100c-4045-b3eb-97057647383f"],
Cell[303575, 7901, 413, 10, 25, "Input",ExpressionUUID->"3f5410e8-d2ce-427a-b601-575760f1e768"],
Cell[CellGroupData[{
Cell[304013, 7915, 361, 6, 49, "Subsection",ExpressionUUID->"f18063b2-9719-4728-9afe-1de09a8ca156"],
Cell[304377, 7923, 636, 14, 31, "Input",ExpressionUUID->"96d20b94-ac35-4da6-ba2e-fe34a2546438"]
}, Open  ]],
Cell[305028, 7940, 212, 4, 39, "Subsubsection",ExpressionUUID->"810ae591-64c5-4be1-acdc-ee2f8d23e644"],
Cell[305243, 7946, 442, 11, 26, "Input",ExpressionUUID->"c79bfb50-95b3-4283-ba92-0e83ae5bdbda"],
Cell[305688, 7959, 881, 22, 57, "Input",ExpressionUUID->"869df752-3ea6-4237-83d4-6120cde64699"],
Cell[306572, 7983, 2980, 79, 201, "Input",ExpressionUUID->"112aaa40-1de0-4b83-aaef-96876da17cdd"],
Cell[CellGroupData[{
Cell[309577, 8066, 272, 6, 111, "Section",ExpressionUUID->"ebb0d7e8-06da-4f73-91e1-46313e748919"],
Cell[309852, 8074, 205, 3, 39, "Subsubsection",ExpressionUUID->"76093659-6523-4e20-bb09-18ae2ebee9bd"]
}, Open  ]],
Cell[310072, 8080, 147, 3, 39, "Subsubsection",ExpressionUUID->"1fd45754-841f-4655-8948-01cc6ae18522"],
Cell[310222, 8085, 275, 6, 25, "Input",ExpressionUUID->"d36be0ff-d3d4-4890-8f88-cdb6a5189d5d"],
Cell[310500, 8093, 2811, 60, 156, "Input",ExpressionUUID->"0e25a2ad-9317-4cc3-875d-4dc5ecfa74e9"],
Cell[313314, 8155, 322, 5, 39, "Subsubsection",ExpressionUUID->"17dc6528-2fb0-4376-8231-edba26444a44"],
Cell[313639, 8162, 3351, 82, 186, "Input",ExpressionUUID->"5a152657-e571-4183-9edd-072d3b05edcc"],
Cell[316993, 8246, 273, 4, 39, "Subsubsection",ExpressionUUID->"dbc9db37-295e-4742-9606-efdf03a942c9"],
Cell[317269, 8252, 3608, 74, 170, "Input",ExpressionUUID->"e7f18188-5bb3-41ac-8fc9-93fbc6beb268"],
Cell[320880, 8328, 322, 5, 39, "Subsubsection",ExpressionUUID->"736c9bac-4701-41b1-b611-6c114f4ab501"],
Cell[321205, 8335, 3866, 89, 186, "Input",ExpressionUUID->"87cd9b8e-3b31-4396-ac86-0f0763bb2c17"],
Cell[325074, 8426, 396, 6, 39, "Subsubsection",ExpressionUUID->"18daad0b-fa7d-46f2-ac79-248468b194c6"],
Cell[325473, 8434, 2695, 69, 166, "Input",ExpressionUUID->"c9a9d3cc-f529-47db-adc6-cff5a1db4b5a"],
Cell[CellGroupData[{
Cell[328193, 8507, 471, 9, 79, "Subsection",ExpressionUUID->"b2a4a426-41c2-4853-9e0e-646ac282d674"],
Cell[328667, 8518, 279, 6, 31, "Input",ExpressionUUID->"b8a11c1c-6258-414e-adde-a29880743825"],
Cell[CellGroupData[{
Cell[328971, 8528, 352, 5, 49, "Subsection",ExpressionUUID->"3891dd18-4580-46a3-b404-0af6ad2003e7"],
Cell[329326, 8535, 2639, 57, 132, "Input",ExpressionUUID->"d306af56-dff7-411b-89d1-e2857631e2b8"],
Cell[CellGroupData[{
Cell[331990, 8596, 380, 7, 39, "Subsubsection",ExpressionUUID->"95b9067b-3e2e-4d3a-9cc2-fc4618d3e5d1"],
Cell[332373, 8605, 4040, 99, 232, "Input",ExpressionUUID->"02da9008-818e-490b-bb0f-ebb7608df7e3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[336462, 8710, 347, 5, 49, "Subsection",ExpressionUUID->"b0f9828c-4aaf-4b68-b8db-94e955a29dd9"],
Cell[336812, 8717, 2559, 57, 166, "Input",ExpressionUUID->"96244ccf-853c-4cc7-a47f-3887e41129db"],
Cell[CellGroupData[{
Cell[339396, 8778, 383, 7, 39, "Subsubsection",ExpressionUUID->"359c8b96-e53a-4997-b284-bef9022fa65a"],
Cell[339782, 8787, 4180, 97, 252, "Input",ExpressionUUID->"3ca51ad2-abe1-42fd-9d3b-ca2b052b7516"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[344023, 8891, 383, 7, 39, "Subsubsection",ExpressionUUID->"10832ed7-ed15-4d83-9fe9-c5690e05b4ca"],
Cell[344409, 8900, 4799, 114, 272, "Input",ExpressionUUID->"95a6cd28-62e9-486c-bb8d-df746da0f6d4"]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    152356,       3658]
NotebookOptionsPosition[    139480,       3464]
NotebookOutlinePosition[    139874,       3480]
CellTagsIndexPosition[    139831,       3477]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
ChristoffelSpheres.nb
run common_funs.nb, common_MTfuns.nb, ChooseTmat.nb\
\>", "Section",
 CellChangeTimes->{{3.9276254615057898`*^9, 
  3.927625469372057*^9}},ExpressionUUID->"59d4d812-4b2e-4186-9442-\
6826736b67df"],

Cell[CellGroupData[{

Cell["user choices", "Section",
 CellChangeTimes->{{3.9276254615057898`*^9, 3.927625469372057*^9}, {
  3.9276601920989237`*^9, 
  3.9276601948199377`*^9}},ExpressionUUID->"764a5bf6-cc27-4365-85e9-\
4479f8c529ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrintFigures", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.927626208034458*^9, 3.927626212297669*^9}, {
  3.927641540015386*^9, 3.927641540569346*^9}, {3.927644869705471*^9, 
  3.927644870093287*^9}, {3.927883339516597*^9, 3.9278833401903353`*^9}, {
  3.9278999091149406`*^9, 3.9278999095439053`*^9}, {3.927906266278652*^9, 
  3.9279062670195913`*^9}, {3.9279101261419287`*^9, 3.9279101267009487`*^9}},
 CellLabel->
  "In[7761]:=",ExpressionUUID->"d9ba5e55-6356-4aad-8bdc-9b9281b28509"],

Cell[CellGroupData[{

Cell["\<\
choose elastic map and density
to find the contours manually, you want to examine the vmin and vmax below\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
  3.927625527728416*^9, 
  3.9276255413255177`*^9}},ExpressionUUID->"cc08436a-72e8-4a48-a4cf-\
d97439428a3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", "=", "TmatBrownAn00"}], ";", 
  RowBox[{"xcontours", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2.8", ",", "8.4", ",", "0.4"}], "]"}]}], ";", 
  RowBox[{"density", "=", "2623"}], ";", 
  RowBox[{"incrementv", "=", "1"}], ";", 
  RowBox[{"isize", "=", "0.3"}], ";", " ", 
  RowBox[{"isizev", "=", "0.3"}], ";", " ", 
  RowBox[{"conminv", "=", "2"}], ";", 
  RowBox[{"conmaxv", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.927572113003128*^9, 3.927572117317361*^9}, 
   3.927625511975512*^9, {3.927626503448579*^9, 3.9276265041827927`*^9}, {
   3.927627534298695*^9, 3.927627534858808*^9}, {3.927628024286652*^9, 
   3.9276280411181707`*^9}, {3.927629535793385*^9, 3.9276295413725843`*^9}, {
   3.9276306088036013`*^9, 3.927630613305378*^9}, 3.927631122599928*^9, {
   3.927631583849873*^9, 3.927631599998171*^9}, 3.927636869118764*^9, {
   3.927637208209831*^9, 3.927637212077043*^9}, {3.927641208266265*^9, 
   3.927641210307341*^9}, {3.92764421092155*^9, 3.927644235670582*^9}, {
   3.92764550979132*^9, 3.927645511637508*^9}, {3.927647463523069*^9, 
   3.927647466203822*^9}, {3.92764839254725*^9, 3.927648394312962*^9}},
 CellLabel->
  "In[7762]:=",ExpressionUUID->"9499a352-0310-4c4d-be3a-e4e0bff24cad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", "=", " ", "TmatIgel"}], ";", 
  RowBox[{"xcontours", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2.5", ",", "11.5", ",", "0.5"}], "]"}]}], ";", 
  RowBox[{"density", "=", "1000"}], ";", 
  RowBox[{"incrementv", "=", "2"}], ";", 
  RowBox[{"isize", "=", "0.3"}], ";", 
  RowBox[{"isizev", "=", "0.2"}], ";", 
  RowBox[{"conminv", "=", "2"}], ";", 
  RowBox[{"conmaxv", "=", "12"}], ";"}]], "Input",
 CellChangeTimes->{{3.927572113003128*^9, 3.927572117317361*^9}, 
   3.927625511975512*^9, {3.927626503448579*^9, 3.9276265041827927`*^9}, {
   3.927627486923215*^9, 3.927627489418063*^9}, {3.927627539219612*^9, 
   3.927627539805564*^9}, {3.927627571279804*^9, 3.9276275718387327`*^9}, {
   3.927628021052342*^9, 3.927628035982787*^9}, {3.927629118671701*^9, 
   3.927629123164963*^9}, 3.9276295291262293`*^9, {3.927630600540083*^9, 
   3.927630601992239*^9}, {3.9276311185741587`*^9, 3.927631121414055*^9}, {
   3.927631582327927*^9, 3.9276315909145327`*^9}, 3.9276368684601727`*^9, {
   3.927644197421163*^9, 3.927644198710836*^9}, {3.927648650922926*^9, 
   3.9276486532126637`*^9}, {3.927883332697176*^9, 3.92788333500838*^9}, 
   3.927982139286798*^9},
 CellLabel->
  "In[7763]:=",ExpressionUUID->"0520d4ed-ced5-4a99-9ccf-19d274c3ee77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat0", "=", "Tmat"}], ";"}]], "Input",
 CellChangeTimes->{{3.927647963110652*^9, 3.9276479652887897`*^9}},
 CellLabel->
  "In[7764]:=",ExpressionUUID->"0cf229da-7154-4bbc-8356-19cebb8ea6fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose a \[CapitalSigma] (XISO, TET, etc)for the reference \
orientation", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
  3.927625527728416*^9, 3.9276255413255177`*^9}, {3.927655474784912*^9, 
  3.9276554990076103`*^9}},ExpressionUUID->"4a0048ff-7f8e-49f7-a365-\
98e2c7028415"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "ORTH"}], ";"}]], "Input",
 CellChangeTimes->{{3.9276526671543493`*^9, 3.927652670555222*^9}, 
   3.9276554656440372`*^9, {3.927657084696368*^9, 3.927657085137282*^9}, {
   3.927659044541614*^9, 3.927659044901167*^9}, {3.927659154102602*^9, 
   3.927659154441086*^9}, {3.92765926360709*^9, 3.927659264068737*^9}, {
   3.927659321906857*^9, 3.927659322296084*^9}, {3.927659388839884*^9, 
   3.927659389244091*^9}, {3.927659520437399*^9, 3.9276595206594753`*^9}, {
   3.927660012064712*^9, 3.927660012538032*^9}, {3.9278994695052443`*^9, 
   3.927899470065146*^9}, {3.9279061697399893`*^9, 3.927906170077796*^9}, {
   3.927906270895905*^9, 3.9279062711198063`*^9}, {3.9279101324667788`*^9, 
   3.927910135123391*^9}, {3.927983782697143*^9, 3.927983783259953*^9}},
 CellLabel->
  "In[7765]:=",ExpressionUUID->"6c0d6afc-c1e6-4de7-b3a1-c6000cd1f24c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat\[CapitalSigma]", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat0", ",", "\[CapitalSigma]"}], "]"}]}], ";", 
  RowBox[{"Uref", "=", 
   RowBox[{"UT", "[", 
    RowBox[{"Tmat0", ",", "\[CapitalSigma]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.927894177508046*^9, 3.927894180337513*^9}},
 CellLabel->
  "In[7766]:=",ExpressionUUID->"aa5acef0-10d5-4c47-bb11-95893ace1a5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["if you want the plots for closest-\[CapitalSigma]-map rather than for \
T", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
   3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
   3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
   3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
   3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
   3.927625527728416*^9, 3.9276255413255177`*^9}, {3.927646076577635*^9, 
   3.9276460804402447`*^9}, {3.927647233034246*^9, 3.927647240509797*^9}, {
   3.927650710452507*^9, 3.9276507110281687`*^9}, 3.9276519539450827`*^9, {
   3.927652018499457*^9, 3.9276520220547323`*^9}, {3.927655503835289*^9, 
   3.927655512002914*^9}, 
   3.9276581186053*^9},ExpressionUUID->"e3be44bf-4e8b-4387-bf47-067c7b658807"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UseSigma", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.927657232847303*^9, 3.927657235664661*^9}, {
  3.927659150155045*^9, 3.927659150692155*^9}, {3.927659266768255*^9, 
  3.927659267225005*^9}, {3.927660015302328*^9, 3.927660015852816*^9}, {
  3.927802272605299*^9, 3.9278022743013697`*^9}, {3.927899905109642*^9, 
  3.9278999065408697`*^9}, {3.9279062624144897`*^9, 3.927906269253174*^9}},
 CellLabel->
  "In[7767]:=",ExpressionUUID->"25224e18-1f10-44f8-90c8-08fd2dc6246e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"UseSigma", ",", 
   RowBox[{
    RowBox[{"Tmat", "=", "Tmat\[CapitalSigma]"}], ";", 
    RowBox[{
     RowBox[{"MatrixNote", "[", "Tmat", "]"}], "=", 
     RowBox[{
      RowBox[{"MatrixNote", "[", "Tmat0", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[CapitalSigma]", "]"}]}]}], ";"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9276507124187317`*^9, 3.9276507179715443`*^9}, {
  3.927650843271389*^9, 3.927650862316845*^9}, {3.927650900441063*^9, 
  3.9276509065383368`*^9}, {3.927651101048053*^9, 3.9276511048418083`*^9}, {
  3.92765161831243*^9, 3.9276516422659807`*^9}, {3.927651712497448*^9, 
  3.927651741731889*^9}, {3.927651843485463*^9, 3.9276518435786257`*^9}, {
  3.927652389784525*^9, 3.927652409251472*^9}, {3.9276526900893106`*^9, 
  3.927652708244609*^9}, {3.927657237286811*^9, 3.9276572548318253`*^9}},
 CellLabel->
  "In[7768]:=",ExpressionUUID->"75a2e835-7c1b-430e-b4e4-ada995e678d0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellChangeTimes->{{3.9276254615057898`*^9, 3.927625469372057*^9}, {
  3.927660183143585*^9, 
  3.92766018574354*^9}},ExpressionUUID->"e4473182-0fc7-44b5-966b-\
848c0f78eca9"],

Cell[CellGroupData[{

Cell["check symmetry of elastic map", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
  3.927625527728416*^9, 3.9276255413255177`*^9}, {3.927646076577635*^9, 
  3.9276460804402447`*^9}},ExpressionUUID->"f1573f09-aae1-4263-a86b-\
72a746014752"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DeriveSymGp", "[", "Tmat", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9273957755126247`*^9, 3.927395783131043*^9}, {
  3.9273958665504932`*^9, 3.9273958670993032`*^9}, {3.9273966576165113`*^9, 
  3.9273966625598392`*^9}, {3.927401376825039*^9, 3.927401393834277*^9}, {
  3.9274015836696672`*^9, 3.92740158593615*^9}, {3.927625653522728*^9, 
  3.9276256540654793`*^9}},
 CellLabel->
  "In[7769]:=",ExpressionUUID->"62724fb3-b6bb-45a8-96c0-7caba147800d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DeriveSymGp", "[", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "XISO"}], "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.927401588974114*^9, 3.927401591300161*^9}, {
  3.927625656976873*^9, 3.927625657559164*^9}},
 CellLabel->
  "In[7770]:=",ExpressionUUID->"d996a1ee-cd80-4aa6-9023-7b56097f2d03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["convert to Voigt", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 
  3.927625520040167*^9}},ExpressionUUID->"964489cb-4ddb-461e-827b-\
1e373d08a457"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cmat", "=", 
   RowBox[{"CmatOfTmat", "[", "Tmat", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.927315210316649*^9, 3.9273152140883837`*^9}, {
   3.927316199428961*^9, 3.927316200922818*^9}, {3.9273163008160133`*^9, 
   3.9273163129079437`*^9}, 3.927395304429574*^9, 3.9273979054286118`*^9, {
   3.9274523147331057`*^9, 3.9274523282699327`*^9}, {3.927571656665818*^9, 
   3.927571676956876*^9}, {3.9275721206192093`*^9, 3.927572125931623*^9}, {
   3.927572275187263*^9, 3.9275722784167128`*^9}, {3.9275736154848623`*^9, 
   3.9275736187637053`*^9}, {3.927573773458354*^9, 3.927573775689727*^9}, {
   3.927574022629644*^9, 3.927574027408889*^9}, 3.927625511020493*^9},
 CellLabel->
  "In[7771]:=",ExpressionUUID->"c69f2d97-094d-4323-8412-6ce582de2fba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["print figures to file", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.927625520040167*^9}, {
  3.927626362690854*^9, 
  3.927626367551813*^9}},ExpressionUUID->"0055b19f-9f3b-41e0-a5ab-\
f5390c048119"],

Cell[BoxData[{
 RowBox[{"MatrixNote", "[", "Tmat", 
  "]"}], "\[IndentingNewLine]", "mdir", "\[IndentingNewLine]", 
 RowBox[{"odir", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"mdir", ",", "\"\<pdf_print\>\""}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"otag", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"odir", ",", 
     RowBox[{"\"\<ChristoffelSpheres_\>\"", "<>", 
      RowBox[{"Tlab", "[", "Tmat", "]"}], "<>", "\"\<_\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.910905503104602*^9, 3.9109055517441063`*^9}, {
  3.9109055854938517`*^9, 3.910905615711937*^9}, {3.910911744107761*^9, 
  3.910911744897134*^9}, {3.912276758251253*^9, 3.9122768067916718`*^9}, {
  3.91310947800861*^9, 3.91310948659916*^9}, {3.9219165176143637`*^9, 
  3.921916518176425*^9}, {3.925605047382234*^9, 3.9256050606854143`*^9}, {
  3.927626375158948*^9, 3.9276263787455797`*^9}},
 CellLabel->
  "In[7772]:=",ExpressionUUID->"cd28920b-f0f1-4678-ac1b-8cec14c0ec5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose color palette for Christoffel spheres ", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.9276449633632507`*^9, 
  3.927644963392454*^9}},ExpressionUUID->"e9451361-ca9d-4da1-af7c-\
62d312663b62"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"DensityPlot", "[", 
           RowBox[{"y", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"ColorFunction", "->", 
             RowBox[{"ColorData", "[", "palette", "]"}]}], ",", 
            RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
            RowBox[{"PlotRangePadding", "->", "0"}], ",", 
            RowBox[{"Frame", "->", "False"}], ",", 
            RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "120"}], ",", 
          RowBox[{"BaselinePosition", "->", "Center"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameTicks", "->", "None"}], ",", 
          RowBox[{"FrameStyle", "->", "Gray"}], ",", 
          RowBox[{"FrameLabel", "->", "palette"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"palette", ",", 
          RowBox[{"ColorData", "[", "\"\<Gradients\>\"", "]"}]}], "}"}]}], 
       "]"}], ",", "4", ",", "4", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"ImageSize", "->", "800"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9275734862866*^9, 3.9275735520279503`*^9}},
 CellLabel->
  "In[7776]:=",ExpressionUUID->"47e6e34d-e9f9-4862-b5b3-e18ddfb8787c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvel", "=", "\"\<Rainbow\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.927572681513842*^9, 3.9275726859415627`*^9}, {
  3.927573554656719*^9, 3.927573555126149*^9}, {3.927573669639818*^9, 
  3.927573670168602*^9}},
 CellLabel->
  "In[7777]:=",ExpressionUUID->"26288248-2838-449d-9ca0-97b0f44f1819"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display output", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625602117004*^9, 
  3.927625603364086*^9}},ExpressionUUID->"5ba5e1c6-59cf-4908-983d-\
145b47c25204"],

Cell[BoxData[
 RowBox[{"PrintVoigt", "[", "Tmat", "]"}]], "Input",
 CellChangeTimes->{{3.927562632757736*^9, 3.927562635868886*^9}, {
   3.927571660565731*^9, 3.927571667363922*^9}, 3.927572107399871*^9},
 CellLabel->
  "In[7778]:=",ExpressionUUID->"9c43b048-b1ce-44fa-ae2f-7615fcf6b541"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display the closest-ISO map", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625602117004*^9, 
  3.927625638387806*^9}},ExpressionUUID->"dcf2479e-0e3e-43dd-8da6-\
54a9612a79b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatISO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "ISO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatISO", "=", 
   RowBox[{"CmatOfTmat", "[", 
    RowBox[{"Closest", "[", 
     RowBox[{"Tmat", ",", "ISO"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "CmatISO", "]"}]}], "Input",
 CellChangeTimes->{{3.927622723519618*^9, 3.92762274231504*^9}, {
  3.927639483177321*^9, 3.9276394831785717`*^9}, {3.927639644346583*^9, 
  3.92763965281987*^9}},
 CellLabel->
  "In[7779]:=",ExpressionUUID->"35f2fc3e-0eec-44bb-93b6-d95891d1a62f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelMatrixTP", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "Cmat_"}], "]"}], ":=", 
   RowBox[{"ChristoffelMatrix", "[", 
    RowBox[{
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], ",", "Cmat"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "Cmat_"}], "]"}], ":=", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"ChristoffelMatrixTP", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.927314693969733*^9, 3.9273147508382587`*^9}, {
  3.9275408780599537`*^9, 3.927540884500498*^9}, {3.9275425916000977`*^9, 
  3.9275425962993402`*^9}, {3.927571704506083*^9, 3.927571705963903*^9}},
 CellLabel->
  "In[7782]:=",ExpressionUUID->"e45f5643-798a-4733-8f32-312bf9cfcbc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesOfChristoffelMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "Cmat_"}], "]"}], ":=", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"ChristoffelMatrix", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cmat"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.927465852430591*^9, 3.9274658747449803`*^9}, {
  3.9274659166588664`*^9, 3.927465928714483*^9}, {3.927490795652926*^9, 
  3.9274908052219763`*^9}, {3.927571706574441*^9, 3.9275717070327263`*^9}},
 CellLabel->
  "In[7784]:=",ExpressionUUID->"9ab8f89b-d4ac-4ac4-9472-c6e16f2a56cb"],

Cell[BoxData[
 RowBox[{"EigenvaluesOfChristoffelMatrix", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "Cmat"}], "]"}]], "Input",
 CellChangeTimes->{{3.927491032414466*^9, 3.9274910384146137`*^9}, 
   3.927571708215535*^9},
 CellLabel->
  "In[7785]:=",ExpressionUUID->"e9d346e7-e9b6-4261-9de8-cb6f07677cfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "velocities for closest ISO, km/s (assumes Cij in GPa and density in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"kg", "/", 
    SuperscriptBox[
     StyleBox["m",
      FontSlant->"Plain"], "3"]}], TraditionalForm]],
  CellChangeTimes->{{3.927451115906128*^9, 3.927451209662067*^9}, {
   3.927451360775897*^9, 3.927451365573579*^9}, {3.9274514750759697`*^9, 
   3.927451475546459*^9}, {3.9274523229562387`*^9, 3.927452322958305*^9}, {
   3.927548224720563*^9, 3.927548225008848*^9}, {3.927557817515873*^9, 
   3.9275578213283587`*^9}, {3.92757171800887*^9, 3.92757171974155*^9}},
  ExpressionUUID->"ff5afeb4-b2b1-4a7e-b36e-84f5677ff80b"],
 ")"
}], "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927641423326644*^9, 
  3.9276414561794777`*^9}},ExpressionUUID->"688cb66b-2a97-43fb-a615-\
13fc7e841112"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VPofTmatISO", "[", 
   RowBox[{"TmatISO_", ",", "density_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Kappa]ofTmatISO", "[", "TmatISO", "]"}], "+", 
        RowBox[{
         FractionBox["4", "3"], 
         RowBox[{"\[Mu]ofTmatISO", "[", "TmatISO", "]"}]}]}], ")"}], 
      SuperscriptBox["10", "9"]}], "density"]], "/", 
   SuperscriptBox["10", "3"]}]}]], "Input",
 CellChangeTimes->{{3.927637424162732*^9, 3.927637430002817*^9}, {
  3.92763928137774*^9, 3.927639293258452*^9}, {3.927639403638598*^9, 
  3.927639418489287*^9}, {3.927641387681588*^9, 3.927641416872486*^9}},
 CellLabel->
  "In[7786]:=",ExpressionUUID->"33b36b06-6ceb-4097-92be-68b4a4a2ce89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VSofTmatISO", "[", 
   RowBox[{"TmatISO_", ",", "density_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"\[Mu]ofTmatISO", "[", "TmatISO", "]"}], 
      SuperscriptBox["10", "9"]}], "density"]], "/", 
   SuperscriptBox["10", "3"]}]}]], "Input",
 CellChangeTimes->{
  3.927637440668151*^9, {3.927639424779504*^9, 3.9276394504029837`*^9}, 
   3.9276414207029057`*^9, 3.927641475786503*^9},
 CellLabel->
  "In[7787]:=",ExpressionUUID->"fb194081-e7ac-4d2c-8945-eb519094d924"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vp0", "=", 
   RowBox[{"VPofTmatISO", "[", 
    RowBox[{"TmatISO", ",", "density"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vs0", "=", 
   RowBox[{"VSofTmatISO", "[", 
    RowBox[{"TmatISO", ",", "density"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stV", "=", 
   RowBox[{"\"\<Vp \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"NumberForm", "[", 
      RowBox[{"vp0", ",", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
    "\"\<, Vs \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"NumberForm", "[", 
      RowBox[{"vs0", ",", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", "2"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"stV", " ", "<>", " ", "\"\< km/s\>\""}]}], "Input",
 CellChangeTimes->{{3.9276394620743113`*^9, 3.927639465070635*^9}, {
  3.927639671924115*^9, 3.927639686703002*^9}, {3.927641502930616*^9, 
  3.927641507453211*^9}, {3.927644408881432*^9, 3.927644425862913*^9}, {
  3.92764468533561*^9, 3.92764468978969*^9}, {3.927644823720747*^9, 
  3.927644861457128*^9}},
 CellLabel->
  "In[7788]:=",ExpressionUUID->"5737d25c-1085-4b32-8f90-f2df91ffc111"]
}, Open  ]],

Cell[CellGroupData[{

Cell["minimum and maximum eigenvalues", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 
  3.9275483689461603`*^9}},ExpressionUUID->"c6209ac5-4aca-46a0-80b4-\
12bb0397e91d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxEigenvalueResult", "=", 
   RowBox[{"Maximize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], "]"}], ",", 
       
       RowBox[{
        RowBox[{"0", "<=", "\[Theta]", "<=", "\[Pi]"}], "&&", 
        RowBox[{"0", "<=", "\[Phi]", "<=", 
         RowBox[{"2", " ", "\[Pi]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minEigenvalueResult", "=", 
   RowBox[{"Minimize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], "]"}], ",", 
       
       RowBox[{
        RowBox[{"0", "<=", "\[Theta]", "<=", "\[Pi]"}], "&&", 
        RowBox[{"0", "<=", "\[Phi]", "<=", 
         RowBox[{"2", " ", "\[Pi]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.927543034875354*^9, 3.9275430781415777`*^9}, {
  3.927543432450995*^9, 3.927543459012227*^9}, {3.9275478732829027`*^9, 
  3.9275478832309103`*^9}, {3.927548112477221*^9, 3.9275481153811817`*^9}, {
  3.927571709661747*^9, 3.9275717098993073`*^9}},
 CellLabel->
  "In[7792]:=",ExpressionUUID->"fee46e49-7817-4bc9-8ac8-4e915f797a09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emax", "=", 
   RowBox[{"maxEigenvalueResult", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"emin", "=", 
   RowBox[{"minEigenvalueResult", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"thetamax", ",", "phimax"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "/.", " ", 
    RowBox[{"maxEigenvalueResult", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"thetamin", ",", "phimin"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "/.", " ", 
    RowBox[{"minEigenvalueResult", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Max eigenvalue is \>\"", ",", "emax", ",", "\"\< for theta = \>\"", 
   ",", 
   RowBox[{"thetamax", " ", "/", "Degree"}], ",", "\"\<, phi = \>\"", ",", 
   RowBox[{"phimax", " ", "/", "Degree"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Min eigenvalue is \>\"", ",", "emin", ",", "\"\< for theta = \>\"", 
   ",", 
   RowBox[{"thetamin", " ", "/", "Degree"}], ",", "\"\<, phi = \>\"", ",", 
   RowBox[{"phimin", " ", "/", "Degree"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
  RowBox[{"thetamax", ",", "phimax", ",", "Cmat"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
  RowBox[{"thetamin", ",", "phimin", ",", "Cmat"}], "]"}]}], "Input",
 CellChangeTimes->{{3.927547895949696*^9, 3.9275481228952217`*^9}, {
  3.927571712039295*^9, 3.927571714813079*^9}},
 CellLabel->
  "In[7794]:=",ExpressionUUID->"1de38f8f-130f-41ef-8182-7310ba777150"]
}, Open  ]],

Cell[CellGroupData[{

Cell["get velocities from eigenvalues of Christoffel matrix", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927630957556481*^9, 
  3.9276309599994307`*^9}},ExpressionUUID->"d2987021-d9ee-46a7-9581-\
019b5d2dc577"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"vels", "[", 
    RowBox[{"eigs_", ",", "density_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eigs", " ", 
        SuperscriptBox["10", "9"]}], ")"}], "/", "density"}]], "/", 
    "1000"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.927315259363559*^9, 3.927315368569132*^9}, {
  3.927315414794742*^9, 3.927315459414472*^9}, {3.927315514127232*^9, 
  3.927315569128357*^9}, {3.9273980956564074`*^9, 3.9273980967115097`*^9}, {
  3.927451464172656*^9, 3.927451477858079*^9}, {3.927452322953746*^9, 
  3.927452322954529*^9}},
 CellLabel->
  "In[7802]:=",ExpressionUUID->"ccd1d429-873e-4ab1-afc6-12810e2440e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   FormBox[
    StyleBox[
     RowBox[{
      RowBox[{"assumes", " ", "Cij", " ", 
       RowBox[{"(", 
        RowBox[{"and", " ", "eigs"}], ")"}], " ", "in", " ", "GPa"}], ",", 
      " ", 
      RowBox[{"density", " ", "in", " ", 
       RowBox[{"kg", "/", 
        SuperscriptBox[
         StyleBox["m",
          FontSlant->"Plain"], "3"]}]}], ",", " ", 
      RowBox[{"vels", " ", "in", " ", 
       RowBox[{"km", "/", "s"}]}]}],
     FontColor->RGBColor[1, 0, 0]],
    TraditionalForm], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"velsTP", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "Cmat_", ",", "density_"}], 
    "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], " ", 
        SuperscriptBox["10", "9"]}], ")"}], "/", "density"}]], "/", "1000", 
    " "}]}]}]], "Input",
 CellChangeTimes->{{3.927451115906128*^9, 3.927451209662067*^9}, {
  3.927451360775897*^9, 3.927451365573579*^9}, {3.9274514750759697`*^9, 
  3.927451475546459*^9}, {3.9274523229562387`*^9, 3.927452322958305*^9}, {
  3.927548224720563*^9, 3.927548225008848*^9}, {3.927557817515873*^9, 
  3.9275578213283587`*^9}, {3.92757171800887*^9, 3.92757171974155*^9}, {
  3.927641461233449*^9, 3.927641465079455*^9}},
 CellLabel->
  "In[7803]:=",ExpressionUUID->"683f1804-9496-4d22-a08d-a54308bc7373"],

Cell[BoxData[{
 RowBox[{"velsTP", "[", 
  RowBox[{"thetamax", ",", "phimax", ",", "Cmat", ",", "density"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"velsTP", "[", 
  RowBox[{"thetamin", ",", "phimin", ",", "Cmat", ",", "density"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vmax", "=", 
  RowBox[{"Max", "[", 
   RowBox[{"velsTP", "[", 
    RowBox[{"thetamax", ",", "phimax", ",", "Cmat", ",", "density"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"vmin", "=", 
  RowBox[{"Min", "[", 
   RowBox[{"velsTP", "[", 
    RowBox[{"thetamin", ",", "phimin", ",", "Cmat", ",", "density"}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.927548339961343*^9, 3.9275483431004477`*^9}, {
  3.927557824382313*^9, 3.927557827658609*^9}, {3.927571720788306*^9, 
  3.927571722072023*^9}},
 CellLabel->
  "In[7804]:=",ExpressionUUID->"727c504c-687f-481c-8406-2c409d2f01ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vels", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "Cmat_", ",", 
    "density_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"EigenvaluesOfChristoffelMatrix", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cmat"}], "]"}], " ", 
       SuperscriptBox["10", "9"]}], ")"}], "/", "density"}]], "/", "1000", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.92755784764541*^9, 3.9275578597320538`*^9}, {
  3.927571722984304*^9, 3.927571727948886*^9}},
 CellLabel->
  "In[7808]:=",ExpressionUUID->"a67b50a3-3dd6-4729-aa23-940cf612345d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test function", "Section",
 CellChangeTimes->{{3.927542409165701*^9, 
  3.927542410572926*^9}},ExpressionUUID->"e0ed86d8-bbfb-478e-8b23-\
980728f368f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"radius", "=", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.9275417146715517`*^9, 3.927541717108988*^9}, 
   3.927563983413767*^9, {3.927574440345656*^9, 3.927574440479261*^9}},
 CellLabel->
  "In[7809]:=",ExpressionUUID->"efb1db04-4be8-4053-9b70-81163b25eea3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FakeEigenvalueFn", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"radius", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{".5", 
       RowBox[{"Cos", "[", 
        RowBox[{"3", " ", 
         RowBox[{"Theta", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"Phi", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}]}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9274665595574694`*^9, 3.927466594180888*^9}, {
  3.927466643485673*^9, 3.9274667263962746`*^9}, {3.927467073961342*^9, 
  3.927467080314502*^9}, {3.92747089696459*^9, 3.927470897703573*^9}, {
  3.9274711723010893`*^9, 3.927471174344078*^9}, {3.927471213716225*^9, 
  3.927471214423504*^9}, {3.9274718679735093`*^9, 3.9274718689795637`*^9}, {
  3.927541719725685*^9, 3.9275417247816896`*^9}},
 CellLabel->
  "In[7810]:=",ExpressionUUID->"0e334b07-23bd-4f58-aee7-dd1bf956ecee"],

Cell[BoxData[
 RowBox[{"FakeEigenvalueFn", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3."}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9274670545340166`*^9, 3.927467055879645*^9}, 
   3.9274681853606586`*^9},
 CellLabel->
  "In[7811]:=",ExpressionUUID->"f3d0dac4-89fe-4f51-be11-d7df780b509e"],

Cell[CellGroupData[{

Cell["Inputs of SpherePolyList are in degrees", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927801631703477*^9, 
  3.9278016509372387`*^9}},ExpressionUUID->"11e35a3e-8668-4513-9748-\
0b3e6aed3f90"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"SpherePolyList", "[", 
   RowBox[{
   "\[Rho]_", ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "\[Phi]1_", ",", 
    "\[Phi]2_", ",", "\[CapitalDelta]\[Theta]_", ",", 
    "\[CapitalDelta]\[Phi]_"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.927540917641247*^9, 3.927540920545684*^9}},
 CellLabel->
  "In[7812]:=",ExpressionUUID->"fdbeaeb2-9591-4912-a9df-6ed0ab0f4957"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define axes for 3D plots", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}},ExpressionUUID->"d6728993-c44e-4aa3-abbd-\
872f10b1eb94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SpherePolyList", "[", 
   RowBox[{
   "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "15.", ",", "15."}], 
   "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FakeEigenvalueFn", "/@", "%"}]}], "Input",
 CellChangeTimes->{{3.9274668775743237`*^9, 3.9274668786491423`*^9}, {
  3.927466922495366*^9, 3.9274669243015847`*^9}, {3.9274671962970715`*^9, 
  3.927467208647416*^9}, {3.9274672622689323`*^9, 3.9274672841845064`*^9}, {
  3.927467319095433*^9, 3.9274673313058405`*^9}, {3.927541138291629*^9, 
  3.927541164466412*^9}, {3.927541196401599*^9, 3.927541198555036*^9}},
 CellLabel->
  "In[7813]:=",ExpressionUUID->"b9784432-d5b4-4238-917d-bffc3aaeaf09"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calling axes will reevaluate based on an updated radius value\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.927628518113895*^9, 
  3.927628536699009*^9}},ExpressionUUID->"f4a5be9a-8718-41e7-90c4-\
a50097b7a8d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lengthAxis", ":=", 
   RowBox[{"2", " ", "radius"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBrad", ":=", "radius"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowScale", ":=", 
    RowBox[{".3", " ", "radius"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Paxes", "[", 
    RowBox[{
    "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
     ",", "BBrad_", ",", "ArrowScale_", ",", "tkns_", ",", "WantArrowColor_", 
     ",", "ArrowColor_"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axes", ":=", 
   RowBox[{"Paxes", "[", 
    RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "lengthAxis", ",", 
     "BBrad", ",", "ArrowScale", ",", ".015", ",", "\"\<TriColor\>\"", ",", 
     "ArrowColor"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9274709669022675`*^9, 3.9274709750680094`*^9}, 
   3.927471127476002*^9, 3.9274712587439165`*^9, {3.9274713457589684`*^9, 
   3.9274713466228313`*^9}, 3.9274714289888268`*^9, {3.9275412430218477`*^9, 
   3.927541280650588*^9}, {3.927541776296599*^9, 3.9275418004557343`*^9}, {
   3.927624461955289*^9, 3.927624473803195*^9}},
 CellLabel->
  "In[7815]:=",ExpressionUUID->"03d87e71-e679-4b86-ab56-becb89fd987c"]
}, Open  ]],

Cell["\<\
The key is that you change the radius  from 1 to FakeEigenvalueFn[{x, y, z}]\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 
  3.9274723722090254`*^9}},ExpressionUUID->"b52ce693-8f0e-44e5-918d-\
10faa6c6b7ab"],

Cell["\<\
Change Opacity if you want. Make SectionRadius = 0 if you do not want section.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275603605941086`*^9, 
  3.927560372049997*^9}, {3.927560973431476*^9, 
  3.9275609964160547`*^9}},ExpressionUUID->"8ac89f76-bd89-4f07-b398-\
8bb7570ca8e2"],

Cell[CellGroupData[{

Cell["\<\
The rotation matrix U specifies the section.
The first and second columns of U give an orthonormal basis for the section \
plane.
For example U = identity gives the xy plane as the section.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275603605941086`*^9, 
  3.927560372049997*^9}, {3.927560973431476*^9, 3.9275609964160547`*^9}, {
  3.927562575370353*^9, 3.927562706752246*^9}, {3.92762855662434*^9, 
  3.927628561151073*^9}},ExpressionUUID->"aa5c798a-d7ed-4148-9b72-\
2b793467723a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Uxy", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "1", "0"},
      {"0", "0", "1"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"Uxz", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "0", 
       RowBox[{"-", "1"}]},
      {"0", "1", "0"}
     }], "\[NoBreak]", ")"}]}], ";", 
  RowBox[{"Uyz", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "1"},
      {"1", "0", "0"},
      {"0", "1", "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Utest", "=", 
   RowBox[{"XRot", "[", 
    RowBox[{"30", "Degree"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927574295806212*^9, 3.927574325824071*^9}, {
  3.927624152036934*^9, 3.927624175781966*^9}, {3.927804152734662*^9, 
  3.927804154343547*^9}},
 CellLabel->
  "In[7819]:=",ExpressionUUID->"310c6695-95cc-4315-b94d-7d634fed4ad8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenvalueSurface", "[", 
   RowBox[{
   "FakeEigenvalueFn_", ",", "U_", ",", "SectionRadius_", ",", "eye_"}], 
   "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Opacity", "[", ".7", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"FakeEigenvalueFn", "[", "#", "]"}], "#"}], "&"}], ",", 
           RowBox[{"SpherePolyList", "[", 
            RowBox[{
            "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5.", ",", 
             "5."}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Polygon", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SectionRadius", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], ")"}]}], "&"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}], ",", 
          RowBox[{".02", "\[Pi]"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ViewPoint", "->", "eye"}], ",", 
    RowBox[{"ImageSize", "->", "250"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9275594881939936`*^9, 3.9275594943196626`*^9}, {
   3.9275595257513275`*^9, 3.9275595697062635`*^9}, {3.9275596035637007`*^9, 
   3.9275596440947123`*^9}, {3.9275596767717934`*^9, 
   3.9275596911294765`*^9}, {3.9275597285043077`*^9, 3.927559831594392*^9}, {
   3.9275599064606457`*^9, 3.9275599424702377`*^9}, {3.927560217191101*^9, 
   3.927560237244731*^9}, 3.9275602712645617`*^9, 3.9275605256900845`*^9, {
   3.9275609063223453`*^9, 3.9275609150078926`*^9}, {3.927561766186644*^9, 
   3.927561795215288*^9}, {3.927562233362937*^9, 3.9275622372883787`*^9}, {
   3.9275639996979713`*^9, 3.9275640016901608`*^9}, {3.9275745548600407`*^9, 
   3.92757455554875*^9}},
 CellLabel->
  "In[7821]:=",ExpressionUUID->"852f68a4-9c40-477f-a316-a279abc81327"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"30", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"30.", "Degree"}], ",", 
        RowBox[{"65.", "Degree"}]}], "}"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SectionRadius", "=", 
    RowBox[{"1.5", " ", "radius"}]}], ";", "\[IndentingNewLine]", "PrintEye", 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Uxy", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Uxz", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Uyz", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Utest", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Utest", ",", "SectionRadius", ",", 
      RowBox[{"30", 
       RowBox[{"Utest", ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9275599656457415`*^9, 3.927559971410331*^9}, {
   3.9275600166795197`*^9, 3.927560017904752*^9}, 3.9275600526273556`*^9, {
   3.9275601188265038`*^9, 3.9275601281437387`*^9}, 3.927560169930709*^9, {
   3.927560386375967*^9, 3.927560498290663*^9}, {3.9275605512643766`*^9, 
   3.927560554956374*^9}, {3.927560658648012*^9, 3.927560693999866*^9}, {
   3.9275607466381736`*^9, 3.927560748788352*^9}, {3.9275609252200947`*^9, 
   3.927560955006311*^9}, {3.927561444021969*^9, 3.9275614457496185`*^9}, 
   3.9275619029796953`*^9, {3.927561960843696*^9, 3.927561993928056*^9}, {
   3.9275620363864994`*^9, 3.927562066376152*^9}, {3.9275622595819674`*^9, 
   3.927562284019062*^9}, {3.927562328972741*^9, 3.9275623578440733`*^9}, {
   3.9275623900481677`*^9, 3.9275623984343567`*^9}, {3.927564030003574*^9, 
   3.92756403028691*^9}, {3.92757432883354*^9, 3.9275743391085367`*^9}, {
   3.927574476561685*^9, 3.9275744775306587`*^9}, {3.927624181244618*^9, 
   3.9276242015170927`*^9}, {3.9276590750984077`*^9, 3.927659077673341*^9}},
 CellLabel->
  "In[7822]:=",ExpressionUUID->"0606c1dc-567d-4615-ab82-16d0b7645912"],

Cell[BoxData[
 RowBox[{
  RowBox[{"section", "[", 
   RowBox[{"FakeEigenvalueFn_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FakeEigenvalueFn", "[", "#", "]"}], "#"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"U", ".", 
            RowBox[{"ZRot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", "\[Pi]"}], ",", 
            RowBox[{".02", "\[Pi]"}]}], "]"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"ViewPoint", "->", 
     RowBox[{"30", 
      RowBox[{"U", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ImageSize", "->", "150"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927561243251502*^9, 3.927561333269188*^9}, {
  3.927561369623223*^9, 3.9275613774911804`*^9}, {3.927574515411446*^9, 
  3.927574516096929*^9}},
 CellLabel->
  "In[7823]:=",ExpressionUUID->"cc97e413-02d5-4fb6-9bc5-729dcac7da16"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Uxy"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Uxz"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Uyz"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", 
      RowBox[{"XRot", "[", 
       RowBox[{"30", "Degree"}], "]"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9275614211163664`*^9, 3.927561469660986*^9, {3.927561540493755*^9, 
   3.92756159441514*^9}, {3.927561638231674*^9, 3.9275616569230237`*^9}, {
   3.9275620889019423`*^9, 3.9275620996168385`*^9}, {3.927574388349403*^9, 
   3.927574407184965*^9}, 3.927644293564529*^9},
 CellLabel->
  "In[7824]:=",ExpressionUUID->"50c76194-58a3-4cb6-abc1-14eb5adffa62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The PolarPlot of rr[\[Theta], U] should give you what you want.  
It will show the plane section determined by U\[CenterDot]{1,0,0} and U\
\[CenterDot]{0,1,0}.   
In the polar plot, U\[CenterDot]{1,0,0} will point to the right and U\
\[CenterDot]{0,1,0} will point up.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9275943404714613`*^9, 3.9275945169951715`*^9}, {
  3.9275946086329956`*^9, 3.9275947342514067`*^9}, {3.927595217289266*^9, 
  3.927595220835821*^9}},ExpressionUUID->"450dcc97-61db-4e31-9c0f-\
124c60bd5119"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rr", "[", 
   RowBox[{"\[Theta]_", ",", "U_", ",", "RadialFn3D_"}], "]"}], ":=", 
  RowBox[{"RadialFn3D", "[", 
   RowBox[{"U", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9276407909668436`*^9, 3.927640817405102*^9}},
 CellLabel->
  "In[7825]:=",ExpressionUUID->"933a3393-d134-4bb8-b2af-cec7d8331ea8"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Uxy", ",", "FakeEigenvalueFn"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Uxz", ",", "FakeEigenvalueFn"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Uyz", ",", "FakeEigenvalueFn"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Utest", ",", "FakeEigenvalueFn"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9275948637555075`*^9, 3.9275948779889092`*^9}, {
   3.927594956212916*^9, 3.927594962871805*^9}, {3.927595002743929*^9, 
   3.9275950269613667`*^9}, {3.9275950723382273`*^9, 3.927595129056366*^9}, {
   3.9275951709052763`*^9, 3.927595186670787*^9}, {3.9276408596834903`*^9, 
   3.927640860908975*^9}, {3.927640914610851*^9, 3.9276409391315503`*^9}, {
   3.927643584140189*^9, 3.927643598988068*^9}, {3.927643633365357*^9, 
   3.92764364195255*^9}, 3.927644285506052*^9},
 CellLabel->
  "In[7826]:=",ExpressionUUID->"6aadee43-67db-449c-b919-08a2583c39d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Real function", "Section",
 CellChangeTimes->{{3.927542409165701*^9, 3.927542410572926*^9}, {
  3.92754250154919*^9, 
  3.9275425020388927`*^9}},ExpressionUUID->"807eca65-8a98-491f-b204-\
40250f5b0b28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.927557920169354*^9, 3.9275579228740664`*^9}},
 CellLabel->
  "In[7827]:=",ExpressionUUID->"d4844678-b2c7-4a71-841e-e614d4156fe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VelFn", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"vels", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cmat", ",", "density"}],
     "]"}], "[", 
   RowBox[{"[", "i", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9274665595574694`*^9, 3.927466594180888*^9}, {
   3.927466643485673*^9, 3.9274667263962746`*^9}, {3.927467073961342*^9, 
   3.927467080314502*^9}, {3.92747089696459*^9, 3.927470897703573*^9}, {
   3.9274711723010893`*^9, 3.927471174344078*^9}, {3.927471213716225*^9, 
   3.927471214423504*^9}, {3.9274718679735093`*^9, 3.9274718689795637`*^9}, {
   3.927541719725685*^9, 3.9275417247816896`*^9}, {3.927557744536252*^9, 
   3.927557758829962*^9}, {3.927557902289937*^9, 3.927557927378057*^9}, {
   3.927558646816268*^9, 3.927558647743783*^9}, 3.927559593110128*^9, 
   3.9275717302823687`*^9},
 CellLabel->
  "In[7828]:=",ExpressionUUID->"33dc579d-8f76-4e16-893b-db37e09207b3"],

Cell[BoxData[
 RowBox[{"VelFn", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3."}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.9274670545340166`*^9, 3.927467055879645*^9}, 
   3.9274681853606586`*^9, {3.927558659213355*^9, 3.927558659301757*^9}, 
   3.9275595940858583`*^9},
 CellLabel->
  "In[7829]:=",ExpressionUUID->"ee1656a5-399e-4536-83c1-d56d72c6a6ae"],

Cell[BoxData[
 RowBox[{"radius", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"vmin", "+", "vmax"}], ")"}], "/", "2"}]}]], "Input",
 CellChangeTimes->{{3.9275579578445053`*^9, 3.927557973496931*^9}, {
  3.9275583924851007`*^9, 3.927558392984747*^9}, {3.927558474851844*^9, 
  3.92755847869106*^9}},
 CellLabel->
  "In[7830]:=",ExpressionUUID->"0f493189-1b9e-4a83-b13b-46c516622873"],

Cell[BoxData[
 RowBox[{"radius", " ", "=", "vmax"}]], "Input",
 CellChangeTimes->{{3.9275598282561693`*^9, 3.927559852939286*^9}},
 CellLabel->
  "In[7831]:=",ExpressionUUID->"802be6d5-0037-43bc-a4ca-98454b39f5e8"],

Cell[CellGroupData[{

Cell["modified functions", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}},ExpressionUUID->"a167cf2d-745c-47df-aa07-\
bc5ad531e144"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VSurface", "[", 
   RowBox[{"i_", ",", "U_", ",", "SectionRadius_", ",", "eye_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Opacity", "[", ".7", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"VelFn", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "#"}], "&"}], ",", 
           RowBox[{"SpherePolyList", "[", 
            RowBox[{
            "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5.", ",", 
             "5."}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Polygon", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SectionRadius", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], ")"}]}], "&"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}], ",", 
          RowBox[{".02", "\[Pi]"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ViewPoint", "->", "eye"}], ",", 
    RowBox[{"ImageSize", "->", "250"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9275594881939936`*^9, 3.9275594943196626`*^9}, {
   3.9275595257513275`*^9, 3.9275595697062635`*^9}, {3.9275596035637007`*^9, 
   3.9275596440947123`*^9}, {3.9275596767717934`*^9, 
   3.9275596911294765`*^9}, {3.9275597285043077`*^9, 3.927559831594392*^9}, {
   3.9275599064606457`*^9, 3.9275599424702377`*^9}, {3.927560217191101*^9, 
   3.927560237244731*^9}, 3.9275602712645617`*^9, 3.9275605256900845`*^9, {
   3.9275609063223453`*^9, 3.9275609150078926`*^9}, {3.927561766186644*^9, 
   3.927561795215288*^9}, {3.927562233362937*^9, 3.9275622372883787`*^9}, {
   3.9275639996979713`*^9, 3.9275640016901608`*^9}, {3.9275745548600407`*^9, 
   3.92757455554875*^9}, {3.9275747412182827`*^9, 3.927574772869199*^9}, {
   3.927574854013932*^9, 3.927574854136785*^9}},
 CellLabel->
  "In[7832]:=",ExpressionUUID->"39b08907-04ff-4b11-9432-f19fa6ebc4a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vsection", "[", 
   RowBox[{"i_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"VelFn", "[", 
           RowBox[{"#", ",", "i"}], "]"}], "#"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"U", ".", 
            RowBox[{"ZRot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", "\[Pi]"}], ",", 
            RowBox[{".02", "\[Pi]"}]}], "]"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"ViewPoint", "->", 
     RowBox[{"30", 
      RowBox[{"U", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ImageSize", "->", "150"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927561243251502*^9, 3.927561333269188*^9}, {
  3.927561369623223*^9, 3.9275613774911804`*^9}, {3.927574515411446*^9, 
  3.927574516096929*^9}, {3.927574840230344*^9, 3.927574852804738*^9}},
 CellLabel->
  "In[7833]:=",ExpressionUUID->"d879d268-f6b2-4cac-87e1-7f1d2b6d6dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vrr", "[", 
   RowBox[{"\[Theta]_", ",", "U_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"VelFn", "[", 
   RowBox[{
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ",", "i"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9275942293228683`*^9, 3.9275943300842977`*^9}, {
   3.927624532309643*^9, 3.927624575039484*^9}, 3.927972095632757*^9, {
   3.927982403965835*^9, 3.9279824062712927`*^9}},
 CellLabel->
  "In[7834]:=",ExpressionUUID->"1e9ab51d-4f87-4896-835b-7cb46cca2804"]
}, Open  ]],

Cell[CellGroupData[{

Cell["example", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.92757498178586*^9}},ExpressionUUID->"0e9da3bb-694d-458f-898a-\
45e3788adb61"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"30", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"30.", "Degree"}], ",", 
        RowBox[{"65.", "Degree"}]}], "}"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SectionRadius", "=", 
    RowBox[{"1.5", " ", "radius"}]}], ";", "\[IndentingNewLine]", "PrintEye", 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", "Uxy", ",", "SectionRadius", ",", "eye"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", "Uxz", ",", "SectionRadius", ",", "eye"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", "Uyz", ",", "SectionRadius", ",", "eye"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", 
      RowBox[{"XRot", "[", 
       RowBox[{"30", "Degree"}], "]"}], ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", 
      RowBox[{"XRot", "[", 
       RowBox[{"30", "Degree"}], "]"}], ",", "SectionRadius", ",", 
      RowBox[{"30", 
       RowBox[{
        RowBox[{"XRot", "[", 
         RowBox[{"30", "Degree"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9275599656457415`*^9, 3.927559971410331*^9}, {
   3.9275600166795197`*^9, 3.927560017904752*^9}, 3.9275600526273556`*^9, {
   3.9275601188265038`*^9, 3.9275601281437387`*^9}, 3.927560169930709*^9, {
   3.927560386375967*^9, 3.927560498290663*^9}, {3.9275605512643766`*^9, 
   3.927560554956374*^9}, {3.927560658648012*^9, 3.927560693999866*^9}, {
   3.9275607466381736`*^9, 3.927560748788352*^9}, {3.9275609252200947`*^9, 
   3.927560955006311*^9}, {3.927561444021969*^9, 3.9275614457496185`*^9}, 
   3.9275619029796953`*^9, {3.927561960843696*^9, 3.927561993928056*^9}, {
   3.9275620363864994`*^9, 3.927562066376152*^9}, {3.9275622595819674`*^9, 
   3.927562284019062*^9}, {3.927562328972741*^9, 3.9275623578440733`*^9}, {
   3.9275623900481677`*^9, 3.9275623984343567`*^9}, {3.927564030003574*^9, 
   3.92756403028691*^9}, {3.92757432883354*^9, 3.9275743391085367`*^9}, {
   3.927574476561685*^9, 3.9275744775306587`*^9}, {3.927574887198574*^9, 
   3.9275749196227407`*^9}, {3.9276590857574987`*^9, 3.927659088558792*^9}},
 CellLabel->
  "In[7835]:=",ExpressionUUID->"b4b66255-f0dc-485a-b308-b20b0c366449"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vsecrow", "[", "i_", "]"}], ":=", 
  RowBox[{"GraphicsRow", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Vsection", "[", 
      RowBox[{"i", ",", "Uxy"}], "]"}], ",", 
     RowBox[{"Vsection", "[", 
      RowBox[{"i", ",", "Uxz"}], "]"}], ",", 
     RowBox[{"Vsection", "[", 
      RowBox[{"i", ",", "Uyz"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Vsecrow", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vsecrow", "[", "2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vsecrow", "[", "3", "]"}]}], "Input",
 CellChangeTimes->{
  3.9275614211163664`*^9, 3.927561469660986*^9, {3.927561540493755*^9, 
   3.92756159441514*^9}, {3.927561638231674*^9, 3.9275616569230237`*^9}, {
   3.9275620889019423`*^9, 3.9275620996168385`*^9}, {3.927574388349403*^9, 
   3.927574407184965*^9}, {3.927574868234214*^9, 3.927574870793655*^9}, {
   3.927574922898066*^9, 3.9275749263405247`*^9}, {3.92757499745505*^9, 
   3.927575067216784*^9}, {3.927575124422624*^9, 3.927575140728879*^9}, {
   3.927624768605688*^9, 3.9276248068421907`*^9}, {3.9276443162112417`*^9, 
   3.927644321780064*^9}},
 CellLabel->
  "In[7836]:=",ExpressionUUID->"0285ce90-a614-4ab8-992c-c7bdfee88214"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vrrrow", "[", "i_", "]"}], ":=", 
  RowBox[{"GraphicsRow", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Vrr", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Vrr", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Vrr", "[", 
        RowBox[{"\[Theta]", ",", "Uyz", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "150"}]}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Vrrrow", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vrrrow", "[", "2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vrrrow", "[", "3", "]"}]}], "Input",
 CellChangeTimes->{{3.9275948637555075`*^9, 3.9275948779889092`*^9}, {
  3.927594956212916*^9, 3.927594962871805*^9}, {3.927595002743929*^9, 
  3.9275950269613667`*^9}, {3.9275950723382273`*^9, 3.927595129056366*^9}, {
  3.9275951709052763`*^9, 3.927595186670787*^9}, {3.927624239788411*^9, 
  3.9276243033934107`*^9}, {3.927624585721673*^9, 3.9276246216449747`*^9}, {
  3.9276246769921217`*^9, 3.927624728838072*^9}, {3.927624827323246*^9, 
  3.9276248454930058`*^9}, {3.9276443302951117`*^9, 3.9276443398274603`*^9}},
 CellLabel->
  "In[7840]:=",ExpressionUUID->"3540817a-39da-497a-b52e-4f2233a4b169"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity sphere plots", "Section",
 CellChangeTimes->{{3.927542409165701*^9, 3.927542410572926*^9}, {
  3.92754250154919*^9, 3.9275425020388927`*^9}, {3.927559458119361*^9, 
  3.92755946441405*^9}},ExpressionUUID->"d77d6a3b-305f-4e8c-bfc0-\
e65ef9e31158"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"xMaxForScaling", "=", 
     RowBox[{"xcontours", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"xMinForScaling", "=", 
     RowBox[{"xcontours", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"plotpoints", "=", "Automatic"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contourstyle", "=", "Automatic"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.927367522886832*^9, 3.9273675258254633`*^9}, {
   3.927367575052473*^9, 3.92736758365965*^9}, {3.927367682841346*^9, 
   3.92736770409767*^9}, {3.927368499806727*^9, 3.927368499978237*^9}, {
   3.927380274957151*^9, 3.927380284819965*^9}, 3.9273953015486393`*^9, 
   3.927451303464744*^9, {3.9276229472605667`*^9, 3.927622952295282*^9}, {
   3.927623937964037*^9, 3.9276239402993593`*^9}},
 CellLabel->
  "In[7844]:=",ExpressionUUID->"cbb2c81d-76d0-4526-8d31-831b40f9713b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"velsTP", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat", ",", "density"}], "]"}], 
    "[", 
    RowBox[{"[", "i", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.927367969021694*^9, 3.927367983723044*^9}, {
   3.927395209773459*^9, 3.9273952143721313`*^9}, {3.9274513833296223`*^9, 
   3.927451389933258*^9}, 3.927452322960244*^9, {3.927559473798356*^9, 
   3.927559474221919*^9}, 3.927571731949768*^9},
 CellLabel->
  "In[7846]:=",ExpressionUUID->"b79c955e-e278-4c67-86b8-c5fb8a865ec3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "vplotPrelim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat_", ",", "i_", ",", "density_", ",", "contours_", ",", "legends_", 
    ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vplotPrelim", "[", 
    RowBox[{
    "Cmat", ",", "i", ",", "density", ",", "contours", ",", "legends", ",", 
     "plotpoints", ",", "contourstyle"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"velsTP", "[", 
       RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat", ",", "density"}], 
       "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
     RowBox[{"ContourStyle", "->", "contourstyle"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", "14", "}"}]}], ",", 
     RowBox[{"PlotPoints", "->", "plotpoints"}], ",", 
     RowBox[{
      StyleBox["ColorFunction",
       FontColor->GrayLevel[0]], 
      StyleBox["\[Rule]",
       FontColor->GrayLevel[0]], 
      RowBox[{
       StyleBox["(",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox[
         RowBox[{
          RowBox[{"ColorData", "[", "cvel", "]"}], "[", 
          FractionBox[
           RowBox[{"#", "-", 
            RowBox[{"contours", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], 
           RowBox[{
            RowBox[{"contours", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], "-", 
            RowBox[{"contours", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]], "]"}],
         FontColor->GrayLevel[0]], "&"}], ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "legends"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.927315691361083*^9, 3.927315728289136*^9}, {
   3.927315925030892*^9, 3.927315925281826*^9}, {3.9273159622416077`*^9, 
   3.92731596806857*^9}, {3.927315999695875*^9, 3.92731605088229*^9}, 
   3.927365911386437*^9, {3.927365956897806*^9, 3.927365988059713*^9}, {
   3.927367371730195*^9, 3.927367389349262*^9}, {3.927367446213491*^9, 
   3.927367453412827*^9}, 3.9273675681605253`*^9, {3.9273676249357643`*^9, 
   3.927367660576573*^9}, {3.9273677668961363`*^9, 3.927367769253557*^9}, {
   3.927451425400581*^9, 3.927451432941256*^9}, {3.927452322989324*^9, 
   3.927452322991699*^9}, 3.927559491385592*^9, 3.9275717560420427`*^9, {
   3.927572139987838*^9, 3.927572140613476*^9}, {3.927572548099042*^9, 
   3.9275725801216993`*^9}, {3.927572654031157*^9, 3.927572654957838*^9}, {
   3.9275726998047113`*^9, 3.9275727002981873`*^9}, 3.927622968015029*^9, {
   3.927623838766149*^9, 3.9276238639428596`*^9}},
 CellLabel->
  "In[7848]:=",ExpressionUUID->"da296015-38fb-48ab-bef0-5c4a8cf7533d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat", ",", "1", ",", "density", ",", "xcontours", ",", "Automatic", ",", 
    "plotpoints", ",", "contourstyle"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927315973270911*^9, 3.927315974131159*^9}, {
   3.9273659205887537`*^9, 3.927365924944152*^9}, 3.927368094478785*^9, {
   3.9273685179144917`*^9, 3.927368521069813*^9}, 3.927380297232993*^9, 
   3.927380349158372*^9, 3.927452322992836*^9, 3.927572146257142*^9, {
   3.927623871785157*^9, 3.9276238721795273`*^9}, 3.9276590992056303`*^9},
 CellLabel->
  "In[7850]:=",ExpressionUUID->"2c098fba-0c32-4925-b4ed-e62604c80c05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat", ",", "2", ",", "density", ",", "xcontours", ",", "Automatic", ",", 
    "plotpoints", ",", "contourstyle"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927315973270911*^9, 3.927315974131159*^9}, {
   3.9273659205887537`*^9, 3.927365924944152*^9}, {3.927368094478785*^9, 
   3.927368108381384*^9}, 3.9273685242995443`*^9, 3.927380302578711*^9, 
   3.927380350210107*^9, 3.9274523230155*^9, 3.927572147182898*^9, {
   3.927623878502592*^9, 3.927623878723196*^9}, 3.927659100408877*^9},
 CellLabel->
  "In[7851]:=",ExpressionUUID->"49721c73-86c5-47f4-9636-1370b6ae9654"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat", ",", "3", ",", "density", ",", "xcontours", ",", "Automatic", ",", 
    "plotpoints", ",", "contourstyle"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927315973270911*^9, 3.927315974131159*^9}, {
   3.9273659205887537`*^9, 3.927365924944152*^9}, {3.927368094478785*^9, 
   3.927368109938775*^9}, 3.927368525505056*^9, 3.927380305669957*^9, 
   3.927380351416151*^9, 3.927452323052836*^9, 3.927572148056055*^9, {
   3.927623884455217*^9, 3.927623884617757*^9}, 3.927659101569631*^9},
 CellLabel->
  "In[7852]:=",ExpressionUUID->"9f5ee7c2-69be-4451-b011-91aebdbb27e0"],

Cell[CellGroupData[{

Cell["adapt functions for plotting on the sphere", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 
  3.9276570172255573`*^9}},ExpressionUUID->"7dda8604-a195-4310-a1a7-\
e355c25980c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vplot", "[", 
    RowBox[{
    "center_", ",", "BBrad_", ",", "Cmat_", ",", "i_", ",", "density_", ",", 
     "contours_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vplot", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Cmat", ",", "i", ",", "density", ",", 
      "contours", ",", "plotpoints", ",", "contourstyle"}], "]"}], "=", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"center", "+", 
          RowBox[{"BBrad", "\[Times]", 
           RowBox[{"xyzTP", "[", "#", "]"}]}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"vplotPrelim", "[", 
          RowBox[{
          "Cmat", ",", "i", ",", "density", ",", "contours", ",", "None", ",",
            "plotpoints", ",", "contourstyle"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", 
       StyleBox[
        RowBox[{
         RowBox[{"vplotPrelim", "[", 
          RowBox[{
          "Cmat", ",", "i", ",", "density", ",", "contours", ",", "None", ",",
            "plotpoints", ",", "contourstyle"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}],
        FontColor->GrayLevel[0]]}], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9032090031365347`*^9, 3.9032090103964543`*^9}, {
   3.903209096513342*^9, 3.9032091634430532`*^9}, {3.9032091995296583`*^9, 
   3.9032092237594786`*^9}, {3.909350177490202*^9, 3.9093502594197197`*^9}, {
   3.9093506370401707`*^9, 3.909350647150671*^9}, {3.9093510886184034`*^9, 
   3.909351108646296*^9}, 3.910367598851852*^9, {3.9146000808203325`*^9, 
   3.914600102333006*^9}, {3.9146778901695733`*^9, 3.914677904035157*^9}, {
   3.914678019416276*^9, 3.914678024392654*^9}, {3.9146781025947514`*^9, 
   3.914678116980199*^9}, 3.9175234474471207`*^9, {3.927366227891131*^9, 
   3.9273662300094547`*^9}, {3.927366399729495*^9, 3.9273664042635593`*^9}, {
   3.9273665991460648`*^9, 3.927366601370543*^9}, {3.927366662910788*^9, 
   3.927366663852827*^9}, {3.9273673162767267`*^9, 3.9273673312644672`*^9}, {
   3.92736820998771*^9, 3.927368213962866*^9}, {3.927451001425161*^9, 
   3.927451022424244*^9}, {3.927452323075506*^9, 3.92745232307834*^9}, {
   3.927572150447754*^9, 3.927572153107648*^9}, {3.927623902993384*^9, 
   3.9276239099008827`*^9}},
 CellLabel->
  "In[7853]:=",ExpressionUUID->"c3d7a5b9-3d63-4f3a-b0a4-55ff23d41cee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["copy settings from ChooseTmat.nb", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 3.9276570172255573`*^9}, {
  3.927884191101515*^9, 
  3.927884204812789*^9}},ExpressionUUID->"7a0fe26e-6f27-4a90-b426-\
c811f397a2b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lengthAxis", "=", "1.35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBrad", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", "0.17"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tkns", "=", "0.009"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PaxesForLatticeU", "[", "U_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Paxes", "[", 
      RowBox[{"True", ",", "True", ",", "True", ",", "U", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "lengthAxis", ",", 
       "BBrad", ",", "ArrowScale", ",", "tkns", ",", "\"\<TriColor\>\"", ",", 
       "ArrowColor"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "ptsz", "]"}], ",", 
       RowBox[{"Point", "/@", "extrapts"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.909177484061034*^9, 3.909177500790882*^9}, 
   3.9091775644071817`*^9, 3.9104514437104053`*^9, {3.921832557771254*^9, 
   3.921832601569133*^9}, {3.921832645308414*^9, 3.9218326616966677`*^9}, {
   3.9218328857478333`*^9, 3.921832889239122*^9}, {3.9218332169791327`*^9, 
   3.921833217051731*^9}, {3.921833542661806*^9, 3.921833553360471*^9}, {
   3.921860796014703*^9, 3.92186080913286*^9}, {3.921860853124206*^9, 
   3.921860859309367*^9}, {3.921861163166931*^9, 3.921861169115209*^9}, {
   3.921877738417543*^9, 3.9218777573423*^9}, {3.927884013592099*^9, 
   3.927884019259376*^9}, {3.927884178902499*^9, 3.9278841794390793`*^9}},
 CellLabel->
  "In[7854]:=",ExpressionUUID->"16ccfda4-e113-47af-9141-0eef296fe7ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["example", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 
  3.927657028007598*^9}},ExpressionUUID->"3863d0e9-c72a-4a8b-9478-\
8e2fd361f2c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"center", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBrad", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eye", "=", "eye0"}], "\[IndentingNewLine]", "options"}], "Input",
 CellChangeTimes->{{3.9273954904630327`*^9, 3.927395494327601*^9}, {
  3.92745844178469*^9, 3.92745846327456*^9}, {3.927559518563994*^9, 
  3.927559525424268*^9}},
 CellLabel->
  "In[7859]:=",ExpressionUUID->"97adc7fb-9b48-48e6-ba8b-ad33274acf30"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"optionsX", "[", 
     RowBox[{"eye_", ",", "vert_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
      RowBox[{"ViewVertical", "->", "vert"}], ",", 
      RowBox[{"Lighting", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}], ",", 
      RowBox[{"Boxed", "->", "False"}]}], "}"}]}], ";"}],
  FontColor->GrayLevel[0]]], "Input",
 CellChangeTimes->{{3.911574792865921*^9, 3.911574796765184*^9}, {
   3.92781020192339*^9, 3.927810220697261*^9}, {3.927810315794078*^9, 
   3.92781033687071*^9}, 3.927810579157205*^9, {3.9278542624925117`*^9, 
   3.9278542648871*^9}},
 CellLabel->
  "In[7863]:=",ExpressionUUID->"5e18f3bb-ba11-41f7-9706-907ffafd9fa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pMONO", "[", 
   RowBox[{"eye_", ",", "vert_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cpMONO", "[", 
       RowBox[{
        StyleBox["Tmat",
         FontColor->RGBColor[1, 0, 0]], ",", 
        RowBox[{"contours", "[", 
         RowBox[{
          StyleBox["Tmat0",
           FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", 
        RowBox[{"MaxForScaling", "[", 
         RowBox[{
          StyleBox["Tmat0",
           FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", 
        "plotpoints", ",", "contourstyle"}], "]"}], ",", 
      RowBox[{"Graphics3D", "[", "PaxesForLattice", "]"}], ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"PaxesForLatticeU", "[", "Uref", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"optionsX", "[", 
     RowBox[{"eye", ",", "vert"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9273965506935043`*^9, 3.927396568041696*^9}, {
  3.92739662233893*^9, 3.9273966294710083`*^9}, {3.9274585453722687`*^9, 
  3.927458546576132*^9}, {3.9275742437908993`*^9, 3.927574243933247*^9}, {
  3.927648115067338*^9, 3.927648152583056*^9}, {3.927883610847308*^9, 
  3.927883632804343*^9}, {3.927884068125127*^9, 3.927884112532792*^9}},
 CellLabel->
  "In[7864]:=",ExpressionUUID->"3a72c6de-a709-43fa-98fc-3bc0281e83cb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"pMONO", "[", 
   RowBox[{"eye0", ",", "Automatic"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.927853691302288*^9, 3.927853691871655*^9}, {
  3.927883639073812*^9, 3.927883645713174*^9}, {3.92789836924467*^9, 
  3.9278983725048513`*^9}},
 CellLabel->
  "In[7865]:=",ExpressionUUID->"3510b882-5ef4-4f3a-90d9-cfcd60bad075"],

Cell[BoxData[
 RowBox[{"Clear", "[", "px", "]"}]], "Input",
 CellChangeTimes->{{3.9278536016793327`*^9, 3.9278536036013203`*^9}},
 CellLabel->
  "In[7866]:=",ExpressionUUID->"af5733e0-8bad-4272-9351-fdf60021fbb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"px", "[", 
   RowBox[{"i_", ",", "eye_", ",", "vert_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vplot", "[", 
       RowBox[{
       "center", ",", "BBrad", ",", "Cmat", ",", "i", ",", "density", ",", 
        "xcontours", ",", "plotpoints", ",", "contourstyle"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", "PaxesForLattice", "]"}], ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"PaxesForLatticeU", "[", "Uref", "]"}], "]"}]}], "}"}], ",", 
    StyleBox[
     RowBox[{"optionsX", "[", 
      RowBox[{"eye", ",", "vert"}], "]"}],
     FontColor->GrayLevel[0]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927367149838009*^9, 3.9273671617460957`*^9}, {
   3.927368161963064*^9, 3.927368172011846*^9}, {3.9273682843079576`*^9, 
   3.927368288600971*^9}, {3.927368324118795*^9, 3.927368337987288*^9}, {
   3.927374383416897*^9, 3.9273743940620537`*^9}, {3.927377643929117*^9, 
   3.9273777104080677`*^9}, {3.927380080601389*^9, 3.927380085138987*^9}, 
   3.927380128657151*^9, 3.927380324287407*^9, 3.927380356774778*^9, 
   3.9273904573865213`*^9, 3.927390502361389*^9, 3.927452323105023*^9, 
   3.927572163235585*^9, {3.927623927694902*^9, 3.927623927835737*^9}, {
   3.927810341259165*^9, 3.9278103479894953`*^9}, 3.927810581626333*^9, {
   3.927853324661438*^9, 3.927853327574348*^9}, {3.927884238462267*^9, 
   3.927884255905744*^9}, {3.9279004772852087`*^9, 3.92790048178858*^9}},
 CellLabel->
  "In[7867]:=",ExpressionUUID->"d4c968d2-fbde-4d61-a368-c82cd962a715"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"px", "[", 
    RowBox[{"1", ",", "eye0", ",", "Automatic"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"px", "[", 
    RowBox[{"2", ",", "eye0", ",", "Automatic"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"px", "[", 
    RowBox[{"3", ",", "eye0", ",", "Automatic"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.927374851660962*^9, 3.927374851727708*^9}, {
  3.927458247255698*^9, 3.927458273482604*^9}, {3.927458412969083*^9, 
  3.927458413655458*^9}, {3.927574222577952*^9, 3.927574237437399*^9}, {
  3.927853593369604*^9, 3.9278536172335653`*^9}, {3.927884264521852*^9, 
  3.927884266523314*^9}},
 CellLabel->
  "In[7868]:=",ExpressionUUID->"219f98bc-a117-4ebc-ac97-246cc2b7be52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
copied from common_funs.nb with these modifications:
1) no degree sign for tick labels
2) left-alignment of tick labels
3) auto-scaling based on contours (see BC_Igel.nb)\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 
  3.9276570388837633`*^9}},ExpressionUUID->"e02da852-35b6-4233-ad67-\
789e87b44a63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"legendsv", "[", 
   RowBox[{
   "contours_", ",", "heading_", ",", "hw_", ",", "fontsize_", ",", 
    "increment_", ",", "offset_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"contours", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", "fontsize"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"offset", ",", 
            RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Left", ",", "Center"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}], ",", 
         "increment"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"heading", ",", 
        RowBox[{"{", 
         RowBox[{".75", ",", 
          RowBox[{"hw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              StyleBox["contours",
               FontWeight->"Plain"], "]"}], "+", ".75"}], ")"}]}]}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".0005", "]"}], ",", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3.5", ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}]}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Thickness", "[", ".004", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ColorData", "[", "cvel", "]"}], "[", 
            FractionBox[
             RowBox[{
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "+", 
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "-", 
              RowBox[{"contours", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], 
             RowBox[{
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}]}], "}"}], 
            "]"}]}], "}"}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.92681501046321*^9, 3.926815066876936*^9, {3.9273906655433817`*^9, 
   3.927390671746499*^9}, {3.927390799530697*^9, 3.927390801326439*^9}, 
   3.927572480718581*^9, {3.9275727328857403`*^9, 3.927572733352859*^9}, 
   3.927622757618585*^9, {3.92762291048197*^9, 3.92762291342074*^9}, {
   3.9276231513559103`*^9, 3.92762315438365*^9}, {3.927623191625724*^9, 
   3.927623256101019*^9}, {3.927623287358045*^9, 3.927623316486948*^9}, {
   3.927623409645603*^9, 3.9276234157856903`*^9}, {3.927623547805225*^9, 
   3.927623670725582*^9}},
 CellLabel->
  "In[7869]:=",ExpressionUUID->"3b8e8e22-5d1a-4125-88f4-0438af22d134"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cols", "=", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Blue", ",", "Yellow"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"rowlabU", "[", 
      RowBox[{"var_", ",", "dig_Integer"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"var", ",", "18", ",", 
          RowBox[{"cols", "[", 
           RowBox[{"[", "dig", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "dig", "]"}], ",", "12", ",", 
          RowBox[{"cols", "[", 
           RowBox[{"[", "dig", "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "DisplayForm"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rowlabU", "[", 
    RowBox[{"var_", ",", "dig_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"StyleBox", "[", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"var", ",", "22", ",", 
          RowBox[{"FontColor", "->", "Black"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "dig", "]"}], ",", "16", ",", 
          RowBox[{"FontColor", "->", "Black"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Background", "->", 
       RowBox[{"Lighter", "[", 
        RowBox[{
         RowBox[{"cols", "[", 
          RowBox[{"[", "dig", "]"}], "]"}], ",", "0.7"}], "]"}]}]}], "]"}], "//",
     "DisplayForm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rowlabU", "[", 
  RowBox[{"\"\<u\>\"", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rowlabU", "[", 
  RowBox[{"\"\<-u\>\"", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rowlabU", "[", 
  RowBox[{"\"\<u\>\"", ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9279782504265423`*^9, 3.927978250430716*^9}, {
   3.927978318930675*^9, 3.927978352176199*^9}, {3.9279783839894257`*^9, 
   3.927978476416491*^9}, {3.927978824466055*^9, 3.92797882753279*^9}, 
   3.9279830862920713`*^9},
 CellLabel->
  "In[7870]:=",ExpressionUUID->"bc4eb215-ddcb-4709-831c-cd28426ca7b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rowlabX", "[", "var_", "]"}], "=", 
   RowBox[{"Style", "[", 
    RowBox[{"var", ",", "18", ",", "Black"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"llabmono", "=", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\[Alpha]\>\"", ",", "16", ",", "Black"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<MONO\>\"", ",", "8", ",", "Black"}], "]"}]}], "]"}], "//",
     "DisplayForm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"llabv", "=", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<km/s\>\"", ",", "12", ",", "Black"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tlabmono", "=", "\"\< \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tlabv1", "=", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<V\>\"", ",", "18", ",", "Black"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<1\>\"", ",", "12", ",", "Black"}], "]"}]}], "]"}], "//", 
    "DisplayForm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tlabv2", "=", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<V\>\"", ",", "18", ",", "Black"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<2\>\"", ",", "12", ",", "Black"}], "]"}]}], "]"}], "//", 
    "DisplayForm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tlabv3", "=", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<V\>\"", ",", "18", ",", "Black"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<3\>\"", ",", "12", ",", "Black"}], "]"}]}], "]"}], "//", 
    "DisplayForm"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927972054288374*^9, 3.9279720841149187`*^9}, {
   3.927972139858328*^9, 3.927972164743976*^9}, {3.927972467698938*^9, 
   3.9279724807871647`*^9}, {3.927972526099205*^9, 3.927972530985024*^9}, 
   3.927972584480117*^9, {3.927972623485202*^9, 3.927972624014929*^9}, {
   3.927972675897853*^9, 3.927972695074963*^9}, {3.9279728027399817`*^9, 
   3.92797282745798*^9}, {3.927972943168627*^9, 3.927973032764391*^9}, {
   3.927973640542472*^9, 3.9279736582663116`*^9}, 3.927974494296006*^9, {
   3.9279745361295137`*^9, 3.927974555406974*^9}, 3.927974683406314*^9, {
   3.9279756999395113`*^9, 3.9279757553141613`*^9}, {3.927975791594994*^9, 
   3.9279758155453777`*^9}, {3.927975867770928*^9, 3.927975886903723*^9}, {
   3.927978503280368*^9, 3.927978506991116*^9}, {3.927981512840452*^9, 
   3.927981527292976*^9}, {3.927983545698991*^9, 3.9279835474923353`*^9}},
 CellLabel->
  "In[7875]:=",ExpressionUUID->"886781c0-6b11-40f1-ad6f-d31dae3f7373"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", "BBrad"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ytit", "=", 
   RowBox[{"0.5", "dx"}]}], ";", 
  RowBox[{"xrowlab", "=", 
   RowBox[{"-", "0.6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ax", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xrowlab", "-", "0.2"}], ",", "4.1"}], "}"}], ",", 
      RowBox[{"0.51", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ax", "=", "Automatic"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"insetSize", "=", "1"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"hw", "=", "1"}], ";", 
  RowBox[{"fontsize", "=", "10"}], ";", 
  RowBox[{"increment", "=", "1"}], ";", 
  RowBox[{"offset", "=", "2.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plmono", "=", 
   RowBox[{"legends", "[", 
    RowBox[{
     RowBox[{"contours", "[", 
      RowBox[{
       StyleBox["Tmat0",
        FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", 
     RowBox[{"MaxForScaling", "[", 
      RowBox[{
       StyleBox["Tmat0",
        FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", "llabmono", 
     ",", "hw", ",", "fontsize", ",", "increment", ",", "offset"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plvel", "=", 
   RowBox[{"legendsv", "[", 
    RowBox[{
    "xcontours", ",", "llabv", ",", "hw", ",", "fontsize", ",", "incrementv", 
     ",", 
     RowBox[{"0.75", "offset"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rowplot", "[", 
   RowBox[{"eye_", ",", "vert_", ",", 
    RowBox[{"rowlab_", ":", "\"\<\>\""}]}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"rowlab", ",", 
          RowBox[{"FontSize", "->", "12"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"xrowlab", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"tlabmono", ",", 
          RowBox[{"FontSize", "->", "12"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.4"}], " ", "dx"}], ",", "ytit"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}], ",", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"pMONO", "[", 
         RowBox[{"eye", ",", "vert"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{"plmono", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.6", " ", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", 
        RowBox[{"isize", " ", "insetSize"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"tlabv1", ",", 
          RowBox[{"FontSize", "->", "12"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.9", " ", "dx"}], ",", "ytit"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}], ",", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"px", "[", 
         RowBox[{"1", ",", "eye", ",", "vert"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.3", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"tlabv2", ",", 
          RowBox[{"FontSize", "->", "12"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.9", " ", "dx"}], ",", "ytit"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}], ",", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"px", "[", 
         RowBox[{"2", ",", "eye", ",", "vert"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2.3", " ", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"tlabv3", ",", 
          RowBox[{"FontSize", "->", "12"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2.9", "dx"}], ",", "ytit"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}], ",", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"px", "[", 
         RowBox[{"3", ",", "eye", ",", "vert"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3.3", " ", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{"plvel", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3.9", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", 
        RowBox[{"isizev", " ", "insetSize"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ImageSize", "->", "1000"}], ",", 
    RowBox[{"PlotRange", "->", "ax"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.927376216325604*^9, 3.927376336414467*^9}, {
   3.927376415768152*^9, 3.9273765188832293`*^9}, {3.927376573215267*^9, 
   3.92737658014285*^9}, {3.9273767195052223`*^9, 3.927376853576849*^9}, {
   3.927376922718214*^9, 3.9273769342190313`*^9}, {3.927376984760398*^9, 
   3.9273770576637*^9}, {3.927377188838036*^9, 3.927377213783823*^9}, {
   3.9273773042976303`*^9, 3.927377385532452*^9}, {3.92738015011973*^9, 
   3.927380183593958*^9}, 3.927380327905439*^9, 3.927380358072084*^9, {
   3.927390261687986*^9, 3.927390377959359*^9}, 3.927390705809435*^9, {
   3.92739085346839*^9, 3.9273909101560183`*^9}, {3.9273910606933537`*^9, 
   3.927391062539332*^9}, {3.927391294673456*^9, 3.927391303641481*^9}, {
   3.9273914087030563`*^9, 3.927391408830256*^9}, {3.9273967318038197`*^9, 
   3.9273967537285423`*^9}, {3.927396809893818*^9, 3.92739689585511*^9}, {
   3.927396945498928*^9, 3.927396955608407*^9}, {3.927396997445565*^9, 
   3.927397095773953*^9}, {3.927397516500288*^9, 3.927397516593511*^9}, {
   3.927397632238873*^9, 3.927397658292055*^9}, {3.927573983271688*^9, 
   3.9275739833946123`*^9}, {3.927574110770733*^9, 3.927574111744277*^9}, {
   3.92762292639769*^9, 3.927622929556329*^9}, {3.92762368883342*^9, 
   3.927623691454838*^9}, {3.9276271001788683`*^9, 3.927627100718525*^9}, {
   3.927627141252305*^9, 3.927627148763607*^9}, {3.9276272261622553`*^9, 
   3.927627226541543*^9}, {3.9276294406181393`*^9, 3.927629456773757*^9}, {
   3.927629502176692*^9, 3.9276295069026413`*^9}, {3.927631112360085*^9, 
   3.92763113992985*^9}, {3.9276311955242567`*^9, 3.927631200247278*^9}, {
   3.927631330839818*^9, 3.9276313345015497`*^9}, {3.927631538664393*^9, 
   3.9276315745353413`*^9}, {3.9276317926853313`*^9, 3.927631793063592*^9}, 
   3.927631847864938*^9, {3.927631892865876*^9, 3.927631893089007*^9}, {
   3.927632051875845*^9, 3.927632053277836*^9}, {3.927647945075626*^9, 
   3.927647946506031*^9}, 3.9276480034406967`*^9, {3.9278049713215227`*^9, 
   3.927804990585066*^9}, {3.927805333223577*^9, 3.9278053356562567`*^9}, {
   3.92785334478468*^9, 3.927853390383103*^9}, {3.927883675947554*^9, 
   3.927883678116498*^9}, {3.927913434807824*^9, 3.927913452272945*^9}, {
   3.9279135364671297`*^9, 3.92791358510318*^9}, {3.927913674183564*^9, 
   3.927913677760028*^9}, 3.927920405290781*^9, {3.9279204551368237`*^9, 
   3.9279204552472763`*^9}, {3.927972138503953*^9, 3.927972141905089*^9}, {
   3.92797225743645*^9, 3.9279722647618847`*^9}, {3.927972303914884*^9, 
   3.927972304351378*^9}, {3.927972353504496*^9, 3.9279723802210407`*^9}, {
   3.927972423788028*^9, 3.927972423898493*^9}, {3.927972535407695*^9, 
   3.927972548504443*^9}, 3.9279725908130417`*^9, {3.927972770417309*^9, 
   3.927972798993759*^9}, 3.9279728408423634`*^9, {3.9279728746691113`*^9, 
   3.927972886358862*^9}, {3.9279729224344397`*^9, 3.927972923848835*^9}, {
   3.927973689594014*^9, 3.9279736945732927`*^9}, {3.927973734723324*^9, 
   3.927973735220025*^9}, {3.9279737812543297`*^9, 3.927973822065135*^9}, {
   3.9279786445383043`*^9, 3.927978675356134*^9}, {3.9279787356825*^9, 
   3.927978770774828*^9}, {3.9279788622495937`*^9, 3.927978878594755*^9}, {
   3.927980982932808*^9, 3.927980984786862*^9}, {3.92798110552577*^9, 
   3.927981112732718*^9}, {3.9279811492245283`*^9, 3.927981158237021*^9}, {
   3.9279816300189533`*^9, 3.927981635544375*^9}, {3.9279816969794683`*^9, 
   3.927981722248229*^9}, {3.927981824873933*^9, 3.927981842175926*^9}, {
   3.927981959166143*^9, 3.927981971626833*^9}, {3.9279820171532993`*^9, 
   3.9279820172452383`*^9}, {3.92798207085219*^9, 3.927982070922894*^9}, {
   3.9279831284435873`*^9, 3.927983128858788*^9}, 3.9279832090535717`*^9, {
   3.9279832654863367`*^9, 3.927983265600358*^9}, {3.927983346112508*^9, 
   3.927983401621635*^9}, {3.9279834450530367`*^9, 3.9279834452241507`*^9}, {
   3.927983879177709*^9, 3.9279838792639923`*^9}},
 CellLabel->
  "In[7882]:=",ExpressionUUID->"94011b07-587b-44d0-a3d6-f647fb77b2a2"],

Cell[BoxData[
 RowBox[{"pmod", " ", ":=", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{"ptitle", ",", "pdefault"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927972228391432*^9, 3.927972229814118*^9}, {
   3.9279732302034883`*^9, 3.9279732305187807`*^9}, 3.927973452631753*^9, {
   3.927973983016807*^9, 3.927974036928543*^9}, {3.927974183520939*^9, 
   3.927974183649022*^9}},
 CellLabel->
  "In[7890]:=",ExpressionUUID->"8c72469c-f71b-409a-a2c2-d76c4479a600"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptitle", ":=", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", "16"}], "]"}], ",", 
       RowBox[{"Spacer", "[", "0", "]"}]}], "}"}], ",", 
     RowBox[{"Alignment", "->", 
      RowBox[{"{", 
       RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdefault", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{"eye0", ",", "Automatic"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eyerad", "=", "50"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "these", " ", "ViewVertical", " ", "arguments", " ", "could", " ", "all", 
    " ", "be", " ", "Automatic"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppz", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{
     RowBox[{"eyerad", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"rowlabX", "[", "\"\<z\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppy", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{
     RowBox[{"eyerad", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"rowlabX", "[", "\"\<-y\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppx", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{
     RowBox[{"eyerad", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"rowlabX", "[", "\"\<x\>\"", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combinedPlotX", ":=", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{"ptitle", ",", "pdefault", ",", "ppz", ",", "ppy", ",", "ppx"}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927391355547772*^9, 3.9273913921374073`*^9}, {
   3.927395477689225*^9, 3.927395478055464*^9}, 3.927397854751377*^9, {
   3.927401612634347*^9, 3.927401621285537*^9}, {3.927625853496684*^9, 
   3.927625910514543*^9}, {3.927626165711009*^9, 3.9276261971362543`*^9}, {
   3.927626966720646*^9, 3.927626971554473*^9}, {3.927650976193636*^9, 
   3.927650976825975*^9}, 3.927805343667182*^9, {3.927805401326309*^9, 
   3.9278054059022503`*^9}, {3.927805499752449*^9, 3.92780550006628*^9}, 
   3.927805535569356*^9, {3.927853403010301*^9, 3.9278534625701*^9}, {
   3.927883680675933*^9, 3.927883681578014*^9}, 3.927884485822742*^9, {
   3.9278846344999933`*^9, 3.927884671725478*^9}, {3.927884702723072*^9, 
   3.927884713056349*^9}, {3.927896819151313*^9, 3.927896823615131*^9}, 
   3.927898174483306*^9, {3.9279009072745657`*^9, 3.927900912345153*^9}, {
   3.927902878260665*^9, 3.927902915565344*^9}, 3.9279045061288853`*^9, {
   3.9279109783062477`*^9, 3.927911025978457*^9}, 3.927911079579392*^9, {
   3.927973355106564*^9, 3.927973356104282*^9}, {3.927973464865945*^9, 
   3.9279734693648033`*^9}, {3.927973591209876*^9, 3.927973596125785*^9}, {
   3.927973860740834*^9, 3.927973910645834*^9}, 3.927983431331156*^9},
 CellLabel->
  "In[7891]:=",ExpressionUUID->"bbb7caf3-9682-4773-99b5-845afe230134"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ppu3", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{
     RowBox[{"eyerad", " ", 
      RowBox[{"Uref", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
     RowBox[{"Uref", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
     RowBox[{"rowlabU", "[", 
      RowBox[{"\"\<u\>\"", ",", "3"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppu2", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{
     RowBox[{"eyerad", " ", 
      RowBox[{"Uref", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ",", 
     RowBox[{"Uref", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"rowlabU", "[", 
      RowBox[{"\"\<-u\>\"", ",", "2"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppu1", ":=", 
   RowBox[{"rowplot", "[", 
    RowBox[{
     RowBox[{"eyerad", " ", 
      RowBox[{"Uref", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ",", 
     RowBox[{"Uref", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"rowlabU", "[", 
      RowBox[{"\"\<u\>\"", ",", "1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combinedPlotU", ":=", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{
     "ptitle", ",", "pdefault", ",", "ppu3", ",", "ppu2", ",", "ppu1"}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927805367761701*^9, 3.9278054884946547`*^9}, 
   3.927805534171563*^9, {3.927805655373163*^9, 3.927805656960025*^9}, {
   3.9278104020153112`*^9, 3.927810428595544*^9}, {3.9278539762776527`*^9, 
   3.927853997234475*^9}, {3.927854116124832*^9, 3.92785416887425*^9}, {
   3.927854696831012*^9, 3.9278547097316647`*^9}, {3.927854775611187*^9, 
   3.9278548043122587`*^9}, {3.9278843511339617`*^9, 3.927884362096266*^9}, 
   3.927884482239089*^9, {3.9278968262091913`*^9, 3.927896839563809*^9}, 
   3.92789817163451*^9, 3.927899383306958*^9, {3.9279009113676643`*^9, 
   3.9279009421945972`*^9}, {3.927902416418457*^9, 3.927902423286459*^9}, {
   3.9279028321777897`*^9, 3.927902840062325*^9}, {3.927902887954273*^9, 
   3.92790291163684*^9}, {3.927911034425744*^9, 3.9279110345724373`*^9}, 
   3.927973357033141*^9, {3.927974288680786*^9, 3.927974311304368*^9}, 
   3.927983429326598*^9},
 CellLabel->
  "In[7898]:=",ExpressionUUID->"225d0ed4-9da4-4311-997a-4ca5e31cbdbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display figures or print to files", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927802028786231*^9, 
  3.927802033026474*^9}},ExpressionUUID->"11a6a252-52b0-4645-a61f-\
450a1cb8e015"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<single.pdf\>\""}], ",", "p1mod"}], "]"}], ",",
    "p1mod"}], "]"}]], "Input",
 CellChangeTimes->{{3.9256051233224792`*^9, 3.9256051480053577`*^9}, {
   3.927626632567033*^9, 3.927626633159384*^9}, {3.9276266662680483`*^9, 
   3.927626666539077*^9}, {3.9276269796731253`*^9, 3.927626980683551*^9}, {
   3.927658791640945*^9, 3.927658798504574*^9}, 3.927883497633019*^9, 
   3.927884476495244*^9},
 CellLabel->
  "In[7902]:=",ExpressionUUID->"a5c1e262-4972-40c9-858a-f04bd932d23f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<Xall.pdf\>\""}], ",", "combinedPlotX"}], 
    "]"}], ",", "combinedPlotX"}], "]"}]], "Input",
 CellChangeTimes->{{3.9256051233224792`*^9, 3.9256051480053577`*^9}, {
   3.927626632567033*^9, 3.927626633159384*^9}, {3.9276266662680483`*^9, 
   3.927626666539077*^9}, {3.9276269796731253`*^9, 3.927626980683551*^9}, {
   3.92780551070078*^9, 3.927805512285058*^9}, 3.927883503944096*^9, {
   3.927884477979106*^9, 3.9278844961535378`*^9}},
 CellLabel->
  "In[7903]:=",ExpressionUUID->"af90c1f1-d7f2-4739-8060-d2b6d7717637"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<Uall.pdf\>\""}], ",", "combinedPlotU"}], 
    "]"}], ",", "combinedPlotU"}], "]"}]], "Input",
 CellChangeTimes->{{3.9278844980977*^9, 3.927884502048769*^9}, {
  3.927896845076026*^9, 3.92789684546852*^9}},
 CellLabel->
  "In[7904]:=",ExpressionUUID->"f10eb7e4-24ad-44f7-8f39-49ecb2dde602"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Polar plots
note: VelFn includes Cmat and density\
\>", "Section",
 CellChangeTimes->{{3.9274520951118298`*^9, 3.927452100082172*^9}, {
  3.927458112211994*^9, 3.92745820522148*^9}, {3.927574176988968*^9, 
  3.927574180236335*^9}, {3.927626705866198*^9, 3.9276267059982777`*^9}, {
  3.927896616638941*^9, 
  3.927896624304288*^9}},ExpressionUUID->"4bdc7f57-87c0-4ca1-ae19-\
6e4eb0c87871"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R1", "=", 
    RowBox[{"Transpose", "[", "rot111", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"permute", " ", 
     RowBox[{"(", 
      RowBox[{"u1", ",", "u2", ",", "u3"}], ")"}], " ", "to", " ", 
     RowBox[{"(", 
      RowBox[{"u3", ",", "u1", ",", "u2"}], ")"}], " ", "to", " ", 
     RowBox[{"(", 
      RowBox[{"u2", ",", "u3", ",", "u1"}], ")"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "Uref", "]"}], "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Uref", ".", "R1"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Uref", ".", "R1", ".", "R1"}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.927906622422195*^9, 3.9279066510703506`*^9}, {
  3.927906701547893*^9, 3.927906717399206*^9}, {3.9279067954276257`*^9, 
  3.927906798572981*^9}, {3.92790686307542*^9, 3.927906908419425*^9}, {
  3.927906998508129*^9, 3.927907000799065*^9}, {3.927920614565896*^9, 
  3.927920616691087*^9}},
 CellLabel->
  "In[7905]:=",ExpressionUUID->"c0c8b067-e4ac-4f58-ab01-8e6a5fa42fa4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Pplot", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"velsTP", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat", ",", "density"}], "]"}], 
    "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9274528238730288`*^9, 3.9274528472338943`*^9}, {
   3.92745337290901*^9, 3.927453376390648*^9}, {3.927560756281579*^9, 
   3.927560756713991*^9}, 3.927572171452937*^9, {3.927625012137012*^9, 
   3.9276250145875063`*^9}},
 CellLabel->
  "In[7906]:=",ExpressionUUID->"847c5e1f-0182-40e9-a808-4a2c404b4bfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pplot", "[", 
   RowBox[{"\[Theta]_", ",", "U_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"VelFn", "[", 
   RowBox[{
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ",", "i"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9275942293228683`*^9, 3.9275943300842977`*^9}, {
   3.927624532309643*^9, 3.927624575039484*^9}, 3.927625007219685*^9},
 CellLabel->
  "In[7907]:=",ExpressionUUID->"7eeff714-c47f-4723-bf18-a2f595248945"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dconv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contourLevels", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"conminv", ",", "conmaxv", ",", "dconv"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"poptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ticks", "->", "None"}], ",", 
     RowBox[{"Axes", "->", "None"}], ",", 
     RowBox[{"Frame", "->", "False"}], ",", 
     RowBox[{"PolarGridLines", "->", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"redCircle", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "vp0"}], "]"}], ",", "Red", ",", 
     "Dashed"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"blueCircle", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "vs0"}], "]"}], ",", "Blue", ",",
      "Dashed"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"stlab", "=", 
  RowBox[{"\"\<con \>\"", " ", "<>", "  ", 
   RowBox[{"ToString", "[", "dconv", "]"}], " ", "<>", " ", "\"\< km/s \>\"", 
   " ", "<>", " ", "stV"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"basemap", "=", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Circle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "r"}], "]"}], ",", 
            "LightGray"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "contourLevels"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"redCircle", ",", "blueCircle"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Axes", "->", "None"}], ",", 
      RowBox[{"AspectRatio", "->", "1"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"1.05", " ", "conmaxv", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarZ", ":=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"\"\<+z axis (xy plane): \>\"", "<>", "stlab"}]}], "}"}], 
          ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarY", ":=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"\"\<-y axis (xz plane): \>\"", "<>", "stlab"}]}], "}"}], 
          ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polarX", ":=", 
    RowBox[{"Show", "[", 
     RowBox[{"basemap", ",", "\[IndentingNewLine]", 
      RowBox[{"PolarPlot", "[", 
       RowBox[{
        RowBox[{"Pplot", "[", 
         RowBox[{"\[Theta]", ",", "Uyz", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "@", "poptions"}], ",", 
        RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PolarPlot", "[", 
       RowBox[{
        RowBox[{"Pplot", "[", 
         RowBox[{"\[Theta]", ",", "Uyz", ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "@", "poptions"}], ",", 
        RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PolarPlot", "[", 
       RowBox[{
        RowBox[{"Pplot", "[", 
         RowBox[{"\[Theta]", ",", "Uyz", ",", "3"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "@", "poptions"}], ",", 
        RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
             RowBox[{"\"\<+x axis (yz plane): \>\"", "<>", "stlab"}]}], "}"}],
            ",", 
           RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
        "]"}]}], ",", 
      RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stit", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ToString", "[", "\[CapitalSigma]", "]"}], "<>", "\"\< \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"\"\<U\>\"", ",", "k"}], "]"}], ",", "TraditionalForm"}], 
     "]"}], "<>", "\"\< axis: \>\"", "<>", "stlab"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polarU3", ":=", 
    RowBox[{"Show", "[", 
     RowBox[{"basemap", ",", "\[IndentingNewLine]", 
      RowBox[{"PolarPlot", "[", 
       RowBox[{
        RowBox[{"Pplot", "[", 
         RowBox[{"\[Theta]", ",", "Uref", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "@", "poptions"}], ",", 
        RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PolarPlot", "[", 
       RowBox[{
        RowBox[{"Pplot", "[", 
         RowBox[{"\[Theta]", ",", "Uref", ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "@", "poptions"}], ",", 
        RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PolarPlot", "[", 
       RowBox[{
        RowBox[{"Pplot", "[", 
         RowBox[{"\[Theta]", ",", "Uref", ",", "3"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "@", "poptions"}], ",", 
        RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
             RowBox[{"stit", "[", "3", "]"}]}], "}"}], ",", 
           RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
        "]"}]}], ",", 
      RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "decide", " ", "if", " ", "you", " ", "want", " ", "to", " ", "look", 
      " ", "down", " ", "the", " ", "u2", " ", "or"}], " ", "-", 
     RowBox[{"u2", " ", "axis"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarU2", ":=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", 
         StyleBox[
          RowBox[{"Uref", ".", "R1"}],
          FontColor->GrayLevel[0]], ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", 
         StyleBox[
          RowBox[{"Uref", ".", "R1"}],
          FontColor->GrayLevel[0]], ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", 
         StyleBox[
          RowBox[{"Uref", ".", "R1"}],
          FontColor->GrayLevel[0]], ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"stit", "[", "2", "]"}]}], "}"}], ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarU1", ":=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", 
         StyleBox[
          RowBox[{"Uref", ".", "R1", ".", "R1"}],
          FontColor->GrayLevel[0]], ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", 
         StyleBox[
          RowBox[{"Uref", ".", "R1", ".", "R1"}],
          FontColor->GrayLevel[0]], ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", 
         StyleBox[
          RowBox[{"Uref", ".", "R1", ".", "R1"}],
          FontColor->GrayLevel[0]], ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"stit", "[", "1", "]"}]}], "}"}], ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927453507075843*^9, 3.927453525726275*^9}, {
   3.927453624205551*^9, 3.9274536436871357`*^9}, {3.927455078759156*^9, 
   3.927455082217255*^9}, {3.927455149654805*^9, 3.927455186158555*^9}, {
   3.927455240293652*^9, 3.9274552427867413`*^9}, {3.9274553077681923`*^9, 
   3.927455328583888*^9}, {3.927455401223524*^9, 3.927455421035512*^9}, {
   3.92745546239775*^9, 3.927455474764678*^9}, {3.927455745172203*^9, 
   3.927455759929166*^9}, 3.927456646025116*^9, {3.927456984109618*^9, 
   3.927457016542502*^9}, {3.927457447213763*^9, 3.927457492102791*^9}, {
   3.9274576896918383`*^9, 3.927457748189204*^9}, {3.9274577795651293`*^9, 
   3.927457800772002*^9}, {3.9274578361546593`*^9, 3.927457872206316*^9}, {
   3.927459287476366*^9, 3.927459289615687*^9}, {3.9276250366645823`*^9, 
   3.927625133305881*^9}, {3.927630624246511*^9, 3.927630630414926*^9}, {
   3.927630746451169*^9, 3.927630755688775*^9}, {3.927630790698454*^9, 
   3.9276307913954153`*^9}, {3.9276368831224318`*^9, 3.927636885110427*^9}, {
   3.9276422373507853`*^9, 3.927642269085462*^9}, {3.927642965781147*^9, 
   3.927642997794739*^9}, {3.927643049183633*^9, 3.927643053215191*^9}, {
   3.92764419089287*^9, 3.9276441920245523`*^9}, {3.927644710758573*^9, 
   3.9276447120200043`*^9}, 3.927644810560998*^9, {3.927645088358633*^9, 
   3.927645221085943*^9}, {3.9276452539786797`*^9, 3.9276452553707*^9}, {
   3.927645980874379*^9, 3.927646002732479*^9}, {3.9276462376336117`*^9, 
   3.927646259249957*^9}, {3.927646458949821*^9, 3.9276464641607018`*^9}, {
   3.927646703591344*^9, 3.9276467258775806`*^9}, {3.9276467772403593`*^9, 
   3.9276467881865177`*^9}, {3.927646838892419*^9, 3.927646910662006*^9}, {
   3.9276469587904863`*^9, 3.927646972746958*^9}, {3.92764740258348*^9, 
   3.927647403810315*^9}, {3.927650928673194*^9, 3.927650940349444*^9}, {
   3.927651900171876*^9, 3.927651908825431*^9}, 3.927652416853813*^9, {
   3.9276524919207*^9, 3.927652491980925*^9}, {3.927801748232087*^9, 
   3.927801759132628*^9}, {3.927802157305128*^9, 3.927802166157515*^9}, {
   3.927802463361422*^9, 3.927802516672221*^9}, {3.927803026395548*^9, 
   3.9278030667525473`*^9}, {3.927803110070854*^9, 3.9278031138047533`*^9}, {
   3.9278966619198933`*^9, 3.927896740636137*^9}, {3.927902430692011*^9, 
   3.9279024325322847`*^9}, {3.927905802880228*^9, 3.9279058961220083`*^9}, {
   3.927905927790532*^9, 3.927905961222603*^9}, {3.9279060250599337`*^9, 
   3.9279060339561157`*^9}, {3.927906064012064*^9, 3.927906102365518*^9}, {
   3.927906419917289*^9, 3.927906421915205*^9}, {3.927906891653181*^9, 
   3.9279068951980133`*^9}, {3.9279069485046473`*^9, 3.92790700741114*^9}, {
   3.927910237114451*^9, 3.9279102862420464`*^9}, {3.9279105923631983`*^9, 
   3.9279105935596*^9}, {3.9279106780418043`*^9, 3.9279106825309563`*^9}, {
   3.92791082999631*^9, 3.9279108974732733`*^9}},
 CellLabel->
  "In[7908]:=",ExpressionUUID->"afaffa34-f3a5-4749-8ebd-a9e67e57a542"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dxx", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "16"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"combinedPlotP", ":=", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polarZ", ",", "polarY", ",", "polarX"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"polarU3", ",", "polarU2", ",", "polarU1"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"ImageSize", "->", "1100"}], ",", 
     RowBox[{"Spacings", "->", 
      RowBox[{"{", 
       RowBox[{"dxx", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927453148098589*^9, 3.927453194807581*^9}, {
   3.9274534350877457`*^9, 3.927453442853806*^9}, {3.927459294090065*^9, 
   3.927459298802376*^9}, {3.927625106358309*^9, 3.9276251081590147`*^9}, {
   3.92763067603115*^9, 3.9276306919523697`*^9}, {3.9276307654049263`*^9, 
   3.927630784561625*^9}, {3.9276308572693644`*^9, 3.927630861634637*^9}, 
   3.9276422735478897`*^9, 3.927644144652856*^9, {3.927646204993021*^9, 
   3.927646219467876*^9}, {3.92764635251051*^9, 3.927646370576591*^9}, {
   3.927646401075062*^9, 3.927646429103841*^9}, {3.9276465592599*^9, 
   3.927646623541296*^9}, 3.927647207802948*^9, 3.927801762226241*^9, {
   3.927802131200791*^9, 3.9278021511499968`*^9}, {3.927802192772004*^9, 
   3.927802228926154*^9}, {3.927803119200182*^9, 3.927803134516959*^9}, {
   3.927884402566936*^9, 3.927884405769877*^9}, {3.9278845831496143`*^9, 
   3.9278846105283613`*^9}, {3.927896706053256*^9, 3.927896731736273*^9}, {
   3.927898317461121*^9, 3.927898322436837*^9}, {3.9279024364078503`*^9, 
   3.927902439951386*^9}},
 CellLabel->
  "In[7922]:=",ExpressionUUID->"23f0f017-220a-44fe-8750-be0344048a6c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<polar.pdf\>\""}], ",", "combinedPlotP"}], 
    "]"}], ",", "combinedPlotP"}], "]"}]], "Input",
 CellChangeTimes->{{3.927630843643276*^9, 3.9276308452836027`*^9}, {
  3.927898319907044*^9, 3.9278983208480377`*^9}},
 CellLabel->
  "In[7925]:=",ExpressionUUID->"951d6b7c-dfac-4b25-aa57-3c9fc8b92f92"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loop over elastic maps and Sigmas to make figures", "Section",
 CellChangeTimes->{{3.9274520951118298`*^9, 3.927452100082172*^9}, {
  3.927458112211994*^9, 3.92745820522148*^9}, {3.927574176988968*^9, 
  3.927574180236335*^9}, {3.927626705866198*^9, 3.9276267059982777`*^9}, {
  3.927896505134399*^9, 
  3.92789651560632*^9}},ExpressionUUID->"574f0a07-c033-4b37-b1b0-\
fd8105423ab8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"List\[CapitalSigma]", "=", 
   RowBox[{"{", 
    RowBox[{
    "TRIV", ",", "MONO", ",", "ORTH", ",", "TET", ",", "TRIG", ",", "XISO", 
     ",", "CUBE"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.921325217799184*^9, 3.921325218344998*^9}, {
  3.921325252288609*^9, 3.921325253323471*^9}, {3.9279012439845257`*^9, 
  3.927901247138124*^9}},
 CellLabel->
  "In[7926]:=",ExpressionUUID->"13945da3-14fd-496e-91b5-849f282c5731"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrintFigures", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"kk", "=", "1"}], ",", 
   RowBox[{"kk", "<=", 
    RowBox[{"Length", "[", "List\[CapitalSigma]", "]"}]}], ",", 
   RowBox[{"kk", "++"}], ",", 
   RowBox[{
    RowBox[{"\[CapitalSigma]", "=", 
     RowBox[{"List\[CapitalSigma]", "[", 
      RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tmat\[CapitalSigma]", "=", 
     RowBox[{"Closest", "[", 
      RowBox[{"Tmat0", ",", "\[CapitalSigma]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Uref", "=", 
     RowBox[{"UT", "[", 
      RowBox[{"Tmat0", ",", "\[CapitalSigma]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "===", "TRIV"}], ",", 
      RowBox[{"Uref", "=", "id"}]}], "]"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "any", " ", "U", " ", "will", " ", "work", " ", "for", " ", "TRIV"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Tmat", "=", "Tmat\[CapitalSigma]"}], ";", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"MatrixNote", "[", "Tmat", "]"}], "=", 
     RowBox[{
      RowBox[{"MatrixNote", "[", "Tmat0", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[CapitalSigma]", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MatrixNote", "[", "Tmat", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Cmat", "=", 
     RowBox[{"CmatOfTmat", "[", "Tmat", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"otag", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"odir", ",", 
        RowBox[{"\"\<ChristoffelSpheres_\>\"", "<>", 
         RowBox[{"Tlab", "[", "Tmat0", "]"}], "<>", "\"\<_\>\""}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"osuffix", "=", 
     RowBox[{
      RowBox[{"ToString", "[", "kk", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[CapitalSigma]", "]"}], "<>", 
      "\"\<.pdf\>\""}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"PrintFigures", ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"otag", "<>", "\"\<single_\>\"", "<>", "osuffix"}], ",", 
        "p1mod"}], "]"}], ",", "p1mod"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"PrintFigures", ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"otag", "<>", "\"\<Xall_\>\"", "<>", "osuffix"}], ",", 
        "combinedPlotX"}], "]"}], ",", "combinedPlotX"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"PrintFigures", ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"otag", "<>", "\"\<Uall_\>\"", "<>", "osuffix"}], ",", 
        "combinedPlotU"}], "]"}], ",", "combinedPlotU"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"PrintFigures", ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"otag", "<>", "\"\<polar_\>\"", "<>", "osuffix"}], ",", 
        "combinedPlotP"}], "]"}], ",", "combinedPlotP"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.927899055737185*^9, 3.927899078331709*^9}, {
  3.9278991173524857`*^9, 3.9278991681105556`*^9}, {3.927899461574686*^9, 
  3.927899463859469*^9}, {3.927899593768791*^9, 3.927899639227316*^9}, {
  3.927900546686359*^9, 3.927900553157305*^9}, {3.927901834344727*^9, 
  3.927901916658698*^9}, {3.927901950155086*^9, 3.927901950205557*^9}, {
  3.9279020119926643`*^9, 3.927902058237166*^9}, {3.927906455883904*^9, 
  3.927906458125163*^9}, {3.92791010501318*^9, 3.9279101068942537`*^9}, {
  3.927984217955167*^9, 3.927984247215444*^9}, {3.927984281418762*^9, 
  3.927984307671166*^9}},
 CellLabel->
  "In[7935]:=",ExpressionUUID->"b2a1b59a-6569-4026-aea7-5bdaf62d8d49"]
}, Open  ]]
},
WindowSize->{1414, 1000},
WindowMargins->{{18, Automatic}, {22, Automatic}},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7a27a924-139e-4997-a27c-940af22d530d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 228, 6, 105, "Section",ExpressionUUID->"59d4d812-4b2e-4186-9442-6826736b67df"],
Cell[CellGroupData[{
Cell[811, 30, 212, 4, 53, "Section",ExpressionUUID->"764a5bf6-cc27-4365-85e9-4479f8c529ed"],
Cell[1026, 36, 531, 9, 30, "Input",ExpressionUUID->"d9ba5e55-6356-4aad-8bdc-9b9281b28509"],
Cell[CellGroupData[{
Cell[1582, 49, 615, 11, 71, "Subsubsection",ExpressionUUID->"cc08436a-72e8-4a48-a4cf-d97439428a3c"],
Cell[2200, 62, 1258, 23, 30, "Input",ExpressionUUID->"9499a352-0310-4c4d-be3a-e4e0bff24cad"],
Cell[3461, 87, 1283, 24, 30, "Input",ExpressionUUID->"0520d4ed-ced5-4a99-9ccf-19d274c3ee77"],
Cell[4747, 113, 226, 5, 30, "Input",ExpressionUUID->"0cf229da-7154-4bbc-8356-19cebb8ea6fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5010, 123, 622, 9, 45, "Subsubsection",ExpressionUUID->"4a0048ff-7f8e-49f7-a365-98e2c7028415"],
Cell[5635, 134, 903, 14, 30, "Input",ExpressionUUID->"6c0d6afc-c1e6-4de7-b3a1-c6000cd1f24c"],
Cell[6541, 150, 422, 10, 30, "Input",ExpressionUUID->"aa5acef0-10d5-4c47-bb11-95893ace1a5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7000, 165, 875, 12, 45, "Subsubsection",ExpressionUUID->"e3be44bf-4e8b-4387-bf47-067c7b658807"],
Cell[7878, 179, 521, 9, 30, "Input",ExpressionUUID->"25224e18-1f10-44f8-90c8-08fd2dc6246e"],
Cell[8402, 190, 972, 19, 30, "Input",ExpressionUUID->"75a2e835-7c1b-430e-b4e4-ada995e678d0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9423, 215, 208, 4, 67, "Section",ExpressionUUID->"e4473182-0fc7-44b5-966b-848c0f78eca9"],
Cell[CellGroupData[{
Cell[9656, 223, 579, 8, 45, "Subsubsection",ExpressionUUID->"f1573f09-aae1-4263-a86b-72a746014752"],
Cell[10238, 233, 497, 9, 30, "Input",ExpressionUUID->"62724fb3-b6bb-45a8-96c0-7caba147800d"],
Cell[10738, 244, 354, 8, 30, "Input",ExpressionUUID->"d996a1ee-cd80-4aa6-9023-7b56097f2d03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11129, 257, 465, 7, 45, "Subsubsection",ExpressionUUID->"964489cb-4ddb-461e-827b-1e373d08a457"],
Cell[11597, 266, 789, 13, 30, "Input",ExpressionUUID->"c69f2d97-094d-4323-8412-6ce582de2fba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12423, 284, 519, 8, 45, "Subsubsection",ExpressionUUID->"0055b19f-9f3b-41e0-a5ab-f5390c048119"],
Cell[12945, 294, 1021, 22, 94, "Input",ExpressionUUID->"cd28920b-f0f1-4678-ac1b-8cec14c0ec5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14003, 321, 496, 7, 45, "Subsubsection",ExpressionUUID->"e9451361-ca9d-4da1-af7c-62d312663b62"],
Cell[14502, 330, 1636, 38, 94, "Input",ExpressionUUID->"47e6e34d-e9f9-4862-b5b3-e18ddfb8787c"],
Cell[16141, 370, 334, 7, 30, "Input",ExpressionUUID->"26288248-2838-449d-9ca0-97b0f44f1819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16512, 382, 463, 7, 45, "Subsubsection",ExpressionUUID->"5ba5e1c6-59cf-4908-983d-145b47c25204"],
Cell[16978, 391, 288, 5, 30, "Input",ExpressionUUID->"9c43b048-b1ce-44fa-ae2f-7615fcf6b541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17303, 401, 476, 7, 45, "Subsubsection",ExpressionUUID->"dcf2479e-0e3e-43dd-8da6-54a9612a79b2"],
Cell[17782, 410, 640, 16, 73, "Input",ExpressionUUID->"35f2fc3e-0eec-44bb-93b6-d95891d1a62f"],
Cell[18425, 428, 975, 23, 52, "Input",ExpressionUUID->"e45f5643-798a-4733-8f32-312bf9cfcbc1"],
Cell[19403, 453, 707, 17, 30, "Input",ExpressionUUID->"9ab8f89b-d4ac-4ac4-9472-c6e16f2a56cb"],
Cell[20113, 472, 346, 8, 30, "Input",ExpressionUUID->"e9d346e7-e9b6-4261-9de8-cb6f07677cfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20496, 485, 1055, 21, 47, "Subsubsection",ExpressionUUID->"688cb66b-2a97-43fb-a615-13fc7e841112"],
Cell[21554, 508, 777, 20, 69, "Input",ExpressionUUID->"33b36b06-6ceb-4097-92be-68b4a4a2ce89"],
Cell[22334, 530, 545, 15, 63, "Input",ExpressionUUID->"fb194081-e7ac-4d2c-8945-eb519094d924"],
Cell[22882, 547, 1253, 33, 94, "Input",ExpressionUUID->"5737d25c-1085-4b32-8f90-f2df91ffc111"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24172, 585, 385, 6, 45, "Subsubsection",ExpressionUUID->"c6209ac5-4aca-46a0-80b4-12bb0397e91d"],
Cell[24560, 593, 1537, 40, 52, "Input",ExpressionUUID->"fee46e49-7817-4bc9-8ac8-4e915f797a09"],
Cell[26100, 635, 1895, 47, 178, "Input",ExpressionUUID->"1de38f8f-130f-41ef-8182-7310ba777150"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28032, 687, 407, 6, 45, "Subsubsection",ExpressionUUID->"d2987021-d9ee-46a7-9581-019b5d2dc577"],
Cell[28442, 695, 711, 18, 38, "Input",ExpressionUUID->"ccd1d429-873e-4ab1-afc6-12810e2440e7"],
Cell[29156, 715, 1505, 39, 61, "Input",ExpressionUUID->"683f1804-9496-4d22-a08d-a54308bc7373"],
Cell[30664, 756, 879, 21, 94, "Input",ExpressionUUID->"727c504c-687f-481c-8406-2c409d2f01ef"],
Cell[31546, 779, 722, 21, 39, "Input",ExpressionUUID->"a67b50a3-3dd6-4729-aa23-940cf612345d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32317, 806, 158, 3, 67, "Section",ExpressionUUID->"e0ed86d8-bbfb-478e-8b23-980728f368f2"],
Cell[32478, 811, 298, 6, 30, "Input",ExpressionUUID->"efb1db04-4be8-4053-9b70-81163b25eea3"],
Cell[32779, 819, 1133, 28, 30, "Input",ExpressionUUID->"0e334b07-23bd-4f58-aee7-dd1bf956ecee"],
Cell[33915, 849, 307, 7, 30, "Input",ExpressionUUID->"f3d0dac4-89fe-4f51-be11-d7df780b509e"],
Cell[CellGroupData[{
Cell[34247, 860, 344, 5, 45, "Subsubsection",ExpressionUUID->"11e35a3e-8668-4513-9748-0b3e6aed3f90"],
Cell[34594, 867, 412, 9, 30, "Input",ExpressionUUID->"fdbeaeb2-9591-4912-a9df-6ed0ab0f4957"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35043, 881, 278, 4, 45, "Subsubsection",ExpressionUUID->"d6728993-c44e-4aa3-abbd-872f10b1eb94"],
Cell[35324, 887, 728, 14, 52, "Input",ExpressionUUID->"b9784432-d5b4-4238-917d-bffc3aaeaf09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36089, 906, 321, 6, 45, "Subsubsection",ExpressionUUID->"f4a5be9a-8718-41e7-90c4-a50097b7a8d3"],
Cell[36413, 914, 1374, 30, 115, "Input",ExpressionUUID->"03d87e71-e679-4b86-ab56-becb89fd987c"]
}, Open  ]],
Cell[37802, 947, 290, 6, 45, "Subsubsection",ExpressionUUID->"b52ce693-8f0e-44e5-918d-10faa6c6b7ab"],
Cell[38095, 955, 391, 7, 37, "Subsubsection",ExpressionUUID->"8ac89f76-bd89-4f07-b398-8bb7570ca8e2"],
Cell[CellGroupData[{
Cell[38511, 966, 596, 11, 89, "Subsubsection",ExpressionUUID->"aa5c798a-d7ed-4148-9b72-2b793467723a"],
Cell[39110, 979, 944, 29, 86, "Input",ExpressionUUID->"310c6695-95cc-4315-b94d-7d634fed4ad8"],
Cell[40057, 1010, 2511, 61, 94, "Input",ExpressionUUID->"852f68a4-9c40-477f-a316-a279abc81327"],
Cell[42571, 1073, 2495, 53, 178, "Input",ExpressionUUID->"0606c1dc-567d-4615-ab82-16d0b7645912"],
Cell[45069, 1128, 1341, 36, 73, "Input",ExpressionUUID->"cc97e413-02d5-4fb6-9bc5-729dcac7da16"],
Cell[46413, 1166, 992, 23, 115, "Input",ExpressionUUID->"50c76194-58a3-4cb6-abc1-14eb5adffa62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47442, 1194, 530, 10, 97, "Subsubsection",ExpressionUUID->"450dcc97-61db-4e31-9c0f-124c60bd5119"],
Cell[47975, 1206, 492, 13, 30, "Input",ExpressionUUID->"933a3393-d134-4bb8-b2af-cec7d8331ea8"],
Cell[48470, 1221, 2058, 48, 115, "Input",ExpressionUUID->"6aadee43-67db-449c-b919-08a2583c39d4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50577, 1275, 208, 4, 67, "Section",ExpressionUUID->"807eca65-8a98-491f-b204-40250f5b0b28"],
Cell[50788, 1281, 219, 5, 30, "Input",ExpressionUUID->"d4844678-b2c7-4a71-841e-e614d4156fe3"],
Cell[51010, 1288, 1066, 23, 30, "Input",ExpressionUUID->"33dc579d-8f76-4e16-893b-db37e09207b3"],
Cell[52079, 1313, 395, 9, 30, "Input",ExpressionUUID->"ee1656a5-399e-4536-83c1-d56d72c6a6ae"],
Cell[52477, 1324, 383, 9, 30, "Input",ExpressionUUID->"0f493189-1b9e-4a83-b13b-46c516622873"],
Cell[52863, 1335, 214, 4, 30, "Input",ExpressionUUID->"802be6d5-0037-43bc-a4ca-98454b39f5e8"],
Cell[CellGroupData[{
Cell[53102, 1343, 271, 4, 45, "Subsubsection",ExpressionUUID->"a167cf2d-745c-47df-aa07-bc5ad531e144"],
Cell[53376, 1349, 2601, 61, 94, "Input",ExpressionUUID->"39b08907-04ff-4b11-9432-f19fa6ebc4a1"],
Cell[55980, 1412, 1394, 37, 73, "Input",ExpressionUUID->"d879d268-f6b2-4cac-87e1-7f1d2b6d6dbd"],
Cell[57377, 1451, 634, 16, 30, "Input",ExpressionUUID->"1e9ab51d-4f87-4896-835b-7cb46cca2804"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58048, 1472, 257, 4, 45, "Subsubsection",ExpressionUUID->"0e9da3bb-694d-458f-898a-45e3788adb61"],
Cell[58308, 1478, 2532, 55, 178, "Input",ExpressionUUID->"b4b66255-f0dc-485a-b308-b20b0c366449"],
Cell[60843, 1535, 1223, 26, 94, "Input",ExpressionUUID->"0285ce90-a614-4ab8-992c-c7bdfee88214"],
Cell[62069, 1563, 1955, 44, 157, "Input",ExpressionUUID->"3540817a-39da-497a-b52e-4f2233a4b169"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64073, 1613, 261, 4, 67, "Section",ExpressionUUID->"d77d6a3b-305f-4e8c-bfc0-e65ef9e31158"],
Cell[64337, 1619, 1039, 24, 94, "Input",ExpressionUUID->"cbb2c81d-76d0-4526-8d31-831b40f9713b"],
Cell[65379, 1645, 996, 23, 52, "Input",ExpressionUUID->"b79c955e-e278-4c67-86b8-c5fb8a865ec3"],
Cell[66378, 1670, 3209, 72, 169, "Input",ExpressionUUID->"da296015-38fb-48ab-bef0-5c4a8cf7533d"],
Cell[69590, 1744, 654, 12, 30, "Input",ExpressionUUID->"2c098fba-0c32-4925-b4ed-e62604c80c05"],
Cell[70247, 1758, 648, 12, 30, "Input",ExpressionUUID->"49721c73-86c5-47f4-9636-1370b6ae9654"],
Cell[70898, 1772, 648, 12, 30, "Input",ExpressionUUID->"9f5ee7c2-69be-4451-b011-91aebdbb27e0"],
Cell[CellGroupData[{
Cell[71571, 1788, 346, 5, 45, "Subsubsection",ExpressionUUID->"7dda8604-a195-4310-a1a7-e355c25980c6"],
Cell[71920, 1795, 2680, 58, 94, "Input",ExpressionUUID->"c3d7a5b9-3d63-4f3a-b0a4-55ff23d41cee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74637, 1858, 385, 6, 45, "Subsubsection",ExpressionUUID->"7a0fe26e-6f27-4a90-b426-c811f397a2b2"],
Cell[75025, 1866, 1645, 35, 115, "Input",ExpressionUUID->"16ccfda4-e113-47af-9141-0eef296fe7ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76707, 1906, 309, 5, 45, "Subsubsection",ExpressionUUID->"3863d0e9-c72a-4a8b-9478-8e2fd361f2c3"],
Cell[77019, 1913, 545, 13, 94, "Input",ExpressionUUID->"97adc7fb-9b48-48e6-ba8b-ad33274acf30"],
Cell[77567, 1928, 836, 21, 30, "Input",ExpressionUUID->"5e18f3bb-ba11-41f7-9706-907ffafd9fa2"],
Cell[78406, 1951, 1359, 32, 73, "Input",ExpressionUUID->"3a72c6de-a709-43fa-98fc-3bc0281e83cb"],
Cell[79768, 1985, 367, 8, 30, "Input",ExpressionUUID->"3510b882-5ef4-4f3a-90d9-cfcd60bad075"],
Cell[80138, 1995, 213, 4, 30, "Input",ExpressionUUID->"af5733e0-8bad-4272-9351-fdf60021fbb9"],
Cell[80354, 2001, 1624, 32, 73, "Input",ExpressionUUID->"d4c968d2-fbde-4d61-a368-c82cd962a715"],
Cell[81981, 2035, 750, 17, 73, "Input",ExpressionUUID->"219f98bc-a117-4ebc-ac97-246cc2b7be52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82768, 2057, 482, 10, 123, "Subsubsection",ExpressionUUID->"e02da852-35b6-4233-ad67-789e87b44a63"],
Cell[83253, 2069, 5240, 138, 170, "Input",ExpressionUUID->"3b8e8e22-5d1a-4125-88f4-0438af22d134"],
Cell[88496, 2209, 2222, 59, 157, "Input",ExpressionUUID->"bc4eb215-ddcb-4709-831c-cd28426ca7b3"],
Cell[90721, 2270, 2821, 67, 157, "Input",ExpressionUUID->"886781c0-6b11-40f1-ad6f-d31dae3f7373"],
Cell[93545, 2339, 9877, 224, 346, "Input",ExpressionUUID->"94011b07-587b-44d0-a3d6-f647fb77b2a2"],
Cell[103425, 2565, 478, 10, 30, "Input",ExpressionUUID->"8c72469c-f71b-409a-a2c2-d76c4479a600"],
Cell[103906, 2577, 3450, 84, 178, "Input",ExpressionUUID->"bbb7caf3-9682-4773-99b5-845afe230134"],
Cell[107359, 2663, 2566, 65, 94, "Input",ExpressionUUID->"225d0ed4-9da4-4311-997a-4ca5e31cbdbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109962, 2733, 335, 5, 45, "Subsubsection",ExpressionUUID->"11a6a252-52b0-4645-a61f-450a1cb8e015"],
Cell[110300, 2740, 619, 13, 30, "Input",ExpressionUUID->"a5c1e262-4972-40c9-858a-f04bd932d23f"],
Cell[110922, 2755, 659, 13, 30, "Input",ExpressionUUID->"af90c1f1-d7f2-4739-8060-d2b6d7717637"],
Cell[111584, 2770, 428, 10, 30, "Input",ExpressionUUID->"f10eb7e4-24ad-44f7-8f39-49ecb2dde602"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112061, 2786, 398, 9, 105, "Section",ExpressionUUID->"4bdc7f57-87c0-4ca1-ae19-6e4eb0c87871"],
Cell[112462, 2797, 1213, 29, 94, "Input",ExpressionUUID->"c0c8b067-e4ac-4f58-ab01-8e6a5fa42fa4"],
Cell[113678, 2828, 646, 15, 30, "Input",ExpressionUUID->"847c5e1f-0182-40e9-a808-4a2c404b4bfa"],
Cell[114327, 2845, 584, 15, 30, "Input",ExpressionUUID->"7eeff714-c47f-4723-bf18-a2f595248945"],
Cell[114914, 2862, 17508, 432, 892, "Input",ExpressionUUID->"afaffa34-f3a5-4749-8ebd-a9e67e57a542"],
Cell[132425, 3296, 1779, 36, 73, "Input",ExpressionUUID->"23f0f017-220a-44fe-8750-be0344048a6c"],
Cell[134207, 3334, 436, 10, 30, "Input",ExpressionUUID->"951d6b7c-dfac-4b25-aa57-3c9fc8b92f92"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134680, 3349, 389, 6, 67, "Section",ExpressionUUID->"574f0a07-c033-4b37-b1b0-fd8105423ab8"],
Cell[135072, 3357, 465, 11, 30, "Input",ExpressionUUID->"13945da3-14fd-496e-91b5-849f282c5731"],
Cell[135540, 3370, 3924, 91, 367, "Input",ExpressionUUID->"b2a1b59a-6569-4026-aea7-5bdaf62d8d49"]
}, Open  ]]
}
]
*)


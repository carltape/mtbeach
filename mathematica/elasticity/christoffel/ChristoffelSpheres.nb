(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    120276,       2916]
NotebookOptionsPosition[    108873,       2742]
NotebookOutlinePosition[    109268,       2758]
CellTagsIndexPosition[    109225,       2755]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
ChristoffelSpheres.nb
run common_funs.nb, common_MTfuns.nb, ChooseTmat.nb\
\>", "Section",
 CellChangeTimes->{{3.9276254615057898`*^9, 
  3.927625469372057*^9}},ExpressionUUID->"59d4d812-4b2e-4186-9442-\
6826736b67df"],

Cell[CellGroupData[{

Cell["user choices", "Section",
 CellChangeTimes->{{3.9276254615057898`*^9, 3.927625469372057*^9}, {
  3.9276601920989237`*^9, 
  3.9276601948199377`*^9}},ExpressionUUID->"764a5bf6-cc27-4365-85e9-\
4479f8c529ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrintFigures", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.927626208034458*^9, 3.927626212297669*^9}, {
  3.927641540015386*^9, 3.927641540569346*^9}, {3.927644869705471*^9, 
  3.927644870093287*^9}},
 CellLabel->
  "In[10180]:=",ExpressionUUID->"d9ba5e55-6356-4aad-8bdc-9b9281b28509"],

Cell[CellGroupData[{

Cell["\<\
choose elastic map and density
to find the contours manually, you want to examine the vmin and vmax below\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
  3.927625527728416*^9, 
  3.9276255413255177`*^9}},ExpressionUUID->"cc08436a-72e8-4a48-a4cf-\
d97439428a3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", "=", "TmatBrownAn00"}], ";", 
  RowBox[{"xcontours", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2.8", ",", "8.4", ",", "0.4"}], "]"}]}], ";", 
  RowBox[{"density", "=", "2623"}], ";", 
  RowBox[{"incrementv", "=", "1"}], ";", 
  RowBox[{"isize", "=", "0.3"}], ";", " ", 
  RowBox[{"isizev", "=", "0.3"}], ";", " ", 
  RowBox[{"conminv", "=", "2"}], ";", 
  RowBox[{"conmaxv", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.927572113003128*^9, 3.927572117317361*^9}, 
   3.927625511975512*^9, {3.927626503448579*^9, 3.9276265041827927`*^9}, {
   3.927627534298695*^9, 3.927627534858808*^9}, {3.927628024286652*^9, 
   3.9276280411181707`*^9}, {3.927629535793385*^9, 3.9276295413725843`*^9}, {
   3.9276306088036013`*^9, 3.927630613305378*^9}, 3.927631122599928*^9, {
   3.927631583849873*^9, 3.927631599998171*^9}, 3.927636869118764*^9, {
   3.927637208209831*^9, 3.927637212077043*^9}, {3.927641208266265*^9, 
   3.927641210307341*^9}, {3.92764421092155*^9, 3.927644235670582*^9}, {
   3.92764550979132*^9, 3.927645511637508*^9}, {3.927647463523069*^9, 
   3.927647466203822*^9}, {3.92764839254725*^9, 3.927648394312962*^9}},
 CellLabel->
  "In[10181]:=",ExpressionUUID->"9499a352-0310-4c4d-be3a-e4e0bff24cad"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Tmat", "=", " ", "TmatIgel"}], ";", 
   RowBox[{"xcontours", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"2.5", ",", "11.5", ",", "0.5"}], "]"}]}], ";", 
   RowBox[{"density", "=", "1000"}], ";", 
   RowBox[{"incrementv", "=", "2"}], ";", 
   RowBox[{"isize", "=", "0.3"}], ";", 
   RowBox[{"isizev", "=", "0.25"}], ";", 
   RowBox[{"conminv", "=", "2"}], ";", 
   RowBox[{"conmaxv", "=", "12"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.927572113003128*^9, 3.927572117317361*^9}, 
   3.927625511975512*^9, {3.927626503448579*^9, 3.9276265041827927`*^9}, {
   3.927627486923215*^9, 3.927627489418063*^9}, {3.927627539219612*^9, 
   3.927627539805564*^9}, {3.927627571279804*^9, 3.9276275718387327`*^9}, {
   3.927628021052342*^9, 3.927628035982787*^9}, {3.927629118671701*^9, 
   3.927629123164963*^9}, 3.9276295291262293`*^9, {3.927630600540083*^9, 
   3.927630601992239*^9}, {3.9276311185741587`*^9, 3.927631121414055*^9}, {
   3.927631582327927*^9, 3.9276315909145327`*^9}, 3.9276368684601727`*^9, {
   3.927644197421163*^9, 3.927644198710836*^9}, {3.927648650922926*^9, 
   3.9276486532126637`*^9}},
 CellLabel->
  "In[10182]:=",ExpressionUUID->"0520d4ed-ced5-4a99-9ccf-19d274c3ee77"]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose a \[CapitalSigma] (XISO, TET, etc)for the reference \
orientation", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
  3.927625527728416*^9, 3.9276255413255177`*^9}, {3.927655474784912*^9, 
  3.9276554990076103`*^9}},ExpressionUUID->"4a0048ff-7f8e-49f7-a365-\
98e2c7028415"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "XISO"}], ";"}]], "Input",
 CellChangeTimes->{{3.9276526671543493`*^9, 3.927652670555222*^9}, 
   3.9276554656440372`*^9, {3.927657084696368*^9, 3.927657085137282*^9}, {
   3.927659044541614*^9, 3.927659044901167*^9}, {3.927659154102602*^9, 
   3.927659154441086*^9}, {3.92765926360709*^9, 3.927659264068737*^9}, {
   3.927659321906857*^9, 3.927659322296084*^9}, {3.927659388839884*^9, 
   3.927659389244091*^9}, {3.927659520437399*^9, 3.9276595206594753`*^9}, {
   3.927660012064712*^9, 3.927660012538032*^9}},
 CellLabel->
  "In[10183]:=",ExpressionUUID->"6c0d6afc-c1e6-4de7-b3a1-c6000cd1f24c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat\[CapitalSigma]", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], ";", 
  RowBox[{"Uref", "=", 
   RowBox[{"UT", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[10184]:=",ExpressionUUID->"aa5acef0-10d5-4c47-bb11-95893ace1a5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat0", "=", "Tmat"}], ";"}]], "Input",
 CellChangeTimes->{{3.927647963110652*^9, 3.9276479652887897`*^9}},
 CellLabel->
  "In[10185]:=",ExpressionUUID->"0cf229da-7154-4bbc-8356-19cebb8ea6fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["if you want the plots for closest-\[CapitalSigma]-map rather than for \
T", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
   3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
   3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
   3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
   3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
   3.927625527728416*^9, 3.9276255413255177`*^9}, {3.927646076577635*^9, 
   3.9276460804402447`*^9}, {3.927647233034246*^9, 3.927647240509797*^9}, {
   3.927650710452507*^9, 3.9276507110281687`*^9}, 3.9276519539450827`*^9, {
   3.927652018499457*^9, 3.9276520220547323`*^9}, {3.927655503835289*^9, 
   3.927655512002914*^9}, 
   3.9276581186053*^9},ExpressionUUID->"e3be44bf-4e8b-4387-bf47-067c7b658807"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UseSigma", "=", "False"}], ";"}]], "Input",
 CellChangeTimes->{{3.927657232847303*^9, 3.927657235664661*^9}, {
  3.927659150155045*^9, 3.927659150692155*^9}, {3.927659266768255*^9, 
  3.927659267225005*^9}, {3.927660015302328*^9, 3.927660015852816*^9}},
 CellLabel->
  "In[10186]:=",ExpressionUUID->"25224e18-1f10-44f8-90c8-08fd2dc6246e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"UseSigma", ",", 
   RowBox[{
    RowBox[{"Tmat", "=", "Tmat\[CapitalSigma]"}], ";", 
    RowBox[{
     RowBox[{"MatrixNote", "[", "Tmat", "]"}], "=", 
     RowBox[{
      RowBox[{"MatrixNote", "[", "Tmat0", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[CapitalSigma]", "]"}]}]}], ";"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9276507124187317`*^9, 3.9276507179715443`*^9}, {
  3.927650843271389*^9, 3.927650862316845*^9}, {3.927650900441063*^9, 
  3.9276509065383368`*^9}, {3.927651101048053*^9, 3.9276511048418083`*^9}, {
  3.92765161831243*^9, 3.9276516422659807`*^9}, {3.927651712497448*^9, 
  3.927651741731889*^9}, {3.927651843485463*^9, 3.9276518435786257`*^9}, {
  3.927652389784525*^9, 3.927652409251472*^9}, {3.9276526900893106`*^9, 
  3.927652708244609*^9}, {3.927657237286811*^9, 3.9276572548318253`*^9}},
 CellLabel->
  "In[10187]:=",ExpressionUUID->"75a2e835-7c1b-430e-b4e4-ada995e678d0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminaries", "Section",
 CellChangeTimes->{{3.9276254615057898`*^9, 3.927625469372057*^9}, {
  3.927660183143585*^9, 
  3.92766018574354*^9}},ExpressionUUID->"e4473182-0fc7-44b5-966b-\
848c0f78eca9"],

Cell[CellGroupData[{

Cell["check symmetry of elastic map", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.9276254970012817`*^9}, {
  3.927625527728416*^9, 3.9276255413255177`*^9}, {3.927646076577635*^9, 
  3.9276460804402447`*^9}},ExpressionUUID->"f1573f09-aae1-4263-a86b-\
72a746014752"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DeriveSymGp", "[", "Tmat", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9273957755126247`*^9, 3.927395783131043*^9}, {
  3.9273958665504932`*^9, 3.9273958670993032`*^9}, {3.9273966576165113`*^9, 
  3.9273966625598392`*^9}, {3.927401376825039*^9, 3.927401393834277*^9}, {
  3.9274015836696672`*^9, 3.92740158593615*^9}, {3.927625653522728*^9, 
  3.9276256540654793`*^9}},
 CellLabel->
  "In[10188]:=",ExpressionUUID->"62724fb3-b6bb-45a8-96c0-7caba147800d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DeriveSymGp", "[", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "XISO"}], "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.927401588974114*^9, 3.927401591300161*^9}, {
  3.927625656976873*^9, 3.927625657559164*^9}},
 CellLabel->
  "In[10189]:=",ExpressionUUID->"d996a1ee-cd80-4aa6-9023-7b56097f2d03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["convert to Voigt", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 
  3.927625520040167*^9}},ExpressionUUID->"964489cb-4ddb-461e-827b-\
1e373d08a457"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cmat", "=", 
   RowBox[{"CmatOfTmat", "[", "Tmat", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.927315210316649*^9, 3.9273152140883837`*^9}, {
   3.927316199428961*^9, 3.927316200922818*^9}, {3.9273163008160133`*^9, 
   3.9273163129079437`*^9}, 3.927395304429574*^9, 3.9273979054286118`*^9, {
   3.9274523147331057`*^9, 3.9274523282699327`*^9}, {3.927571656665818*^9, 
   3.927571676956876*^9}, {3.9275721206192093`*^9, 3.927572125931623*^9}, {
   3.927572275187263*^9, 3.9275722784167128`*^9}, {3.9275736154848623`*^9, 
   3.9275736187637053`*^9}, {3.927573773458354*^9, 3.927573775689727*^9}, {
   3.927574022629644*^9, 3.927574027408889*^9}, 3.927625511020493*^9},
 CellLabel->
  "In[10190]:=",ExpressionUUID->"c69f2d97-094d-4323-8412-6ce582de2fba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["print figures to file", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625485540309*^9, 3.927625520040167*^9}, {
  3.927626362690854*^9, 
  3.927626367551813*^9}},ExpressionUUID->"0055b19f-9f3b-41e0-a5ab-\
f5390c048119"],

Cell[BoxData[{
 RowBox[{"MatrixNote", "[", "Tmat", 
  "]"}], "\[IndentingNewLine]", "mdir", "\[IndentingNewLine]", 
 RowBox[{"odir", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"mdir", ",", "\"\<pdf_print\>\""}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"otag", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"odir", ",", 
     RowBox[{"\"\<ChristoffelSpheres_\>\"", "<>", 
      RowBox[{"Tlab", "[", "Tmat", "]"}], "<>", "\"\<_\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.910905503104602*^9, 3.9109055517441063`*^9}, {
  3.9109055854938517`*^9, 3.910905615711937*^9}, {3.910911744107761*^9, 
  3.910911744897134*^9}, {3.912276758251253*^9, 3.9122768067916718`*^9}, {
  3.91310947800861*^9, 3.91310948659916*^9}, {3.9219165176143637`*^9, 
  3.921916518176425*^9}, {3.925605047382234*^9, 3.9256050606854143`*^9}, {
  3.927626375158948*^9, 3.9276263787455797`*^9}},
 CellLabel->
  "In[10191]:=",ExpressionUUID->"cd28920b-f0f1-4678-ac1b-8cec14c0ec5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose color palette for Christoffel spheres ", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.9276449633632507`*^9, 
  3.927644963392454*^9}},ExpressionUUID->"e9451361-ca9d-4da1-af7c-\
62d312663b62"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"DensityPlot", "[", 
           RowBox[{"y", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"ColorFunction", "->", 
             RowBox[{"ColorData", "[", "palette", "]"}]}], ",", 
            RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
            RowBox[{"PlotRangePadding", "->", "0"}], ",", 
            RowBox[{"Frame", "->", "False"}], ",", 
            RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "120"}], ",", 
          RowBox[{"BaselinePosition", "->", "Center"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"FrameTicks", "->", "None"}], ",", 
          RowBox[{"FrameStyle", "->", "Gray"}], ",", 
          RowBox[{"FrameLabel", "->", "palette"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"palette", ",", 
          RowBox[{"ColorData", "[", "\"\<Gradients\>\"", "]"}]}], "}"}]}], 
       "]"}], ",", "4", ",", "4", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"ImageSize", "->", "800"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9275734862866*^9, 3.9275735520279503`*^9}},
 CellLabel->
  "In[10195]:=",ExpressionUUID->"47e6e34d-e9f9-4862-b5b3-e18ddfb8787c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvel", "=", "\"\<Rainbow\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.927572681513842*^9, 3.9275726859415627`*^9}, {
  3.927573554656719*^9, 3.927573555126149*^9}, {3.927573669639818*^9, 
  3.927573670168602*^9}},
 CellLabel->
  "In[10196]:=",ExpressionUUID->"26288248-2838-449d-9ca0-97b0f44f1819"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display output", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625602117004*^9, 
  3.927625603364086*^9}},ExpressionUUID->"5ba5e1c6-59cf-4908-983d-\
145b47c25204"],

Cell[BoxData[
 RowBox[{"PrintVoigt", "[", "Tmat", "]"}]], "Input",
 CellChangeTimes->{{3.927562632757736*^9, 3.927562635868886*^9}, {
   3.927571660565731*^9, 3.927571667363922*^9}, 3.927572107399871*^9},
 CellLabel->
  "In[10197]:=",ExpressionUUID->"9c43b048-b1ce-44fa-ae2f-7615fcf6b541"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display the closest-ISO map", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927625441323547*^9, 
  3.927625451261591*^9}, {3.927625602117004*^9, 
  3.927625638387806*^9}},ExpressionUUID->"dcf2479e-0e3e-43dd-8da6-\
54a9612a79b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatISO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "ISO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatISO", "=", 
   RowBox[{"CmatOfTmat", "[", 
    RowBox[{"Closest", "[", 
     RowBox[{"Tmat", ",", "ISO"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "CmatISO", "]"}]}], "Input",
 CellChangeTimes->{{3.927622723519618*^9, 3.92762274231504*^9}, {
  3.927639483177321*^9, 3.9276394831785717`*^9}, {3.927639644346583*^9, 
  3.92763965281987*^9}},
 CellLabel->
  "In[10198]:=",ExpressionUUID->"35f2fc3e-0eec-44bb-93b6-d95891d1a62f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelMatrixTP", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "Cmat_"}], "]"}], ":=", 
   RowBox[{"ChristoffelMatrix", "[", 
    RowBox[{
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], ",", "Cmat"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "Cmat_"}], "]"}], ":=", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"ChristoffelMatrixTP", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.927314693969733*^9, 3.9273147508382587`*^9}, {
  3.9275408780599537`*^9, 3.927540884500498*^9}, {3.9275425916000977`*^9, 
  3.9275425962993402`*^9}, {3.927571704506083*^9, 3.927571705963903*^9}},
 CellLabel->
  "In[10201]:=",ExpressionUUID->"e45f5643-798a-4733-8f32-312bf9cfcbc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesOfChristoffelMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "Cmat_"}], "]"}], ":=", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"ChristoffelMatrix", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cmat"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.927465852430591*^9, 3.9274658747449803`*^9}, {
  3.9274659166588664`*^9, 3.927465928714483*^9}, {3.927490795652926*^9, 
  3.9274908052219763`*^9}, {3.927571706574441*^9, 3.9275717070327263`*^9}},
 CellLabel->
  "In[10203]:=",ExpressionUUID->"9ab8f89b-d4ac-4ac4-9472-c6e16f2a56cb"],

Cell[BoxData[
 RowBox[{"EigenvaluesOfChristoffelMatrix", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "Cmat"}], "]"}]], "Input",
 CellChangeTimes->{{3.927491032414466*^9, 3.9274910384146137`*^9}, 
   3.927571708215535*^9},
 CellLabel->
  "In[10204]:=",ExpressionUUID->"e9d346e7-e9b6-4261-9de8-cb6f07677cfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "velocities for closest ISO, km/s (assumes Cij in GPa and density in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"kg", "/", 
    SuperscriptBox[
     StyleBox["m",
      FontSlant->"Plain"], "3"]}], TraditionalForm]],
  CellChangeTimes->{{3.927451115906128*^9, 3.927451209662067*^9}, {
   3.927451360775897*^9, 3.927451365573579*^9}, {3.9274514750759697`*^9, 
   3.927451475546459*^9}, {3.9274523229562387`*^9, 3.927452322958305*^9}, {
   3.927548224720563*^9, 3.927548225008848*^9}, {3.927557817515873*^9, 
   3.9275578213283587`*^9}, {3.92757171800887*^9, 3.92757171974155*^9}},
  ExpressionUUID->"ff5afeb4-b2b1-4a7e-b36e-84f5677ff80b"],
 ")"
}], "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 3.9275483689461603`*^9}, {3.927641423326644*^9, 
  3.9276414561794777`*^9}},ExpressionUUID->"688cb66b-2a97-43fb-a615-\
13fc7e841112"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VPofTmatISO", "[", 
   RowBox[{"TmatISO_", ",", "density_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Kappa]ofTmatISO", "[", "TmatISO", "]"}], "+", 
        RowBox[{
         FractionBox["4", "3"], 
         RowBox[{"\[Mu]ofTmatISO", "[", "TmatISO", "]"}]}]}], ")"}], 
      SuperscriptBox["10", "9"]}], "density"]], "/", 
   SuperscriptBox["10", "3"]}]}]], "Input",
 CellChangeTimes->{{3.927637424162732*^9, 3.927637430002817*^9}, {
  3.92763928137774*^9, 3.927639293258452*^9}, {3.927639403638598*^9, 
  3.927639418489287*^9}, {3.927641387681588*^9, 3.927641416872486*^9}},
 CellLabel->
  "In[10205]:=",ExpressionUUID->"33b36b06-6ceb-4097-92be-68b4a4a2ce89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VSofTmatISO", "[", 
   RowBox[{"TmatISO_", ",", "density_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"\[Mu]ofTmatISO", "[", "TmatISO", "]"}], 
      SuperscriptBox["10", "9"]}], "density"]], "/", 
   SuperscriptBox["10", "3"]}]}]], "Input",
 CellChangeTimes->{
  3.927637440668151*^9, {3.927639424779504*^9, 3.9276394504029837`*^9}, 
   3.9276414207029057`*^9, 3.927641475786503*^9},
 CellLabel->
  "In[10206]:=",ExpressionUUID->"fb194081-e7ac-4d2c-8945-eb519094d924"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vp0", "=", 
   RowBox[{"VPofTmatISO", "[", 
    RowBox[{"TmatISO", ",", "density"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vs0", "=", 
   RowBox[{"VSofTmatISO", "[", 
    RowBox[{"TmatISO", ",", "density"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stV", "=", 
   RowBox[{"\"\<Vp \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"NumberForm", "[", 
      RowBox[{"vp0", ",", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
    "\"\<, Vs \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"NumberForm", "[", 
      RowBox[{"vs0", ",", 
       RowBox[{"{", 
        RowBox[{"Infinity", ",", "2"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"stV", " ", "<>", " ", "\"\< km/s\>\""}]}], "Input",
 CellChangeTimes->{{3.9276394620743113`*^9, 3.927639465070635*^9}, {
  3.927639671924115*^9, 3.927639686703002*^9}, {3.927641502930616*^9, 
  3.927641507453211*^9}, {3.927644408881432*^9, 3.927644425862913*^9}, {
  3.92764468533561*^9, 3.92764468978969*^9}, {3.927644823720747*^9, 
  3.927644861457128*^9}},
 CellLabel->
  "In[10207]:=",ExpressionUUID->"5737d25c-1085-4b32-8f90-f2df91ffc111"]
}, Open  ]],

Cell[CellGroupData[{

Cell["minimum and maximum eigenvalues", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927548364474094*^9, 
  3.9275483689461603`*^9}},ExpressionUUID->"c6209ac5-4aca-46a0-80b4-\
12bb0397e91d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxEigenvalueResult", "=", 
   RowBox[{"Maximize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], "]"}], ",", 
       
       RowBox[{
        RowBox[{"0", "<=", "\[Theta]", "<=", "\[Pi]"}], "&&", 
        RowBox[{"0", "<=", "\[Phi]", "<=", 
         RowBox[{"2", " ", "\[Pi]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minEigenvalueResult", "=", 
   RowBox[{"Minimize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], "]"}], ",", 
       
       RowBox[{
        RowBox[{"0", "<=", "\[Theta]", "<=", "\[Pi]"}], "&&", 
        RowBox[{"0", "<=", "\[Phi]", "<=", 
         RowBox[{"2", " ", "\[Pi]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.927543034875354*^9, 3.9275430781415777`*^9}, {
  3.927543432450995*^9, 3.927543459012227*^9}, {3.9275478732829027`*^9, 
  3.9275478832309103`*^9}, {3.927548112477221*^9, 3.9275481153811817`*^9}, {
  3.927571709661747*^9, 3.9275717098993073`*^9}},
 CellLabel->
  "In[10211]:=",ExpressionUUID->"fee46e49-7817-4bc9-8ac8-4e915f797a09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emax", "=", 
   RowBox[{"maxEigenvalueResult", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"emin", "=", 
   RowBox[{"minEigenvalueResult", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"thetamax", ",", "phimax"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "/.", " ", 
    RowBox[{"maxEigenvalueResult", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"thetamin", ",", "phimin"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "/.", " ", 
    RowBox[{"minEigenvalueResult", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Max eigenvalue is \>\"", ",", "emax", ",", "\"\< for theta = \>\"", 
   ",", 
   RowBox[{"thetamax", " ", "/", "Degree"}], ",", "\"\<, phi = \>\"", ",", 
   RowBox[{"phimax", " ", "/", "Degree"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Min eigenvalue is \>\"", ",", "emin", ",", "\"\< for theta = \>\"", 
   ",", 
   RowBox[{"thetamin", " ", "/", "Degree"}], ",", "\"\<, phi = \>\"", ",", 
   RowBox[{"phimin", " ", "/", "Degree"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
  RowBox[{"thetamax", ",", "phimax", ",", "Cmat"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
  RowBox[{"thetamin", ",", "phimin", ",", "Cmat"}], "]"}]}], "Input",
 CellChangeTimes->{{3.927547895949696*^9, 3.9275481228952217`*^9}, {
  3.927571712039295*^9, 3.927571714813079*^9}},
 CellLabel->
  "In[10073]:=",ExpressionUUID->"1de38f8f-130f-41ef-8182-7310ba777150"]
}, Open  ]],

Cell[CellGroupData[{

Cell["get velocities from eigenvalues of Christoffel matrix", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}, {3.927548267389008*^9, 3.927548273632464*^9}, {
  3.927630957556481*^9, 
  3.9276309599994307`*^9}},ExpressionUUID->"d2987021-d9ee-46a7-9581-\
019b5d2dc577"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"vels", "[", 
    RowBox[{"eigs_", ",", "density_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eigs", " ", 
        SuperscriptBox["10", "9"]}], ")"}], "/", "density"}]], "/", 
    "1000"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.927315259363559*^9, 3.927315368569132*^9}, {
  3.927315414794742*^9, 3.927315459414472*^9}, {3.927315514127232*^9, 
  3.927315569128357*^9}, {3.9273980956564074`*^9, 3.9273980967115097`*^9}, {
  3.927451464172656*^9, 3.927451477858079*^9}, {3.927452322953746*^9, 
  3.927452322954529*^9}},
 CellLabel->
  "In[10081]:=",ExpressionUUID->"ccd1d429-873e-4ab1-afc6-12810e2440e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   FormBox[
    StyleBox[
     RowBox[{
      RowBox[{"assumes", " ", "Cij", " ", 
       RowBox[{"(", 
        RowBox[{"and", " ", "eigs"}], ")"}], " ", "in", " ", "GPa"}], ",", 
      " ", 
      RowBox[{"density", " ", "in", " ", 
       RowBox[{"kg", "/", 
        SuperscriptBox[
         StyleBox["m",
          FontSlant->"Plain"], "3"]}]}], ",", " ", 
      RowBox[{"vels", " ", "in", " ", 
       RowBox[{"km", "/", "s"}]}]}],
     FontColor->RGBColor[1, 0, 0]],
    TraditionalForm], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"velsTP", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "Cmat_", ",", "density_"}], 
    "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"EigenvaluesOfChristoffelMatrixTP", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat"}], "]"}], " ", 
        SuperscriptBox["10", "9"]}], ")"}], "/", "density"}]], "/", "1000", 
    " "}]}]}]], "Input",
 CellChangeTimes->{{3.927451115906128*^9, 3.927451209662067*^9}, {
  3.927451360775897*^9, 3.927451365573579*^9}, {3.9274514750759697`*^9, 
  3.927451475546459*^9}, {3.9274523229562387`*^9, 3.927452322958305*^9}, {
  3.927548224720563*^9, 3.927548225008848*^9}, {3.927557817515873*^9, 
  3.9275578213283587`*^9}, {3.92757171800887*^9, 3.92757171974155*^9}, {
  3.927641461233449*^9, 3.927641465079455*^9}},
 CellLabel->
  "In[10082]:=",ExpressionUUID->"683f1804-9496-4d22-a08d-a54308bc7373"],

Cell[BoxData[{
 RowBox[{"velsTP", "[", 
  RowBox[{"thetamax", ",", "phimax", ",", "Cmat", ",", "density"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"velsTP", "[", 
  RowBox[{"thetamin", ",", "phimin", ",", "Cmat", ",", "density"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vmax", "=", 
  RowBox[{"Max", "[", 
   RowBox[{"velsTP", "[", 
    RowBox[{"thetamax", ",", "phimax", ",", "Cmat", ",", "density"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"vmin", "=", 
  RowBox[{"Min", "[", 
   RowBox[{"velsTP", "[", 
    RowBox[{"thetamin", ",", "phimin", ",", "Cmat", ",", "density"}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.927548339961343*^9, 3.9275483431004477`*^9}, {
  3.927557824382313*^9, 3.927557827658609*^9}, {3.927571720788306*^9, 
  3.927571722072023*^9}},
 CellLabel->
  "In[10083]:=",ExpressionUUID->"727c504c-687f-481c-8406-2c409d2f01ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vels", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "Cmat_", ",", 
    "density_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"EigenvaluesOfChristoffelMatrix", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cmat"}], "]"}], " ", 
       SuperscriptBox["10", "9"]}], ")"}], "/", "density"}]], "/", "1000", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.92755784764541*^9, 3.9275578597320538`*^9}, {
  3.927571722984304*^9, 3.927571727948886*^9}},
 CellLabel->
  "In[10087]:=",ExpressionUUID->"a67b50a3-3dd6-4729-aa23-940cf612345d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test function", "Section",
 CellChangeTimes->{{3.927542409165701*^9, 
  3.927542410572926*^9}},ExpressionUUID->"e0ed86d8-bbfb-478e-8b23-\
980728f368f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"radius", "=", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.9275417146715517`*^9, 3.927541717108988*^9}, 
   3.927563983413767*^9, {3.927574440345656*^9, 3.927574440479261*^9}},
 CellLabel->
  "In[10088]:=",ExpressionUUID->"efb1db04-4be8-4053-9b70-81163b25eea3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FakeEigenvalueFn", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"radius", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{".5", 
       RowBox[{"Cos", "[", 
        RowBox[{"3", " ", 
         RowBox[{"Theta", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"Phi", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}]}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9274665595574694`*^9, 3.927466594180888*^9}, {
  3.927466643485673*^9, 3.9274667263962746`*^9}, {3.927467073961342*^9, 
  3.927467080314502*^9}, {3.92747089696459*^9, 3.927470897703573*^9}, {
  3.9274711723010893`*^9, 3.927471174344078*^9}, {3.927471213716225*^9, 
  3.927471214423504*^9}, {3.9274718679735093`*^9, 3.9274718689795637`*^9}, {
  3.927541719725685*^9, 3.9275417247816896`*^9}},
 CellLabel->
  "In[10089]:=",ExpressionUUID->"0e334b07-23bd-4f58-aee7-dd1bf956ecee"],

Cell[BoxData[
 RowBox[{"FakeEigenvalueFn", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3."}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9274670545340166`*^9, 3.927467055879645*^9}, 
   3.9274681853606586`*^9},
 CellLabel->
  "In[10090]:=",ExpressionUUID->"f3d0dac4-89fe-4f51-be11-d7df780b509e"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Inputs of SpherePolyList are in degrees",
 FontColor->RGBColor[1, 0, 1]]], "Subsubsection",
 CellChangeTimes->{{3.9274658146806445`*^9, 3.927465841091202*^9}, {
  3.927465992028285*^9, 3.9274660136052732`*^9}, {3.9274661466577206`*^9, 
  3.9274661868549304`*^9}, {3.9274663586009426`*^9, 3.927466369591963*^9}, {
  3.927466746769907*^9, 3.9274667504629107`*^9}, {3.9274703603028336`*^9, 
  3.927470362014451*^9}},ExpressionUUID->"94565e05-bb2c-4dc4-85f2-\
20a2c0f90d5b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"SpherePolyList", "[", 
   RowBox[{
   "\[Rho]_", ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "\[Phi]1_", ",", 
    "\[Phi]2_", ",", "\[CapitalDelta]\[Theta]_", ",", 
    "\[CapitalDelta]\[Phi]_"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.927540917641247*^9, 3.927540920545684*^9}},
 CellLabel->
  "In[10091]:=",ExpressionUUID->"fdbeaeb2-9591-4912-a9df-6ed0ab0f4957"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define axes for 3D plots", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275410872515707`*^9, 
  3.927541091386294*^9}},ExpressionUUID->"d6728993-c44e-4aa3-abbd-\
872f10b1eb94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SpherePolyList", "[", 
   RowBox[{
   "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "15.", ",", "15."}], 
   "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FakeEigenvalueFn", "/@", "%"}]}], "Input",
 CellChangeTimes->{{3.9274668775743237`*^9, 3.9274668786491423`*^9}, {
  3.927466922495366*^9, 3.9274669243015847`*^9}, {3.9274671962970715`*^9, 
  3.927467208647416*^9}, {3.9274672622689323`*^9, 3.9274672841845064`*^9}, {
  3.927467319095433*^9, 3.9274673313058405`*^9}, {3.927541138291629*^9, 
  3.927541164466412*^9}, {3.927541196401599*^9, 3.927541198555036*^9}},
 CellLabel->
  "In[10092]:=",ExpressionUUID->"b9784432-d5b4-4238-917d-bffc3aaeaf09"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calling axes will reevaluate based on an updated radius value\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.927628518113895*^9, 
  3.927628536699009*^9}},ExpressionUUID->"f4a5be9a-8718-41e7-90c4-\
a50097b7a8d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lengthAxis", ":=", 
   RowBox[{"2", " ", "radius"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBrad", ":=", "radius"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowScale", ":=", 
    RowBox[{".3", " ", "radius"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Paxes", "[", 
    RowBox[{
    "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
     ",", "BBrad_", ",", "ArrowScale_", ",", "tkns_", ",", "WantArrowColor_", 
     ",", "ArrowColor_"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axes", ":=", 
   RowBox[{"Paxes", "[", 
    RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "lengthAxis", ",", 
     "BBrad", ",", "ArrowScale", ",", ".015", ",", "\"\<TriColor\>\"", ",", 
     "ArrowColor"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9274709669022675`*^9, 3.9274709750680094`*^9}, 
   3.927471127476002*^9, 3.9274712587439165`*^9, {3.9274713457589684`*^9, 
   3.9274713466228313`*^9}, 3.9274714289888268`*^9, {3.9275412430218477`*^9, 
   3.927541280650588*^9}, {3.927541776296599*^9, 3.9275418004557343`*^9}, {
   3.927624461955289*^9, 3.927624473803195*^9}},
 CellLabel->
  "In[10094]:=",ExpressionUUID->"03d87e71-e679-4b86-ab56-becb89fd987c"]
}, Open  ]],

Cell["\<\
The key is that you change the radius  from 1 to FakeEigenvalueFn[{x, y, z}]\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 
  3.9274723722090254`*^9}},ExpressionUUID->"b52ce693-8f0e-44e5-918d-\
10faa6c6b7ab"],

Cell["\<\
Change Opacity if you want. Make SectionRadius = 0 if you do not want section.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275603605941086`*^9, 
  3.927560372049997*^9}, {3.927560973431476*^9, 
  3.9275609964160547`*^9}},ExpressionUUID->"8ac89f76-bd89-4f07-b398-\
8bb7570ca8e2"],

Cell[CellGroupData[{

Cell["\<\
The rotation matrix U specifies the section.
The first and second columns of U give an orthonormal basis for the section \
plane.
For example U = identity gives the xy plane as the section.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.9275603605941086`*^9, 
  3.927560372049997*^9}, {3.927560973431476*^9, 3.9275609964160547`*^9}, {
  3.927562575370353*^9, 3.927562706752246*^9}, {3.92762855662434*^9, 
  3.927628561151073*^9}},ExpressionUUID->"aa5c798a-d7ed-4148-9b72-\
2b793467723a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Uxy", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "1", "0"},
      {"0", "0", "1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Uxz", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "0", 
       RowBox[{"-", "1"}]},
      {"0", "1", "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Uyz", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", "1"},
      {"1", "0", "0"},
      {"0", "1", "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Utest", "=", 
   RowBox[{"XRot", "[", 
    RowBox[{"30", "Degree"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927574295806212*^9, 3.927574325824071*^9}, {
  3.927624152036934*^9, 3.927624175781966*^9}},
 CellLabel->
  "In[10098]:=",ExpressionUUID->"310c6695-95cc-4315-b94d-7d634fed4ad8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenvalueSurface", "[", 
   RowBox[{
   "FakeEigenvalueFn_", ",", "U_", ",", "SectionRadius_", ",", "eye_"}], 
   "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Opacity", "[", ".7", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"FakeEigenvalueFn", "[", "#", "]"}], "#"}], "&"}], ",", 
           RowBox[{"SpherePolyList", "[", 
            RowBox[{
            "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5.", ",", 
             "5."}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Polygon", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SectionRadius", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], ")"}]}], "&"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}], ",", 
          RowBox[{".02", "\[Pi]"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ViewPoint", "->", "eye"}], ",", 
    RowBox[{"ImageSize", "->", "250"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9275594881939936`*^9, 3.9275594943196626`*^9}, {
   3.9275595257513275`*^9, 3.9275595697062635`*^9}, {3.9275596035637007`*^9, 
   3.9275596440947123`*^9}, {3.9275596767717934`*^9, 
   3.9275596911294765`*^9}, {3.9275597285043077`*^9, 3.927559831594392*^9}, {
   3.9275599064606457`*^9, 3.9275599424702377`*^9}, {3.927560217191101*^9, 
   3.927560237244731*^9}, 3.9275602712645617`*^9, 3.9275605256900845`*^9, {
   3.9275609063223453`*^9, 3.9275609150078926`*^9}, {3.927561766186644*^9, 
   3.927561795215288*^9}, {3.927562233362937*^9, 3.9275622372883787`*^9}, {
   3.9275639996979713`*^9, 3.9275640016901608`*^9}, {3.9275745548600407`*^9, 
   3.92757455554875*^9}},
 CellLabel->
  "In[10102]:=",ExpressionUUID->"852f68a4-9c40-477f-a316-a279abc81327"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"30", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"30.", "Degree"}], ",", 
        RowBox[{"65.", "Degree"}]}], "}"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SectionRadius", "=", 
    RowBox[{"1.5", " ", "radius"}]}], ";", "\[IndentingNewLine]", "PrintEye", 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Uxy", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Uxz", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Uyz", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{
     "FakeEigenvalueFn", ",", "Utest", ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"EigenvalueSurface", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Utest", ",", "SectionRadius", ",", 
      RowBox[{"30", 
       RowBox[{"Utest", ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9275599656457415`*^9, 3.927559971410331*^9}, {
   3.9275600166795197`*^9, 3.927560017904752*^9}, 3.9275600526273556`*^9, {
   3.9275601188265038`*^9, 3.9275601281437387`*^9}, 3.927560169930709*^9, {
   3.927560386375967*^9, 3.927560498290663*^9}, {3.9275605512643766`*^9, 
   3.927560554956374*^9}, {3.927560658648012*^9, 3.927560693999866*^9}, {
   3.9275607466381736`*^9, 3.927560748788352*^9}, {3.9275609252200947`*^9, 
   3.927560955006311*^9}, {3.927561444021969*^9, 3.9275614457496185`*^9}, 
   3.9275619029796953`*^9, {3.927561960843696*^9, 3.927561993928056*^9}, {
   3.9275620363864994`*^9, 3.927562066376152*^9}, {3.9275622595819674`*^9, 
   3.927562284019062*^9}, {3.927562328972741*^9, 3.9275623578440733`*^9}, {
   3.9275623900481677`*^9, 3.9275623984343567`*^9}, {3.927564030003574*^9, 
   3.92756403028691*^9}, {3.92757432883354*^9, 3.9275743391085367`*^9}, {
   3.927574476561685*^9, 3.9275744775306587`*^9}, {3.927624181244618*^9, 
   3.9276242015170927`*^9}, {3.9276590750984077`*^9, 3.927659077673341*^9}},
 CellLabel->
  "In[10103]:=",ExpressionUUID->"0606c1dc-567d-4615-ab82-16d0b7645912"],

Cell[BoxData[
 RowBox[{
  RowBox[{"section", "[", 
   RowBox[{"FakeEigenvalueFn_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FakeEigenvalueFn", "[", "#", "]"}], "#"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"U", ".", 
            RowBox[{"ZRot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", "\[Pi]"}], ",", 
            RowBox[{".02", "\[Pi]"}]}], "]"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"ViewPoint", "->", 
     RowBox[{"30", 
      RowBox[{"U", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ImageSize", "->", "150"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927561243251502*^9, 3.927561333269188*^9}, {
  3.927561369623223*^9, 3.9275613774911804`*^9}, {3.927574515411446*^9, 
  3.927574516096929*^9}},
 CellLabel->
  "In[10104]:=",ExpressionUUID->"cc97e413-02d5-4fb6-9bc5-729dcac7da16"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Uxy"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Uxz"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", "Uyz"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"section", "[", 
     RowBox[{"FakeEigenvalueFn", ",", 
      RowBox[{"XRot", "[", 
       RowBox[{"30", "Degree"}], "]"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9275614211163664`*^9, 3.927561469660986*^9, {3.927561540493755*^9, 
   3.92756159441514*^9}, {3.927561638231674*^9, 3.9275616569230237`*^9}, {
   3.9275620889019423`*^9, 3.9275620996168385`*^9}, {3.927574388349403*^9, 
   3.927574407184965*^9}, 3.927644293564529*^9},
 CellLabel->
  "In[10105]:=",ExpressionUUID->"50c76194-58a3-4cb6-abc1-14eb5adffa62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The PolarPlot of rr[\[Theta], U] should give you what you want.  
It will show the plane section determined by U\[CenterDot]{1,0,0} and U\
\[CenterDot]{0,1,0}.   
In the polar plot, U\[CenterDot]{1,0,0} will point to the right and U\
\[CenterDot]{0,1,0} will point up.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9275943404714613`*^9, 3.9275945169951715`*^9}, {
  3.9275946086329956`*^9, 3.9275947342514067`*^9}, {3.927595217289266*^9, 
  3.927595220835821*^9}},ExpressionUUID->"450dcc97-61db-4e31-9c0f-\
124c60bd5119"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rr", "[", 
   RowBox[{"\[Theta]_", ",", "U_", ",", "RadialFn3D_"}], "]"}], ":=", 
  RowBox[{"RadialFn3D", "[", 
   RowBox[{"U", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9276407909668436`*^9, 3.927640817405102*^9}},
 CellLabel->
  "In[10106]:=",ExpressionUUID->"933a3393-d134-4bb8-b2af-cec7d8331ea8"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Uxy", ",", "FakeEigenvalueFn"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Uxz", ",", "FakeEigenvalueFn"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Uyz", ",", "FakeEigenvalueFn"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"rr", "[", 
       RowBox[{"\[Theta]", ",", "Utest", ",", "FakeEigenvalueFn"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "150"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9275948637555075`*^9, 3.9275948779889092`*^9}, {
   3.927594956212916*^9, 3.927594962871805*^9}, {3.927595002743929*^9, 
   3.9275950269613667`*^9}, {3.9275950723382273`*^9, 3.927595129056366*^9}, {
   3.9275951709052763`*^9, 3.927595186670787*^9}, {3.9276408596834903`*^9, 
   3.927640860908975*^9}, {3.927640914610851*^9, 3.9276409391315503`*^9}, {
   3.927643584140189*^9, 3.927643598988068*^9}, {3.927643633365357*^9, 
   3.92764364195255*^9}, 3.927644285506052*^9},
 CellLabel->
  "In[10107]:=",ExpressionUUID->"6aadee43-67db-449c-b919-08a2583c39d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Real function", "Section",
 CellChangeTimes->{{3.927542409165701*^9, 3.927542410572926*^9}, {
  3.92754250154919*^9, 
  3.9275425020388927`*^9}},ExpressionUUID->"807eca65-8a98-491f-b204-\
40250f5b0b28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.927557920169354*^9, 3.9275579228740664`*^9}},
 CellLabel->
  "In[10108]:=",ExpressionUUID->"d4844678-b2c7-4a71-841e-e614d4156fe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VelFn", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"vels", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cmat", ",", "density"}],
     "]"}], "[", 
   RowBox[{"[", "i", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9274665595574694`*^9, 3.927466594180888*^9}, {
   3.927466643485673*^9, 3.9274667263962746`*^9}, {3.927467073961342*^9, 
   3.927467080314502*^9}, {3.92747089696459*^9, 3.927470897703573*^9}, {
   3.9274711723010893`*^9, 3.927471174344078*^9}, {3.927471213716225*^9, 
   3.927471214423504*^9}, {3.9274718679735093`*^9, 3.9274718689795637`*^9}, {
   3.927541719725685*^9, 3.9275417247816896`*^9}, {3.927557744536252*^9, 
   3.927557758829962*^9}, {3.927557902289937*^9, 3.927557927378057*^9}, {
   3.927558646816268*^9, 3.927558647743783*^9}, 3.927559593110128*^9, 
   3.9275717302823687`*^9},
 CellLabel->
  "In[10109]:=",ExpressionUUID->"33dc579d-8f76-4e16-893b-db37e09207b3"],

Cell[BoxData[
 RowBox[{"VelFn", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3."}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.9274670545340166`*^9, 3.927467055879645*^9}, 
   3.9274681853606586`*^9, {3.927558659213355*^9, 3.927558659301757*^9}, 
   3.9275595940858583`*^9},
 CellLabel->
  "In[10110]:=",ExpressionUUID->"ee1656a5-399e-4536-83c1-d56d72c6a6ae"],

Cell[BoxData[
 RowBox[{"radius", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"vmin", "+", "vmax"}], ")"}], "/", "2"}]}]], "Input",
 CellChangeTimes->{{3.9275579578445053`*^9, 3.927557973496931*^9}, {
  3.9275583924851007`*^9, 3.927558392984747*^9}, {3.927558474851844*^9, 
  3.92755847869106*^9}},
 CellLabel->
  "In[10111]:=",ExpressionUUID->"0f493189-1b9e-4a83-b13b-46c516622873"],

Cell[BoxData[
 RowBox[{"radius", " ", "=", "vmax"}]], "Input",
 CellChangeTimes->{{3.9275598282561693`*^9, 3.927559852939286*^9}},
 CellLabel->
  "In[10112]:=",ExpressionUUID->"802be6d5-0037-43bc-a4ca-98454b39f5e8"],

Cell[CellGroupData[{

Cell["modified functions", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}},ExpressionUUID->"a167cf2d-745c-47df-aa07-\
bc5ad531e144"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VSurface", "[", 
   RowBox[{"i_", ",", "U_", ",", "SectionRadius_", ",", "eye_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Opacity", "[", ".7", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"VelFn", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "#"}], "&"}], ",", 
           RowBox[{"SpherePolyList", "[", 
            RowBox[{
            "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5.", ",", 
             "5."}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Polygon", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SectionRadius", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], 
             RowBox[{"U", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], ")"}]}], "&"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}], ",", 
          RowBox[{".02", "\[Pi]"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ViewPoint", "->", "eye"}], ",", 
    RowBox[{"ImageSize", "->", "250"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9275594881939936`*^9, 3.9275594943196626`*^9}, {
   3.9275595257513275`*^9, 3.9275595697062635`*^9}, {3.9275596035637007`*^9, 
   3.9275596440947123`*^9}, {3.9275596767717934`*^9, 
   3.9275596911294765`*^9}, {3.9275597285043077`*^9, 3.927559831594392*^9}, {
   3.9275599064606457`*^9, 3.9275599424702377`*^9}, {3.927560217191101*^9, 
   3.927560237244731*^9}, 3.9275602712645617`*^9, 3.9275605256900845`*^9, {
   3.9275609063223453`*^9, 3.9275609150078926`*^9}, {3.927561766186644*^9, 
   3.927561795215288*^9}, {3.927562233362937*^9, 3.9275622372883787`*^9}, {
   3.9275639996979713`*^9, 3.9275640016901608`*^9}, {3.9275745548600407`*^9, 
   3.92757455554875*^9}, {3.9275747412182827`*^9, 3.927574772869199*^9}, {
   3.927574854013932*^9, 3.927574854136785*^9}},
 CellLabel->
  "In[10113]:=",ExpressionUUID->"39b08907-04ff-4b11-9432-f19fa6ebc4a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vsection", "[", 
   RowBox[{"i_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"VelFn", "[", 
           RowBox[{"#", ",", "i"}], "]"}], "#"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"U", ".", 
            RowBox[{"ZRot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", "\[Pi]"}], ",", 
            RowBox[{".02", "\[Pi]"}]}], "]"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "axes"}], "}"}], ",", 
    RowBox[{"ViewPoint", "->", 
     RowBox[{"30", 
      RowBox[{"U", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ",", 
    RowBox[{"Boxed", "->", "False"}], ",", 
    RowBox[{"ImageSize", "->", "150"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927561243251502*^9, 3.927561333269188*^9}, {
  3.927561369623223*^9, 3.9275613774911804`*^9}, {3.927574515411446*^9, 
  3.927574516096929*^9}, {3.927574840230344*^9, 3.927574852804738*^9}},
 CellLabel->
  "In[10114]:=",ExpressionUUID->"d879d268-f6b2-4cac-87e1-7f1d2b6d6dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vrr", "[", 
   RowBox[{"\[Theta]_", ",", "U_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"VelFn", "[", 
   RowBox[{
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ",", "i"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9275942293228683`*^9, 3.9275943300842977`*^9}, {
  3.927624532309643*^9, 3.927624575039484*^9}},
 CellLabel->
  "In[10115]:=",ExpressionUUID->"1e9ab51d-4f87-4896-835b-7cb46cca2804"]
}, Open  ]],

Cell[CellGroupData[{

Cell["example", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.92757498178586*^9}},ExpressionUUID->"0e9da3bb-694d-458f-898a-\
45e3788adb61"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"30", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"30.", "Degree"}], ",", 
        RowBox[{"65.", "Degree"}]}], "}"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SectionRadius", "=", 
    RowBox[{"1.5", " ", "radius"}]}], ";", "\[IndentingNewLine]", "PrintEye", 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", "Uxy", ",", "SectionRadius", ",", "eye"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", "Uxz", ",", "SectionRadius", ",", "eye"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", "Uyz", ",", "SectionRadius", ",", "eye"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", 
      RowBox[{"XRot", "[", 
       RowBox[{"30", "Degree"}], "]"}], ",", "SectionRadius", ",", "eye"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"VSurface", "[", 
     RowBox[{"i", ",", 
      RowBox[{"XRot", "[", 
       RowBox[{"30", "Degree"}], "]"}], ",", "SectionRadius", ",", 
      RowBox[{"30", 
       RowBox[{
        RowBox[{"XRot", "[", 
         RowBox[{"30", "Degree"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9275599656457415`*^9, 3.927559971410331*^9}, {
   3.9275600166795197`*^9, 3.927560017904752*^9}, 3.9275600526273556`*^9, {
   3.9275601188265038`*^9, 3.9275601281437387`*^9}, 3.927560169930709*^9, {
   3.927560386375967*^9, 3.927560498290663*^9}, {3.9275605512643766`*^9, 
   3.927560554956374*^9}, {3.927560658648012*^9, 3.927560693999866*^9}, {
   3.9275607466381736`*^9, 3.927560748788352*^9}, {3.9275609252200947`*^9, 
   3.927560955006311*^9}, {3.927561444021969*^9, 3.9275614457496185`*^9}, 
   3.9275619029796953`*^9, {3.927561960843696*^9, 3.927561993928056*^9}, {
   3.9275620363864994`*^9, 3.927562066376152*^9}, {3.9275622595819674`*^9, 
   3.927562284019062*^9}, {3.927562328972741*^9, 3.9275623578440733`*^9}, {
   3.9275623900481677`*^9, 3.9275623984343567`*^9}, {3.927564030003574*^9, 
   3.92756403028691*^9}, {3.92757432883354*^9, 3.9275743391085367`*^9}, {
   3.927574476561685*^9, 3.9275744775306587`*^9}, {3.927574887198574*^9, 
   3.9275749196227407`*^9}, {3.9276590857574987`*^9, 3.927659088558792*^9}},
 CellLabel->
  "In[10116]:=",ExpressionUUID->"b4b66255-f0dc-485a-b308-b20b0c366449"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vsecrow", "[", "i_", "]"}], ":=", 
  RowBox[{"GraphicsRow", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Vsection", "[", 
      RowBox[{"i", ",", "Uxy"}], "]"}], ",", 
     RowBox[{"Vsection", "[", 
      RowBox[{"i", ",", "Uxz"}], "]"}], ",", 
     RowBox[{"Vsection", "[", 
      RowBox[{"i", ",", "Uyz"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Vsecrow", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vsecrow", "[", "2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vsecrow", "[", "3", "]"}]}], "Input",
 CellChangeTimes->{
  3.9275614211163664`*^9, 3.927561469660986*^9, {3.927561540493755*^9, 
   3.92756159441514*^9}, {3.927561638231674*^9, 3.9275616569230237`*^9}, {
   3.9275620889019423`*^9, 3.9275620996168385`*^9}, {3.927574388349403*^9, 
   3.927574407184965*^9}, {3.927574868234214*^9, 3.927574870793655*^9}, {
   3.927574922898066*^9, 3.9275749263405247`*^9}, {3.92757499745505*^9, 
   3.927575067216784*^9}, {3.927575124422624*^9, 3.927575140728879*^9}, {
   3.927624768605688*^9, 3.9276248068421907`*^9}, {3.9276443162112417`*^9, 
   3.927644321780064*^9}},
 CellLabel->
  "In[10117]:=",ExpressionUUID->"0285ce90-a614-4ab8-992c-c7bdfee88214"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vrrrow", "[", "i_", "]"}], ":=", 
  RowBox[{"GraphicsRow", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Vrr", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Vrr", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Vrr", "[", 
        RowBox[{"\[Theta]", ",", "Uyz", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "150"}]}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Vrrrow", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vrrrow", "[", "2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vrrrow", "[", "3", "]"}]}], "Input",
 CellChangeTimes->{{3.9275948637555075`*^9, 3.9275948779889092`*^9}, {
  3.927594956212916*^9, 3.927594962871805*^9}, {3.927595002743929*^9, 
  3.9275950269613667`*^9}, {3.9275950723382273`*^9, 3.927595129056366*^9}, {
  3.9275951709052763`*^9, 3.927595186670787*^9}, {3.927624239788411*^9, 
  3.9276243033934107`*^9}, {3.927624585721673*^9, 3.9276246216449747`*^9}, {
  3.9276246769921217`*^9, 3.927624728838072*^9}, {3.927624827323246*^9, 
  3.9276248454930058`*^9}, {3.9276443302951117`*^9, 3.9276443398274603`*^9}},
 CellLabel->
  "In[10121]:=",ExpressionUUID->"3540817a-39da-497a-b52e-4f2233a4b169"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity sphere plots", "Section",
 CellChangeTimes->{{3.927542409165701*^9, 3.927542410572926*^9}, {
  3.92754250154919*^9, 3.9275425020388927`*^9}, {3.927559458119361*^9, 
  3.92755946441405*^9}},ExpressionUUID->"d77d6a3b-305f-4e8c-bfc0-\
e65ef9e31158"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"xMaxForScaling", "=", 
     RowBox[{"xcontours", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"xMinForScaling", "=", 
     RowBox[{"xcontours", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"plotpoints", "=", "Automatic"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contourstyle", "=", "Automatic"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.927367522886832*^9, 3.9273675258254633`*^9}, {
   3.927367575052473*^9, 3.92736758365965*^9}, {3.927367682841346*^9, 
   3.92736770409767*^9}, {3.927368499806727*^9, 3.927368499978237*^9}, {
   3.927380274957151*^9, 3.927380284819965*^9}, 3.9273953015486393`*^9, 
   3.927451303464744*^9, {3.9276229472605667`*^9, 3.927622952295282*^9}, {
   3.927623937964037*^9, 3.9276239402993593`*^9}},
 CellLabel->
  "In[10125]:=",ExpressionUUID->"cbb2c81d-76d0-4526-8d31-831b40f9713b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"velsTP", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat", ",", "density"}], "]"}], 
    "[", 
    RowBox[{"[", "i", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLegends", "->", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.927367969021694*^9, 3.927367983723044*^9}, {
   3.927395209773459*^9, 3.9273952143721313`*^9}, {3.9274513833296223`*^9, 
   3.927451389933258*^9}, 3.927452322960244*^9, {3.927559473798356*^9, 
   3.927559474221919*^9}, 3.927571731949768*^9},
 CellLabel->
  "In[10127]:=",ExpressionUUID->"b79c955e-e278-4c67-86b8-c5fb8a865ec3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "vplotPrelim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat_", ",", "i_", ",", "density_", ",", "contours_", ",", "legends_", 
    ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vplotPrelim", "[", 
    RowBox[{
    "Cmat", ",", "i", ",", "density", ",", "contours", ",", "legends", ",", 
     "plotpoints", ",", "contourstyle"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"velsTP", "[", 
       RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat", ",", "density"}], 
       "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
     RowBox[{"ContourStyle", "->", "contourstyle"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", "14", "}"}]}], ",", 
     RowBox[{"PlotPoints", "->", "plotpoints"}], ",", 
     RowBox[{
      StyleBox["ColorFunction",
       FontColor->GrayLevel[0]], 
      StyleBox["\[Rule]",
       FontColor->GrayLevel[0]], 
      RowBox[{
       StyleBox["(",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox[
         RowBox[{
          RowBox[{"ColorData", "[", "cvel", "]"}], "[", 
          FractionBox[
           RowBox[{"#", "-", 
            RowBox[{"contours", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], 
           RowBox[{
            RowBox[{"contours", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], "-", 
            RowBox[{"contours", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]], "]"}],
         FontColor->GrayLevel[0]], "&"}], ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "legends"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.927315691361083*^9, 3.927315728289136*^9}, {
   3.927315925030892*^9, 3.927315925281826*^9}, {3.9273159622416077`*^9, 
   3.92731596806857*^9}, {3.927315999695875*^9, 3.92731605088229*^9}, 
   3.927365911386437*^9, {3.927365956897806*^9, 3.927365988059713*^9}, {
   3.927367371730195*^9, 3.927367389349262*^9}, {3.927367446213491*^9, 
   3.927367453412827*^9}, 3.9273675681605253`*^9, {3.9273676249357643`*^9, 
   3.927367660576573*^9}, {3.9273677668961363`*^9, 3.927367769253557*^9}, {
   3.927451425400581*^9, 3.927451432941256*^9}, {3.927452322989324*^9, 
   3.927452322991699*^9}, 3.927559491385592*^9, 3.9275717560420427`*^9, {
   3.927572139987838*^9, 3.927572140613476*^9}, {3.927572548099042*^9, 
   3.9275725801216993`*^9}, {3.927572654031157*^9, 3.927572654957838*^9}, {
   3.9275726998047113`*^9, 3.9275727002981873`*^9}, 3.927622968015029*^9, {
   3.927623838766149*^9, 3.9276238639428596`*^9}},
 CellLabel->
  "In[10129]:=",ExpressionUUID->"da296015-38fb-48ab-bef0-5c4a8cf7533d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat", ",", "1", ",", "density", ",", "xcontours", ",", "Automatic", ",", 
    "plotpoints", ",", "contourstyle"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927315973270911*^9, 3.927315974131159*^9}, {
   3.9273659205887537`*^9, 3.927365924944152*^9}, 3.927368094478785*^9, {
   3.9273685179144917`*^9, 3.927368521069813*^9}, 3.927380297232993*^9, 
   3.927380349158372*^9, 3.927452322992836*^9, 3.927572146257142*^9, {
   3.927623871785157*^9, 3.9276238721795273`*^9}, 3.9276590992056303`*^9},
 CellLabel->
  "In[10131]:=",ExpressionUUID->"2c098fba-0c32-4925-b4ed-e62604c80c05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat", ",", "2", ",", "density", ",", "xcontours", ",", "Automatic", ",", 
    "plotpoints", ",", "contourstyle"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927315973270911*^9, 3.927315974131159*^9}, {
   3.9273659205887537`*^9, 3.927365924944152*^9}, {3.927368094478785*^9, 
   3.927368108381384*^9}, 3.9273685242995443`*^9, 3.927380302578711*^9, 
   3.927380350210107*^9, 3.9274523230155*^9, 3.927572147182898*^9, {
   3.927623878502592*^9, 3.927623878723196*^9}, 3.927659100408877*^9},
 CellLabel->
  "In[10132]:=",ExpressionUUID->"49721c73-86c5-47f4-9636-1370b6ae9654"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vplotPrelim", "[", 
   RowBox[{
   "Cmat", ",", "3", ",", "density", ",", "xcontours", ",", "Automatic", ",", 
    "plotpoints", ",", "contourstyle"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.927315973270911*^9, 3.927315974131159*^9}, {
   3.9273659205887537`*^9, 3.927365924944152*^9}, {3.927368094478785*^9, 
   3.927368109938775*^9}, 3.927368525505056*^9, 3.927380305669957*^9, 
   3.927380351416151*^9, 3.927452323052836*^9, 3.927572148056055*^9, {
   3.927623884455217*^9, 3.927623884617757*^9}, 3.927659101569631*^9},
 CellLabel->
  "In[10133]:=",ExpressionUUID->"9f5ee7c2-69be-4451-b011-91aebdbb27e0"],

Cell[CellGroupData[{

Cell["adapt functions for plotting on the sphere", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 
  3.9276570172255573`*^9}},ExpressionUUID->"7dda8604-a195-4310-a1a7-\
e355c25980c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vplot", "[", 
    RowBox[{
    "center_", ",", "BBrad_", ",", "Cmat_", ",", "i_", ",", "density_", ",", 
     "contours_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vplot", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Cmat", ",", "i", ",", "density", ",", 
      "contours", ",", "plotpoints", ",", "contourstyle"}], "]"}], "=", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"center", "+", 
          RowBox[{"BBrad", "\[Times]", 
           RowBox[{"xyzTP", "[", "#", "]"}]}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"vplotPrelim", "[", 
          RowBox[{
          "Cmat", ",", "i", ",", "density", ",", "contours", ",", "None", ",",
            "plotpoints", ",", "contourstyle"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", 
       StyleBox[
        RowBox[{
         RowBox[{"vplotPrelim", "[", 
          RowBox[{
          "Cmat", ",", "i", ",", "density", ",", "contours", ",", "None", ",",
            "plotpoints", ",", "contourstyle"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}],
        FontColor->GrayLevel[0]]}], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9032090031365347`*^9, 3.9032090103964543`*^9}, {
   3.903209096513342*^9, 3.9032091634430532`*^9}, {3.9032091995296583`*^9, 
   3.9032092237594786`*^9}, {3.909350177490202*^9, 3.9093502594197197`*^9}, {
   3.9093506370401707`*^9, 3.909350647150671*^9}, {3.9093510886184034`*^9, 
   3.909351108646296*^9}, 3.910367598851852*^9, {3.9146000808203325`*^9, 
   3.914600102333006*^9}, {3.9146778901695733`*^9, 3.914677904035157*^9}, {
   3.914678019416276*^9, 3.914678024392654*^9}, {3.9146781025947514`*^9, 
   3.914678116980199*^9}, 3.9175234474471207`*^9, {3.927366227891131*^9, 
   3.9273662300094547`*^9}, {3.927366399729495*^9, 3.9273664042635593`*^9}, {
   3.9273665991460648`*^9, 3.927366601370543*^9}, {3.927366662910788*^9, 
   3.927366663852827*^9}, {3.9273673162767267`*^9, 3.9273673312644672`*^9}, {
   3.92736820998771*^9, 3.927368213962866*^9}, {3.927451001425161*^9, 
   3.927451022424244*^9}, {3.927452323075506*^9, 3.92745232307834*^9}, {
   3.927572150447754*^9, 3.927572153107648*^9}, {3.927623902993384*^9, 
   3.9276239099008827`*^9}},
 CellLabel->
  "In[10134]:=",ExpressionUUID->"c3d7a5b9-3d63-4f3a-b0a4-55ff23d41cee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["example", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 
  3.927657028007598*^9}},ExpressionUUID->"3863d0e9-c72a-4a8b-9478-\
8e2fd361f2c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"center", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBrad", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eye", "=", "eye0"}], "\[IndentingNewLine]", "options"}], "Input",
 CellChangeTimes->{{3.9273954904630327`*^9, 3.927395494327601*^9}, {
  3.92745844178469*^9, 3.92745846327456*^9}, {3.927559518563994*^9, 
  3.927559525424268*^9}},
 CellLabel->
  "In[10135]:=",ExpressionUUID->"97adc7fb-9b48-48e6-ba8b-ad33274acf30"],

Cell[BoxData[
 RowBox[{"pMONO", ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cpMONO", "[", 
       RowBox[{"Tmat", ",", 
        RowBox[{"contours", "[", 
         RowBox[{
          StyleBox["Tmat0",
           FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", 
        RowBox[{"MaxForScaling", "[", 
         RowBox[{
          StyleBox["Tmat0",
           FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", 
        "plotpoints", ",", "contourstyle"}], "]"}], ",", 
      RowBox[{"Graphics3D", "[", "PaxesTriColor", "]"}]}], "}"}], ",", 
    "options"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9273965506935043`*^9, 3.927396568041696*^9}, {
  3.92739662233893*^9, 3.9273966294710083`*^9}, {3.9274585453722687`*^9, 
  3.927458546576132*^9}, {3.9275742437908993`*^9, 3.927574243933247*^9}, {
  3.927648115067338*^9, 3.927648152583056*^9}},
 CellLabel->
  "In[10139]:=",ExpressionUUID->"3a72c6de-a709-43fa-98fc-3bc0281e83cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"px", "[", "i_", "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vplot", "[", 
       RowBox[{
       "center", ",", "BBrad", ",", "Cmat", ",", "i", ",", "density", ",", 
        "xcontours", ",", "plotpoints", ",", "contourstyle"}], "]"}], ",", 
      RowBox[{"Graphics3D", "[", "PaxesTriColor", "]"}]}], "}"}], ",", 
    "options"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.927367149838009*^9, 3.9273671617460957`*^9}, {
   3.927368161963064*^9, 3.927368172011846*^9}, {3.9273682843079576`*^9, 
   3.927368288600971*^9}, {3.927368324118795*^9, 3.927368337987288*^9}, {
   3.927374383416897*^9, 3.9273743940620537`*^9}, {3.927377643929117*^9, 
   3.9273777104080677`*^9}, {3.927380080601389*^9, 3.927380085138987*^9}, 
   3.927380128657151*^9, 3.927380324287407*^9, 3.927380356774778*^9, 
   3.9273904573865213`*^9, 3.927390502361389*^9, 3.927452323105023*^9, 
   3.927572163235585*^9, {3.927623927694902*^9, 3.927623927835737*^9}},
 CellLabel->
  "In[10140]:=",ExpressionUUID->"d4c968d2-fbde-4d61-a368-c82cd962a715"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"px", "[", "1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"px", "[", "2", "]"}], "\[IndentingNewLine]", 
   RowBox[{"px", "[", "3", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.927374851660962*^9, 3.927374851727708*^9}, {
  3.927458247255698*^9, 3.927458273482604*^9}, {3.927458412969083*^9, 
  3.927458413655458*^9}, {3.927574222577952*^9, 3.927574237437399*^9}},
 CellLabel->
  "In[10141]:=",ExpressionUUID->"219f98bc-a117-4ebc-ac97-246cc2b7be52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
copied from common_funs.nb with these modifications:
1) no degree sign for tick labels
2) left-alignment of tick labels
3) auto-scaling based on contours (see BC_Igel.nb)\
\>", "Subsubsection",
 CellChangeTimes->{{3.9274722580198994`*^9, 3.927472289400688*^9}, {
  3.9274723314199657`*^9, 3.9274723722090254`*^9}, {3.92757498105445*^9, 
  3.9275749882000227`*^9}, {3.927657015529718*^9, 
  3.9276570388837633`*^9}},ExpressionUUID->"e02da852-35b6-4233-ad67-\
789e87b44a63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"legendsv", "[", 
   RowBox[{
   "contours_", ",", "heading_", ",", "hw_", ",", "fontsize_", ",", 
    "increment_", ",", "offset_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"contours", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", "fontsize"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"offset", ",", 
            RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Left", ",", "Center"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}], ",", 
         "increment"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"heading", ",", 
        RowBox[{"{", 
         RowBox[{".75", ",", 
          RowBox[{"hw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              StyleBox["contours",
               FontWeight->"Plain"], "]"}], "+", ".75"}], ")"}]}]}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".0005", "]"}], ",", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3.5", ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}]}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Thickness", "[", ".004", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ColorData", "[", "cvel", "]"}], "[", 
            FractionBox[
             RowBox[{
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "+", 
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "-", 
              RowBox[{"contours", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], 
             RowBox[{
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{".5", 
                 RowBox[{"contours", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}]}], "}"}], 
            "]"}]}], "}"}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.92681501046321*^9, 3.926815066876936*^9, {3.9273906655433817`*^9, 
   3.927390671746499*^9}, {3.927390799530697*^9, 3.927390801326439*^9}, 
   3.927572480718581*^9, {3.9275727328857403`*^9, 3.927572733352859*^9}, 
   3.927622757618585*^9, {3.92762291048197*^9, 3.92762291342074*^9}, {
   3.9276231513559103`*^9, 3.92762315438365*^9}, {3.927623191625724*^9, 
   3.927623256101019*^9}, {3.927623287358045*^9, 3.927623316486948*^9}, {
   3.927623409645603*^9, 3.9276234157856903`*^9}, {3.927623547805225*^9, 
   3.927623670725582*^9}},
 CellLabel->
  "In[10142]:=",ExpressionUUID->"3b8e8e22-5d1a-4125-88f4-0438af22d134"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"0.9", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ax", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "4.0"}], "}"}], ",", 
      RowBox[{"0.5", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ax", "=", "Automatic"}], ";"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"insetSize", "=", "1"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"hw", "=", "1"}], ";", 
  RowBox[{"fontsize", "=", "10"}], ";", 
  RowBox[{"increment", "=", "1"}], ";", 
  RowBox[{"offset", "=", "2.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vlabmono", "=", 
    RowBox[{
     RowBox[{"SubscriptBox", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[Alpha]\>\"", ",", "18"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<MONO\>\"", ",", "10"}], "]"}]}], "]"}], "//", 
     "DisplayForm"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"vlab", "=", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<V\>\"", ",", "18"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<p\>\"", ",", "10"}], "]"}]}], "]"}], "//", 
      "DisplayForm"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlab", "=", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<V (km/s)\>\"", ",", "14"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plmono", "=", 
   RowBox[{"legends", "[", 
    RowBox[{
     RowBox[{"contours", "[", 
      RowBox[{
       StyleBox["Tmat0",
        FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", 
     RowBox[{"MaxForScaling", "[", 
      RowBox[{
       StyleBox["Tmat0",
        FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ",", "vlabmono", 
     ",", "hw", ",", "fontsize", ",", "increment", ",", "offset"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plvel", "=", 
   RowBox[{"legendsv", "[", 
    RowBox[{
    "xcontours", ",", "vlab", ",", "hw", ",", "fontsize", ",", "incrementv", 
     ",", 
     RowBox[{"0.75", "offset"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rowplot", ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Inset", "[", 
       RowBox[{"pMONO", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{"plmono", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.7", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", 
        RowBox[{"isize", " ", "insetSize"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"px", "[", "1", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.4", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"px", "[", "2", "]"}], ",", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"2.4", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"px", "[", "3", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3.5", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", "insetSize"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{"plvel", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4.2", "dx"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}], ",", 
        RowBox[{"isizev", " ", "insetSize"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ImageSize", "->", "1000"}], ",", 
    RowBox[{"PlotRange", "->", "ax"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.927376216325604*^9, 3.927376336414467*^9}, {
   3.927376415768152*^9, 3.9273765188832293`*^9}, {3.927376573215267*^9, 
   3.92737658014285*^9}, {3.9273767195052223`*^9, 3.927376853576849*^9}, {
   3.927376922718214*^9, 3.9273769342190313`*^9}, {3.927376984760398*^9, 
   3.9273770576637*^9}, {3.927377188838036*^9, 3.927377213783823*^9}, {
   3.9273773042976303`*^9, 3.927377385532452*^9}, {3.92738015011973*^9, 
   3.927380183593958*^9}, 3.927380327905439*^9, 3.927380358072084*^9, {
   3.927390261687986*^9, 3.927390377959359*^9}, 3.927390705809435*^9, {
   3.92739085346839*^9, 3.9273909101560183`*^9}, {3.9273910606933537`*^9, 
   3.927391062539332*^9}, {3.927391294673456*^9, 3.927391303641481*^9}, {
   3.9273914087030563`*^9, 3.927391408830256*^9}, {3.9273967318038197`*^9, 
   3.9273967537285423`*^9}, {3.927396809893818*^9, 3.92739689585511*^9}, {
   3.927396945498928*^9, 3.927396955608407*^9}, {3.927396997445565*^9, 
   3.927397095773953*^9}, {3.927397516500288*^9, 3.927397516593511*^9}, {
   3.927397632238873*^9, 3.927397658292055*^9}, {3.927573983271688*^9, 
   3.9275739833946123`*^9}, {3.927574110770733*^9, 3.927574111744277*^9}, {
   3.92762292639769*^9, 3.927622929556329*^9}, {3.92762368883342*^9, 
   3.927623691454838*^9}, {3.9276271001788683`*^9, 3.927627100718525*^9}, {
   3.927627141252305*^9, 3.927627148763607*^9}, {3.9276272261622553`*^9, 
   3.927627226541543*^9}, {3.9276294406181393`*^9, 3.927629456773757*^9}, {
   3.927629502176692*^9, 3.9276295069026413`*^9}, {3.927631112360085*^9, 
   3.92763113992985*^9}, {3.9276311955242567`*^9, 3.927631200247278*^9}, {
   3.927631330839818*^9, 3.9276313345015497`*^9}, {3.927631538664393*^9, 
   3.9276315745353413`*^9}, {3.9276317926853313`*^9, 3.927631793063592*^9}, 
   3.927631847864938*^9, {3.927631892865876*^9, 3.927631893089007*^9}, {
   3.927632051875845*^9, 3.927632053277836*^9}, {3.927647945075626*^9, 
   3.927647946506031*^9}, 3.9276480034406967`*^9},
 CellLabel->
  "In[10143]:=",ExpressionUUID->"94011b07-587b-44d0-a3d6-f647fb77b2a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", "eye0"}], ";", 
  RowBox[{"p1", "=", "rowplot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eyerad", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"eyerad", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ";", 
  RowBox[{"p2", "=", "rowplot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"eyerad", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", 
  RowBox[{"p3", "=", "rowplot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"eyerad", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
  RowBox[{"p4", "=", "rowplot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"eyerad", " ", 
    RowBox[{"Uref", ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p5", "=", "rowplot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combinedPlot", "=", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927391355547772*^9, 3.9273913921374073`*^9}, {
   3.927395477689225*^9, 3.927395478055464*^9}, 3.927397854751377*^9, {
   3.927401612634347*^9, 3.927401621285537*^9}, {3.927625853496684*^9, 
   3.927625910514543*^9}, {3.927626165711009*^9, 3.9276261971362543`*^9}, {
   3.927626966720646*^9, 3.927626971554473*^9}, {3.927650976193636*^9, 
   3.927650976825975*^9}},
 CellLabel->
  "In[10152]:=",ExpressionUUID->"bbb7caf3-9682-4773-99b5-845afe230134"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1mod", "=", 
   RowBox[{"Panel", "[", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", 
         RowBox[{
          RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
          RowBox[{
           StyleBox["Alignment",
            FontColor->GrayLevel[0]], "->", "Left"}], ",", 
          RowBox[{"FontSize", "->", "16"}]}], "]"}], ",", "p1"}], "}"}], 
      "]"}], ",", 
     RowBox[{"Background", "->", "White"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9276586327334757`*^9, 3.927658651747801*^9}, {
   3.927658945641676*^9, 3.9276589458317204`*^9}, {3.927658982001905*^9, 
   3.927659008647702*^9}, 3.9276592181129913`*^9},
 CellLabel->
  "In[10160]:=",ExpressionUUID->"794258f7-0954-4eb0-b1d4-305a8b23108c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<single.pdf\>\""}], ",", "p1mod"}], "]"}], ",",
    "p1mod"}], "]"}]], "Input",
 CellChangeTimes->{{3.9256051233224792`*^9, 3.9256051480053577`*^9}, {
  3.927626632567033*^9, 3.927626633159384*^9}, {3.9276266662680483`*^9, 
  3.927626666539077*^9}, {3.9276269796731253`*^9, 3.927626980683551*^9}, {
  3.927658791640945*^9, 3.927658798504574*^9}},
 CellLabel->
  "In[10161]:=",ExpressionUUID->"a5c1e262-4972-40c9-858a-f04bd932d23f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<all.pdf\>\""}], ",", "combinedPlot"}], "]"}], 
   ",", "combinedPlot"}], "]"}]], "Input",
 CellChangeTimes->{{3.9256051233224792`*^9, 3.9256051480053577`*^9}, {
  3.927626632567033*^9, 3.927626633159384*^9}, {3.9276266662680483`*^9, 
  3.927626666539077*^9}, {3.9276269796731253`*^9, 3.927626980683551*^9}},
 CellLabel->
  "In[10162]:=",ExpressionUUID->"af90c1f1-d7f2-4739-8060-d2b6d7717637"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polar plots", "Section",
 CellChangeTimes->{{3.9274520951118298`*^9, 3.927452100082172*^9}, {
  3.927458112211994*^9, 3.92745820522148*^9}, {3.927574176988968*^9, 
  3.927574180236335*^9}, {3.927626705866198*^9, 
  3.9276267059982777`*^9}},ExpressionUUID->"4bdc7f57-87c0-4ca1-ae19-\
6e4eb0c87871"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Pplot", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"velsTP", "[", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "Cmat", ",", "density"}], "]"}], 
    "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9274528238730288`*^9, 3.9274528472338943`*^9}, {
   3.92745337290901*^9, 3.927453376390648*^9}, {3.927560756281579*^9, 
   3.927560756713991*^9}, 3.927572171452937*^9, {3.927625012137012*^9, 
   3.9276250145875063`*^9}},
 CellLabel->
  "In[10163]:=",ExpressionUUID->"847c5e1f-0182-40e9-a808-4a2c404b4bfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pplot", "[", 
   RowBox[{"\[Theta]_", ",", "U_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"VelFn", "[", 
   RowBox[{
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ",", "i"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9275942293228683`*^9, 3.9275943300842977`*^9}, {
   3.927624532309643*^9, 3.927624575039484*^9}, 3.927625007219685*^9},
 CellLabel->
  "In[10164]:=",ExpressionUUID->"7eeff714-c47f-4723-bf18-a2f595248945"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dconv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contourLevels", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"conminv", ",", "conmaxv", ",", "dconv"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"poptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ticks", "->", "None"}], ",", 
     RowBox[{"Axes", "->", "None"}], ",", 
     RowBox[{"Frame", "->", "False"}], ",", 
     RowBox[{"PolarGridLines", "->", "None"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"redCircle", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "vp0"}], "]"}], ",", "Red", ",", 
     "Dashed"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"blueCircle", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "vs0"}], "]"}], ",", "Blue", ",",
      "Dashed"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"stlab", "=", 
  RowBox[{"\"\<con \>\"", " ", "<>", "  ", 
   RowBox[{"ToString", "[", "dconv", "]"}], " ", "<>", " ", "\"\< km/s \>\"", 
   " ", "<>", " ", "stV"}]}], "\n", 
 RowBox[{
  RowBox[{"basemap", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "r"}], "]"}], ",", 
           "LightGray"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "contourLevels"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"redCircle", ",", "blueCircle"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "None"}], ",", 
     RowBox[{"AspectRatio", "->", "1"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"1.05", " ", "conmaxv", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarXY", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxy", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"\"\<xy plane (+z axis): \>\"", "<>", "stlab"}]}], "}"}], 
          ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarXZ", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uxz", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"\"\<xz plane (-y axis): \>\"", "<>", "stlab"}]}], "}"}], 
          ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarYZ", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uyz", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uyz", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uyz", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{"\"\<yz plane (+x axis): \>\"", "<>", "stlab"}]}], "}"}], 
          ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarXISO", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"basemap", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uref", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Red"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uref", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Blue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"Pplot", "[", 
        RowBox[{"\[Theta]", ",", "Uref", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"Evaluate", "@", "poptions"}], ",", 
       RowBox[{"PlotStyle", "->", "Green"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", 
            RowBox[{
             RowBox[{"ToString", "[", "\[CapitalSigma]", "]"}], "<>", 
             "\"\< axis: \>\"", "<>", "stlab"}]}], "}"}], ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"Axes", "->", "False"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927453507075843*^9, 3.927453525726275*^9}, {
   3.927453624205551*^9, 3.9274536436871357`*^9}, {3.927455078759156*^9, 
   3.927455082217255*^9}, {3.927455149654805*^9, 3.927455186158555*^9}, {
   3.927455240293652*^9, 3.9274552427867413`*^9}, {3.9274553077681923`*^9, 
   3.927455328583888*^9}, {3.927455401223524*^9, 3.927455421035512*^9}, {
   3.92745546239775*^9, 3.927455474764678*^9}, {3.927455745172203*^9, 
   3.927455759929166*^9}, 3.927456646025116*^9, {3.927456984109618*^9, 
   3.927457016542502*^9}, {3.927457447213763*^9, 3.927457492102791*^9}, {
   3.9274576896918383`*^9, 3.927457748189204*^9}, {3.9274577795651293`*^9, 
   3.927457800772002*^9}, {3.9274578361546593`*^9, 3.927457872206316*^9}, {
   3.927459287476366*^9, 3.927459289615687*^9}, {3.9276250366645823`*^9, 
   3.927625133305881*^9}, {3.927630624246511*^9, 3.927630630414926*^9}, {
   3.927630746451169*^9, 3.927630755688775*^9}, {3.927630790698454*^9, 
   3.9276307913954153`*^9}, {3.9276368831224318`*^9, 3.927636885110427*^9}, {
   3.9276422373507853`*^9, 3.927642269085462*^9}, {3.927642965781147*^9, 
   3.927642997794739*^9}, {3.927643049183633*^9, 3.927643053215191*^9}, {
   3.92764419089287*^9, 3.9276441920245523`*^9}, {3.927644710758573*^9, 
   3.9276447120200043`*^9}, 3.927644810560998*^9, {3.927645088358633*^9, 
   3.927645221085943*^9}, {3.9276452539786797`*^9, 3.9276452553707*^9}, {
   3.927645980874379*^9, 3.927646002732479*^9}, {3.9276462376336117`*^9, 
   3.927646259249957*^9}, {3.927646458949821*^9, 3.9276464641607018`*^9}, {
   3.927646703591344*^9, 3.9276467258775806`*^9}, {3.9276467772403593`*^9, 
   3.9276467881865177`*^9}, {3.927646838892419*^9, 3.927646910662006*^9}, {
   3.9276469587904863`*^9, 3.927646972746958*^9}, {3.92764740258348*^9, 
   3.927647403810315*^9}, {3.927650928673194*^9, 3.927650940349444*^9}, {
   3.927651900171876*^9, 3.927651908825431*^9}, 3.927652416853813*^9, {
   3.9276524919207*^9, 3.927652491980925*^9}},
 CellLabel->
  "In[10165]:=",ExpressionUUID->"afaffa34-f3a5-4749-8ebd-a9e67e57a542"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "16"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"combinedPlot", "=", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"polarXY", ",", "polarXZ", ",", "polarYZ", ",", "polarXISO"}], 
       "}"}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "1100"}], ",", 
     RowBox[{"Spacings", "->", 
      RowBox[{"{", 
       RowBox[{"dx", ",", "0"}], "}"}]}], ",", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"MatrixNote", "[", "Tmat", "]"}], ",", "fontSize", ",", 
           "Black"}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"0.02", ",", "1.1"}], "}"}], "]"}]}], "]"}], "}"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.927453148098589*^9, 3.927453194807581*^9}, {
   3.9274534350877457`*^9, 3.927453442853806*^9}, {3.927459294090065*^9, 
   3.927459298802376*^9}, {3.927625106358309*^9, 3.9276251081590147`*^9}, {
   3.92763067603115*^9, 3.9276306919523697`*^9}, {3.9276307654049263`*^9, 
   3.927630784561625*^9}, {3.9276308572693644`*^9, 3.927630861634637*^9}, 
   3.9276422735478897`*^9, 3.927644144652856*^9, {3.927646204993021*^9, 
   3.927646219467876*^9}, {3.92764635251051*^9, 3.927646370576591*^9}, {
   3.927646401075062*^9, 3.927646429103841*^9}, {3.9276465592599*^9, 
   3.927646623541296*^9}, 3.927647207802948*^9},
 CellLabel->
  "In[10176]:=",ExpressionUUID->"23f0f017-220a-44fe-8750-be0344048a6c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"otag", "<>", "\"\<polar.pdf\>\""}], ",", "combinedPlot"}], 
    "]"}], ",", "combinedPlot"}], "]"}]], "Input",
 CellChangeTimes->{{3.927630843643276*^9, 3.9276308452836027`*^9}},
 CellLabel->
  "In[10179]:=",ExpressionUUID->"951d6b7c-dfac-4b25-aa57-3c9fc8b92f92"]
}, Open  ]]
},
WindowSize->{1387, 1061},
WindowMargins->{{Automatic, 56}, {-70, Automatic}},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7a27a924-139e-4997-a27c-940af22d530d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 228, 6, 105, "Section",ExpressionUUID->"59d4d812-4b2e-4186-9442-6826736b67df"],
Cell[CellGroupData[{
Cell[811, 30, 212, 4, 53, "Section",ExpressionUUID->"764a5bf6-cc27-4365-85e9-4479f8c529ed"],
Cell[1026, 36, 330, 7, 44, "Input",ExpressionUUID->"d9ba5e55-6356-4aad-8bdc-9b9281b28509"],
Cell[CellGroupData[{
Cell[1381, 47, 615, 11, 71, "Subsubsection",ExpressionUUID->"cc08436a-72e8-4a48-a4cf-d97439428a3c"],
Cell[1999, 60, 1259, 23, 44, "Input",ExpressionUUID->"9499a352-0310-4c4d-be3a-e4e0bff24cad"],
Cell[3261, 85, 1249, 24, 44, "Input",ExpressionUUID->"0520d4ed-ced5-4a99-9ccf-19d274c3ee77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4547, 114, 622, 9, 45, "Subsubsection",ExpressionUUID->"4a0048ff-7f8e-49f7-a365-98e2c7028415"],
Cell[5172, 125, 654, 11, 44, "Input",ExpressionUUID->"6c0d6afc-c1e6-4de7-b3a1-c6000cd1f24c"],
Cell[5829, 138, 355, 9, 44, "Input",ExpressionUUID->"aa5acef0-10d5-4c47-bb11-95893ace1a5f"],
Cell[6187, 149, 227, 5, 44, "Input",ExpressionUUID->"0cf229da-7154-4bbc-8356-19cebb8ea6fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6451, 159, 875, 12, 45, "Subsubsection",ExpressionUUID->"e3be44bf-4e8b-4387-bf47-067c7b658807"],
Cell[7329, 173, 373, 7, 44, "Input",ExpressionUUID->"25224e18-1f10-44f8-90c8-08fd2dc6246e"],
Cell[7705, 182, 973, 19, 44, "Input",ExpressionUUID->"75a2e835-7c1b-430e-b4e4-ada995e678d0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8727, 207, 208, 4, 67, "Section",ExpressionUUID->"e4473182-0fc7-44b5-966b-848c0f78eca9"],
Cell[CellGroupData[{
Cell[8960, 215, 579, 8, 45, "Subsubsection",ExpressionUUID->"f1573f09-aae1-4263-a86b-72a746014752"],
Cell[9542, 225, 498, 9, 44, "Input",ExpressionUUID->"62724fb3-b6bb-45a8-96c0-7caba147800d"],
Cell[10043, 236, 355, 8, 44, "Input",ExpressionUUID->"d996a1ee-cd80-4aa6-9023-7b56097f2d03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10435, 249, 465, 7, 45, "Subsubsection",ExpressionUUID->"964489cb-4ddb-461e-827b-1e373d08a457"],
Cell[10903, 258, 790, 13, 44, "Input",ExpressionUUID->"c69f2d97-094d-4323-8412-6ce582de2fba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11730, 276, 519, 8, 45, "Subsubsection",ExpressionUUID->"0055b19f-9f3b-41e0-a5ab-f5390c048119"],
Cell[12252, 286, 1022, 22, 108, "Input",ExpressionUUID->"cd28920b-f0f1-4678-ac1b-8cec14c0ec5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13311, 313, 496, 7, 45, "Subsubsection",ExpressionUUID->"e9451361-ca9d-4da1-af7c-62d312663b62"],
Cell[13810, 322, 1637, 38, 108, "Input",ExpressionUUID->"47e6e34d-e9f9-4862-b5b3-e18ddfb8787c"],
Cell[15450, 362, 335, 7, 44, "Input",ExpressionUUID->"26288248-2838-449d-9ca0-97b0f44f1819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15822, 374, 463, 7, 45, "Subsubsection",ExpressionUUID->"5ba5e1c6-59cf-4908-983d-145b47c25204"],
Cell[16288, 383, 289, 5, 44, "Input",ExpressionUUID->"9c43b048-b1ce-44fa-ae2f-7615fcf6b541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16614, 393, 476, 7, 45, "Subsubsection",ExpressionUUID->"dcf2479e-0e3e-43dd-8da6-54a9612a79b2"],
Cell[17093, 402, 641, 16, 87, "Input",ExpressionUUID->"35f2fc3e-0eec-44bb-93b6-d95891d1a62f"],
Cell[17737, 420, 976, 23, 66, "Input",ExpressionUUID->"e45f5643-798a-4733-8f32-312bf9cfcbc1"],
Cell[18716, 445, 708, 17, 44, "Input",ExpressionUUID->"9ab8f89b-d4ac-4ac4-9472-c6e16f2a56cb"],
Cell[19427, 464, 347, 8, 44, "Input",ExpressionUUID->"e9d346e7-e9b6-4261-9de8-cb6f07677cfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19811, 477, 1055, 21, 47, "Subsubsection",ExpressionUUID->"688cb66b-2a97-43fb-a615-13fc7e841112"],
Cell[20869, 500, 778, 20, 83, "Input",ExpressionUUID->"33b36b06-6ceb-4097-92be-68b4a4a2ce89"],
Cell[21650, 522, 546, 15, 77, "Input",ExpressionUUID->"fb194081-e7ac-4d2c-8945-eb519094d924"],
Cell[22199, 539, 1254, 33, 108, "Input",ExpressionUUID->"5737d25c-1085-4b32-8f90-f2df91ffc111"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23490, 577, 385, 6, 45, "Subsubsection",ExpressionUUID->"c6209ac5-4aca-46a0-80b4-12bb0397e91d"],
Cell[23878, 585, 1538, 40, 66, "Input",ExpressionUUID->"fee46e49-7817-4bc9-8ac8-4e915f797a09"],
Cell[25419, 627, 1896, 47, 192, "Input",ExpressionUUID->"1de38f8f-130f-41ef-8182-7310ba777150"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27352, 679, 407, 6, 45, "Subsubsection",ExpressionUUID->"d2987021-d9ee-46a7-9581-019b5d2dc577"],
Cell[27762, 687, 712, 18, 52, "Input",ExpressionUUID->"ccd1d429-873e-4ab1-afc6-12810e2440e7"],
Cell[28477, 707, 1506, 39, 75, "Input",ExpressionUUID->"683f1804-9496-4d22-a08d-a54308bc7373"],
Cell[29986, 748, 880, 21, 108, "Input",ExpressionUUID->"727c504c-687f-481c-8406-2c409d2f01ef"],
Cell[30869, 771, 723, 21, 53, "Input",ExpressionUUID->"a67b50a3-3dd6-4729-aa23-940cf612345d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31641, 798, 158, 3, 67, "Section",ExpressionUUID->"e0ed86d8-bbfb-478e-8b23-980728f368f2"],
Cell[31802, 803, 299, 6, 44, "Input",ExpressionUUID->"efb1db04-4be8-4053-9b70-81163b25eea3"],
Cell[32104, 811, 1134, 28, 44, "Input",ExpressionUUID->"0e334b07-23bd-4f58-aee7-dd1bf956ecee"],
Cell[33241, 841, 308, 7, 44, "Input",ExpressionUUID->"f3d0dac4-89fe-4f51-be11-d7df780b509e"],
Cell[CellGroupData[{
Cell[33574, 852, 494, 7, 45, "Subsubsection",ExpressionUUID->"94565e05-bb2c-4dc4-85f2-20a2c0f90d5b"],
Cell[34071, 861, 413, 9, 44, "Input",ExpressionUUID->"fdbeaeb2-9591-4912-a9df-6ed0ab0f4957"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34521, 875, 278, 4, 45, "Subsubsection",ExpressionUUID->"d6728993-c44e-4aa3-abbd-872f10b1eb94"],
Cell[34802, 881, 729, 14, 66, "Input",ExpressionUUID->"b9784432-d5b4-4238-917d-bffc3aaeaf09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35568, 900, 321, 6, 45, "Subsubsection",ExpressionUUID->"f4a5be9a-8718-41e7-90c4-a50097b7a8d3"],
Cell[35892, 908, 1375, 30, 129, "Input",ExpressionUUID->"03d87e71-e679-4b86-ab56-becb89fd987c"]
}, Open  ]],
Cell[37282, 941, 290, 6, 45, "Subsubsection",ExpressionUUID->"b52ce693-8f0e-44e5-918d-10faa6c6b7ab"],
Cell[37575, 949, 391, 7, 37, "Subsubsection",ExpressionUUID->"8ac89f76-bd89-4f07-b398-8bb7570ca8e2"],
Cell[CellGroupData[{
Cell[37991, 960, 596, 11, 89, "Subsubsection",ExpressionUUID->"aa5c798a-d7ed-4148-9b72-2b793467723a"],
Cell[38590, 973, 966, 30, 216, "Input",ExpressionUUID->"310c6695-95cc-4315-b94d-7d634fed4ad8"],
Cell[39559, 1005, 2512, 61, 108, "Input",ExpressionUUID->"852f68a4-9c40-477f-a316-a279abc81327"],
Cell[42074, 1068, 2496, 53, 192, "Input",ExpressionUUID->"0606c1dc-567d-4615-ab82-16d0b7645912"],
Cell[44573, 1123, 1342, 36, 87, "Input",ExpressionUUID->"cc97e413-02d5-4fb6-9bc5-729dcac7da16"],
Cell[45918, 1161, 993, 23, 129, "Input",ExpressionUUID->"50c76194-58a3-4cb6-abc1-14eb5adffa62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46948, 1189, 530, 10, 97, "Subsubsection",ExpressionUUID->"450dcc97-61db-4e31-9c0f-124c60bd5119"],
Cell[47481, 1201, 493, 13, 44, "Input",ExpressionUUID->"933a3393-d134-4bb8-b2af-cec7d8331ea8"],
Cell[47977, 1216, 2059, 48, 129, "Input",ExpressionUUID->"6aadee43-67db-449c-b919-08a2583c39d4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50085, 1270, 208, 4, 67, "Section",ExpressionUUID->"807eca65-8a98-491f-b204-40250f5b0b28"],
Cell[50296, 1276, 220, 5, 44, "Input",ExpressionUUID->"d4844678-b2c7-4a71-841e-e614d4156fe3"],
Cell[50519, 1283, 1067, 23, 44, "Input",ExpressionUUID->"33dc579d-8f76-4e16-893b-db37e09207b3"],
Cell[51589, 1308, 396, 9, 44, "Input",ExpressionUUID->"ee1656a5-399e-4536-83c1-d56d72c6a6ae"],
Cell[51988, 1319, 384, 9, 44, "Input",ExpressionUUID->"0f493189-1b9e-4a83-b13b-46c516622873"],
Cell[52375, 1330, 215, 4, 44, "Input",ExpressionUUID->"802be6d5-0037-43bc-a4ca-98454b39f5e8"],
Cell[CellGroupData[{
Cell[52615, 1338, 271, 4, 45, "Subsubsection",ExpressionUUID->"a167cf2d-745c-47df-aa07-bc5ad531e144"],
Cell[52889, 1344, 2602, 61, 108, "Input",ExpressionUUID->"39b08907-04ff-4b11-9432-f19fa6ebc4a1"],
Cell[55494, 1407, 1395, 37, 87, "Input",ExpressionUUID->"d879d268-f6b2-4cac-87e1-7f1d2b6d6dbd"],
Cell[56892, 1446, 560, 15, 44, "Input",ExpressionUUID->"1e9ab51d-4f87-4896-835b-7cb46cca2804"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57489, 1466, 257, 4, 45, "Subsubsection",ExpressionUUID->"0e9da3bb-694d-458f-898a-45e3788adb61"],
Cell[57749, 1472, 2533, 55, 192, "Input",ExpressionUUID->"b4b66255-f0dc-485a-b308-b20b0c366449"],
Cell[60285, 1529, 1224, 26, 108, "Input",ExpressionUUID->"0285ce90-a614-4ab8-992c-c7bdfee88214"],
Cell[61512, 1557, 1956, 44, 171, "Input",ExpressionUUID->"3540817a-39da-497a-b52e-4f2233a4b169"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63517, 1607, 261, 4, 67, "Section",ExpressionUUID->"d77d6a3b-305f-4e8c-bfc0-e65ef9e31158"],
Cell[63781, 1613, 1040, 24, 108, "Input",ExpressionUUID->"cbb2c81d-76d0-4526-8d31-831b40f9713b"],
Cell[64824, 1639, 997, 23, 66, "Input",ExpressionUUID->"b79c955e-e278-4c67-86b8-c5fb8a865ec3"],
Cell[65824, 1664, 3210, 72, 183, "Input",ExpressionUUID->"da296015-38fb-48ab-bef0-5c4a8cf7533d"],
Cell[69037, 1738, 655, 12, 44, "Input",ExpressionUUID->"2c098fba-0c32-4925-b4ed-e62604c80c05"],
Cell[69695, 1752, 649, 12, 44, "Input",ExpressionUUID->"49721c73-86c5-47f4-9636-1370b6ae9654"],
Cell[70347, 1766, 649, 12, 44, "Input",ExpressionUUID->"9f5ee7c2-69be-4451-b011-91aebdbb27e0"],
Cell[CellGroupData[{
Cell[71021, 1782, 346, 5, 45, "Subsubsection",ExpressionUUID->"7dda8604-a195-4310-a1a7-e355c25980c6"],
Cell[71370, 1789, 2681, 58, 108, "Input",ExpressionUUID->"c3d7a5b9-3d63-4f3a-b0a4-55ff23d41cee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74088, 1852, 309, 5, 45, "Subsubsection",ExpressionUUID->"3863d0e9-c72a-4a8b-9478-8e2fd361f2c3"],
Cell[74400, 1859, 546, 13, 108, "Input",ExpressionUUID->"97adc7fb-9b48-48e6-ba8b-ad33274acf30"],
Cell[74949, 1874, 987, 24, 44, "Input",ExpressionUUID->"3a72c6de-a709-43fa-98fc-3bc0281e83cb"],
Cell[75939, 1900, 1102, 22, 44, "Input",ExpressionUUID->"d4c968d2-fbde-4d61-a368-c82cd962a715"],
Cell[77044, 1924, 505, 10, 87, "Input",ExpressionUUID->"219f98bc-a117-4ebc-ac97-246cc2b7be52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77586, 1939, 482, 10, 123, "Subsubsection",ExpressionUUID->"e02da852-35b6-4233-ad67-789e87b44a63"],
Cell[78071, 1951, 5241, 138, 184, "Input",ExpressionUUID->"3b8e8e22-5d1a-4125-88f4-0438af22d134"],
Cell[83315, 2091, 6545, 162, 381, "Input",ExpressionUUID->"94011b07-587b-44d0-a3d6-f647fb77b2a2"],
Cell[89863, 2255, 1740, 47, 192, "Input",ExpressionUUID->"bbb7caf3-9682-4773-99b5-845afe230134"],
Cell[91606, 2304, 818, 21, 44, "Input",ExpressionUUID->"794258f7-0954-4eb0-b1d4-305a8b23108c"],
Cell[92427, 2327, 569, 12, 44, "Input",ExpressionUUID->"a5c1e262-4972-40c9-858a-f04bd932d23f"],
Cell[92999, 2341, 531, 11, 44, "Input",ExpressionUUID->"af90c1f1-d7f2-4739-8060-d2b6d7717637"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93579, 2358, 303, 5, 67, "Section",ExpressionUUID->"4bdc7f57-87c0-4ca1-ae19-6e4eb0c87871"],
Cell[93885, 2365, 647, 15, 44, "Input",ExpressionUUID->"847c5e1f-0182-40e9-a808-4a2c404b4bfa"],
Cell[94535, 2382, 585, 15, 44, "Input",ExpressionUUID->"7eeff714-c47f-4723-bf18-a2f595248945"],
Cell[95123, 2399, 11682, 288, 612, "Input",ExpressionUUID->"afaffa34-f3a5-4749-8ebd-a9e67e57a542"],
Cell[106808, 2689, 1662, 39, 108, "Input",ExpressionUUID->"23f0f017-220a-44fe-8750-be0344048a6c"],
Cell[108473, 2730, 384, 9, 44, "Input",ExpressionUUID->"951d6b7c-dfac-4b25-aa57-3c9fc8b92f92"]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33748,        856]
NotebookOptionsPosition[     29859,        781]
NotebookOutlinePosition[     30253,        797]
CellTagsIndexPosition[     30210,        794]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Illustrate a problematic elastic map for the built-in Mathematica function \
NMinimize
INSTRUCTIONS: Run common_funs.nb, ES_FindSymGroups.nb, chooseTmat.nb, then \
this notebook\
\>", "Subsubsection",
 CellChangeTimes->{{3.890830810901332*^9, 3.8908308426026735`*^9}, {
  3.893278661162142*^9, 3.8932786741393857`*^9}, {3.893278756078294*^9, 
  3.8932787740663166`*^9}, {3.8932788180017567`*^9, 3.8932788415078044`*^9}, {
  3.8935160470543633`*^9, 3.8935160486827707`*^9}, {3.893780658218905*^9, 
  3.8937806912963953`*^9}, {3.895828355430451*^9, 3.895828376021146*^9}, {
  3.898974131225287*^9, 3.898974170088593*^9}, {3.903349304149493*^9, 
  3.903349304707603*^9}, {3.9033921744207773`*^9, 3.903392199962062*^9}, {
  3.9036332896537733`*^9, 3.9036333153095913`*^9}, {3.9037176254464483`*^9, 
  3.903717630210827*^9}},ExpressionUUID->"f90ce2d8-5692-400e-8ba3-\
7da3acb4a708"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatBrown"}], ";"}]], "Input",
 CellChangeTimes->{{3.903950044107786*^9, 3.903950058828689*^9}},
 CellLabel->
  "In[2020]:=",ExpressionUUID->"29dc9455-8760-4b78-85f3-508dd805718a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The problematic point is the closest MONO to closestMONO (dt = 0.5).
By definition, the closest MONO to closestMONO should have beta = 0, but it \
does not.
This impacts the trajectory from MONO to ORTH as well.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.903948682143021*^9}, {3.903948762903328*^9, 
  3.903948765851276*^9}, {3.903950030433522*^9, 3.903950038671253*^9}, {
  3.9039503940457687`*^9, 3.903950414748888*^9}, {3.903953052705418*^9, 
  3.903953082822302*^9}},ExpressionUUID->"1ec997ee-4d6e-4b93-acea-\
2a4e013504cd"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.013], 
   {GrayLevel[
    0], {PointBox[{1, 0}], PointBox[{2, 0}], PointBox[{3, 0}], 
     PointBox[{4, 0.0648893498413718}], PointBox[{5, 0}], 
     PointBox[{6, 0.17769221815702035`}], PointBox[{7, 0}], 
     PointBox[{8, 1.9056385771839512`}], PointBox[{9, 3.807137918692344}], 
     PointBox[{10, 2.52652167320092}], PointBox[{11, 5.043255901216653}]}, 
    LineBox[{{1, 0}, {2, 0}, {3, 0}, {4, 0.0648893498413718}, {5, 0}, {
      6, 0.17769221815702035`}, {7, 0}, {8, 1.9056385771839512`}, {
      9, 3.807137918692344}, {10, 2.52652167320092}, {
      11, 5.043255901216653}}]}, {InsetBox[
     StyleBox["11",
      StripOnInput->False,
      FontSize->12], {1, -0.30259535407299915}], InsetBox[
     StyleBox["5",
      StripOnInput->False,
      FontSize->12], {2, -0.30259535407299915}], InsetBox[
     StyleBox["3",
      StripOnInput->False,
      FontSize->12], {3, -0.30259535407299915}], InsetBox[
     StyleBox["10",
      StripOnInput->False,
      FontSize->12], {4, -0.30259535407299915}], InsetBox[
     StyleBox["16",
      StripOnInput->False,
      FontSize->12], {5, -0.30259535407299915}], InsetBox[
     StyleBox["15",
      StripOnInput->False,
      FontSize->12], {6, -0.30259535407299915}], InsetBox[
     StyleBox["14",
      StripOnInput->False,
      FontSize->12], {7, -0.30259535407299915}], InsetBox[
     StyleBox["12",
      StripOnInput->False,
      FontSize->12], {8, -0.30259535407299915}], InsetBox[
     StyleBox["8",
      StripOnInput->False,
      FontSize->12], {9, -0.30259535407299915}], InsetBox[
     StyleBox["7",
      StripOnInput->False,
      FontSize->12], {10, -0.30259535407299915}], InsetBox[
     StyleBox["6",
      StripOnInput->False,
      FontSize->12], {11, -0.30259535407299915}]}, {InsetBox[
     StyleBox["\<\"ISO\"\>",
      StripOnInput->False,
      FontSize->11], {1, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {2, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"XISO\"\>",
      StripOnInput->False,
      FontSize->11], {3, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {4, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"TET\"\>",
      StripOnInput->False,
      FontSize->11], {5, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {6, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"ORTH\"\>",
      StripOnInput->False,
      FontSize->11], {7, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {8, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"MONO\"\>",
      StripOnInput->False,
      FontSize->11], {9, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {10, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"TRIV\"\>",
      StripOnInput->False,
      FontSize->11], {11, -0.6051907081459983}]}, InsetBox[
    StyleBox[
     InterpretationBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(MONO\\)]\\)\"\>", 
       "\[InvisibleSpace]", "\<\" (\"\>", "\[InvisibleSpace]", "5.04`", 
       "\[InvisibleSpace]", "\<\")\"\>"}],
      SequenceForm[
      "\!\(\*SubscriptBox[\(\[Beta]\), \(MONO\)]\)", " (", 5.04, ")"],
      Editable->False],
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontSize->15,
     FontColor->GrayLevel[0]], {11.33, 5.043255901216653}, NCache[
    ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
  AspectRatio->1,
  Axes->True,
  AxesOrigin->{1, 0},
  ImageSize->500,
  Ticks->{None, {{0, 
      FormBox["0", TraditionalForm]}, {5, 
      FormBox["5", TraditionalForm]}, {10, 
      FormBox["10", TraditionalForm]}, {15, 
      FormBox["15", TraditionalForm]}, {20, 
      FormBox["20", TraditionalForm]}, {25, 
      FormBox["25", TraditionalForm]}, {30, 
      FormBox["30", TraditionalForm]}, {35, 
      FormBox["35", TraditionalForm]}, {40, 
      FormBox["40", TraditionalForm]}, {45, 
      FormBox["45", TraditionalForm]}, {50, 
      FormBox["50", TraditionalForm]}}},
  TicksStyle->12]], "Output",
 CellChangeTimes->{3.903949821505679*^9},
 CellLabel->
  "Out[1796]=",ExpressionUUID->"003ad0cb-1c84-471a-8114-2583c613c13e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define a function to minimize a square patch.
Adjust d\[Theta] based on how close the local minima are.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.9039487460959673`*^9, 
  3.903948749054757*^9}},ExpressionUUID->"8b95e8c9-8d23-44a9-ba7d-\
35054c0552f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.2", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dphi", "=", "dtheta"}], ";"}]}], "Input",
 CellChangeTimes->{{3.903950092796522*^9, 3.903950092859026*^9}},
 CellLabel->
  "In[2021]:=",ExpressionUUID->"34b04fea-fd14-4d66-9e04-f13c44c84e5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flocal", "[", 
   RowBox[{
   "theta0_", ",", "phi0_", ",", "dtheta_", ",", "dphi_", ",", "Tmat_"}], 
   "]"}], ":=", 
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
       RowBox[{"Tmat", ",", 
        StyleBox[
         RowBox[{"UsHat", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0.", ",", "\[Phi]"}], "}"}], "]"}],
         FontColor->GrayLevel[0]], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        StyleBox["MONO",
         FontColor->GrayLevel[0]]}], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{
        RowBox[{
         RowBox[{"theta0", "-", "dtheta"}], "\[LessEqual]", "\[Theta]", 
         "\[LessEqual]", 
         RowBox[{"theta0", "+", "dtheta"}]}], "&&", 
        RowBox[{
         RowBox[{"phi0", "-", "dphi"}], "\[LessEqual]", "\[Phi]", 
         "\[LessEqual]", 
         RowBox[{"phi0", "+", "dphi"}]}]}],
       FontColor->GrayLevel[0]]}], 
     StyleBox["}",
      FontColor->GrayLevel[0]]}], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}],
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
     FontColor->GrayLevel[0]]}], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.9036083197244177`*^9, 3.903608362376245*^9}, {
  3.9036106472162113`*^9, 3.903610648322323*^9}, {3.9036121192166977`*^9, 
  3.9036121210374107`*^9}, {3.90361339447526*^9, 3.903613398608843*^9}},
 CellLabel->
  "In[2023]:=",ExpressionUUID->"31abb03a-ed54-4e95-a60e-78d266eb5494"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The original GetTempAnd\[Theta]0\[Sigma]0\[Phi]0 from \
ES_FindSymGroups.nb", "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903632223553894*^9, 
  3.903632227295744*^9}},ExpressionUUID->"f7358229-7e46-4932-9f9d-\
0280c2167d6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"\[Pi]", "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}},
 CellLabel->
  "In[2024]:=",ExpressionUUID->"0c383cb1-2c3d-4161-a8cb-af6ebc5d4f47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Closest MONO map to the input TRIV map:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9},ExpressionUUID->"72a9d154-3d91-48c1-ac4d-\
a0bf33b3940f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WantDetails", "=", "\"\<WantDetails\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "MONO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9034909365203495`*^9, 3.9034909417599707`*^9}, {
  3.903490972954488*^9, 3.9034909776829195`*^9}, {3.903492723882085*^9, 
  3.903492724665868*^9}, {3.903774709900457*^9, 3.90377471147127*^9}, {
  3.9038139415681133`*^9, 3.9038139416869392`*^9}},
 CellLabel->
  "In[2025]:=",ExpressionUUID->"92152023-630b-4a45-9e34-aaf460ba5154"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM: Upper left blue patch (green point) and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903615593070054*^9, 
   3.903615596774147*^9}},ExpressionUUID->"6520fd56-9f60-47a2-ba86-\
9283a2d99916"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.75", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"1.5", "\[Pi]"}], ",", 
   RowBox[{"0.3", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.903610836241662*^9, 3.9036108433004313`*^9}, {
  3.903612141937793*^9, 3.903612143727542*^9}, {3.903613404748014*^9, 
  3.903613405946828*^9}},
 CellLabel->
  "In[2027]:=",ExpressionUUID->"774b453e-77cf-459e-8079-59bf4eec5c28"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Central blue patch and its antipode region:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 
  3.903608916512686*^9}},ExpressionUUID->"9dc83fc2-2f65-4b93-a153-\
58f4829fab03"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flocal", "[", 
  RowBox[{"0.", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610844393611*^9, 3.9036108464630632`*^9}, {
  3.903612145409684*^9, 3.9036121533628607`*^9}, {3.903613406999185*^9, 
  3.903613407813992*^9}},
 CellLabel->
  "In[2029]:=",ExpressionUUID->"a8880bcb-4e6b-4517-be83-1a4a6c60536b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lower left blue patch and its antipode region:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903610102058091*^9, 
  3.903610103441699*^9}},ExpressionUUID->"54c9a020-dbfd-4905-ac37-\
1b0c12122fd3"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.4", " ", "\[Pi]"}], ",", 
   RowBox[{"0.2", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"1.4", "\[Pi]"}], ",", 
   RowBox[{"0.8", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610110222937*^9, 3.9036101503750677`*^9}, {
  3.903610849010233*^9, 3.903610849697979*^9}, {3.903612155464027*^9, 
  3.903612156292495*^9}, {3.903613409664483*^9, 3.903613410342144*^9}},
 CellLabel->
  "In[2031]:=",ExpressionUUID->"71f5291d-efee-4f5e-9f4f-346819dcf3dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The full search finds the right minimum (as before):", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608927243236*^9}, {
  3.9036097666270857`*^9, 3.903609774771015*^9}, {3.9036099377892313`*^9, 
  3.903609947136746*^9}},ExpressionUUID->"3419d619-ece2-4939-8b60-\
bf3a2fbadde4"],

Cell[BoxData[
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "Tmat"}], "]"}]], "Input",
 CellChangeTimes->{{3.9036086193953114`*^9, 3.903608621514728*^9}, 
   3.903608688126421*^9, {3.903608939596114*^9, 3.9036089397314053`*^9}, {
   3.903609764509275*^9, 3.903609800384961*^9}, 3.9036108530464354`*^9, 
   3.903612159348856*^9, 3.903613411443239*^9},
 CellLabel->
  "In[2033]:=",ExpressionUUID->"f80e9bf5-aff6-4404-b86d-9b42637a0702"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now we start with the MONO map closest to our initial map.
Same as the 6x6 matrix above:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903613437902824*^9, 3.903613438169568*^9}, {
  3.9039532427530327`*^9, 
  3.9039532444502773`*^9}},ExpressionUUID->"ad06c437-af0b-4c05-bc7e-\
4d4c28767b74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatMONO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "MONO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "TmatMONO", "]"}]}], "Input",
 CellChangeTimes->{{3.9035515547837605`*^9, 3.9035515587197356`*^9}, {
  3.90355316903367*^9, 3.9035531699744463`*^9}, {3.903612226775538*^9, 
  3.903612233635367*^9}, {3.9036134228246*^9, 3.9036134257078238`*^9}, {
  3.9038139492803926`*^9, 3.90381395000098*^9}},
 CellLabel->
  "In[2034]:=",ExpressionUUID->"75cf0133-239d-4a27-adf1-294fa57ec6fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
With the original GetTempAnd\[Theta]0\[Sigma]0\[Phi]0. Mathematica gets the \
wrong min.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.903574224131977*^9, 3.903574227197657*^9}, {3.903610398081959*^9, 
  3.9036103992886143`*^9}, {3.90395333915557*^9, 
  3.9039533398914013`*^9}},ExpressionUUID->"3c77e848-2131-4cf8-8465-\
71236adf7a7b"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"TmatMONO", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.903528230666829*^9, 3.903528235717515*^9}, {
   3.903528291279476*^9, 3.903528321995905*^9}, {3.9035532799654255`*^9, 
   3.9035532829357986`*^9}, {3.903612237242344*^9, 3.90361223822894*^9}, 
   3.9036134432383747`*^9, {3.903813955037669*^9, 3.903813956040202*^9}},
 CellLabel->
  "In[2036]:=",ExpressionUUID->"8f6cda3e-f1eb-4a6f-8c02-e3271bbe3b49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"TmatMONO", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellChangeTimes->{{3.903564672712715*^9, 3.9035646928964877`*^9}, {
   3.903564842549506*^9, 3.903564844425836*^9}, {3.903612247135099*^9, 
   3.9036122479481583`*^9}, 3.9036134470431128`*^9, {3.903813958120751*^9, 
   3.903813958832635*^9}},
 CellLabel->
  "In[2037]:=",ExpressionUUID->"c2032a0d-cd2e-4b5d-b2cf-fc10d45cf7a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM: Upper left blue patch and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903610207365817*^9, 
   3.9036102166388197`*^9}},ExpressionUUID->"a2806c8a-287b-4583-9c97-\
d6053ea472c6"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.75", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"1.5", "\[Pi]"}], ",", 
   RowBox[{"0.3", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.903610187854774*^9, 3.9036101953786793`*^9}, {
  3.903610708423315*^9, 3.903610713432969*^9}, {3.90361225917003*^9, 
  3.903612264148344*^9}, {3.9036134494371862`*^9, 3.903613450160366*^9}},
 CellLabel->
  "In[2038]:=",ExpressionUUID->"2bc30d43-c627-4d03-bad0-60add1091f21"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
INCORRECT MINIMUM: Central blue patch and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903610219804668*^9, 
  3.903610222790009*^9}},ExpressionUUID->"2ac21f6f-281e-498c-9b41-\
c4c339d00b44"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flocal", "[", 
  RowBox[{"0.", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610189225421*^9, 3.903610193835452*^9}, {
  3.903610715069703*^9, 3.903610726460271*^9}, {3.9036122678237247`*^9, 
  3.9036122725663013`*^9}, {3.903613451404108*^9, 3.90361345217169*^9}},
 CellLabel->
  "In[2040]:=",ExpressionUUID->"4e069087-6657-438e-b060-6fa0deaf6650"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
LOCAL MINIMUM: Lower left blue patch (green dot) and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903610102058091*^9, 3.903610103441699*^9}, {3.903615577094337*^9, 
  3.9036155812890472`*^9}, {3.903632459934937*^9, 
  3.9036324623550463`*^9}},ExpressionUUID->"b8fc7116-d32a-41f3-9ac7-\
95e84465cf6d"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.4", " ", "\[Pi]"}], ",", 
   RowBox[{"0.2", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"1.4", "\[Pi]"}], ",", 
   RowBox[{"0.8", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610110222937*^9, 3.9036101503750677`*^9}, {
  3.903610190761064*^9, 3.903610192536477*^9}, {3.9036107170559063`*^9, 
  3.903610728404282*^9}, {3.903612277288454*^9, 3.903612281505413*^9}, {
  3.903613453273155*^9, 3.903613453998769*^9}},
 CellLabel->
  "In[2042]:=",ExpressionUUID->"9ead269b-cfa9-4dd2-8aca-7b91a7baa5bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
By extending the \[Theta] search range slightly, it finds the correct minimum:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903621290344014*^9, 
  3.903621291677219*^9}, {3.9036322708984537`*^9, 3.903632289072583*^9}, {
  3.903633162568083*^9, 3.903633163355859*^9}, {3.903774754624404*^9, 
  3.903774755378228*^9}, {3.903953434093707*^9, 
  3.903953459551322*^9}},ExpressionUUID->"fb49c27f-5cef-4823-ae8c-\
42b3af1a3efa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fac", "=", "1.15"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"NMinimize", " ", "fails"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fac", "=", "1.2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"NMinimize", " ", "works"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            RowBox[{
             StyleBox["fac",
              FontColor->RGBColor[1, 0, 0]], " ", 
             StyleBox["\[Pi]",
              FontColor->RGBColor[1, 0, 0]]}], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"TmatMONO", ",", "MONO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.903632775123807*^9, 3.9036327772790728`*^9}, {
  3.903632828774523*^9, 3.903632828889262*^9}, {3.90363286001886*^9, 
  3.903632872003104*^9}, {3.903632924761256*^9, 3.903632974089238*^9}, {
  3.903633038406363*^9, 3.903633095775194*^9}, {3.9037747689843493`*^9, 
  3.903774776381312*^9}, {3.903813999671261*^9, 3.9038140003651752`*^9}},
 CellLabel->
  "In[2046]:=",ExpressionUUID->"6d93c447-65a7-4370-a702-c2d72cf99ece"]
}, Open  ]]
},
WindowSize->{1045, 946},
WindowMargins->{{Automatic, 137}, {Automatic, 29}},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"60d140f9-3644-4213-b230-2811dc283c42"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 887, 15, 71, "Subsubsection",ExpressionUUID->"f90ce2d8-5692-400e-8ba3-7da3acb4a708"],
Cell[1470, 39, 238, 5, 30, "Input",ExpressionUUID->"29dc9455-8760-4b78-85f3-508dd805718a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1745, 49, 765, 13, 97, "Subsubsection",ExpressionUUID->"1ec997ee-4d6e-4b93-acea-2a4e013504cd"],
Cell[2513, 64, 4444, 114, 439, "Output",ExpressionUUID->"003ad0cb-1c84-471a-8114-2583c613c13e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6994, 183, 416, 8, 71, "Subsubsection",ExpressionUUID->"8b95e8c9-8d23-44a9-ba7d-35054c0552f2"],
Cell[7413, 193, 335, 8, 52, "Input",ExpressionUUID->"34b04fea-fd14-4d66-9e04-f13c44c84e5c"],
Cell[7751, 203, 1850, 55, 73, "Input",ExpressionUUID->"31abb03a-ed54-4e95-a60e-78d266eb5494"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9638, 263, 620, 9, 45, "Subsubsection",ExpressionUUID->"f7358229-7e46-4932-9f9d-0280c2167d6c"],
Cell[10261, 274, 3060, 87, 136, "Input",ExpressionUUID->"0c383cb1-2c3d-4161-a8cb-af6ebc5d4f47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13358, 366, 368, 5, 45, "Subsubsection",ExpressionUUID->"72a9d154-3d91-48c1-ac4d-a0bf33b3940f"],
Cell[13729, 373, 544, 11, 52, "Input",ExpressionUUID->"92152023-630b-4a45-9e34-aaf460ba5154"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14310, 389, 416, 7, 45, "Subsubsection",ExpressionUUID->"6520fd56-9f60-47a2-ba86-9283a2d99916"],
Cell[14729, 398, 755, 17, 52, "Input",ExpressionUUID->"774b453e-77cf-459e-8079-59bf4eec5c28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15521, 420, 347, 5, 45, "Subsubsection",ExpressionUUID->"9dc83fc2-2f65-4b93-a153-58f4829fab03"],
Cell[15871, 427, 703, 15, 52, "Input",ExpressionUUID->"a8880bcb-4e6b-4517-be83-1a4a6c60536b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16611, 447, 399, 6, 45, "Subsubsection",ExpressionUUID->"54c9a020-dbfd-4905-ac37-1b0c12122fd3"],
Cell[17013, 455, 797, 17, 52, "Input",ExpressionUUID->"71f5291d-efee-4f5e-9f4f-346819dcf3dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17847, 477, 455, 6, 45, "Subsubsection",ExpressionUUID->"3419d619-ece2-4939-8b60-bf3a2fbadde4"],
Cell[18305, 485, 521, 10, 30, "Input",ExpressionUUID->"f80e9bf5-aff6-4404-b86d-9b42637a0702"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18863, 500, 452, 9, 71, "Subsubsection",ExpressionUUID->"ad06c437-af0b-4c05-bc7e-4d4c28767b74"],
Cell[19318, 511, 562, 11, 52, "Input",ExpressionUUID->"75cf0133-239d-4a27-adf1-294fa57ec6fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19917, 527, 396, 8, 45, "Subsubsection",ExpressionUUID->"3c77e848-2131-4cf8-8465-71236adf7a7b"],
Cell[20316, 537, 468, 8, 30, "Input",ExpressionUUID->"8f6cda3e-f1eb-4a6f-8c02-e3271bbe3b49"],
Cell[20787, 547, 451, 9, 30, "Input",ExpressionUUID->"c2032a0d-cd2e-4b5d-b2cf-fc10d45cf7a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21275, 561, 404, 7, 45, "Subsubsection",ExpressionUUID->"a2806c8a-287b-4583-9c97-d6053ea472c6"],
Cell[21682, 570, 810, 17, 52, "Input",ExpressionUUID->"2bc30d43-c627-4d03-bad0-60add1091f21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22529, 592, 423, 8, 45, "Subsubsection",ExpressionUUID->"2ac21f6f-281e-498c-9b41-c4c339d00b44"],
Cell[22955, 602, 756, 15, 52, "Input",ExpressionUUID->"4e069087-6657-438e-b060-6fa0deaf6650"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23748, 622, 533, 9, 45, "Subsubsection",ExpressionUUID->"b8fc7116-d32a-41f3-9ac7-95e84465cf6d"],
Cell[24284, 633, 856, 18, 52, "Input",ExpressionUUID->"9ead269b-cfa9-4dd2-8aca-7b91a7baa5bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25177, 656, 826, 13, 45, "Subsubsection",ExpressionUUID->"fb49c27f-5cef-4823-ae8c-42b3af1a3efa"],
Cell[26006, 671, 3837, 107, 199, "Input",ExpressionUUID->"6d93c447-65a7-4370-a702-c2d72cf99ece"]
}, Open  ]]
}
]
*)


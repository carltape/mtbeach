(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27658,        627]
NotebookOptionsPosition[     26576,        590]
NotebookOutlinePosition[     27148,        611]
CellTagsIndexPosition[     27105,        608]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Supporting software for W. Tape and C. Tape,
\[OpenCurlyDoubleQuote]Elastic symmetry with beachball pictures\
\[CloseCurlyDoubleQuote] (2021 GJI).
Equation/section/figure numbers are from the paper. 
\
\>", "Subsubsection",
 CellChangeTimes->{{3.823395561256716*^9, 3.823395597101345*^9}, 
   3.8233986511201973`*^9, {3.829239841508174*^9, 3.829239887023471*^9}, {
   3.8292401146810503`*^9, 3.829240120992628*^9}, {3.8298243059093733`*^9, 
   3.829824312759672*^9}, {3.830281519760976*^9, 3.830281544582182*^9}, {
   3.8311161931833076`*^9, 3.8311161949648533`*^9}, {3.831218629093547*^9, 
   3.831218632794236*^9}, 3.831218765802577*^9}],

Cell[CellGroupData[{

Cell["\<\
Section 2.2.2 [see also elastic_mapping_ex7_none.nb]
THIS MATRIX IS MODIFIED FROM EQ 23 -- HERE IT HAS NO 1/5 FACTOR.
THE 1/5 FACTOR WAS USED IN ORDER TO HAVE EIGENVALUES THAT WERE SMALLER AND \
CLOSER TO 1.\
\>", "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.823014467466748*^9, 3.8230144692648273`*^9}, {
   3.8230145172388773`*^9, 3.8230145382989864`*^9}, {3.823395639305503*^9, 
   3.8233956406158333`*^9}, {3.8293319731901197`*^9, 3.829331975374164*^9}, {
   3.8311464179362917`*^9, 3.831146436627475*^9}, {3.831218692710463*^9, 
   3.831218710006412*^9}, {3.8312251871137123`*^9, 3.831225214162472*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tmat", "=", "\[InvisibleSpace]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"5", "0", "0", 
         RowBox[{"-", "2"}], "0", "0"},
        {"0", "6", "0", "0", 
         RowBox[{"-", "2"}], "0"},
        {"0", "0", "5", "0", "0", "0"},
        {
         RowBox[{"-", "2"}], "0", "0", "5", "0", "0"},
        {"0", 
         RowBox[{"-", "2"}], "0", "0", "6", "0"},
        {"0", "0", "0", "0", "0", "6"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], "     ", 
  RowBox[{
   StyleBox["(*",
    FontColor->GrayLevel[0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox[
    RowBox[{"Eq", " ", 
     RowBox[{"(", "23", ")"}], " ", "without", " ", 
     RowBox[{"1", "/", "5"}], " ", "factor"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->GrayLevel[0.5]]}]}]], "Input",
 CellChangeTimes->{{3.8230142368022685`*^9, 3.823014252527461*^9}, 
   3.82301431802474*^9, {3.829332013202524*^9, 3.829332023752008*^9}, {
   3.831218712659933*^9, 3.831218721357514*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Emat", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "1", "0"},
      {"0", "0", "4"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";", 
  "     ", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"Eq", " ", 
     RowBox[{"(", "22", ")"}]}], " ", "*)"}],
   FontColor->GrayLevel[0.5]], "\[IndentingNewLine]", 
  RowBox[{"Fvec", "=", 
   RowBox[{"Tmat", ".", 
    RowBox[{"BBcoords", "[", "Emat", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fmat", "=", 
   RowBox[{"MatrixFromBBcoords", "[", "Fvec", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<[T\!\(\*SubscriptBox[\(]\), \(BB\)]\) = \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"denominator", " ", "Tmat"}], "]"}], "]"}], ",", " ", 
     "\"\<      (Eq (23) in paper)\>\""}], "]"}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<E = \>\"", ",", 
     RowBox[{"MatrixForm", "[", "Emat", "]"}]}], "]"}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<[E\!\(\*SubscriptBox[\"]\", 
StyleBox[\"B\",
FontFamily->\"Courier New\",
FontSize->14]]\) = \>\"", ",", 
    RowBox[{"Simplify", "[", 
     RowBox[{"BBcoords", "[", "Emat", "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<[T(E)\!\(\*SubscriptBox[\"]\", 
StyleBox[\"B\",
FontFamily->\"Courier New\",
FontSize->14]]\) = [T\!\(\*SubscriptBox[\"]\", 
StyleBox[\"BB\",
FontFamily->\"Courier New\",
FontSize->14]]\) [E\!\(\*SubscriptBox[\"]\", 
StyleBox[\"B\",
FontFamily->\"Courier New\",
FontSize->14]]\) = \>\"", ",", 
    RowBox[{"FullSimplify", "[", "Fmat", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<T(E) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"FullSimplify", "[", 
     StyleBox["Fmat",
      FontColor->GrayLevel[0]], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.784485753063143*^9, 3.784485840109955*^9}, {
   3.784486154112197*^9, 3.7844862106623316`*^9}, {3.7844898567201667`*^9, 
   3.7844898853498583`*^9}, {3.7844902337576303`*^9, 
   3.7844902508229747`*^9}, {3.784492031696679*^9, 3.7844920335560665`*^9}, {
   3.7844922201547365`*^9, 3.7844922258585567`*^9}, {3.7845142014360285`*^9, 
   3.784514202357899*^9}, {3.784568280444154*^9, 3.784568365318034*^9}, {
   3.7845684284506493`*^9, 3.7845685219399557`*^9}, {3.7845685606959763`*^9, 
   3.7845686700376143`*^9}, {3.7845687466302557`*^9, 
   3.7845687991412582`*^9}, {3.784568884734619*^9, 3.7845688889221272`*^9}, 
   3.784568921898036*^9, {3.784569075797982*^9, 3.7845690923645415`*^9}, 
   3.7845691522724695`*^9, {3.784569342992133*^9, 3.7845693497433243`*^9}, {
   3.7845693812319803`*^9, 3.784569497037727*^9}, {3.784569543467268*^9, 
   3.7845695790223246`*^9}, 3.7845696261583643`*^9, {3.7845734464952717`*^9, 
   3.784573462246401*^9}, {3.784573614532589*^9, 3.784573638457378*^9}, {
   3.784573673680604*^9, 3.784573798768009*^9}, {3.7851037041809506`*^9, 
   3.7851037067747154`*^9}, {3.785205149562662*^9, 3.7852051585789146`*^9}, {
   3.786046622301008*^9, 3.7860466300770087`*^9}, {3.7860468646390095`*^9, 
   3.786046869020006*^9}, {3.7867339922297544`*^9, 3.7867339970752096`*^9}, {
   3.786756681449721*^9, 3.786756684056719*^9}, {3.7867584050843906`*^9, 
   3.786758433964387*^9}, {3.78675846548339*^9, 3.78675850330639*^9}, {
   3.78675857645839*^9, 3.7867586252923927`*^9}, {3.7867586718563905`*^9, 
   3.7867586798853893`*^9}, {3.7867587252923746`*^9, 
   3.7867587259163895`*^9}, {3.78675879036539*^9, 3.786758790844387*^9}, {
   3.7867607621453776`*^9, 3.7867607789883785`*^9}, {3.7878668786792374`*^9, 
   3.787866895459239*^9}, {3.7878669845812407`*^9, 3.7878670064672365`*^9}, {
   3.7878670485542374`*^9, 3.787867117461237*^9}, {3.787867191336239*^9, 
   3.787867214886237*^9}, {3.7878672602932425`*^9, 3.787867285957239*^9}, {
   3.7878673266472363`*^9, 3.787867338520237*^9}, {3.7878678027912483`*^9, 
   3.787867886805236*^9}, {3.7878679295872498`*^9, 3.7878679401662416`*^9}, {
   3.7878680027902403`*^9, 3.7878680032372274`*^9}, 3.7890873062299805`*^9, 
   3.7890887743041267`*^9, {3.7920842457092595`*^9, 3.7920842495482607`*^9}, 
   3.795878309394946*^9, {3.7958815851406565`*^9, 3.795881663288494*^9}, 
   3.7967328894879985`*^9, {3.7967331196942024`*^9, 3.7967332645115747`*^9}, {
   3.796733321614849*^9, 3.796733331508827*^9}, {3.796733463703419*^9, 
   3.796733506809387*^9}, {3.796733546338855*^9, 3.7967335481855645`*^9}, {
   3.7967411315295377`*^9, 3.796741152018135*^9}, {3.7967413100390043`*^9, 
   3.7967413236069326`*^9}, {3.7967414675679135`*^9, 3.796741570896435*^9}, {
   3.796741748383411*^9, 3.7967418014435377`*^9}, {3.7967425233962517`*^9, 
   3.7967425544673176`*^9}, {3.796744059510317*^9, 3.7967440889703355`*^9}, {
   3.79674417835292*^9, 3.7967441809329453`*^9}, {3.7967442263185005`*^9, 
   3.796744266423231*^9}, {3.7967443080433235`*^9, 3.796744313878334*^9}, 
   3.796748683349861*^9, {3.7998946390433345`*^9, 3.7998946803173485`*^9}, {
   3.7998953163854017`*^9, 3.7998953193169804`*^9}, {3.7998953833739214`*^9, 
   3.7998953937623262`*^9}, {3.799899003664321*^9, 3.799899006478409*^9}, {
   3.7998990383011265`*^9, 3.7998991446112413`*^9}, 3.7998991869805713`*^9, 
   3.799941901189232*^9, {3.8095329002004156`*^9, 3.8095329306798177`*^9}, {
   3.8095329915357213`*^9, 3.8095330251283274`*^9}, {3.809533061611264*^9, 
   3.809533080521224*^9}, 3.80953319921325*^9, {3.8180958666135044`*^9, 
   3.818095894595036*^9}, {3.818095933388815*^9, 3.8180959347086906`*^9}, {
   3.818096017526526*^9, 3.8180960469387846`*^9}, {3.822843302086482*^9, 
   3.822843351256476*^9}, {3.8228434800874686`*^9, 3.8228435324864855`*^9}, {
   3.8228437891104712`*^9, 3.822843842724476*^9}, {3.822844310886476*^9, 
   3.822844373141479*^9}, {3.822844451190479*^9, 3.8228444778294687`*^9}, {
   3.8228445219744887`*^9, 3.822844587477478*^9}, {3.823014323040011*^9, 
   3.823014329767253*^9}, {3.8230144121705246`*^9, 3.8230144281450987`*^9}, {
   3.829234040415694*^9, 3.829234059604354*^9}, {3.8292341181163692`*^9, 
   3.829234120146386*^9}, {3.830345749350686*^9, 3.830345754297881*^9}, {
   3.831124784588636*^9, 3.831124825367519*^9}, {3.831125493788682*^9, 
   3.8311255584868107`*^9}, {3.8312187284311867`*^9, 
   3.8312187285213957`*^9}, {3.831225042288103*^9, 3.831225091680978*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Section 2.2.2 [optional] : action of T on B1, ..., B6\
\>", "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.823014467466748*^9, 3.8230144692648273`*^9}, {
   3.8230145172388773`*^9, 3.8230145382989864`*^9}, {3.823395639305503*^9, 
   3.8233956406158333`*^9}, {3.8293319731901197`*^9, 3.829331975374164*^9}, {
   3.831134949381502*^9, 3.83113496713999*^9}, {3.831146490139083*^9, 
   3.831146498131888*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fac", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tcols", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Tmat", " ", "fac"}], ")"}], ".", 
    RowBox[{"BBcoords", "/@", "basisBB"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "Tcols"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"(", 
    RowBox[{"MatrixFromBBcoords", "/@", "Tcols"}], ")"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8311468744604607`*^9, 3.831146877538534*^9}, {
  3.831146962996667*^9, 3.8311470627579937`*^9}, {3.8312187742169113`*^9, 
  3.831218774333426*^9}, {3.8312251141559963`*^9, 3.831225124517785*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Section 2.2.2 [optional] : visualizing the input and output beachballs\
\>", "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.823014467466748*^9, 3.8230144692648273`*^9}, {
   3.8230145172388773`*^9, 3.8230145382989864`*^9}, {3.823395639305503*^9, 
   3.8233956406158333`*^9}, {3.8293319731901197`*^9, 3.829331975374164*^9}, {
   3.831134949381502*^9, 3.83113496713999*^9}}],

Cell["Eigenvalues and norms :", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}, {
  3.823011528688262*^9, 3.823011549857715*^9}, {3.8302660893207617`*^9, 
  3.83026612249611*^9}, {3.830266728600277*^9, 3.830266731711629*^9}, {
  3.830266773176055*^9, 3.830266774338895*^9}, {3.831133744859105*^9, 
  3.831133745178101*^9}, {3.8311346002604103`*^9, 3.8311346523733387`*^9}, {
  3.831135007117797*^9, 3.831135027648512*^9}}],

Cell[BoxData[{
 RowBox[{"1.", 
  RowBox[{
  "\[CapitalLambda]ofMnotNormalized", "[", "Emat", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"1.", 
  RowBox[{
  "\[CapitalLambda]ofMnotNormalized", "[", "Fmat", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NormMatrix", "[", 
  RowBox[{"1.", "Emat"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NormMatrix", "[", 
  RowBox[{"1.", "Fmat"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"GEvals", ",", "GEvecs"}], "}"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Eigensystem", "[", "Fmat", "]"}], "]"}]}], ";"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.831130899531124*^9, 3.8311309330022326`*^9}, 
   3.831131027673217*^9, {3.8311316375793285`*^9, 3.8311316446663294`*^9}, {
   3.831135020158161*^9, 3.831135049204363*^9}}],

Cell["\<\
Plot a beachball for the input E (strain) :
(We perturb the beachball to emphasize that it is NOT an isotropic beachball.)\
\>", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}, {
  3.823011528688262*^9, 3.823011549857715*^9}, {3.8302660893207617`*^9, 
  3.83026612249611*^9}, {3.830266728600277*^9, 3.830266731711629*^9}, {
  3.830266773176055*^9, 3.830266774338895*^9}, {3.831133744859105*^9, 
  3.831133745178101*^9}, {3.8311346002604103`*^9, 3.8311346523733387`*^9}}],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"mat3x3", "=", "Emat"}],
   FontColor->RGBColor[1, 0, 0]], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"30", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "30"}], ",", "65"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tkns", "=", ".013"}], ";", 
  RowBox[{"BBrad", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", ".2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Epsilon]In", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]In", "  ", "=", 
    RowBox[{"-", "1.015"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"perturbation", " ", "factor", " ", "for", " ", "beachballs"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PrintEye", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<BBrad = \>\"", ",", "BBrad"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]In", "\[NotEqual]", "0."}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<The beachball is \!\(\*\n\
StyleBox[\\\"perturbed\\\",\\nFontColor->RGBColor[1, 0, 0]]\),   \
\[CapitalLambda] + \[Epsilon](1,1,1) = \>\"", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"PaddedForm", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", "mat3x3", "]"}], 
         "+", 
         RowBox[{"\[Epsilon]In", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], ")"}]}], ",", 
      "\"\<,   \[Epsilon]In  = \>\"", ",", "\[Epsilon]In"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<mat3x3 = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "mat3x3", "]"}], ",", 
    "\"\<,  but the beachball is not scaled\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BeachballForM", "[", 
      RowBox[{
       RowBox[{"1.", 
        RowBox[{"PerturbMatrix", "[", 
         RowBox[{"mat3x3", ",", "\[Epsilon]In"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NormMatrix", "[", "mat3x3", "]"}], "*)"}], "BBrad"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Paxes", "[", 
      RowBox[{"True", ",", 
       StyleBox["False",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[",",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["False",
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{
        RowBox[{"Uraw", "[", "mat3x3", "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"1.5", "BBrad"}], ",", "BBrad", ",", "ArrowScale", ",", 
       RowBox[{".8", "tkns"}], ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
      "]"}]}], " ", "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831125423096257*^9, 3.831125425156006*^9}, {
   3.831125645552698*^9, 3.831125698428095*^9}, {3.8311290957090025`*^9, 
   3.831129167449684*^9}, {3.831129431113014*^9, 3.8311294321057615`*^9}, {
   3.8311295684593554`*^9, 3.8311296246521587`*^9}, {3.8311296614330435`*^9, 
   3.831129663977043*^9}, {3.831129811769062*^9, 3.831129836425065*^9}, {
   3.831129998633086*^9, 3.8311301040730996`*^9}, {3.831130410429171*^9, 
   3.8311304742651463`*^9}, {3.8311305143131514`*^9, 
   3.8311305154500628`*^9}, {3.8311305607931576`*^9, 3.831130653543282*^9}, {
   3.8311307190297966`*^9, 3.8311307736112194`*^9}, {3.8311309419152403`*^9, 
   3.831130944539238*^9}, {3.83113098857224*^9, 3.831131036889218*^9}, {
   3.8311310745882397`*^9, 3.831131109977227*^9}, 3.831131143913231*^9, 
   3.8311311838828487`*^9, {3.831131227785242*^9, 3.831131256745246*^9}, {
   3.83113129204125*^9, 3.8311313208572536`*^9}, {3.831131429802594*^9, 
   3.8311314328908696`*^9}, {3.831131483671266*^9, 3.8311316193233204`*^9}, {
   3.831131660444327*^9, 3.8311317209053125`*^9}, {3.831131820585249*^9, 
   3.8311318390173197`*^9}, {3.831132436377613*^9, 3.831132453611096*^9}, {
   3.83113255780179*^9, 3.8311325955912237`*^9}, 3.831132649699299*^9, {
   3.831132701484988*^9, 3.8311327058991103`*^9}, {3.831132740568945*^9, 
   3.8311328035631104`*^9}, {3.8311328346205606`*^9, 
   3.8311328352560787`*^9}, {3.831132919051882*^9, 3.831133008460001*^9}, {
   3.8311330475774317`*^9, 3.8311330607151594`*^9}, {3.8311331611485786`*^9, 
   3.831133334780611*^9}, {3.8311335966346655`*^9, 3.831133613145096*^9}, {
   3.831133678635686*^9, 3.831133695577468*^9}, {3.831134507178109*^9, 
   3.831134507641377*^9}, {3.831134701680153*^9, 3.831134711731854*^9}, {
   3.8311347801734858`*^9, 3.831134816696011*^9}, {3.831134858556459*^9, 
   3.831134890541*^9}, {3.831135691276381*^9, 3.831135724252001*^9}, 
   3.831135812971092*^9, {3.831144325420372*^9, 3.831144330964264*^9}}],

Cell["\<\
Plot a beachball for the output F (stress) :
(We perturb the beachball to emphasize that it is NOT an isotropic beachball.)\
\>", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}, {
  3.823011528688262*^9, 3.823011549857715*^9}, {3.8302660893207617`*^9, 
  3.83026612249611*^9}, {3.830266728600277*^9, 3.830266731711629*^9}, {
  3.830266773176055*^9, 3.830266774338895*^9}, {3.831133744859105*^9, 
  3.831133745178101*^9}, {3.8311346002604103`*^9, 3.831134682125046*^9}}],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"mat3x3", "=", "Fmat"}],
   FontColor->RGBColor[1, 0, 0]], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Epsilon]In", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]In", "  ", "=", 
   RowBox[{"-", "5.5"}]}], ";", "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"perturbation", " ", "factor", " ", "for", " ", "beachballs"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", "PrintEye", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<BBrad = \>\"", ",", "BBrad"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]In", "\[NotEqual]", "0."}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<The beachball is \!\(\*\n\
StyleBox[\\\"perturbed\\\",\\nFontColor->RGBColor[1, 0, 0]]\),   \
\[CapitalLambda] + \[Epsilon](1,1,1) = \>\"", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"PaddedForm", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", "mat3x3", "]"}], 
         "+", 
         RowBox[{"\[Epsilon]In", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], ")"}]}], ",", 
      "\"\<,   \[Epsilon]In  = \>\"", ",", "\[Epsilon]In"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<mat3x3 = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "mat3x3", "]"}], ",", 
    "\"\<,  but the beachball is not scaled\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BeachballForM", "[", 
      RowBox[{
       RowBox[{"1.", 
        RowBox[{"PerturbMatrix", "[", 
         RowBox[{"mat3x3", ",", "\[Epsilon]In"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NormMatrix", "[", "mat3x3", "]"}], "*)"}], "BBrad"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Paxes", "[", 
      RowBox[{"True", ",", 
       StyleBox["True",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[",",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["True",
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{
        RowBox[{"Uraw", "[", "mat3x3", "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"1.5", "BBrad"}], ",", "BBrad", ",", "ArrowScale", ",", 
       RowBox[{".8", "tkns"}], ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
      "]"}]}], " ", "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831125423096257*^9, 3.831125425156006*^9}, {
   3.831125645552698*^9, 3.831125698428095*^9}, {3.8311290957090025`*^9, 
   3.831129167449684*^9}, {3.831129431113014*^9, 3.8311294321057615`*^9}, {
   3.8311295684593554`*^9, 3.8311296246521587`*^9}, {3.8311296614330435`*^9, 
   3.831129663977043*^9}, {3.831129811769062*^9, 3.831129836425065*^9}, {
   3.831129998633086*^9, 3.8311301040730996`*^9}, {3.831130410429171*^9, 
   3.8311304742651463`*^9}, {3.8311305143131514`*^9, 
   3.8311305154500628`*^9}, {3.8311305607931576`*^9, 3.831130653543282*^9}, {
   3.8311307190297966`*^9, 3.8311307736112194`*^9}, {3.8311309419152403`*^9, 
   3.831130944539238*^9}, {3.83113098857224*^9, 3.831131036889218*^9}, {
   3.8311310745882397`*^9, 3.831131109977227*^9}, 3.831131143913231*^9, 
   3.8311311838828487`*^9, {3.831131227785242*^9, 3.831131256745246*^9}, {
   3.83113129204125*^9, 3.8311313208572536`*^9}, {3.831131429802594*^9, 
   3.8311314328908696`*^9}, {3.831131483671266*^9, 3.8311316193233204`*^9}, {
   3.831131660444327*^9, 3.8311317209053125`*^9}, {3.831131820585249*^9, 
   3.8311318390173197`*^9}, {3.831132436377613*^9, 3.831132453611096*^9}, {
   3.83113255780179*^9, 3.8311325955912237`*^9}, 3.831132649699299*^9, {
   3.831132701484988*^9, 3.8311327058991103`*^9}, {3.831132740568945*^9, 
   3.8311328035631104`*^9}, {3.8311328346205606`*^9, 
   3.8311328352560787`*^9}, {3.831132919051882*^9, 3.831133008460001*^9}, {
   3.8311330475774317`*^9, 3.8311330607151594`*^9}, {3.8311331611485786`*^9, 
   3.831133334780611*^9}, {3.8311335966346655`*^9, 3.831133613145096*^9}, {
   3.831133678635686*^9, 3.831133695577468*^9}, {3.831134507178109*^9, 
   3.831134507641377*^9}, {3.831134718713263*^9, 3.831134745748781*^9}, {
   3.831135400664568*^9, 3.831135431232826*^9}, {3.831135602381033*^9, 
   3.831135617907707*^9}, {3.8311357387331142`*^9, 3.831135809506493*^9}, {
   3.831144335479455*^9, 3.831144339549334*^9}, {3.831225145742621*^9, 
   3.83122516003712*^9}}]
}, Open  ]]
},
WindowSize->{1361, 862},
WindowMargins->{{Automatic, 512}, {Automatic, -9}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/carltape/REPOSITORIES/mtbeach/plot/mma/print.\
pdf"},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 649, 12, 107, "Subsubsection"],
Cell[CellGroupData[{
Cell[1232, 36, 1120, 17, 78, "Subsubsection"],
Cell[2355, 55, 1599, 45, 114, "Input"],
Cell[3957, 102, 6938, 134, 222, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10932, 241, 915, 14, 35, "Subsubsection"],
Cell[11850, 257, 727, 17, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12614, 279, 882, 13, 35, "Subsubsection"],
Cell[13499, 294, 447, 6, 31, "Text"],
Cell[13949, 302, 870, 24, 121, "Input"],
Cell[14822, 328, 505, 8, 51, "Text"],
Cell[15330, 338, 5532, 124, 363, "Input"],
Cell[20865, 464, 504, 8, 51, "Text"],
Cell[21372, 474, 5188, 113, 297, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

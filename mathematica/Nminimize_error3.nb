(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23074,        597]
NotebookOptionsPosition[     20180,        542]
NotebookOutlinePosition[     20574,        558]
CellTagsIndexPosition[     20531,        555]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Illustrate a problematic elastic map for the built-in Mathematica function \
NMinimize
INSTRUCTIONS: Run common_funs.nb, ES_FindSymGroups.nb, chooseTmat.nb, then \
this notebook\
\>", "Subsubsection",
 CellChangeTimes->{{3.890830810901332*^9, 3.8908308426026735`*^9}, {
  3.893278661162142*^9, 3.8932786741393857`*^9}, {3.893278756078294*^9, 
  3.8932787740663166`*^9}, {3.8932788180017567`*^9, 3.8932788415078044`*^9}, {
  3.8935160470543633`*^9, 3.8935160486827707`*^9}, {3.893780658218905*^9, 
  3.8937806912963953`*^9}, {3.895828355430451*^9, 3.895828376021146*^9}, {
  3.898974131225287*^9, 3.898974170088593*^9}, {3.903349304149493*^9, 
  3.903349304707603*^9}, {3.9033921744207773`*^9, 3.903392199962062*^9}, {
  3.9036332896537733`*^9, 3.9036333153095913`*^9}, {3.9037176254464483`*^9, 
  3.903717630210827*^9}},ExpressionUUID->"f90ce2d8-5692-400e-8ba3-\
7da3acb4a708"],

Cell[CellGroupData[{

Cell["The problematic point is between TRIV and MONO (Igel map):", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.903948682143021*^9}, {3.903948762903328*^9, 
  3.903948765851276*^9}},ExpressionUUID->"d026c002-e607-4996-97e8-\
020f8c61463c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatIgel"}], ";"}]], "Input",
 CellChangeTimes->{{3.903911975098435*^9, 3.903911984132441*^9}, {
  3.9039179866579733`*^9, 
  3.9039179872220087`*^9}},ExpressionUUID->"29dc9455-8760-4b78-85f3-\
508dd805718a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define a function to minimize a square patch.
Adjust d\[Theta] based on how close the local minima are.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.9039487460959673`*^9, 
  3.903948749054757*^9}},ExpressionUUID->"7eccf78c-0b7b-4239-9a0a-\
e0666596bb88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.1", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dphi", "=", "dtheta"}], ";"}]}], "Input",ExpressionUUID->"ab75d697-\
5398-4c52-af39-534111e06e5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flocal", "[", 
   RowBox[{
   "theta0_", ",", "phi0_", ",", "dtheta_", ",", "dphi_", ",", "Tmat_"}], 
   "]"}], ":=", 
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
       RowBox[{"Tmat", ",", 
        StyleBox[
         RowBox[{"UsHat", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0.", ",", "\[Phi]"}], "}"}], "]"}],
         FontColor->GrayLevel[0]], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        StyleBox["MONO",
         FontColor->GrayLevel[0]]}], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox[
       RowBox[{
        RowBox[{
         RowBox[{"theta0", "-", "dtheta"}], "\[LessEqual]", "\[Theta]", 
         "\[LessEqual]", 
         RowBox[{"theta0", "+", "dtheta"}]}], "&&", 
        RowBox[{
         RowBox[{"phi0", "-", "dphi"}], "\[LessEqual]", "\[Phi]", 
         "\[LessEqual]", 
         RowBox[{"phi0", "+", "dphi"}]}]}],
       FontColor->GrayLevel[0]]}], 
     StyleBox["}",
      FontColor->GrayLevel[0]]}], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}],
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
     FontColor->GrayLevel[0]]}], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.9036083197244177`*^9, 3.903608362376245*^9}, {
  3.9036106472162113`*^9, 3.903610648322323*^9}, {3.9036121192166977`*^9, 
  3.9036121210374107`*^9}, {3.90361339447526*^9, 3.903613398608843*^9}},
 CellLabel->
  "In[1479]:=",ExpressionUUID->"a8e13fe5-928e-4c91-920c-96f228e607c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
GetTempAnd\[Theta]0\[Sigma]0\[Phi]0 from ES_FindSymGroups.nb (search range to \
2\[Pi])\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903632223553894*^9, 
  3.903632227295744*^9}, {3.903917613024246*^9, 3.9039176215688057`*^9}, {
  3.903917777865439*^9, 
  3.903917789845838*^9}},ExpressionUUID->"f7358229-7e46-4932-9f9d-\
0280c2167d6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox[
             RowBox[{"2", "\[Pi]"}],
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, 3.903917624151566*^9},
 CellLabel->
  "In[1476]:=",ExpressionUUID->"0c383cb1-2c3d-4161-a8cb-af6ebc5d4f47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Closest MONO map to the input TRIV map:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9},ExpressionUUID->"72a9d154-3d91-48c1-ac4d-\
a0bf33b3940f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WantDetails", "=", "\"\<WantDetails\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "MONO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9034909365203495`*^9, 3.9034909417599707`*^9}, {
  3.903490972954488*^9, 3.9034909776829195`*^9}, {3.903492723882085*^9, 
  3.903492724665868*^9}, {3.903774709900457*^9, 3.90377471147127*^9}, {
  3.9038139415681133`*^9, 3.9038139416869392`*^9}},
 CellLabel->
  "In[1477]:=",ExpressionUUID->"92152023-630b-4a45-9e34-aaf460ba5154"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now we start with the MONO map closest to our initial map.
Same as the 6x6 matrix above:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903613437902824*^9, 
  3.903613438169568*^9}},ExpressionUUID->"0899cc08-9cfc-47aa-bf94-\
7b75e4fbd460"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatMONO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "MONO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "TmatMONO", "]"}]}], "Input",
 CellChangeTimes->{{3.9035515547837605`*^9, 3.9035515587197356`*^9}, {
  3.90355316903367*^9, 3.9035531699744463`*^9}, {3.903612226775538*^9, 
  3.903612233635367*^9}, {3.9036134228246*^9, 3.9036134257078238`*^9}, {
  3.9038139492803926`*^9, 3.90381395000098*^9}},
 CellLabel->
  "In[1482]:=",ExpressionUUID->"c057f8fd-9938-4562-8de8-2ecc20e37bd3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now we consider the point halfway from Tmat to TmatMONO.", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
  3.903612769329549*^9, 
  3.903612774341297*^9}},ExpressionUUID->"2af7d279-0265-4b64-af65-\
966a11749ea5"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"Tmatx", "=", 
    RowBox[{
     RowBox[{"0.8", "Tmat"}], "+", 
     RowBox[{"0.2", "TmatMONO"}]}]}], ";"}],
  FontColor->GrayLevel[0]]], "Input",
 CellChangeTimes->{{3.903612135073666*^9, 3.903612139491146*^9}, 
   3.903612194626137*^9, {3.9036123711443987`*^9, 3.903612374234449*^9}, {
   3.9036124449145*^9, 3.903612446956444*^9}, {3.903612541623007*^9, 
   3.903612543717054*^9}, {3.90391212554218*^9, 3.903912129604117*^9}},
 CellLabel->
  "In[1484]:=",ExpressionUUID->"75a9a7a5-4837-4441-8c29-e51cf96081cc"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}},
 CellLabel->
  "In[1485]:=",ExpressionUUID->"f15f6388-6c3e-4ec3-ba25-b77b49461cfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"Tmatx", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellChangeTimes->{{3.903564672712715*^9, 3.9035646928964877`*^9}, {
  3.9035757174438686`*^9, 3.903575728194148*^9}, {3.903612467260022*^9, 
  3.903612467850656*^9}, {3.903814008567244*^9, 3.903814009322*^9}},
 CellLabel->
  "In[1486]:=",ExpressionUUID->"1e266e09-8acd-4469-82d3-0d3d185f3d03"]
}, Open  ]],

Cell["\<\
The green dot in the contour plot turns out to be the global minimum, as we \
see next.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035534818176193`*^9, 3.9035534986743283`*^9}, {
  3.9035750952861786`*^9, 3.903575191198477*^9}, {3.903575321752406*^9, 
  3.9035753538676496`*^9}, {3.9035755142122316`*^9, 3.9035755461264524`*^9}, {
  3.903575630337594*^9, 3.90357564701593*^9}, {3.9035758726511326`*^9, 
  3.9035759345953417`*^9}, {3.903613866273098*^9, 3.9036138740916243`*^9}, {
  3.903632747218294*^9, 
  3.9036327496666594`*^9}},ExpressionUUID->"778ec645-3c10-48e3-a9fd-\
136965e54a40"],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM: blue patch at the center and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903613773962192*^9, 
   3.903613776758567*^9}, {3.9039175333539743`*^9, 
   3.903917544770721*^9}},ExpressionUUID->"8a9290dd-339a-45da-92b2-\
e0714e044f24"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"Flocal", "[", 
   RowBox[{"0", ",", 
    RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmatx"}], 
   "]"}],
  FontColor->GrayLevel[0]]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039123274778852`*^9, 
  3.903912346035796*^9}},
 CellLabel->
  "In[1487]:=",ExpressionUUID->"44539545-5f5a-49af-b05e-29ca984c5691"]
}, Open  ]],

Cell[CellGroupData[{

Cell["INCORRECT MINIMUM: blue patch to the upper left of center:", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
  3.9039124161664*^9}, {3.903917548657856*^9, 
  3.903917555319745*^9}},ExpressionUUID->"45eb33f9-05ea-4ca6-816c-\
3a028bce06ef"],

Cell[BoxData[
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.8", " ", "\[Pi]"}], ",", 
   RowBox[{"0.6", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], "]"}]], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.9036107529335117`*^9, 3.9036107552435017`*^9}, {
  3.9036124832516193`*^9, 3.903612483521886*^9}, {3.903612514373981*^9, 
  3.903612522581709*^9}, {3.90391239249794*^9, 3.903912410678315*^9}, {
  3.903912447956493*^9, 3.903912452967393*^9}},
 CellLabel->
  "In[1489]:=",ExpressionUUID->"33aa1a57-82d0-4afc-aa7f-32524969462a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change the search range back to \[Pi], and it works:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
  3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
  3.903917750887499*^9, 
  3.903917765377664*^9}},ExpressionUUID->"577eff73-97e5-46d1-b3c7-\
1d5f6ecd0760"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox["\[Pi]",
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, {3.903917624151566*^9, 3.9039176448645563`*^9}},
 CellLabel->
  "In[1490]:=",ExpressionUUID->"14bd5be8-d2fe-4e75-bbfd-aec1e8b4b1a5"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}},
 CellLabel->
  "In[1491]:=",ExpressionUUID->"8d2a774e-1797-4bb4-bd3c-4c85bb51ea54"]
}, Open  ]]
},
WindowSize->{1045, 946},
WindowMargins->{{Automatic, 260}, {Automatic, 39}},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"60d140f9-3644-4213-b230-2811dc283c42"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 887, 15, 71, "Subsubsection",ExpressionUUID->"f90ce2d8-5692-400e-8ba3-7da3acb4a708"],
Cell[CellGroupData[{
Cell[1470, 39, 460, 7, 37, "Subsubsection",ExpressionUUID->"d026c002-e607-4996-97e8-020f8c61463c"],
Cell[1933, 48, 266, 6, 30, "Input",ExpressionUUID->"29dc9455-8760-4b78-85f3-508dd805718a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2236, 59, 416, 8, 71, "Subsubsection",ExpressionUUID->"7eccf78c-0b7b-4239-9a0a-e0666596bb88"],
Cell[2655, 69, 242, 6, 52, "Input",ExpressionUUID->"ab75d697-5398-4c52-af39-534111e06e5a"],
Cell[2900, 77, 1850, 55, 73, "Input",ExpressionUUID->"a8e13fe5-928e-4c91-920c-96f228e607c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4787, 137, 740, 13, 45, "Subsubsection",ExpressionUUID->"f7358229-7e46-4932-9f9d-0280c2167d6c"],
Cell[5530, 152, 3227, 91, 136, "Input",ExpressionUUID->"0c383cb1-2c3d-4161-a8cb-af6ebc5d4f47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8794, 248, 368, 5, 45, "Subsubsection",ExpressionUUID->"72a9d154-3d91-48c1-ac4d-a0bf33b3940f"],
Cell[9165, 255, 544, 11, 52, "Input",ExpressionUUID->"92152023-630b-4a45-9e34-aaf460ba5154"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9746, 271, 399, 8, 71, "Subsubsection",ExpressionUUID->"0899cc08-9cfc-47aa-bf94-7b75e4fbd460"],
Cell[10148, 281, 562, 11, 52, "Input",ExpressionUUID->"c057f8fd-9938-4562-8de8-2ecc20e37bd3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10747, 297, 412, 7, 45, "Subsubsection",ExpressionUUID->"2af7d279-0265-4b64-af65-966a11749ea5"],
Cell[11162, 306, 560, 13, 30, "Input",ExpressionUUID->"75a9a7a5-4837-4441-8c29-e51cf96081cc"],
Cell[11725, 321, 462, 10, 30, "Input",ExpressionUUID->"f15f6388-6c3e-4ec3-ba25-b77b49461cfe"],
Cell[12190, 333, 415, 8, 30, "Input",ExpressionUUID->"1e266e09-8acd-4469-82d3-0d3d185f3d03"]
}, Open  ]],
Cell[12620, 344, 602, 11, 45, "Subsubsection",ExpressionUUID->"778ec645-3c10-48e3-a9fd-136965e54a40"],
Cell[CellGroupData[{
Cell[13247, 359, 457, 8, 37, "Subsubsection",ExpressionUUID->"8a9290dd-339a-45da-92b2-e0714e044f24"],
Cell[13707, 369, 924, 24, 52, "Input",ExpressionUUID->"44539545-5f5a-49af-b05e-29ca984c5691"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14668, 398, 506, 8, 45, "Subsubsection",ExpressionUUID->"45eb33f9-05ea-4ca6-816c-3a028bce06ef"],
Cell[15177, 408, 711, 14, 30, "Input",ExpressionUUID->"33aa1a57-82d0-4afc-aa7f-32524969462a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15925, 427, 547, 8, 45, "Subsubsection",ExpressionUUID->"577eff73-97e5-46d1-b3c7-1d5f6ecd0760"],
Cell[16475, 437, 3224, 90, 136, "Input",ExpressionUUID->"14bd5be8-d2fe-4e75-bbfd-aec1e8b4b1a5"],
Cell[19702, 529, 462, 10, 30, "Input",ExpressionUUID->"8d2a774e-1797-4bb4-bd3c-4c85bb51ea54"]
}, Open  ]]
}
]
*)


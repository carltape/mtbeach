(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    186827,       4528]
NotebookOptionsPosition[    170210,       4244]
NotebookOutlinePosition[    170657,       4262]
CellTagsIndexPosition[    170614,       4259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "A collection of challenging elastic maps T for finding the \
closest-Sigma-to-T.\nThe issues pertain to using the built-in Mathematica \
function NMinimize.\nES_FindSymGroups.nb calls GetTempAnd\[Theta]0\[Sigma]0\
\[Phi]0, which calls NMinimize.\nHere we experiment with different options \
for GetTempAnd\[Theta]0\[Sigma]0\[Phi]0.\n",
 StyleBox["INSTRUCTIONS",
  FontWeight->"Bold"],
 ": Run common_funs.nb, ES_FindSymGroups.nb, chooseTmat.nb, then this notebook"
}], "Subsubsection",
 CellChangeTimes->{{3.890830810901332*^9, 3.8908308426026735`*^9}, {
   3.893278661162142*^9, 3.8932786741393857`*^9}, {3.893278756078294*^9, 
   3.8932787740663166`*^9}, {3.8932788180017567`*^9, 
   3.8932788415078044`*^9}, {3.8935160470543633`*^9, 
   3.8935160486827707`*^9}, {3.893780658218905*^9, 3.8937806912963953`*^9}, {
   3.895828355430451*^9, 3.895828376021146*^9}, {3.898974131225287*^9, 
   3.898974170088593*^9}, {3.903349304149493*^9, 3.903349304707603*^9}, {
   3.9033921744207773`*^9, 3.903392199962062*^9}, {3.9036332896537733`*^9, 
   3.9036333153095913`*^9}, {3.9037176254464483`*^9, 3.903717630210827*^9}, {
   3.904068701948415*^9, 3.904068733997629*^9}, 3.904328099637385*^9, {
   3.904329179122108*^9, 
   3.904329237345764*^9}},ExpressionUUID->"f90ce2d8-5692-400e-8ba3-\
7da3acb4a708"],

Cell[CellGroupData[{

Cell["General functions", "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, {
   3.9043280856217213`*^9, 
   3.9043280883586483`*^9}},ExpressionUUID->"5b9796e9-96cd-403e-a322-\
56fe7a85c111"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WantDetails", "=", "\"\<WantDetails\>\""}], ";"}]], "Input",
 CellLabel->
  "In[936]:=",ExpressionUUID->"1e97db76-91b1-4b2b-82ed-2958cd41cf4e"],

Cell[CellGroupData[{

Cell["Function to minimize over a localized square patch", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.9039487460959673`*^9, 3.903948749054757*^9}, {
  3.904068635347416*^9, 3.9040686374536123`*^9}, {3.904329143883762*^9, 
  3.904329155897887*^9}, {3.906131403172831*^9, 
  3.90613140533862*^9}},ExpressionUUID->"03550abf-6de7-494e-87fe-\
cf4e13e75f3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Flocal", "[", 
    RowBox[{
    "theta0_", ",", "phi0_", ",", "dtheta_", ",", "dphi_", ",", "Tmat_"}], 
    "]"}], ":=", 
   RowBox[{"NMinimize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
        RowBox[{"Tmat", ",", 
         StyleBox[
          RowBox[{"UsHat", "[", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0.", ",", "\[Phi]"}], "}"}], "]"}],
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->GrayLevel[0]]}], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{
         RowBox[{
          RowBox[{"theta0", "-", "dtheta"}], "\[LessEqual]", "\[Theta]", 
          "\[LessEqual]", 
          RowBox[{"theta0", "+", "dtheta"}]}], "&&", 
         RowBox[{
          RowBox[{"phi0", "-", "dphi"}], "\[LessEqual]", "\[Phi]", 
          "\[LessEqual]", 
          RowBox[{"phi0", "+", "dphi"}]}]}],
        FontColor->GrayLevel[0]]}], 
      StyleBox["}",
       FontColor->GrayLevel[0]]}], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}],
      FontColor->GrayLevel[0]], 
     StyleBox[",",
      FontColor->GrayLevel[0]], 
     StyleBox[
      RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}], 
  StyleBox[";",
   FontColor->GrayLevel[0]]}]], "Input",
 CellChangeTimes->{{3.9036083197244177`*^9, 3.903608362376245*^9}, {
   3.9036106472162113`*^9, 3.903610648322323*^9}, {3.9036121192166977`*^9, 
   3.9036121210374107`*^9}, {3.90361339447526*^9, 3.903613398608843*^9}, {
   3.906060518182427*^9, 3.906060524372533*^9}, {3.90606070404795*^9, 
   3.90606070932936*^9}, {3.906060751635016*^9, 3.906060770520397*^9}, {
   3.9060608240418797`*^9, 3.9060608395186462`*^9}, {3.906060897577071*^9, 
   3.906060900960884*^9}, {3.90606545568648*^9, 3.906065456507951*^9}, {
   3.906065509580166*^9, 3.906065558193178*^9}, {3.9060657410272007`*^9, 
   3.906065797664282*^9}, {3.90606589804653*^9, 3.906065911190815*^9}, {
   3.906066562582665*^9, 3.9060665818913794`*^9}, {3.906066623227047*^9, 
   3.906066637834691*^9}, 3.906066695553399*^9, {3.90606675315142*^9, 
   3.906066764491145*^9}, {3.906066811424584*^9, 3.9060668183846292`*^9}, {
   3.906067695033647*^9, 3.906067698462428*^9}},
 CellLabel->
  "In[937]:=",ExpressionUUID->"28fed0c1-f167-47b3-8abc-54efafd57ee2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adjust d\[Theta] based on how close the local minima are.", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.9039487460959673`*^9, 3.903948749054757*^9}, {
  3.904068645150661*^9, 
  3.904068645888809*^9}},ExpressionUUID->"7cafa255-d8a8-4c8d-981f-\
4744a6281eca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.2", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dphi", "=", "dtheta"}], ";"}]}], "Input",
 CellChangeTimes->{{3.903950092796522*^9, 3.903950092859026*^9}},
 CellLabel->
  "In[938]:=",ExpressionUUID->"7a53d6f3-c686-4adb-a9db-ec7423b24770"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 0: Brown map, default search", "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, {
   3.906054201293281*^9, 
   3.9060542070998898`*^9}},ExpressionUUID->"dd3f03a5-86f1-4699-a528-\
03b5a62fea5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatBrown"}], ";"}]], "Input",
 CellChangeTimes->{{3.903950044107786*^9, 3.903950058828689*^9}, {
   3.905679032832416*^9, 3.905679033678056*^9}, {3.906054214659333*^9, 
   3.906054216223477*^9}, {3.9060602941185493`*^9, 3.9060602948690577`*^9}, 
   3.909513940451797*^9},ExpressionUUID->"cadd552a-9686-4611-8564-\
5f97ad494032"],

Cell[CellGroupData[{

Cell["\<\
The problematic point is t = 0.7 on the segment from TRIG to CUBE.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.903948682143021*^9}, {3.903948762903328*^9, 
  3.903948765851276*^9}, {3.903950030433522*^9, 3.903950038671253*^9}, {
  3.9039503940457687`*^9, 3.903950414748888*^9}, {3.903953052705418*^9, 
  3.903953082822302*^9}, {3.9043281424512377`*^9, 3.904328144667798*^9}, {
  3.9060544766451817`*^9, 
  3.906054495095042*^9}},ExpressionUUID->"d6fedb2d-08e7-4a95-aa76-\
3db462e703e1"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.02], 
   LineBox[{{0., 0}, {0.05, 0.3198889922029585}, {0.1, 0.6335148900251985}, {
     0.15000000000000002`, 0.936920870066306}, {0.2, 1.225115894925466}, {
     0.25, 1.4919216959662962`}, {0.30000000000000004`, 
     1.7299174050178396`}, {0.35000000000000003`, 1.9306068638080287`}, {0.4, 
     2.084974641949901}, {0.45, 2.184557353931949}, {0.5, 
     2.222943805075354}, {0.55, 2.197247527480036}, {0.6000000000000001, 
     2.1088567598823453`}, {0.65, 1.9630315635146711`}, {0.7000000000000001, 
     2.53271160091975}, {0.75, 1.5312919495311488`}, {0.8, 
     1.2627146068417532`}, {0.8500000000000001, 0.9694547825404184}, {0.9, 
     0.6579283447249422}, {0.9500000000000001, 0.33337561745418964`}, {
     1., 0}}], 
   {GrayLevel[
    0], {PointBox[{0., 0}], PointBox[{0.05, 0.3198889922029585}], 
     PointBox[{0.1, 0.6335148900251985}], 
     PointBox[{0.15000000000000002`, 0.936920870066306}], 
     PointBox[{0.2, 1.225115894925466}], 
     PointBox[{0.25, 1.4919216959662962`}], 
     PointBox[{0.30000000000000004`, 1.7299174050178396`}], 
     PointBox[{0.35000000000000003`, 1.9306068638080287`}], 
     PointBox[{0.4, 2.084974641949901}], PointBox[{0.45, 2.184557353931949}], 
     PointBox[{0.5, 2.222943805075354}], PointBox[{0.55, 2.197247527480036}], 
     PointBox[{0.6000000000000001, 2.1088567598823453`}], 
     PointBox[{0.65, 1.9630315635146711`}], 
     PointBox[{0.7000000000000001, 2.53271160091975}], 
     PointBox[{0.75, 1.5312919495311488`}], 
     PointBox[{0.8, 1.2627146068417532`}], 
     PointBox[{0.8500000000000001, 0.9694547825404184}], 
     PointBox[{0.9, 0.6579283447249422}], 
     PointBox[{0.9500000000000001, 0.33337561745418964`}], 
     PointBox[{1., 0}]}}, InsetBox[
    StyleBox[
     InterpretationBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(MONO\\)]\\)\"\>", 
       "\[InvisibleSpace]", "\<\" (\"\>", "\[InvisibleSpace]", "0.`", 
       "\[InvisibleSpace]", "\<\")\"\>"}],
      SequenceForm[
      "\!\(\*SubscriptBox[\(\[Beta]\), \(MONO\)]\)", " (", 0., ")"],
      Editable->False],
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontSize->15,
     FontColor->GrayLevel[0]], {-0.05, 0}, NCache[
    ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]},
  AspectRatio->1,
  Axes->True,
  AxesOrigin->{0., 0},
  ImageSize->{308.0713806152344, Automatic}]], "Output",
 CellChangeTimes->{{3.906054354816798*^9, 3.9060543881242647`*^9}},
 CellLabel->
  "Out[2236]=",ExpressionUUID->"a40f3238-2121-44d9-bf72-5acb4e20b11d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["closest to TRIG, closest to CUBE", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
  3.903612769329549*^9, 3.903612774341297*^9}, {3.90391804026791*^9, 
  3.903918046735718*^9}, {3.903952209145755*^9, 3.9039522542009983`*^9}, {
  3.903952303754738*^9, 3.9039523780537453`*^9}, {3.9039528138815393`*^9, 
  3.9039528162511883`*^9}, {3.906054609713245*^9, 3.906054609848214*^9}, {
  3.906116045582447*^9, 3.9061160494157457`*^9}, {3.906116230324225*^9, 
  3.906116236203705*^9}},ExpressionUUID->"f3cf56b9-9f22-47ba-b989-\
e7ef8d7759c4"],

Cell[BoxData[{
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "TRIG"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "CUBE"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9034909365203495`*^9, 3.9034909417599707`*^9}, {
  3.903490972954488*^9, 3.9034909776829195`*^9}, {3.903492723882085*^9, 
  3.903492724665868*^9}, {3.903774709900457*^9, 3.90377471147127*^9}, {
  3.9038139415681133`*^9, 3.9038139416869392`*^9}, {3.903917872202607*^9, 
  3.903917878165914*^9}, {3.9039478007426577`*^9, 3.903947811929987*^9}, {
  3.9039478478271723`*^9, 3.9039478485306883`*^9}, {3.903949169670692*^9, 
  3.903949170193779*^9}, {3.903950649041699*^9, 3.903950658785625*^9}, {
  3.906054585549129*^9, 3.906054589928094*^9}},
 CellLabel->
  "In[941]:=",ExpressionUUID->"c42f6f06-c8de-4169-ac4b-a88c33c4707c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reconstruct the problematic map.", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
  3.903612769329549*^9, 3.903612774341297*^9}, {3.90391804026791*^9, 
  3.903918046735718*^9}, {3.903952209145755*^9, 3.9039522542009983`*^9}, {
  3.903952303754738*^9, 3.9039523780537453`*^9}, {3.9039528138815393`*^9, 
  3.9039528162511883`*^9}, {3.906054609713245*^9, 
  3.906054609848214*^9}},ExpressionUUID->"f4d36bdb-7509-4c91-a22e-\
0f2ddf4454f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatTRIG", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "TRIG"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatCUBE", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "CUBE"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Tmatx", "=", 
    RowBox[{
     RowBox[{"0.3", "TmatTRIG"}], "+", 
     RowBox[{"0.7", "TmatCUBE"}]}]}], ";"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "TmatTRIG", "]"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "TmatCUBE", "]"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "Tmatx", "]"}],
  FontColor->GrayLevel[0]]}], "Input",
 CellChangeTimes->{{3.903612135073666*^9, 3.903612139491146*^9}, 
   3.903612194626137*^9, {3.9036123711443987`*^9, 3.903612374234449*^9}, {
   3.9036124449145*^9, 3.903612446956444*^9}, {3.903612541623007*^9, 
   3.903612543717054*^9}, {3.90391212554218*^9, 3.903912129604117*^9}, {
   3.9039180163350067`*^9, 3.903918029587595*^9}, {3.903950661605802*^9, 
   3.903950662074152*^9}, {3.903951802202528*^9, 3.903951823828722*^9}, {
   3.9039524102100697`*^9, 3.903952412521187*^9}, {3.906054617031415*^9, 
   3.906054651929165*^9}, {3.9060547452212963`*^9, 3.9060547478157797`*^9}},
 CellLabel->
  "In[943]:=",ExpressionUUID->"91d7bf6a-b9da-4238-99a4-0d623d7d9071"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This fails to find the global minimum (\[Beta] = 2.53 vs \[Beta] = 1.76):\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903615593070054*^9, 
   3.903615596774147*^9}, {3.904068760653698*^9, 3.904068768521387*^9}, {
   3.904328233302038*^9, 3.904328233607606*^9}, {3.906054945588151*^9, 
   3.906054951791377*^9}, {3.906055059058229*^9, 3.9060550869091454`*^9}, {
   3.906066952587536*^9, 3.9060669582242126`*^9}, 3.906077055724525*^9, {
   3.906077979771069*^9, 3.906077984938139*^9}, {3.906140489431095*^9, 
   3.9061404995172043`*^9}},ExpressionUUID->"3ef35be5-7c1c-48d8-8ae0-\
4316e6c0fb9e"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmatx", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.906054660751451*^9, 3.9060546622904253`*^9}},
 CellLabel->
  "In[949]:=",ExpressionUUID->"fa02659c-0803-4b17-aee1-eecdc02b6a0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM (\[Beta] = 1.76): Upper left blue patch and its antipode \
region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903615593070054*^9, 
   3.903615596774147*^9}, {3.904068760653698*^9, 3.904068768521387*^9}, {
   3.904328233302038*^9, 3.904328233607606*^9}, {3.906054945588151*^9, 
   3.906054951791377*^9}, {3.906055059058229*^9, 3.9060550869091454`*^9}, {
   3.906066952587536*^9, 3.9060669582242126`*^9}, 
   3.906077055724525*^9},ExpressionUUID->"f929abd5-4d92-4453-a60b-\
cc87ccb2b8a3"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.75", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmatx"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.5", "\[Pi]"}], ",", 
      RowBox[{"0.3", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmatx"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.903610836241662*^9, 3.9036108433004313`*^9}, {
  3.903612141937793*^9, 3.903612143727542*^9}, {3.903613404748014*^9, 
  3.903613405946828*^9}, {3.906055045058288*^9, 3.906055047230221*^9}, {
  3.906066011133284*^9, 3.906066015310581*^9}, {3.906066736752087*^9, 
  3.906066737188098*^9}, {3.9060668594775963`*^9, 3.906066884035562*^9}, {
  3.9060676405363293`*^9, 3.906067657283489*^9}, {3.906067738149069*^9, 
  3.906067739881688*^9}, {3.906148146586462*^9, 3.9061481491818647`*^9}},
 CellLabel->
  "In[950]:=",ExpressionUUID->"7a2e6957-82d9-4bf7-b2a8-9dbf881be2c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
INCORRECT MINIMUM (\[Beta] = 2.53): Blue patch (green point) on the equator \
and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903615593070054*^9, 
   3.903615596774147*^9}, {3.904068760653698*^9, 3.904068768521387*^9}, {
   3.904328233302038*^9, 3.904328233607606*^9}, {3.9060548899832277`*^9, 
   3.906054964635738*^9}, {3.9060550615095663`*^9, 3.9060550798497753`*^9}, {
   3.906066961621668*^9, 
   3.9060669659057293`*^9}},ExpressionUUID->"bc4457a6-e676-43b0-b4f0-\
e1f1b8ee2a54"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmatx"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.5", "\[Pi]"}], ",", 
      RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmatx"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.903610836241662*^9, 3.9036108433004313`*^9}, {
  3.903612141937793*^9, 3.903612143727542*^9}, {3.903613404748014*^9, 
  3.903613405946828*^9}, {3.906054916698236*^9, 3.9060549205721807`*^9}, {
  3.906055049566929*^9, 3.9060550512640257`*^9}, {3.906066016808015*^9, 
  3.9060660183297253`*^9}, {3.906066886100333*^9, 3.906066887622151*^9}, {
  3.906067659103167*^9, 3.90606766073151*^9}, {3.9060677433957367`*^9, 
  3.906067744909379*^9}, {3.906148151364427*^9, 3.9061481541204367`*^9}},
 CellLabel->
  "In[952]:=",ExpressionUUID->"e7f7cdbe-820e-46d5-a5fa-fe9eb72036fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
More detailed plot of the contours (hover the mouse over any contour)\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903615593070054*^9, 
   3.903615596774147*^9}, {3.904068760653698*^9, 3.904068768521387*^9}, {
   3.904328233302038*^9, 3.904328233607606*^9}, {3.906054945588151*^9, 
   3.906054951791377*^9}, {3.906055059058229*^9, 3.9060550869091454`*^9}, {
   3.906065312389247*^9, 3.906065317640106*^9}, {3.906065399628129*^9, 
   3.9060654044055567`*^9}},ExpressionUUID->"fc2efdb9-73a8-48c5-805f-\
81426c218e86"],

Cell[BoxData[
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Alpha", "[", 
     RowBox[{"Tmatx", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "MONO"}], "]"}], "/", 
    "Degree"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"Contours", "\[Rule]", 
    RowBox[{"Range", "[", 
     RowBox[{"2", ",", "8"}], "]"}]}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
   RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "700"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9060653236223373`*^9, 3.9060653239270983`*^9}, {
  3.9060653556608543`*^9, 3.906065355983398*^9}},
 CellLabel->
  "In[954]:=",ExpressionUUID->"aa2cec88-c642-42c8-a8d8-b398cf422575"]
}, Open  ]]
}, Open  ]],

Cell["\<\
The rest of the \[OpenCurlyDoubleQuote]fail\[CloseCurlyDoubleQuote] examples \
occurred when we were using a 2D search over MONO.
These were all successful when we switched to the 3D search.\
\>", "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, 
   3.906054537325962*^9, {3.90605510077778*^9, 3.906055133843193*^9}, {
   3.906055187953302*^9, 3.906055207058976*^9}, {3.90607707708218*^9, 
   3.906077077711121*^9}, {3.906116072318046*^9, 
   3.906116075066448*^9}},ExpressionUUID->"dbbd5b43-948a-4144-b548-\
ab8599fe0653"],

Cell[TextData[{
 "2D Search for the closest MONO map to Tmat\n",
 StyleBox["Make sure you Clear[GetTempAnd\[Theta]0\[Sigma]0\[Phi]0] and then \
re-run ES_FindSymGroups.nb when you are done, so that GetTempAnd\[Theta]0\
\[Sigma]0\[Phi]0 is re-set to the 3D search.",
  FontColor->RGBColor[1, 0, 0]]
}], "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, 
   3.906054537325962*^9, {3.90605510077778*^9, 3.906055133843193*^9}, {
   3.90605518484516*^9, 3.9060551858468513`*^9}, {3.906055522018257*^9, 
   3.9060555462161922`*^9}, {3.9060779246894503`*^9, 3.906077934981159*^9}, {
   3.906117645779689*^9, 
   3.906117646821744*^9}},ExpressionUUID->"18ee179c-88cb-4648-925b-\
873eed5ac9d7"],

Cell[CellGroupData[{

Cell[TextData[{
 "Example 1: Brown map, 2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "49ec5bb6-25fe-45e0-a8e0-262790a2b53a"],
 " = \[Pi]"
}], "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 
   3.904068583949627*^9},ExpressionUUID->"1d23c2d7-a65a-451d-b6b0-\
652b960d9f18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatBrownTypo"}], ";"}]], "Input",
 CellChangeTimes->{{3.903950044107786*^9, 3.903950058828689*^9}, {
  3.905679032832416*^9, 3.905679033678056*^9}},
 CellLabel->
  "In[955]:=",ExpressionUUID->"29dc9455-8760-4b78-85f3-508dd805718a"],

Cell[CellGroupData[{

Cell["\<\
The problematic point is the closest MONO to closestMONO (dt = 0.5).
By definition, the closest MONO to closestMONO should have \[Beta] = 0, but \
it does not.
This impacts the trajectory from MONO to ORTH as well.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.903948682143021*^9}, {3.903948762903328*^9, 
  3.903948765851276*^9}, {3.903950030433522*^9, 3.903950038671253*^9}, {
  3.9039503940457687`*^9, 3.903950414748888*^9}, {3.903953052705418*^9, 
  3.903953082822302*^9}, {3.9043281424512377`*^9, 
  3.904328144667798*^9}},ExpressionUUID->"1ec997ee-4d6e-4b93-acea-\
2a4e013504cd"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.013], 
   {GrayLevel[
    0], {PointBox[{1, 0}], PointBox[{2, 0}], PointBox[{3, 0}], 
     PointBox[{4, 0.0648893498413718}], PointBox[{5, 0}], 
     PointBox[{6, 0.17769221815702035`}], PointBox[{7, 0}], 
     PointBox[{8, 1.9056385771839512`}], PointBox[{9, 3.807137918692344}], 
     PointBox[{10, 2.52652167320092}], PointBox[{11, 5.043255901216653}]}, 
    LineBox[{{1, 0}, {2, 0}, {3, 0}, {4, 0.0648893498413718}, {5, 0}, {
      6, 0.17769221815702035`}, {7, 0}, {8, 1.9056385771839512`}, {
      9, 3.807137918692344}, {10, 2.52652167320092}, {
      11, 5.043255901216653}}]}, {InsetBox[
     StyleBox["11",
      StripOnInput->False,
      FontSize->12], {1, -0.30259535407299915}], InsetBox[
     StyleBox["5",
      StripOnInput->False,
      FontSize->12], {2, -0.30259535407299915}], InsetBox[
     StyleBox["3",
      StripOnInput->False,
      FontSize->12], {3, -0.30259535407299915}], InsetBox[
     StyleBox["10",
      StripOnInput->False,
      FontSize->12], {4, -0.30259535407299915}], InsetBox[
     StyleBox["16",
      StripOnInput->False,
      FontSize->12], {5, -0.30259535407299915}], InsetBox[
     StyleBox["15",
      StripOnInput->False,
      FontSize->12], {6, -0.30259535407299915}], InsetBox[
     StyleBox["14",
      StripOnInput->False,
      FontSize->12], {7, -0.30259535407299915}], InsetBox[
     StyleBox["12",
      StripOnInput->False,
      FontSize->12], {8, -0.30259535407299915}], InsetBox[
     StyleBox["8",
      StripOnInput->False,
      FontSize->12], {9, -0.30259535407299915}], InsetBox[
     StyleBox["7",
      StripOnInput->False,
      FontSize->12], {10, -0.30259535407299915}], InsetBox[
     StyleBox["6",
      StripOnInput->False,
      FontSize->12], {11, -0.30259535407299915}]}, {InsetBox[
     StyleBox["\<\"ISO\"\>",
      StripOnInput->False,
      FontSize->11], {1, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {2, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"XISO\"\>",
      StripOnInput->False,
      FontSize->11], {3, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {4, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"TET\"\>",
      StripOnInput->False,
      FontSize->11], {5, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {6, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"ORTH\"\>",
      StripOnInput->False,
      FontSize->11], {7, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {8, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"MONO\"\>",
      StripOnInput->False,
      FontSize->11], {9, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {10, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"TRIV\"\>",
      StripOnInput->False,
      FontSize->11], {11, -0.6051907081459983}]}, InsetBox[
    StyleBox[
     InterpretationBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(MONO\\)]\\)\"\>", 
       "\[InvisibleSpace]", "\<\" (\"\>", "\[InvisibleSpace]", "5.04`", 
       "\[InvisibleSpace]", "\<\")\"\>"}],
      SequenceForm[
      "\!\(\*SubscriptBox[\(\[Beta]\), \(MONO\)]\)", " (", 5.04, ")"],
      Editable->False],
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontSize->15,
     FontColor->GrayLevel[0]], {11.33, 5.043255901216653}, NCache[
    ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
  AspectRatio->1,
  Axes->True,
  AxesOrigin->{1, 0},
  ImageSize->500,
  Ticks->{None, {{0, 
      FormBox["0", TraditionalForm]}, {5, 
      FormBox["5", TraditionalForm]}, {10, 
      FormBox["10", TraditionalForm]}, {15, 
      FormBox["15", TraditionalForm]}, {20, 
      FormBox["20", TraditionalForm]}, {25, 
      FormBox["25", TraditionalForm]}, {30, 
      FormBox["30", TraditionalForm]}, {35, 
      FormBox["35", TraditionalForm]}, {40, 
      FormBox["40", TraditionalForm]}, {45, 
      FormBox["45", TraditionalForm]}, {50, 
      FormBox["50", TraditionalForm]}}},
  TicksStyle->12]], "Output",
 CellChangeTimes->{3.903949821505679*^9},
 CellLabel->
  "Out[1796]=",ExpressionUUID->"003ad0cb-1c84-471a-8114-2583c613c13e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adjust d\[Theta] based on how close the local minima are.", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.9039487460959673`*^9, 3.903948749054757*^9}, {
  3.904068645150661*^9, 
  3.904068645888809*^9}},ExpressionUUID->"8b95e8c9-8d23-44a9-ba7d-\
35054c0552f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.2", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dphi", "=", "dtheta"}], ";"}]}], "Input",
 CellChangeTimes->{{3.903950092796522*^9, 3.903950092859026*^9}},
 CellLabel->
  "In[956]:=",ExpressionUUID->"34b04fea-fd14-4d66-9e04-f13c44c84e5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7787c9e9-a911-4956-a661-27577d267f33"],
 " = \[Pi]"
}], "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903632223553894*^9, 
  3.903632227295744*^9}, {3.904068592985598*^9, 
  3.904068596986977*^9}},ExpressionUUID->"f7358229-7e46-4932-9f9d-\
0280c2167d6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox["\[Pi]",
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}},
 CellLabel->
  "In[958]:=",ExpressionUUID->"0c383cb1-2c3d-4161-a8cb-af6ebc5d4f47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Closest MONO map to the input TRIV map (\[Beta] = 5.04: this is correct):\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9, {3.906116110600745*^9, 3.906116118918619*^9}, {
   3.906131543629163*^9, 
   3.9061315449027987`*^9}},ExpressionUUID->"72a9d154-3d91-48c1-ac4d-\
a0bf33b3940f"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.9034909365203495`*^9, 3.9034909417599707`*^9}, {
  3.903490972954488*^9, 3.9034909776829195`*^9}, {3.903492723882085*^9, 
  3.903492724665868*^9}, {3.903774709900457*^9, 3.90377471147127*^9}, {
  3.9038139415681133`*^9, 3.9038139416869392`*^9}, {3.90406861034619*^9, 
  3.90406861118274*^9}, {3.906117751493675*^9, 3.906117755111253*^9}, {
  3.906118270011084*^9, 3.9061182724545193`*^9}},
 CellLabel->
  "In[959]:=",ExpressionUUID->"92152023-630b-4a45-9e34-aaf460ba5154"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM (\[Beta] = 5.04): Upper left blue patch (green point) and its \
antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903615593070054*^9, 
   3.903615596774147*^9}, {3.904068760653698*^9, 3.904068768521387*^9}, {
   3.904328233302038*^9, 3.904328233607606*^9}, 3.906074783749874*^9, {
   3.9060750740868587`*^9, 
   3.9060750747191257`*^9}},ExpressionUUID->"6520fd56-9f60-47a2-ba86-\
9283a2d99916"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Flocal", "[", 
    RowBox[{
     RowBox[{"0.5", "\[Pi]"}], ",", 
     RowBox[{"0.75", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Flocal", "[", 
    RowBox[{
     RowBox[{"1.5", "\[Pi]"}], ",", 
     RowBox[{"0.3", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.903610836241662*^9, 3.9036108433004313`*^9}, {
  3.903612141937793*^9, 3.903612143727542*^9}, {3.903613404748014*^9, 
  3.903613405946828*^9}, {3.906067760727477*^9, 3.9060677621467323`*^9}, {
  3.906078046295273*^9, 3.9060780471572523`*^9}, {3.906117758329062*^9, 
  3.9061177607012453`*^9}},
 CellLabel->
  "In[960]:=",ExpressionUUID->"774b453e-77cf-459e-8079-59bf4eec5c28"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
LOCAL MINIMUM (\[Beta] = 5.21): Central blue patch and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.904068774865206*^9, 3.904068781228168*^9}, {3.9043282373897657`*^9, 
   3.9043282376134768`*^9}, 3.90607478458112*^9, {3.906075082886222*^9, 
   3.90607508383526*^9}, {3.90610758718524*^9, 
   3.90610758756137*^9}},ExpressionUUID->"9dc83fc2-2f65-4b93-a153-\
58f4829fab03"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Flocal", "[", 
    RowBox[{"\[Pi]", ",", 
     RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Flocal", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610844393611*^9, 3.9036108464630632`*^9}, {
  3.903612145409684*^9, 3.9036121533628607`*^9}, {3.903613406999185*^9, 
  3.903613407813992*^9}, {3.9060677636107483`*^9, 3.906067765312541*^9}, {
  3.9060780505479*^9, 3.906078051691826*^9}, {3.906117763786982*^9, 
  3.906117766103409*^9}},
 CellLabel->
  "In[961]:=",ExpressionUUID->"a8880bcb-4e6b-4517-be83-1a4a6c60536b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
LOCAL MINIMUM (\[Beta] = 5.16): Lower left blue patch and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903610102058091*^9, 3.903610103441699*^9}, {3.904068785955351*^9, 
   3.9040687905612993`*^9}, {3.904328240275743*^9, 3.904328240520019*^9}, 
   3.906074785176219*^9, {3.9060750890015163`*^9, 3.906075092969612*^9}, {
   3.90610759196243*^9, 
   3.906107593194552*^9}},ExpressionUUID->"54c9a020-dbfd-4905-ac37-\
1b0c12122fd3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Flocal", "[", 
    RowBox[{
     RowBox[{"0.4", " ", "\[Pi]"}], ",", 
     RowBox[{"0.2", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Flocal", "[", 
    RowBox[{
     RowBox[{"1.4", "\[Pi]"}], ",", 
     RowBox[{"0.8", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610110222937*^9, 3.9036101503750677`*^9}, {
  3.903610849010233*^9, 3.903610849697979*^9}, {3.903612155464027*^9, 
  3.903612156292495*^9}, {3.903613409664483*^9, 3.903613410342144*^9}, {
  3.9060677664936943`*^9, 3.906067767928749*^9}, {3.906078054609379*^9, 
  3.906078055537635*^9}, {3.906117769499208*^9, 3.906117772504533*^9}},
 CellLabel->
  "In[962]:=",ExpressionUUID->"71f5291d-efee-4f5e-9f4f-346819dcf3dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The full search finds the right minimum (as before):", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608927243236*^9}, {
  3.9036097666270857`*^9, 3.903609774771015*^9}, {3.9036099377892313`*^9, 
  3.903609947136746*^9}},ExpressionUUID->"3419d619-ece2-4939-8b60-\
bf3a2fbadde4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Flocal", "[", 
    RowBox[{"\[Pi]", ",", 
     RowBox[{"0.5", "\[Pi]"}], ",", "\[Pi]", ",", 
     RowBox[{"0.5", "\[Pi]"}], ",", "Tmat"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"%", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]}], "]"}], "/", "Degree"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9036086193953114`*^9, 3.903608621514728*^9}, 
   3.903608688126421*^9, {3.903608939596114*^9, 3.9036089397314053`*^9}, {
   3.903609764509275*^9, 3.903609800384961*^9}, 3.9036108530464354`*^9, 
   3.903612159348856*^9, 3.903613411443239*^9, {3.90606777518462*^9, 
   3.906067775361693*^9}, 3.90607805944208*^9, {3.906117775650876*^9, 
   3.906117778400422*^9}},
 CellLabel->
  "In[963]:=",ExpressionUUID->"f80e9bf5-aff6-4404-b86d-9b42637a0702"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problematic map.", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903613437902824*^9, 3.903613438169568*^9}, {
  3.9039532427530327`*^9, 3.9039532444502773`*^9}, {3.904068662599929*^9, 
  3.9040686814137993`*^9}},ExpressionUUID->"ad06c437-af0b-4c05-bc7e-\
4d4c28767b74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatMONO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "MONO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "TmatMONO", "]"}]}], "Input",
 CellChangeTimes->{{3.9035515547837605`*^9, 3.9035515587197356`*^9}, {
  3.90355316903367*^9, 3.9035531699744463`*^9}, {3.903612226775538*^9, 
  3.903612233635367*^9}, {3.9036134228246*^9, 3.9036134257078238`*^9}, {
  3.9038139492803926`*^9, 3.90381395000098*^9}},
 CellLabel->
  "In[964]:=",ExpressionUUID->"75cf0133-239d-4a27-adf1-294fa57ec6fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["This fails to find the global minimum (\[Beta] = 3.81 vs \[Beta] =0):", \
"Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.903574224131977*^9, 3.903574227197657*^9}, {3.903610398081959*^9, 
  3.9036103992886143`*^9}, {3.90395333915557*^9, 3.9039533398914013`*^9}, {
  3.904328288167399*^9, 3.904328293196622*^9}, {3.9061406319492397`*^9, 
  3.9061406643214207`*^9}, {3.906161397712377*^9, 
  3.906161405398497*^9}},ExpressionUUID->"3c77e848-2131-4cf8-8465-\
71236adf7a7b"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"TmatMONO", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.903528230666829*^9, 3.903528235717515*^9}, {
   3.903528291279476*^9, 3.903528321995905*^9}, {3.9035532799654255`*^9, 
   3.9035532829357986`*^9}, {3.903612237242344*^9, 3.90361223822894*^9}, 
   3.9036134432383747`*^9, {3.903813955037669*^9, 3.903813956040202*^9}},
 CellLabel->
  "In[966]:=",ExpressionUUID->"8f6cda3e-f1eb-4a6f-8c02-e3271bbe3b49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"TmatMONO", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellChangeTimes->{{3.903564672712715*^9, 3.9035646928964877`*^9}, {
   3.903564842549506*^9, 3.903564844425836*^9}, {3.903612247135099*^9, 
   3.9036122479481583`*^9}, 3.9036134470431128`*^9, {3.903813958120751*^9, 
   3.903813958832635*^9}},
 CellLabel->
  "In[967]:=",ExpressionUUID->"c2032a0d-cd2e-4b5d-b2cf-fc10d45cf7a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM (\[Beta] ~ 0): Upper left blue patch and its antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903610207365817*^9, 
   3.9036102166388197`*^9}, {3.904330157528626*^9, 3.904330159899702*^9}, {
   3.906075131101077*^9, 
   3.9060751360347853`*^9}},ExpressionUUID->"a2806c8a-287b-4583-9c97-\
d6053ea472c6"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.75", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "TmatMONO", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.5", "\[Pi]"}], ",", 
      RowBox[{"0.3", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}],
      "]"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "TmatMONO", "]"}]}], "]"}], "/", 
     "Degree"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.903610187854774*^9, 3.9036101953786793`*^9}, {
  3.903610708423315*^9, 3.903610713432969*^9}, {3.90361225917003*^9, 
  3.903612264148344*^9}, {3.9036134494371862`*^9, 3.903613450160366*^9}, {
  3.906067781963607*^9, 3.906067783277775*^9}, {3.9060678851823673`*^9, 
  3.9060678861542673`*^9}, {3.906117847890952*^9, 3.9061178518800488`*^9}},
 CellLabel->
  "In[968]:=",ExpressionUUID->"2bc30d43-c627-4d03-bad0-60add1091f21"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
INCORRECT MINIMUM (\[Beta] = 3.81): Central blue patch and its antipode \
region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903610219804668*^9, 3.903610222790009*^9}, {3.904330162292161*^9, 
   3.904330167666895*^9}, 3.9060747860448093`*^9, {3.906075266070477*^9, 
   3.9060752668875732`*^9}},ExpressionUUID->"2ac21f6f-281e-498c-9b41-\
c4c339d00b44"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "TmatMONO", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}],
      "]"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "TmatMONO", "]"}]}], "]"}], "/", 
     "Degree"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610189225421*^9, 3.903610193835452*^9}, {
  3.903610715069703*^9, 3.903610726460271*^9}, {3.9036122678237247`*^9, 
  3.9036122725663013`*^9}, {3.903613451404108*^9, 3.90361345217169*^9}, {
  3.9060677846451902`*^9, 3.90606778591311*^9}, {3.906067888648841*^9, 
  3.906067889647327*^9}, {3.906117800853331*^9, 3.906117803032234*^9}},
 CellLabel->
  "In[970]:=",ExpressionUUID->"4e069087-6657-438e-b060-6fa0deaf6650"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
LOCAL MINIMUM (\[Beta] = 3.81): Lower left blue patch (green dot) and its \
antipode region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903610102058091*^9, 3.903610103441699*^9}, {3.903615577094337*^9, 
   3.9036155812890472`*^9}, {3.903632459934937*^9, 3.9036324623550463`*^9}, {
   3.9043301699772167`*^9, 3.904330176120268*^9}, 3.906074786643195*^9, {
   3.906075273702361*^9, 
   3.906075274353148*^9}},ExpressionUUID->"b8fc7116-d32a-41f3-9ac7-\
95e84465cf6d"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.4", " ", "\[Pi]"}], ",", 
   RowBox[{"0.2", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "TmatMONO", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.4", "\[Pi]"}], ",", 
      RowBox[{"0.8", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "TmatMONO"}],
      "]"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "TmatMONO", "]"}]}], "]"}], "/", 
     "Degree"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.903610110222937*^9, 3.9036101503750677`*^9}, {
  3.903610190761064*^9, 3.903610192536477*^9}, {3.9036107170559063`*^9, 
  3.903610728404282*^9}, {3.903612277288454*^9, 3.903612281505413*^9}, {
  3.903613453273155*^9, 3.903613453998769*^9}, {3.906067787227909*^9, 
  3.9060677886469717`*^9}, {3.9060678906143103`*^9, 3.906067891897334*^9}, {
  3.906117805121993*^9, 3.9061178075632553`*^9}},
 CellLabel->
  "In[972]:=",ExpressionUUID->"9ead269b-cfa9-4dd2-8aca-7b91a7baa5bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
By extending the \[Theta] search range slightly, the 2D search finds the \
correct minimum (\[Beta]  ~ 0):\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903621290344014*^9, 
  3.903621291677219*^9}, {3.9036322708984537`*^9, 3.903632289072583*^9}, {
  3.903633162568083*^9, 3.903633163355859*^9}, {3.903774754624404*^9, 
  3.903774755378228*^9}, {3.903953434093707*^9, 3.903953459551322*^9}, {
  3.9039791780932083`*^9, 3.9039791858290367`*^9}, {3.903979339963491*^9, 
  3.903979356341303*^9}, {3.904068561199368*^9, 3.9040685713220377`*^9}, {
  3.904330192053433*^9, 3.9043301928303957`*^9}, {3.9061183375534487`*^9, 
  3.906118337675482*^9}},ExpressionUUID->"fb49c27f-5cef-4823-ae8c-\
42b3af1a3efa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fac", "=", "1.15"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"NMinimize", " ", "fails"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fac", "=", "1.2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"NMinimize", " ", "works"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            RowBox[{
             StyleBox["fac",
              FontColor->RGBColor[1, 0, 0]], " ", 
             StyleBox["\[Pi]",
              FontColor->RGBColor[1, 0, 0]]}], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"TmatMONO", ",", "MONO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.903632775123807*^9, 3.9036327772790728`*^9}, {
  3.903632828774523*^9, 3.903632828889262*^9}, {3.90363286001886*^9, 
  3.903632872003104*^9}, {3.903632924761256*^9, 3.903632974089238*^9}, {
  3.903633038406363*^9, 3.903633095775194*^9}, {3.9037747689843493`*^9, 
  3.903774776381312*^9}, {3.903813999671261*^9, 3.9038140003651752`*^9}, {
  3.906106977425683*^9, 3.906106982623396*^9}, {3.906148331057213*^9, 
  3.9061483314048767`*^9}},
 CellLabel->
  "In[974]:=",ExpressionUUID->"6d93c447-65a7-4370-a702-c2d72cf99ece"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"TmatMONO", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellChangeTimes->{{3.904330411081169*^9, 3.904330420748352*^9}},
 CellLabel->
  "In[978]:=",ExpressionUUID->"afb1d8cb-2f07-491d-a471-8111cc332e24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The 3D search finds the correct minimum (\[Beta]  ~ 0):", \
"Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903621290344014*^9, 
  3.903621291677219*^9}, {3.9036322708984537`*^9, 3.903632289072583*^9}, {
  3.903633162568083*^9, 3.903633163355859*^9}, {3.903774754624404*^9, 
  3.903774755378228*^9}, {3.903953434093707*^9, 3.903953459551322*^9}, {
  3.903977344097166*^9, 3.903977347141885*^9}, {3.903981522052161*^9, 
  3.903981531395966*^9}, {3.904330184749757*^9, 3.904330186448839*^9}, {
  3.906075282320137*^9, 
  3.906075291104261*^9}},ExpressionUUID->"904f35e0-6124-4066-bbbc-\
4d23d97d07a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"Tmat", ",", 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], "=", " ", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", "\[LessEqual]",
            "\[Pi]"}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"Tmat", ",", 
          StyleBox["MONO",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"TmatMONO", ",", "MONO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8432638002966256`*^9, 3.843263848587617*^9}, {
   3.843263901498243*^9, 3.8432639249045906`*^9}, {3.843264035112605*^9, 
   3.843264049384597*^9}, {3.8432640820756454`*^9, 3.8432641113867397`*^9}, {
   3.8432641575126195`*^9, 3.843264176600622*^9}, 3.8432642092735014`*^9, {
   3.85800443755595*^9, 3.858004508964686*^9}, {3.8580045492990336`*^9, 
   3.8580046084862204`*^9}, {3.8580046498167143`*^9, 
   3.8580046922574406`*^9}, {3.8580047386393414`*^9, 
   3.8580047519394045`*^9}, {3.858004893375312*^9, 3.858004901820363*^9}, {
   3.858008522332718*^9, 3.858008531919662*^9}, {3.8580086348792405`*^9, 
   3.8580086378895903`*^9}, {3.8580089489322834`*^9, 
   3.8580089933041143`*^9}, {3.8597262185704365`*^9, 
   3.8597262225626307`*^9}, {3.865886834723418*^9, 3.865886838446048*^9}, {
   3.865887046777639*^9, 3.865887059826816*^9}, {3.869838173908651*^9, 
   3.8698382816994867`*^9}, {3.869838335398591*^9, 3.8698383624375315`*^9}, 
   3.8698411107142754`*^9, {3.869841151929311*^9, 3.869841153561617*^9}, {
   3.8698412683313093`*^9, 3.8698412928033447`*^9}, {3.8702366100574226`*^9, 
   3.870236619333077*^9}, {3.8984721524199743`*^9, 3.8984721641800203`*^9}, {
   3.901910507639677*^9, 3.901910529659231*^9}, {3.9019105611702805`*^9, 
   3.9019105769789267`*^9}, {3.903970152708353*^9, 3.9039702037288265`*^9}, {
   3.903977352789545*^9, 3.9039773536211433`*^9}, {3.906107001151857*^9, 
   3.906107002138945*^9}, {3.906147878292588*^9, 3.906147879012083*^9}},
 CellLabel->
  "In[979]:=",ExpressionUUID->"378cef70-64a0-49ac-9946-f6bc60ae6ad7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Example 2: Brown map, 2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "a164831b-5fbc-4170-b3f0-80c9ded52c5d"],
 " = 2\[Pi]"
}], "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, {
   3.9040689211243963`*^9, 3.904068921632965*^9}, 
   3.904068955368416*^9},ExpressionUUID->"629b85e5-7023-41b3-aaf1-\
d8fe16e29078"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatBrownTypo"}], ";"}]], "Input",
 CellChangeTimes->{{3.903911975098435*^9, 3.903911984132441*^9}, {
   3.903917975494522*^9, 3.903917976366488*^9}, {3.903918186869246*^9, 
   3.903918190304811*^9}, 3.90567922174448*^9},
 CellLabel->
  "In[981]:=",ExpressionUUID->"e1d5f5c8-455a-4783-b241-cfa44e0dc35b"],

Cell[CellGroupData[{

Cell["The problematic point is between TET and XISO (dt =0.2):", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.9039486611957273`*^9}, {3.9039487563831387`*^9, 
  3.903948758841838*^9}, {3.903950443153172*^9, 
  3.9039504443079357`*^9}},ExpressionUUID->"40a76f08-e141-4b71-8f1a-\
e3818c102e4c"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.013], 
   {GrayLevel[
    0], {PointBox[{1, 0}], PointBox[{2, 0}], PointBox[{3, 0}], 
     PointBox[{4, 0}], PointBox[{5, 0}], PointBox[{6, 0}], 
     PointBox[{7, 0.03673050374626612}], PointBox[{8, 0.4807032741079858}], 
     PointBox[{9, 0.0645545580026454}], PointBox[{10, 0.045645556764235776`}],
      PointBox[{11, 0}], PointBox[{12, 0.11642139249347044`}], 
     PointBox[{13, 0.17231832888282142`}], 
     PointBox[{14, 0.16850352612103642`}], 
     PointBox[{15, 0.10895685197513129`}], PointBox[{16, 0}], 
     PointBox[{17, 0}], PointBox[{18, 0}], PointBox[{19, 0}], 
     PointBox[{20, 0}], PointBox[{21, 0}], 
     PointBox[{22, 1.0111592216286542`}], PointBox[{23, 2.0216889762657204`}],
      PointBox[{24, 3.0309621448884165`}], 
     PointBox[{25, 4.0383562825592785`}], PointBox[{26, 5.043255901216653}]}, 
    LineBox[{{1, 0}, {2, 0}, {3, 0}, {4, 0}, {5, 0}, {6, 0}, {
      7, 0.03673050374626612}, {8, 0.4807032741079858}, {
      9, 0.0645545580026454}, {10, 0.045645556764235776`}, {11, 0}, {
      12, 0.11642139249347044`}, {13, 0.17231832888282142`}, {
      14, 0.16850352612103642`}, {15, 0.10895685197513129`}, {16, 0}, {17, 
      0}, {18, 0}, {19, 0}, {20, 0}, {21, 0}, {22, 1.0111592216286542`}, {
      23, 2.0216889762657204`}, {24, 3.0309621448884165`}, {
      25, 4.0383562825592785`}, {26, 5.043255901216653}}]}, {InsetBox[
     StyleBox["25",
      StripOnInput->False,
      FontSize->12], {1, -0.30259535407299915}], InsetBox[
     StyleBox["17",
      StripOnInput->False,
      FontSize->12], {2, -0.30259535407299915}], InsetBox[
     StyleBox["13",
      StripOnInput->False,
      FontSize->12], {3, -0.30259535407299915}], InsetBox[
     StyleBox["9",
      StripOnInput->False,
      FontSize->12], {4, -0.30259535407299915}], InsetBox[
     StyleBox["8",
      StripOnInput->False,
      FontSize->12], {5, -0.30259535407299915}], InsetBox[
     StyleBox["6",
      StripOnInput->False,
      FontSize->12], {6, -0.30259535407299915}], InsetBox[
     StyleBox["12",
      StripOnInput->False,
      FontSize->12], {7, -0.30259535407299915}], InsetBox[
     StyleBox["16",
      StripOnInput->False,
      FontSize->12], {8, -0.30259535407299915}], InsetBox[
     StyleBox["29",
      StripOnInput->False,
      FontSize->12], {9, -0.30259535407299915}], InsetBox[
     StyleBox["33",
      StripOnInput->False,
      FontSize->12], {10, -0.30259535407299915}], InsetBox[
     StyleBox["43",
      StripOnInput->False,
      FontSize->12], {11, -0.30259535407299915}], InsetBox[
     StyleBox["42",
      StripOnInput->False,
      FontSize->12], {12, -0.30259535407299915}], InsetBox[
     StyleBox["41",
      StripOnInput->False,
      FontSize->12], {13, -0.30259535407299915}], InsetBox[
     StyleBox["40",
      StripOnInput->False,
      FontSize->12], {14, -0.30259535407299915}], InsetBox[
     StyleBox["39",
      StripOnInput->False,
      FontSize->12], {15, -0.30259535407299915}], InsetBox[
     StyleBox["38",
      StripOnInput->False,
      FontSize->12], {16, -0.30259535407299915}], InsetBox[
     StyleBox["36",
      StripOnInput->False,
      FontSize->12], {17, -0.30259535407299915}], InsetBox[
     StyleBox["32",
      StripOnInput->False,
      FontSize->12], {18, -0.30259535407299915}], InsetBox[
     StyleBox["30",
      StripOnInput->False,
      FontSize->12], {19, -0.30259535407299915}], InsetBox[
     StyleBox["26",
      StripOnInput->False,
      FontSize->12], {20, -0.30259535407299915}], InsetBox[
     StyleBox["24",
      StripOnInput->False,
      FontSize->12], {21, -0.30259535407299915}], InsetBox[
     StyleBox["23",
      StripOnInput->False,
      FontSize->12], {22, -0.30259535407299915}], InsetBox[
     StyleBox["22",
      StripOnInput->False,
      FontSize->12], {23, -0.30259535407299915}], InsetBox[
     StyleBox["21",
      StripOnInput->False,
      FontSize->12], {24, -0.30259535407299915}], InsetBox[
     StyleBox["20",
      StripOnInput->False,
      FontSize->12], {25, -0.30259535407299915}], InsetBox[
     StyleBox["19",
      StripOnInput->False,
      FontSize->12], {26, -0.30259535407299915}]}, {InsetBox[
     StyleBox["\<\"ISO\"\>",
      StripOnInput->False,
      FontSize->11], {1, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {2, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {3, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {4, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {5, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"XISO\"\>",
      StripOnInput->False,
      FontSize->11], {6, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {7, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {8, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {9, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {10, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"TET\"\>",
      StripOnInput->False,
      FontSize->11], {11, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {12, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {13, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {14, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {15, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"ORTH\"\>",
      StripOnInput->False,
      FontSize->11], {16, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {17, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {18, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {19, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {20, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"MONO\"\>",
      StripOnInput->False,
      FontSize->11], {21, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {22, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {23, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {24, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {25, -0.6051907081459983}], InsetBox[
     StyleBox["\<\"TRIV\"\>",
      StripOnInput->False,
      FontSize->11], {26, -0.6051907081459983}]}, InsetBox[
    StyleBox[
     InterpretationBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(MONO\\)]\\)\"\>", 
       "\[InvisibleSpace]", "\<\" (\"\>", "\[InvisibleSpace]", "5.04`", 
       "\[InvisibleSpace]", "\<\")\"\>"}],
      SequenceForm[
      "\!\(\*SubscriptBox[\(\[Beta]\), \(MONO\)]\)", " (", 5.04, ")"],
      Editable->False],
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontSize->15,
     FontColor->GrayLevel[0]], {26.78, 5.043255901216653}, NCache[
    ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
  AspectRatio->1,
  Axes->True,
  AxesOrigin->{1, 0},
  ImageSize->500,
  Ticks->{None, {{0, 
      FormBox["0", TraditionalForm]}, {5, 
      FormBox["5", TraditionalForm]}, {10, 
      FormBox["10", TraditionalForm]}, {15, 
      FormBox["15", TraditionalForm]}, {20, 
      FormBox["20", TraditionalForm]}, {25, 
      FormBox["25", TraditionalForm]}, {30, 
      FormBox["30", TraditionalForm]}, {35, 
      FormBox["35", TraditionalForm]}, {40, 
      FormBox["40", TraditionalForm]}, {45, 
      FormBox["45", TraditionalForm]}, {50, 
      FormBox["50", TraditionalForm]}}},
  TicksStyle->12]], "Output",
 CellChangeTimes->{3.903910873960269*^9},
 CellLabel->
  "Out[1283]=",ExpressionUUID->"071dcbc4-fa53-45fa-b246-a5bb49ab7961"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adjust d\[Theta] based on how close the local minima are.", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, 
   3.903948733778756*^9, {3.904069006603745*^9, 
   3.904069007519643*^9}},ExpressionUUID->"66ec39d3-f2a2-471c-8848-\
e8ec705c1b9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.2", "\[Pi]"}]}], ";", " ", 
  RowBox[{"dphi", "=", "dtheta"}], ";"}]], "Input",
 CellChangeTimes->{{3.903608410297072*^9, 3.903608420324973*^9}, 
   3.903608513402856*^9, 3.9036086282304993`*^9, {3.903912461388278*^9, 
   3.9039124614977007`*^9}, {3.9039481938838797`*^9, 3.90394819572519*^9}},
 CellLabel->
  "In[982]:=",ExpressionUUID->"83981434-dafe-4960-a4e9-bf3682884827"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "162429e1-2c60-49d1-aafc-d7449266de82"],
 " = 2\[Pi]"
}], "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
   3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
   3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
   3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
   3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
   3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903632223553894*^9, 
   3.903632227295744*^9}, {3.904068592985598*^9, 3.904068596986977*^9}, 
   3.904329279223062*^9},ExpressionUUID->"922be7a4-bece-45e6-a553-\
eb3caca9c64c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->GrayLevel[0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox[
             RowBox[{"2", "\[Pi]"}],
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, 3.903917624151566*^9, {3.9061070119858828`*^9, 
   3.906107012702959*^9}, {3.906132228007873*^9, 3.90613222870786*^9}, {
   3.906140158156932*^9, 3.906140158339753*^9}, {3.90614788376124*^9, 
   3.906147884445966*^9}},
 CellLabel->
  "In[983]:=",ExpressionUUID->"5f1d279f-b2fa-4a28-901f-8b5b20774d0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check the starting value of TRIV (\[Beta]  = 5.04)", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9, {3.903947858312419*^9, 3.903947875525981*^9}, 
   3.906075304768743*^9},ExpressionUUID->"76bb90ea-7272-4fcf-9881-\
a4050486cba2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"OutputFor", "[", 
   RowBox[{"Tmat", ",", "MONO"}], "]"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.903947855966342*^9, 3.903947856340501*^9}, {
  3.903949177012637*^9, 3.9039491780190763`*^9}, {3.9040690210483847`*^9, 
  3.904069021794829*^9}, {3.906116205654689*^9, 3.906116207786056*^9}},
 CellLabel->
  "In[984]:=",ExpressionUUID->"5792b791-cf61-413e-8b04-bb8f8149d819"]
}, Open  ]],

Cell[CellGroupData[{

Cell["closest to TET, closest to XISO", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9, {3.903949159446639*^9, 3.90394915979805*^9}, {
   3.903952802202408*^9, 3.903952808227405*^9}, {3.90433026396484*^9, 
   3.904330266201482*^9}, 3.906116219353158*^9, {3.906118056551551*^9, 
   3.9061180923341627`*^9}},ExpressionUUID->"8cd4c60b-587c-4dcf-8db7-\
2ce336390175"],

Cell[BoxData[{
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "TET"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "XISO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9034909365203495`*^9, 3.9034909417599707`*^9}, {
  3.903490972954488*^9, 3.9034909776829195`*^9}, {3.903492723882085*^9, 
  3.903492724665868*^9}, {3.903774709900457*^9, 3.90377471147127*^9}, {
  3.9038139415681133`*^9, 3.9038139416869392`*^9}, {3.903917872202607*^9, 
  3.903917878165914*^9}, {3.9039478007426577`*^9, 3.903947811929987*^9}, {
  3.9039478478271723`*^9, 3.9039478485306883`*^9}, {3.903949169670692*^9, 
  3.903949170193779*^9}, {3.903950649041699*^9, 3.903950658785625*^9}},
 CellLabel->
  "In[985]:=",ExpressionUUID->"34238de8-ce96-41ad-82ae-241ed4df3228"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reconstruct the problematic map.", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
  3.903612769329549*^9, 3.903612774341297*^9}, {3.90391804026791*^9, 
  3.903918046735718*^9}, {3.903952209145755*^9, 3.9039522542009983`*^9}, {
  3.903952303754738*^9, 3.9039523780537453`*^9}, {3.9039528138815393`*^9, 
  3.9039528162511883`*^9}, {3.906067850937714*^9, 
  3.9060678513569813`*^9}},ExpressionUUID->"3efd4547-f2a7-4116-9614-\
d8fca32d3dfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatTET", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "TET"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatXISO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "XISO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Tmatx", "=", 
    RowBox[{
     RowBox[{"0.4", "TmatTET"}], "+", 
     RowBox[{"0.6", "TmatXISO"}]}]}], ";"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "TmatTET", "]"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "TmatXISO", "]"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "Tmatx", "]"}],
  FontColor->GrayLevel[0]]}], "Input",
 CellChangeTimes->{{3.903612135073666*^9, 3.903612139491146*^9}, 
   3.903612194626137*^9, {3.9036123711443987`*^9, 3.903612374234449*^9}, {
   3.9036124449145*^9, 3.903612446956444*^9}, {3.903612541623007*^9, 
   3.903612543717054*^9}, {3.90391212554218*^9, 3.903912129604117*^9}, {
   3.9039180163350067`*^9, 3.903918029587595*^9}, {3.903950661605802*^9, 
   3.903950662074152*^9}, {3.903951802202528*^9, 3.903951823828722*^9}, {
   3.9039524102100697`*^9, 3.903952412521187*^9}},
 CellLabel->
  "In[987]:=",ExpressionUUID->"a8f360c6-9b7d-41b9-ae10-16eaf83ec5cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["This fails to find the global minimum (\[Beta] = 0.48 vs \[Beta] \
=0.06):", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
  3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
  3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
  3.903948261378167*^9}, {3.9039528418949003`*^9, 3.903952851238057*^9}, {
  3.903953153161577*^9, 3.9039531583885736`*^9}, {3.903953744294252*^9, 
  3.9039537508417*^9}, {3.906161166276196*^9, 
  3.906161251574087*^9}},ExpressionUUID->"a66bf582-30d9-4f2a-a3f7-\
82855cf899a0"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}},
 CellLabel->
  "In[993]:=",ExpressionUUID->"3b8bdccd-d9e1-40f1-a4fc-b748a4b81c92"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CORRECT MINIMUM (\[Beta] = 0.06): blue patch near \[Theta] = 0", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
   3.903948261378167*^9}, {3.9039528418949003`*^9, 3.903952851238057*^9}, {
   3.903953798421772*^9, 3.903953802607382*^9}, 3.904243943258354*^9, {
   3.904330016202962*^9, 3.9043300198026114`*^9}, 3.906074787193338*^9, {
   3.9060754297014236`*^9, 3.906075437403584*^9}, 
   3.906161234107607*^9},ExpressionUUID->"d55128b2-f81b-4fcb-ae5e-\
207884c5564b"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{"0", ",", 
      RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
      StyleBox["dphi",
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["Tmatx",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039479239430943`*^9, 
  3.903947937925682*^9}, {3.906067867714178*^9, 3.9060678694335318`*^9}, {
  3.906117871570326*^9, 3.9061178738784323`*^9}},
 CellLabel->
  "In[996]:=",ExpressionUUID->"629f4d46-8acd-44d5-86d4-b6862ee7be31"]
}, Open  ]],

Cell[CellGroupData[{

Cell["INCORRECT MINIMUM (\[Beta] = 0.481): blue path near \[Theta] = pi/2", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
   3.903948261378167*^9}, {3.903952853544272*^9, 3.903952865045164*^9}, {
   3.903953800115402*^9, 3.903953804183167*^9}, {3.904330274536064*^9, 
   3.9043302950166807`*^9}, 3.9060747878800097`*^9, {3.906075445204069*^9, 
   3.906075450285557*^9}, 
   3.906161237301993*^9},ExpressionUUID->"6346f300-180e-48f1-ad3d-\
60ee267cc866"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.5", "\[Pi]"}], ",", 
      RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
      StyleBox["dphi",
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["Tmatx",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039479239430943`*^9, 
  3.903947937925682*^9}, {3.9039482817970247`*^9, 3.903948295085189*^9}, {
  3.906067870578848*^9, 3.9060678728983727`*^9}, {3.906117875652954*^9, 
  3.906117877660049*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"1a222187-8f60-49c1-930b-f01397494f54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LOCAL MINIMUM (\[Beta] = 0.484): blue patch near poles", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
   3.903948261378167*^9}, 3.903952915905813*^9, {3.904330284181634*^9, 
   3.9043302978982058`*^9}, 3.906074788476775*^9, {3.906075464486363*^9, 
   3.906075466300721*^9}},ExpressionUUID->"77acf173-78f2-4508-8826-\
5986befdad37"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.7", "\[Pi]"}], ",", 
   RowBox[{"0.9", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.7", "\[Pi]"}], ",", 
      RowBox[{"0.1", "\[Pi]"}], ",", "dtheta", ",", 
      StyleBox["dphi",
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["Tmatx",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039479239430943`*^9, 
  3.903947937925682*^9}, {3.9039482817970247`*^9, 3.903948295085189*^9}, {
  3.903948342213685*^9, 3.903948344422038*^9}, {3.9039485097941513`*^9, 
  3.9039485433758097`*^9}, {3.906067874114614*^9, 3.906067875496593*^9}, {
  3.906117879323619*^9, 3.9061178814798813`*^9}},
 CellLabel->
  "In[1000]:=",ExpressionUUID->"cc957494-8c37-4fd1-bf09-ce8b7ab3e801"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Change the \[Theta] search range to \[Pi], and then it finds the global \
minimum:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
  3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
  3.903917750887499*^9, 3.903917765377664*^9}, {3.903948549891163*^9, 
  3.9039485503948174`*^9}, {3.903952680666849*^9, 3.903952692439741*^9}, {
  3.903952933677717*^9, 3.9039529360721693`*^9}, {3.903953783464199*^9, 
  3.903953783997858*^9}, {3.90395381767177*^9, 
  3.903953821560981*^9}},ExpressionUUID->"a4a594c1-d351-4219-a560-\
3c82448887c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox["\[Pi]",
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, {3.903917624151566*^9, 3.9039176448645563`*^9}, 
   3.903918479802446*^9, 3.903948438794223*^9, 3.903952530611207*^9, 
   3.9039526466510973`*^9, {3.906107021136352*^9, 3.906107021737026*^9}, {
   3.9061478905205*^9, 3.9061478911423817`*^9}},
 CellLabel->
  "In[1002]:=",ExpressionUUID->"b272fa6c-53d7-4159-b4f4-414ea2752956"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}},
 CellLabel->
  "In[1003]:=",ExpressionUUID->"327dda21-1028-4ba6-bf19-eb32ad36dc92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"Tmatx", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellLabel->
  "In[1004]:=",ExpressionUUID->"2729898d-0af1-4ab7-a085-dd5f4741d78e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change to a 3D search, and then it finds the global minimum:", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948549891163*^9, 
   3.9039485503948174`*^9}, {3.903952680666849*^9, 3.903952692439741*^9}, {
   3.903952933677717*^9, 3.9039529360721693`*^9}, {3.903953783464199*^9, 
   3.903953783997858*^9}, {3.90395381767177*^9, 3.903953821560981*^9}, 
   3.9039814536968603`*^9, {3.903981502373006*^9, 
   3.903981505993672*^9}},ExpressionUUID->"9d1c9121-cb84-481c-922e-\
44eab3d2a817"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"Tmat", ",", 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], "=", " ", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", "\[LessEqual]",
            "\[Pi]"}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"Tmat", ",", 
          StyleBox["MONO",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8432638002966256`*^9, 3.843263848587617*^9}, {
   3.843263901498243*^9, 3.8432639249045906`*^9}, {3.843264035112605*^9, 
   3.843264049384597*^9}, {3.8432640820756454`*^9, 3.8432641113867397`*^9}, {
   3.8432641575126195`*^9, 3.843264176600622*^9}, 3.8432642092735014`*^9, {
   3.85800443755595*^9, 3.858004508964686*^9}, {3.8580045492990336`*^9, 
   3.8580046084862204`*^9}, {3.8580046498167143`*^9, 
   3.8580046922574406`*^9}, {3.8580047386393414`*^9, 
   3.8580047519394045`*^9}, {3.858004893375312*^9, 3.858004901820363*^9}, {
   3.858008522332718*^9, 3.858008531919662*^9}, {3.8580086348792405`*^9, 
   3.8580086378895903`*^9}, {3.8580089489322834`*^9, 
   3.8580089933041143`*^9}, {3.8597262185704365`*^9, 
   3.8597262225626307`*^9}, {3.865886834723418*^9, 3.865886838446048*^9}, {
   3.865887046777639*^9, 3.865887059826816*^9}, {3.869838173908651*^9, 
   3.8698382816994867`*^9}, {3.869838335398591*^9, 3.8698383624375315`*^9}, 
   3.8698411107142754`*^9, {3.869841151929311*^9, 3.869841153561617*^9}, {
   3.8698412683313093`*^9, 3.8698412928033447`*^9}, {3.8702366100574226`*^9, 
   3.870236619333077*^9}, {3.8984721524199743`*^9, 3.8984721641800203`*^9}, {
   3.901910507639677*^9, 3.901910529659231*^9}, {3.9019105611702805`*^9, 
   3.9019105769789267`*^9}, {3.903970152708353*^9, 3.9039702037288265`*^9}, {
   3.903977352789545*^9, 3.9039773536211433`*^9}, {3.903981567888324*^9, 
   3.9039815813461933`*^9}, {3.904329103934411*^9, 3.9043291041926126`*^9}, {
   3.906107028559512*^9, 3.906107029186533*^9}, {3.906147894702888*^9, 
   3.906147897076399*^9}},
 CellLabel->
  "In[1005]:=",ExpressionUUID->"546b46d9-ae99-443b-95aa-a3b7c21ab9d1"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmatx", ",", "MONO"}], "]"}]], "Input",
 CellLabel->
  "In[1006]:=",ExpressionUUID->"eab384ec-164e-4807-99d4-d300076d9756"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Example 3: Igel map, 2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "8eab830a-a194-4933-b8d6-b70b1af344ec"],
 " = 2\[Pi]"
}], "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, {
   3.9040689211243963`*^9, 3.904068921632965*^9}, 3.904068955368416*^9, {
   3.904243952294083*^9, 3.904243952510644*^9}, {3.904244130392399*^9, 
   3.904244130993854*^9}},ExpressionUUID->"4cc410d6-fb31-4b33-99f2-\
252b84d14d19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatIgel"}], ";"}]], "Input",
 CellChangeTimes->{{3.903911975098435*^9, 3.903911984132441*^9}, {
  3.9039179866579733`*^9, 3.9039179872220087`*^9}},
 CellLabel->
  "In[1007]:=",ExpressionUUID->"4909bf82-52ef-4906-b622-5deff4c766da"],

Cell[CellGroupData[{

Cell["The problematic point is between TRIV and MONO (dt = 0.2):", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.903948682143021*^9}, {3.903948762903328*^9, 
  3.903948765851276*^9}, {3.904328364638974*^9, 
  3.90432836607799*^9}},ExpressionUUID->"080e5f5e-1d5d-4398-a968-\
01fc5e730ca7"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.013], 
   {GrayLevel[
    0], {PointBox[{1, 0}], PointBox[{2, 0}], PointBox[{3, 0}], 
     PointBox[{4, 0}], PointBox[{5, 0}], PointBox[{6, 0}], 
     PointBox[{7, 0.019038270539994018`}], PointBox[{8, 0.02827972080636015}],
      PointBox[{9, 0.02782593551101212}], 
     PointBox[{10, 0.018142341375773488`}], PointBox[{11, 0}], 
     PointBox[{12, 0}], PointBox[{13, 0.010934370343943796`}], 
     PointBox[{14, 0.01082589674771458}], PointBox[{15, 0}], 
     PointBox[{16, 0}], PointBox[{17, 0.01021190593479381}], 
     PointBox[{18, 0.015484672577081656`}], 
     PointBox[{19, 0.015621466258229301`}], 
     PointBox[{20, 0.010484317465523467`}], PointBox[{21, 0}], 
     PointBox[{22, 0.8626618321188855}], PointBox[{23, 1.724932724659626}], 
     PointBox[{24, 2.5864227999933473`}], PointBox[{25, 5.197543167617523}], 
     PointBox[{26, 4.305512612446112}]}, 
    LineBox[{{1, 0}, {2, 0}, {3, 0}, {4, 0}, {5, 0}, {6, 0}, {
      7, 0.019038270539994018`}, {8, 0.02827972080636015}, {
      9, 0.02782593551101212}, {10, 0.018142341375773488`}, {11, 0}, {12, 
      0}, {13, 0.010934370343943796`}, {14, 0.01082589674771458}, {15, 0}, {
      16, 0}, {17, 0.01021190593479381}, {18, 0.015484672577081656`}, {
      19, 0.015621466258229301`}, {20, 0.010484317465523467`}, {21, 0}, {
      22, 0.8626618321188855}, {23, 1.724932724659626}, {
      24, 2.5864227999933473`}, {25, 5.197543167617523}, {
      26, 4.305512612446112}}]}, 
   {Dashing[{0.01, 0.02}], {LineBox[{{1, 0}, {1, 0}}], 
     LineBox[{{6, 0}, {6, 0}}], LineBox[{{11, 0}, {11, 0}}], 
     LineBox[{{16, 0}, {16, 0}}], LineBox[{{21, 0}, {21, 0}}], 
     LineBox[{{26, 0}, {26, 4.305512612446112}}]}}, {InsetBox[
     StyleBox["25",
      StripOnInput->False,
      FontSize->12], {1, -0.30138588287122786}], InsetBox[
     StyleBox["17",
      StripOnInput->False,
      FontSize->12], {2, -0.30138588287122786}], InsetBox[
     StyleBox["13",
      StripOnInput->False,
      FontSize->12], {3, -0.30138588287122786}], InsetBox[
     StyleBox["9",
      StripOnInput->False,
      FontSize->12], {4, -0.30138588287122786}], InsetBox[
     StyleBox["8",
      StripOnInput->False,
      FontSize->12], {5, -0.30138588287122786}], InsetBox[
     StyleBox["6",
      StripOnInput->False,
      FontSize->12], {6, -0.30138588287122786}], InsetBox[
     StyleBox["12",
      StripOnInput->False,
      FontSize->12], {7, -0.30138588287122786}], InsetBox[
     StyleBox["16",
      StripOnInput->False,
      FontSize->12], {8, -0.30138588287122786}], InsetBox[
     StyleBox["29",
      StripOnInput->False,
      FontSize->12], {9, -0.30138588287122786}], InsetBox[
     StyleBox["33",
      StripOnInput->False,
      FontSize->12], {10, -0.30138588287122786}], InsetBox[
     StyleBox["43",
      StripOnInput->False,
      FontSize->12], {11, -0.30138588287122786}], InsetBox[
     StyleBox["42",
      StripOnInput->False,
      FontSize->12], {12, -0.30138588287122786}], InsetBox[
     StyleBox["41",
      StripOnInput->False,
      FontSize->12], {13, -0.30138588287122786}], InsetBox[
     StyleBox["40",
      StripOnInput->False,
      FontSize->12], {14, -0.30138588287122786}], InsetBox[
     StyleBox["39",
      StripOnInput->False,
      FontSize->12], {15, -0.30138588287122786}], InsetBox[
     StyleBox["38",
      StripOnInput->False,
      FontSize->12], {16, -0.30138588287122786}], InsetBox[
     StyleBox["36",
      StripOnInput->False,
      FontSize->12], {17, -0.30138588287122786}], InsetBox[
     StyleBox["32",
      StripOnInput->False,
      FontSize->12], {18, -0.30138588287122786}], InsetBox[
     StyleBox["30",
      StripOnInput->False,
      FontSize->12], {19, -0.30138588287122786}], InsetBox[
     StyleBox["26",
      StripOnInput->False,
      FontSize->12], {20, -0.30138588287122786}], InsetBox[
     StyleBox["24",
      StripOnInput->False,
      FontSize->12], {21, -0.30138588287122786}], InsetBox[
     StyleBox["23",
      StripOnInput->False,
      FontSize->12], {22, -0.30138588287122786}], InsetBox[
     StyleBox["22",
      StripOnInput->False,
      FontSize->12], {23, -0.30138588287122786}], InsetBox[
     StyleBox["21",
      StripOnInput->False,
      FontSize->12], {24, -0.30138588287122786}], InsetBox[
     StyleBox["20",
      StripOnInput->False,
      FontSize->12], {25, -0.30138588287122786}], InsetBox[
     StyleBox["19",
      StripOnInput->False,
      FontSize->12], {26, -0.30138588287122786}]}, {InsetBox[
     StyleBox["\<\"ISO\"\>",
      StripOnInput->False,
      FontSize->11], {1, -0.6027717657424557}], InsetBox[
     StyleBox["\<\"XISO\"\>",
      StripOnInput->False,
      FontSize->11], {6, -0.6027717657424557}], InsetBox[
     StyleBox["\<\"TET\"\>",
      StripOnInput->False,
      FontSize->11], {11, -0.6027717657424557}], InsetBox[
     StyleBox["\<\"ORTH\"\>",
      StripOnInput->False,
      FontSize->11], {16, -0.6027717657424557}], InsetBox[
     StyleBox["\<\"MONO\"\>",
      StripOnInput->False,
      FontSize->11], {21, -0.6027717657424557}], InsetBox[
     StyleBox["\<\"TRIV\"\>",
      StripOnInput->False,
      FontSize->11], {26, -0.6027717657424557}]}, InsetBox[
    StyleBox[
     InterpretationBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(MONO\\)]\\)\"\>", 
       "\[InvisibleSpace]", "\<\" (\"\>", "\[InvisibleSpace]", 
       "4.3100000000000005`", "\[InvisibleSpace]", "\<\")\"\>"}],
      SequenceForm[
      "\!\(\*SubscriptBox[\(\[Beta]\), \(MONO\)]\)", " (", 
       4.3100000000000005`, ")"],
      Editable->False],
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontSize->15,
     FontColor->GrayLevel[0]], {26.78, 4.305512612446112}, NCache[
    ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
  AspectRatio->1,
  Axes->True,
  AxesOrigin->{1, 0},
  ImageSize->500,
  Ticks->{None, {{0, 
      FormBox["0", TraditionalForm]}, {5, 
      FormBox["5", TraditionalForm]}, {10, 
      FormBox["10", TraditionalForm]}, {15, 
      FormBox["15", TraditionalForm]}, {20, 
      FormBox["20", TraditionalForm]}, {25, 
      FormBox["25", TraditionalForm]}, {30, 
      FormBox["30", TraditionalForm]}, {35, 
      FormBox["35", TraditionalForm]}, {40, 
      FormBox["40", TraditionalForm]}, {45, 
      FormBox["45", TraditionalForm]}, {50, 
      FormBox["50", TraditionalForm]}}},
  TicksStyle->12]], "Output",
 CellChangeTimes->{
  3.904247981708069*^9, 3.9042589879709883`*^9, 3.904261639738411*^9, 
   3.9043226820649757`*^9, 3.904323525882546*^9, 3.904324622476645*^9, 
   3.904324730953615*^9, 3.904324803488924*^9, {3.904324911794693*^9, 
   3.904324935624289*^9}},
 CellLabel->
  "Out[976]=",ExpressionUUID->"75a8649a-559e-4602-89bf-5905341e690d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.1", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dphi", "=", "dtheta"}], ";"}]}], "Input",
 CellLabel->
  "In[1008]:=",ExpressionUUID->"8d206631-2b32-47d3-a520-78f38180bee8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "335d6a40-cb25-4576-9073-7dbdf81c4bd4"],
 " = 2\[Pi]"
}], "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
   3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
   3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
   3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
   3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
   3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903632223553894*^9, 
   3.903632227295744*^9}, {3.904068592985598*^9, 3.904068596986977*^9}, 
   3.904329292067493*^9},ExpressionUUID->"ea88f7f9-7ddd-4680-be40-\
fd3b981c71aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox[
             RowBox[{"2", "\[Pi]"}],
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, 3.903917624151566*^9, {3.906107035953951*^9, 
   3.906107036527372*^9}, {3.9061479050610447`*^9, 3.9061479058217*^9}},
 CellLabel->
  "In[1010]:=",ExpressionUUID->"40f56b3d-9881-41bd-a5e8-593f894aef97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Closest MONO map to the input TRIV map:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9},ExpressionUUID->"98002df5-2aa4-4f89-aa43-\
bd9e9b90f4f0"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.9034909365203495`*^9, 3.9034909417599707`*^9}, {
  3.903490972954488*^9, 3.9034909776829195`*^9}, {3.903492723882085*^9, 
  3.903492724665868*^9}, {3.903774709900457*^9, 3.90377471147127*^9}, {
  3.9038139415681133`*^9, 3.9038139416869392`*^9}, {3.904324986943927*^9, 
  3.9043249877542543`*^9}},
 CellLabel->
  "In[1011]:=",ExpressionUUID->"1cf9c1af-86f4-48c6-a788-3d8e2818ec45"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reconstruct the problematic map.", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
   3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
   3.903612769329549*^9, 3.903612774341297*^9}, {3.904325466585635*^9, 
   3.9043254909848967`*^9}, {3.904328432260364*^9, 3.9043284418968143`*^9}, {
   3.9043307877173*^9, 3.9043308005723467`*^9}, 
   3.90611813819097*^9},ExpressionUUID->"204a8ef6-6b22-470e-a5c5-\
a2b8a8d1b5a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatMONO", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "MONO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Tmatx", "=", 
    RowBox[{
     RowBox[{"0.8", "Tmat"}], "+", 
     RowBox[{"0.2", "TmatMONO"}]}]}], ";"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "Tmatx", "]"}],
  FontColor->GrayLevel[0]]}], "Input",
 CellChangeTimes->{{3.903612135073666*^9, 3.903612139491146*^9}, 
   3.903612194626137*^9, {3.9036123711443987`*^9, 3.903612374234449*^9}, {
   3.9036124449145*^9, 3.903612446956444*^9}, {3.903612541623007*^9, 
   3.903612543717054*^9}, {3.90391212554218*^9, 3.903912129604117*^9}, {
   3.9061613495480347`*^9, 
   3.906161361886325*^9}},ExpressionUUID->"542005ba-4fe0-4b0a-8643-\
d64b25a14bee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["This fails to find the global minimum (\[Beta] = 5.20 vs \[Beta] \
=3.45):", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
  3.903612769329549*^9, 3.903612774341297*^9}, {3.904325466585635*^9, 
  3.9043254909848967`*^9}, {3.904328432260364*^9, 3.9043284418968143`*^9}, {
  3.9043307877173*^9, 3.9043308005723467`*^9}, {3.90611813819097*^9, 
  3.906118155699733*^9}, {3.9061613854374943`*^9, 3.906161387441587*^9}, {
  3.90616143668312*^9, 3.9061614411426077`*^9}, {3.906161479542129*^9, 
  3.90616148920514*^9}},ExpressionUUID->"3549dae6-01d6-4f72-8df8-\
8d0c9a345ce0"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}},
 CellLabel->
  "In[1015]:=",ExpressionUUID->"91d57728-5d47-4edf-a56b-aaf6d136ed38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"Tmatx", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellChangeTimes->{{3.903564672712715*^9, 3.9035646928964877`*^9}, {
  3.9035757174438686`*^9, 3.903575728194148*^9}, {3.903612467260022*^9, 
  3.903612467850656*^9}, {3.903814008567244*^9, 3.903814009322*^9}},
 CellLabel->
  "In[1016]:=",ExpressionUUID->"0a3542bf-9b24-4935-8134-53d900905de8"]
}, Open  ]],

Cell["\<\
The green dot in the contour plot turns out to be a local minimum, as we see \
next.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035534818176193`*^9, 3.9035534986743283`*^9}, {
  3.9035750952861786`*^9, 3.903575191198477*^9}, {3.903575321752406*^9, 
  3.9035753538676496`*^9}, {3.9035755142122316`*^9, 3.9035755461264524`*^9}, {
  3.903575630337594*^9, 3.90357564701593*^9}, {3.9035758726511326`*^9, 
  3.9035759345953417`*^9}, {3.903613866273098*^9, 3.9036138740916243`*^9}, {
  3.903632747218294*^9, 3.9036327496666594`*^9}, {3.904325606646901*^9, 
  3.904325609111808*^9}},ExpressionUUID->"adaa795a-bd0d-45cd-acb9-\
97df6e1f32d9"],

Cell[CellGroupData[{

Cell["\<\
CORRECT MINIMUM (\[Beta] = 3.45): blue patch at the center and its antipode \
region:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, 3.9036089127632837`*^9, {3.903613773962192*^9, 
   3.903613776758567*^9}, {3.9039175333539743`*^9, 3.903917544770721*^9}, {
   3.9043301080268917`*^9, 3.904330113101041*^9}, 3.906074789077374*^9, {
   3.906075609227768*^9, 
   3.9060756130342283`*^9}},ExpressionUUID->"ebf094e6-b409-4ec0-8317-\
eb9aa8d2d622"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{"\[Pi]", ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox[
     RowBox[{"Flocal", "[", 
      RowBox[{"0", ",", 
       RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", "Tmatx"}], 
      "]"}],
     FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039123274778852`*^9, 
  3.903912346035796*^9}, {3.9060747132503242`*^9, 3.906074715616016*^9}, {
  3.906117889197336*^9, 3.906117891250865*^9}},
 CellLabel->
  "In[1017]:=",ExpressionUUID->"cf6181c4-3f21-43f9-bcac-50c7cbae9c79"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
INCORRECT MINIMUM (\[Beta] = 2.138): blue patch (with green dot) to the upper \
left of center:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.904328488853861*^9, 3.90432849242845*^9}, {3.904330328020083*^9, 
   3.9043303323518543`*^9}, 
   3.906074789726687*^9},ExpressionUUID->"8beae2c0-4d19-4cb0-b3d7-\
cef42aa7d377"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.8", " ", "\[Pi]"}], ",", 
   RowBox[{"0.6", "\[Pi]"}], ",", "dtheta", ",", "dphi", ",", 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}]}], "Input",
 CellChangeTimes->{{3.903608625509404*^9, 3.903608626267803*^9}, {
  3.903608772675317*^9, 3.903608772816221*^9}, {3.903608890296454*^9, 
  3.903608892791*^9}, {3.9036107529335117`*^9, 3.9036107552435017`*^9}, {
  3.9036124832516193`*^9, 3.903612483521886*^9}, {3.903612514373981*^9, 
  3.903612522581709*^9}, {3.90391239249794*^9, 3.903912410678315*^9}, {
  3.903912447956493*^9, 3.903912452967393*^9}, {3.9060756737364073`*^9, 
  3.906075675139247*^9}},
 CellLabel->
  "In[1019]:=",ExpressionUUID->"b9e9207d-ec75-4917-9fbf-d73424de64c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change the search range back to \[Pi], and it works:", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
  3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
  3.903917750887499*^9, 
  3.903917765377664*^9}},ExpressionUUID->"ab3143de-ea9a-4bc6-a24b-\
1513e88648bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox["\[Pi]",
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, {3.903917624151566*^9, 3.9039176448645563`*^9}, {
   3.904329025437489*^9, 3.904329025940671*^9}, {3.904329095819582*^9, 
   3.9043290986468153`*^9}, {3.906107043022855*^9, 3.906107043553789*^9}, {
   3.906147911946686*^9, 3.906147912760951*^9}},
 CellLabel->
  "In[1021]:=",ExpressionUUID->"d9ab6cd2-c73b-428d-a0b9-a36ed8b62e45"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}, 
   3.904329024241897*^9, 3.9043290976896544`*^9},
 CellLabel->
  "In[1022]:=",ExpressionUUID->"a7c5dc8a-3643-445f-992f-6af2fde33a01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"Tmatx", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellLabel->
  "In[1023]:=",ExpressionUUID->"493fa888-d3ad-490f-96d0-26740a86a506"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change to a 3D search, and then it finds the global minimum:", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948549891163*^9, 
   3.9039485503948174`*^9}, {3.903952680666849*^9, 3.903952692439741*^9}, {
   3.903952933677717*^9, 3.9039529360721693`*^9}, {3.903953783464199*^9, 
   3.903953783997858*^9}, {3.90395381767177*^9, 3.903953821560981*^9}, 
   3.9039814536968603`*^9, {3.903981502373006*^9, 
   3.903981505993672*^9}},ExpressionUUID->"ecf348dc-0b48-42a4-bb01-\
1483cd91fc47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"Tmat", ",", 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], "=", " ", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", "\[LessEqual]",
            "\[Pi]"}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"Tmat", ",", 
          StyleBox["MONO",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8432638002966256`*^9, 3.843263848587617*^9}, {
   3.843263901498243*^9, 3.8432639249045906`*^9}, {3.843264035112605*^9, 
   3.843264049384597*^9}, {3.8432640820756454`*^9, 3.8432641113867397`*^9}, {
   3.8432641575126195`*^9, 3.843264176600622*^9}, 3.8432642092735014`*^9, {
   3.85800443755595*^9, 3.858004508964686*^9}, {3.8580045492990336`*^9, 
   3.8580046084862204`*^9}, {3.8580046498167143`*^9, 
   3.8580046922574406`*^9}, {3.8580047386393414`*^9, 
   3.8580047519394045`*^9}, {3.858004893375312*^9, 3.858004901820363*^9}, {
   3.858008522332718*^9, 3.858008531919662*^9}, {3.8580086348792405`*^9, 
   3.8580086378895903`*^9}, {3.8580089489322834`*^9, 
   3.8580089933041143`*^9}, {3.8597262185704365`*^9, 
   3.8597262225626307`*^9}, {3.865886834723418*^9, 3.865886838446048*^9}, {
   3.865887046777639*^9, 3.865887059826816*^9}, {3.869838173908651*^9, 
   3.8698382816994867`*^9}, {3.869838335398591*^9, 3.8698383624375315`*^9}, 
   3.8698411107142754`*^9, {3.869841151929311*^9, 3.869841153561617*^9}, {
   3.8698412683313093`*^9, 3.8698412928033447`*^9}, {3.8702366100574226`*^9, 
   3.870236619333077*^9}, {3.8984721524199743`*^9, 3.8984721641800203`*^9}, {
   3.901910507639677*^9, 3.901910529659231*^9}, {3.9019105611702805`*^9, 
   3.9019105769789267`*^9}, {3.903970152708353*^9, 3.9039702037288265`*^9}, {
   3.903977352789545*^9, 3.9039773536211433`*^9}, {3.903981567888324*^9, 
   3.9039815813461933`*^9}, {3.904329103934411*^9, 3.9043291041926126`*^9}, {
   3.906107051170526*^9, 3.906107051706114*^9}, {3.906147920121004*^9, 
   3.906147920801903*^9}},
 CellLabel->
  "In[1024]:=",ExpressionUUID->"4cb55a53-85f0-4e46-a38e-cbbbc97f81bb"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmatx", ",", "MONO"}], "]"}]], "Input",
 CellLabel->
  "In[1025]:=",ExpressionUUID->"2b87b66a-ac95-40ec-9cda-b86033620301"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Example 4: TmatMar17 map, 2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "d73341ac-2bc1-49bf-beff-b76122a8e699"],
 " = \[Pi]"
}], "Section",
 CellChangeTimes->{{3.9040683900833473`*^9, 3.904068412256774*^9}, {
   3.9040684782506*^9, 3.904068499791157*^9}, 3.904068583949627*^9, {
   3.9040689211243963`*^9, 3.904068921632965*^9}, 3.904068955368416*^9, {
   3.904243952294083*^9, 3.904243952510644*^9}, {3.904244141116647*^9, 
   3.904244145657735*^9}, 
   3.9043285520322027`*^9},ExpressionUUID->"88e2952f-5570-46e6-a477-\
fa280c615650"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", " ", "=", " ", "TmatMar17"}], ";"}]], "Input",
 CellChangeTimes->{{3.903911975098435*^9, 3.903911984132441*^9}, {
  3.903917975494522*^9, 3.903917976366488*^9}, {3.903918186869246*^9, 
  3.903918190304811*^9}, {3.903981028232626*^9, 3.903981029905818*^9}},
 CellLabel->
  "In[1026]:=",ExpressionUUID->"1448e63a-8f5d-47f0-ac1b-983fcd7fd5ca"],

Cell[CellGroupData[{

Cell[TextData[{
 "The problematic point is between ORTH and TET (dt =0.2, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "9041e22c-d585-4d40-afa9-f0170cbc4a5f"],
 " = \[Pi]):"
}], "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
  3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, {
  3.9039486478452806`*^9, 3.9039486611957273`*^9}, {3.9039487563831387`*^9, 
  3.903948758841838*^9}, {3.903950443153172*^9, 3.9039504443079357`*^9}, {
  3.903980897060602*^9, 
  3.903980912178186*^9}},ExpressionUUID->"9fb929a4-50f8-4f5b-8e0d-\
830b6a786a60"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.013], 
   {GrayLevel[
    0], {PointBox[{1, 0}], PointBox[{2, 0}], PointBox[{3, 0}], 
     PointBox[{4, 0}], PointBox[{5, 0}], PointBox[{6, 0}], PointBox[{7, 0}], 
     PointBox[{8, 0}], PointBox[{9, 0}], PointBox[{10, 0}], PointBox[{11, 0}],
      PointBox[{12, 0.010210126155255204`}], 
     PointBox[{13, 0.3561014405547147}], 
     PointBox[{14, 0.015470656532848261`}], 
     PointBox[{15, 0.010368006250304035`}], PointBox[{16, 0}], 
     PointBox[{17, 0.25376643294921836`}], PointBox[{18, 0.3696705868176573}],
      PointBox[{19, 0.3498453087020049}], PointBox[{20, 0.2168469024196451}], 
     PointBox[{21, 0}], PointBox[{22, 0.9949307561922274}], 
     PointBox[{23, 1.9892618573333862`}], PointBox[{24, 2.9823958140544433`}],
      PointBox[{25, 3.9737394488340185`}], PointBox[{26, 4.96270600345851}]}, 
    LineBox[{{1, 0}, {2, 0}, {3, 0}, {4, 0}, {5, 0}, {6, 0}, {7, 0}, {8, 0}, {
      9, 0}, {10, 0}, {11, 0}, {12, 0.010210126155255204`}, {
      13, 0.3561014405547147}, {14, 0.015470656532848261`}, {
      15, 0.010368006250304035`}, {16, 0}, {17, 0.25376643294921836`}, {
      18, 0.3696705868176573}, {19, 0.3498453087020049}, {
      20, 0.2168469024196451}, {21, 0}, {22, 0.9949307561922274}, {
      23, 1.9892618573333862`}, {24, 2.9823958140544433`}, {
      25, 3.9737394488340185`}, {26, 4.96270600345851}}]}, {InsetBox[
     StyleBox["25",
      StripOnInput->False,
      FontSize->12], {1, -0.29776236020751057}], InsetBox[
     StyleBox["17",
      StripOnInput->False,
      FontSize->12], {2, -0.29776236020751057}], InsetBox[
     StyleBox["13",
      StripOnInput->False,
      FontSize->12], {3, -0.29776236020751057}], InsetBox[
     StyleBox["9",
      StripOnInput->False,
      FontSize->12], {4, -0.29776236020751057}], InsetBox[
     StyleBox["8",
      StripOnInput->False,
      FontSize->12], {5, -0.29776236020751057}], InsetBox[
     StyleBox["6",
      StripOnInput->False,
      FontSize->12], {6, -0.29776236020751057}], InsetBox[
     StyleBox["12",
      StripOnInput->False,
      FontSize->12], {7, -0.29776236020751057}], InsetBox[
     StyleBox["16",
      StripOnInput->False,
      FontSize->12], {8, -0.29776236020751057}], InsetBox[
     StyleBox["29",
      StripOnInput->False,
      FontSize->12], {9, -0.29776236020751057}], InsetBox[
     StyleBox["33",
      StripOnInput->False,
      FontSize->12], {10, -0.29776236020751057}], InsetBox[
     StyleBox["43",
      StripOnInput->False,
      FontSize->12], {11, -0.29776236020751057}], InsetBox[
     StyleBox["42",
      StripOnInput->False,
      FontSize->12], {12, -0.29776236020751057}], InsetBox[
     StyleBox["41",
      StripOnInput->False,
      FontSize->12], {13, -0.29776236020751057}], InsetBox[
     StyleBox["40",
      StripOnInput->False,
      FontSize->12], {14, -0.29776236020751057}], InsetBox[
     StyleBox["39",
      StripOnInput->False,
      FontSize->12], {15, -0.29776236020751057}], InsetBox[
     StyleBox["38",
      StripOnInput->False,
      FontSize->12], {16, -0.29776236020751057}], InsetBox[
     StyleBox["36",
      StripOnInput->False,
      FontSize->12], {17, -0.29776236020751057}], InsetBox[
     StyleBox["32",
      StripOnInput->False,
      FontSize->12], {18, -0.29776236020751057}], InsetBox[
     StyleBox["30",
      StripOnInput->False,
      FontSize->12], {19, -0.29776236020751057}], InsetBox[
     StyleBox["26",
      StripOnInput->False,
      FontSize->12], {20, -0.29776236020751057}], InsetBox[
     StyleBox["24",
      StripOnInput->False,
      FontSize->12], {21, -0.29776236020751057}], InsetBox[
     StyleBox["23",
      StripOnInput->False,
      FontSize->12], {22, -0.29776236020751057}], InsetBox[
     StyleBox["22",
      StripOnInput->False,
      FontSize->12], {23, -0.29776236020751057}], InsetBox[
     StyleBox["21",
      StripOnInput->False,
      FontSize->12], {24, -0.29776236020751057}], InsetBox[
     StyleBox["20",
      StripOnInput->False,
      FontSize->12], {25, -0.29776236020751057}], InsetBox[
     StyleBox["19",
      StripOnInput->False,
      FontSize->12], {26, -0.29776236020751057}]}, {InsetBox[
     StyleBox["\<\"ISO\"\>",
      StripOnInput->False,
      FontSize->11], {1, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {2, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {3, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {4, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {5, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"XISO\"\>",
      StripOnInput->False,
      FontSize->11], {6, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {7, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {8, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {9, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {10, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"TET\"\>",
      StripOnInput->False,
      FontSize->11], {11, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {12, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {13, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {14, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {15, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"ORTH\"\>",
      StripOnInput->False,
      FontSize->11], {16, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {17, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {18, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {19, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {20, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"MONO\"\>",
      StripOnInput->False,
      FontSize->11], {21, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {22, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {23, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {24, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"\"\>",
      StripOnInput->False,
      FontSize->11], {25, -0.5955247204150211}], InsetBox[
     StyleBox["\<\"TRIV\"\>",
      StripOnInput->False,
      FontSize->11], {26, -0.5955247204150211}]}, InsetBox[
    StyleBox[
     InterpretationBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(MONO\\)]\\)\"\>", 
       "\[InvisibleSpace]", "\<\" (\"\>", "\[InvisibleSpace]", "4.96`", 
       "\[InvisibleSpace]", "\<\")\"\>"}],
      SequenceForm[
      "\!\(\*SubscriptBox[\(\[Beta]\), \(MONO\)]\)", " (", 4.96, ")"],
      Editable->False],
     StripOnInput->False,
     LineColor->GrayLevel[0],
     FrontFaceColor->GrayLevel[0],
     BackFaceColor->GrayLevel[0],
     GraphicsColor->GrayLevel[0],
     FontSize->15,
     FontColor->GrayLevel[0]], {26.78, 4.96270600345851}, NCache[
    ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
  AspectRatio->1,
  Axes->True,
  AxesOrigin->{1, 0},
  ImageSize->500,
  Ticks->{None, {{0, 
      FormBox["0", TraditionalForm]}, {5, 
      FormBox["5", TraditionalForm]}, {10, 
      FormBox["10", TraditionalForm]}, {15, 
      FormBox["15", TraditionalForm]}, {20, 
      FormBox["20", TraditionalForm]}, {25, 
      FormBox["25", TraditionalForm]}, {30, 
      FormBox["30", TraditionalForm]}, {35, 
      FormBox["35", TraditionalForm]}, {40, 
      FormBox["40", TraditionalForm]}, {45, 
      FormBox["45", TraditionalForm]}, {50, 
      FormBox["50", TraditionalForm]}}},
  TicksStyle->12]], "Output",
 CellChangeTimes->{3.9039807864437523`*^9, 3.903980828064631*^9},
 CellLabel->
  "Out[2649]=",ExpressionUUID->"2520146d-b59d-4057-8cc5-de85ccd187b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adjust d\[Theta] based on how close the local minima are.", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.903948197956471*^9, 3.903948211949337*^9}, 
   3.903948733778756*^9, {3.904328565615839*^9, 
   3.9043285664480753`*^9}},ExpressionUUID->"6d21d20b-7b09-4f5c-9ae3-\
ffe289bb1a20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dtheta", " ", "=", " ", 
   RowBox[{"0.2", "\[Pi]"}]}], ";", " ", 
  RowBox[{"dphi", "=", "dtheta"}], ";"}]], "Input",
 CellChangeTimes->{{3.903608410297072*^9, 3.903608420324973*^9}, 
   3.903608513402856*^9, 3.9036086282304993`*^9, {3.903912461388278*^9, 
   3.9039124614977007`*^9}, {3.9039481938838797`*^9, 3.90394819572519*^9}},
 CellLabel->
  "In[1027]:=",ExpressionUUID->"31dcd6ac-380e-4202-947b-d1648d1135d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "2D search with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],ExpressionUUID->
  "b74f0b99-1e39-4314-b342-4be57f4950e2"],
 " = \[Pi]"
}], "Subsubsection",
 CellChangeTimes->{{3.9035533622040715`*^9, 3.903553398839633*^9}, {
  3.9035534289419327`*^9, 3.903553438846491*^9}, {3.903574283568838*^9, 
  3.9035742842939005`*^9}, {3.90361443610213*^9, 3.903614436982295*^9}, {
  3.9036144858597097`*^9, 3.903614500781948*^9}, {3.9036152097123823`*^9, 
  3.903615220379242*^9}, {3.903615318011033*^9, 3.903615319547217*^9}, {
  3.903615359787485*^9, 3.9036153634226418`*^9}, {3.903632223553894*^9, 
  3.903632227295744*^9}, {3.904068592985598*^9, 
  3.904068596986977*^9}},ExpressionUUID->"d472af5d-6d8e-47d9-ae76-\
924a5bdb91d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox["\[Pi]",
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, 3.903917624151566*^9, 3.903980927856555*^9, {
   3.906107058589802*^9, 3.90610705939196*^9}, {3.9061479281850367`*^9, 
   3.9061479289289417`*^9}},
 CellLabel->
  "In[1028]:=",ExpressionUUID->"5f0b808d-152d-4111-9f14-a0f391b96632"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Check the starting value of TRIV (",
 Cell[BoxData[
  SubscriptBox["\[Beta]", "MONO"]],
  CellChangeTimes->{3.9043254840319*^9, 3.904329548407053*^9, 
   3.9043311040935917`*^9},ExpressionUUID->
  "b2899595-e0fe-4eb7-ab1e-b175652fafea"],
 "= 4.96)"
}], "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9, {3.903947858312419*^9, 3.903947875525981*^9}, {
   3.9039810482142153`*^9, 3.903981058055059*^9}, {3.9043311532822943`*^9, 
   3.904331170867765*^9}},ExpressionUUID->"996550ac-a7b5-4397-b146-\
e2e85b8a62a0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"OutputFor", "[", 
   RowBox[{"Tmat", ",", "MONO"}], "]"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.903947855966342*^9, 3.903947856340501*^9}, {
  3.903949177012637*^9, 3.9039491780190763`*^9}, {3.9043249927169113`*^9, 
  3.904324993530846*^9}, {3.906116325375524*^9, 3.90611632823883*^9}},
 CellLabel->
  "In[1029]:=",ExpressionUUID->"c7294db4-6f33-4837-a11a-97872a72bca4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["closest to ORTH, closest to TET", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.903609707132456*^9, 
   3.903609714439845*^9}, {3.90361123079871*^9, 3.903611236106979*^9}, 
   3.9036112760412617`*^9, {3.903949159446639*^9, 3.90394915979805*^9}, {
   3.903952802202408*^9, 3.903952808227405*^9}, {3.9039816467966957`*^9, 
   3.903981649251082*^9}, {3.906116245872278*^9, 
   3.906116251337694*^9}},ExpressionUUID->"5de1787d-84c4-4659-ac47-\
2b87db3537d7"],

Cell[BoxData[{
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "TET"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "ORTH"}], "]"}]}], "Input",
 CellChangeTimes->{{3.906076419177247*^9, 3.906076425845674*^9}},
 CellLabel->
  "In[1030]:=",ExpressionUUID->"40f54a9d-6657-4432-9041-ac86498b0452"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reconstruct the problematic map.", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741556923313`*^9, 3.9035741698530107`*^9}, {3.903612201527424*^9, 
  3.903612221340769*^9}, {3.903612377269466*^9, 3.9036123863475237`*^9}, {
  3.903612769329549*^9, 3.903612774341297*^9}, {3.90391804026791*^9, 
  3.903918046735718*^9}, {3.903952209145755*^9, 3.9039522542009983`*^9}, {
  3.903952303754738*^9, 3.9039523780537453`*^9}, {3.9039528138815393`*^9, 
  3.9039528162511883`*^9}, {3.906067850937714*^9, 
  3.9060678513569813`*^9}},ExpressionUUID->"a193ed3d-634b-4035-b3cc-\
f0dcd47fec5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TmatTET", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "TET"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatORTH", "=", 
   RowBox[{"Closest", "[", 
    RowBox[{"Tmat", ",", "ORTH"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Tmatx", "=", 
    RowBox[{
     RowBox[{"0.6", "TmatTET"}], "+", 
     RowBox[{"0.4", "TmatORTH"}]}]}], ";"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "TmatTET", "]"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "TmatORTH", "]"}],
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"MatrixForm", "[", "Tmatx", "]"}],
  FontColor->GrayLevel[0]]}], "Input",
 CellChangeTimes->{{3.903612135073666*^9, 3.903612139491146*^9}, 
   3.903612194626137*^9, {3.9036123711443987`*^9, 3.903612374234449*^9}, {
   3.9036124449145*^9, 3.903612446956444*^9}, {3.903612541623007*^9, 
   3.903612543717054*^9}, {3.90391212554218*^9, 3.903912129604117*^9}, {
   3.9039180163350067`*^9, 3.903918029587595*^9}, {3.903950661605802*^9, 
   3.903950662074152*^9}, {3.903951802202528*^9, 3.903951823828722*^9}, {
   3.9039524102100697`*^9, 3.903952412521187*^9}, {3.906076364260736*^9, 
   3.906076382034103*^9}, {3.906076697966139*^9, 3.9060767010477467`*^9}},
 CellLabel->
  "In[1032]:=",ExpressionUUID->"65d09efe-9d01-467d-ba4a-2275cff33cae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "This fails to find the global minimum (it finds \[Beta] = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["0.356", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]],ExpressionUUID->
  "e3a978c1-d64e-4184-a253-87c5f53fef5e"],
 ", but the minimum is \[Beta] = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["0.015", 
    StyleBox["o",
     FontSlant->"Plain"]], TraditionalForm]],ExpressionUUID->
  "350253b6-2330-4203-8b3e-f0d75c1e7460"],
 "):"
}], "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
  3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
  3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
  3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
  3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
  3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
  3.903948261378167*^9}, {3.9039528418949003`*^9, 3.903952851238057*^9}, {
  3.903953153161577*^9, 3.9039531583885736`*^9}, {3.903953744294252*^9, 
  3.9039537508417*^9}, {3.904329371101934*^9, 3.9043294248329163`*^9}, {
  3.9043294712770367`*^9, 
  3.904329480987731*^9}},ExpressionUUID->"76c5fa34-c5ff-4cd8-825d-\
50ae7f958e88"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmatx", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.906076573613934*^9, 3.906076581882519*^9}},
 CellLabel->
  "In[1038]:=",ExpressionUUID->"199158fd-462c-4f25-9f68-8e6737437e4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LOCAL MINIMUM (\[Beta] = 0.36): blue sausage near \[Theta] = 2\[Pi]", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
   3.903948261378167*^9}, {3.9039528418949003`*^9, 3.903952851238057*^9}, {
   3.903953798421772*^9, 3.903953802607382*^9}, {3.903981419155958*^9, 
   3.903981419677495*^9}, {3.903981677301983*^9, 3.903981678178134*^9}, {
   3.90432882475557*^9, 3.904328825858021*^9}, {3.904330856220984*^9, 
   3.9043308683397217`*^9}, 3.9060747923609858`*^9, {3.9060769431022882`*^9, 
   3.906076944036909*^9}},ExpressionUUID->"1cdae954-3b2f-4557-8cf2-\
d3453de40693"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"1.95", "\[Pi]"}], ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"0.95", " ", "\[Pi]"}], ",", 
      RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
      StyleBox["dphi",
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["Tmatx",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039479239430943`*^9, 
  3.903947937925682*^9}, {3.904328840346992*^9, 3.9043288630185223`*^9}, {
  3.90607473558388*^9, 3.90607473723341*^9}, {3.906117922613316*^9, 
  3.9061179247483797`*^9}},
 CellLabel->
  "In[1039]:=",ExpressionUUID->"3fd1629a-d065-4ae7-a534-0e1b59a1dc4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["INCORRECT MINIMUM (\[Beta] = 0.36): blue sausage near \[Theta] = \
\[Pi]/2", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
   3.903948261378167*^9}, {3.903952853544272*^9, 3.903952865045164*^9}, {
   3.903953800115402*^9, 3.903953804183167*^9}, {3.903981385547277*^9, 
   3.9039813900901527`*^9}, 3.903981681965089*^9, {3.904328718578805*^9, 
   3.904328720709087*^9}, {3.904330870386118*^9, 3.904330875938998*^9}, 
   3.90607479297816*^9, {3.906076947224285*^9, 
   3.906076948151173*^9}},ExpressionUUID->"59721e57-d879-4ddc-9157-\
e0ab7f63a967"],

Cell[BoxData[{
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.5", "\[Pi]"}], ",", 
   RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcSin", "[", 
   RowBox[{
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", 
  "Degree"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flocal", "[", 
     RowBox[{
      RowBox[{"1.5", "\[Pi]"}], ",", 
      RowBox[{"0.5", "\[Pi]"}], ",", "dtheta", ",", 
      StyleBox["dphi",
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["Tmatx",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"%", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"NormMatrix", "[", "Tmatx", "]"}]}], "]"}], "/", "Degree"}]}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039479239430943`*^9, 
  3.903947937925682*^9}, {3.9039482817970247`*^9, 3.903948295085189*^9}, {
  3.9039813275134*^9, 3.9039813276593733`*^9}, {3.9060747397318707`*^9, 
  3.9060747410836573`*^9}, {3.9061179265546837`*^9, 3.906117928780238*^9}},
 CellLabel->
  "In[1041]:=",ExpressionUUID->"10bfdb9d-67df-4a5c-bc59-38800a099007"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CORRECT MINIMUM (\[Beta] = 0.197): blue isolated patch", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948260792901*^9, 
   3.903948261378167*^9}, 3.903952915905813*^9, {3.9039813683167963`*^9, 
   3.903981378781724*^9}, {3.903981433109041*^9, 3.903981439842843*^9}, {
   3.904330878496373*^9, 3.90433088465602*^9}, 
   3.906074793577244*^9},ExpressionUUID->"79481102-2b7f-426c-86f2-\
43decad646ac"],

Cell[BoxData[
 RowBox[{"Flocal", "[", 
  RowBox[{
   RowBox[{"0.4", "\[Pi]"}], ",", 
   RowBox[{"0.2", "\[Pi]"}], ",", "dtheta", ",", 
   StyleBox["dphi",
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}]], "Input",
 CellChangeTimes->{{3.9036083897794533`*^9, 3.9036084239220753`*^9}, {
  3.9036085837917767`*^9, 3.903608586153689*^9}, {3.903608765127543*^9, 
  3.90360876530715*^9}, {3.9036107473485003`*^9, 3.9036107507205143`*^9}, {
  3.903612481520553*^9, 3.903612532444592*^9}, {3.9039479239430943`*^9, 
  3.903947937925682*^9}, {3.9039482817970247`*^9, 3.903948295085189*^9}, {
  3.903948342213685*^9, 3.903948344422038*^9}, {3.9039485097941513`*^9, 
  3.9039485433758097`*^9}, {3.903981331961933*^9, 3.903981343360779*^9}},
 CellLabel->
  "In[1043]:=",ExpressionUUID->"69f90005-f05a-42a8-af23-17a5e2730ab4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Change the \[Theta] search range to 2\[Pi], and then it finds the global \
minimum:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948549891163*^9, 
   3.9039485503948174`*^9}, {3.903952680666849*^9, 3.903952692439741*^9}, {
   3.903952933677717*^9, 3.9039529360721693`*^9}, {3.903953783464199*^9, 
   3.903953783997858*^9}, {3.90395381767177*^9, 3.903953821560981*^9}, 
   3.9039814536968603`*^9},ExpressionUUID->"e4df2cbe-a4ac-4737-93cc-\
bb9a54d16de6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{
       StyleBox["Tmat",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontColor->GrayLevel[0]], 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["]",
       FontColor->RGBColor[1, 0, 0]]}], "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0.05", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{
            StyleBox[
             RowBox[{"2", "\[Pi]"}],
             FontColor->RGBColor[1, 0, 0]], "+", "0.05"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{
         StyleBox["Tmat",
          FontColor->GrayLevel[0]], 
         StyleBox[",",
          FontColor->GrayLevel[0]], 
         StyleBox["MONO",
          FontColor->RGBColor[1, 0, 0]]}], 
        StyleBox["]",
         FontColor->RGBColor[1, 0, 0]]}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.903552345167324*^9, 3.903552370568324*^9}, {
   3.9035748622184563`*^9, 3.903574867475771*^9}, 3.903614231925976*^9, {
   3.903621574914694*^9, 3.903621596716565*^9}, {3.903917578429175*^9, 
   3.903917579161215*^9}, {3.903917624151566*^9, 3.9039176448645563`*^9}, 
   3.903918479802446*^9, 3.903948438794223*^9, 3.903952530611207*^9, 
   3.9039526466510973`*^9, 3.903981447474565*^9, {3.904329055230142*^9, 
   3.904329066212654*^9}, {3.9061070663816843`*^9, 3.906107066887644*^9}, {
   3.9061479361192408`*^9, 3.906147936808495*^9}},
 CellLabel->
  "In[1044]:=",ExpressionUUID->"e83240ff-18d4-43f4-abb0-2f427312d89c"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{
   StyleBox["Tmatx",
    FontColor->GrayLevel[0]], ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9035526350307894`*^9, {3.9035534672391605`*^9, 3.903553477675378*^9}, {
   3.903575589496046*^9, 3.903575595623665*^9}, {3.903612459100554*^9, 
   3.903612459881679*^9}, {3.9038140053122787`*^9, 3.903814006856325*^9}, {
   3.9043290539947367`*^9, 3.904329065063571*^9}},
 CellLabel->
  "In[1045]:=",ExpressionUUID->"f94ff8c0-a292-4507-b2fe-3096c9f4c300"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"Tmatx", ",", "MONO"}], "]"}], "/", "Degree"}]], "Input",
 CellChangeTimes->{{3.903564672712715*^9, 3.9035646928964877`*^9}, {
  3.9035757174438686`*^9, 3.903575728194148*^9}, {3.903612467260022*^9, 
  3.903612467850656*^9}, {3.903814008567244*^9, 3.903814009322*^9}},
 CellLabel->
  "In[1046]:=",ExpressionUUID->"80d349b7-98e5-428d-9d5a-debb46070712"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change to a 3D search, and then it finds the global minimum:", \
"Subsubsection",
 CellChangeTimes->{{3.9035530823236613`*^9, 3.9035531177726784`*^9}, {
   3.9035741735047836`*^9, 3.9035741768193836`*^9}, {3.90360882481588*^9, 
   3.9036088557510653`*^9}, {3.903608897714216*^9, 3.903608916512686*^9}, {
   3.903613780534309*^9, 3.903613782950293*^9}, {3.903912413149152*^9, 
   3.9039124161664*^9}, {3.903917548657856*^9, 3.903917555319745*^9}, {
   3.903917750887499*^9, 3.903917765377664*^9}, {3.903948549891163*^9, 
   3.9039485503948174`*^9}, {3.903952680666849*^9, 3.903952692439741*^9}, {
   3.903952933677717*^9, 3.9039529360721693`*^9}, {3.903953783464199*^9, 
   3.903953783997858*^9}, {3.90395381767177*^9, 3.903953821560981*^9}, 
   3.9039814536968603`*^9, {3.903981502373006*^9, 
   3.903981505993672*^9}},ExpressionUUID->"710fc4e2-d248-4fbe-8360-\
7298fa2a5bb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"Tmat", ",", 
       StyleBox["MONO",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], "=", " ", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", "\[LessEqual]",
            "\[Pi]"}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"Tmat", ",", 
          StyleBox["MONO",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8432638002966256`*^9, 3.843263848587617*^9}, {
   3.843263901498243*^9, 3.8432639249045906`*^9}, {3.843264035112605*^9, 
   3.843264049384597*^9}, {3.8432640820756454`*^9, 3.8432641113867397`*^9}, {
   3.8432641575126195`*^9, 3.843264176600622*^9}, 3.8432642092735014`*^9, {
   3.85800443755595*^9, 3.858004508964686*^9}, {3.8580045492990336`*^9, 
   3.8580046084862204`*^9}, {3.8580046498167143`*^9, 
   3.8580046922574406`*^9}, {3.8580047386393414`*^9, 
   3.8580047519394045`*^9}, {3.858004893375312*^9, 3.858004901820363*^9}, {
   3.858008522332718*^9, 3.858008531919662*^9}, {3.8580086348792405`*^9, 
   3.8580086378895903`*^9}, {3.8580089489322834`*^9, 
   3.8580089933041143`*^9}, {3.8597262185704365`*^9, 
   3.8597262225626307`*^9}, {3.865886834723418*^9, 3.865886838446048*^9}, {
   3.865887046777639*^9, 3.865887059826816*^9}, {3.869838173908651*^9, 
   3.8698382816994867`*^9}, {3.869838335398591*^9, 3.8698383624375315`*^9}, 
   3.8698411107142754`*^9, {3.869841151929311*^9, 3.869841153561617*^9}, {
   3.8698412683313093`*^9, 3.8698412928033447`*^9}, {3.8702366100574226`*^9, 
   3.870236619333077*^9}, {3.8984721524199743`*^9, 3.8984721641800203`*^9}, {
   3.901910507639677*^9, 3.901910529659231*^9}, {3.9019105611702805`*^9, 
   3.9019105769789267`*^9}, {3.903970152708353*^9, 3.9039702037288265`*^9}, {
   3.903977352789545*^9, 3.9039773536211433`*^9}, {3.903981567888324*^9, 
   3.9039815813461933`*^9}, {3.904329072421041*^9, 3.9043290727491503`*^9}, {
   3.906107072386777*^9, 3.906107072887146*^9}, {3.906147942361722*^9, 
   3.906147943051124*^9}},
 CellLabel->
  "In[1047]:=",ExpressionUUID->"4df5a11a-5362-4353-abe8-8320f5c3c9bd"],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmatx", ",", "MONO"}], "]"}]], "Input",
 CellLabel->
  "In[1048]:=",ExpressionUUID->"e24bc51e-ad26-4c81-97c9-b916abaaf51c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1080, 1035},
WindowMargins->{{52, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"60d140f9-3644-4213-b230-2811dc283c42"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1314, 22, 149, "Subsubsection",ExpressionUUID->"f90ce2d8-5692-400e-8ba3-7da3acb4a708"],
Cell[CellGroupData[{
Cell[1897, 46, 289, 5, 53, "Section",ExpressionUUID->"5b9796e9-96cd-403e-a322-56fe7a85c111"],
Cell[2189, 53, 178, 4, 30, "Input",ExpressionUUID->"1e97db76-91b1-4b2b-82ed-2958cd41cf4e"],
Cell[CellGroupData[{
Cell[2392, 61, 500, 7, 45, "Subsubsection",ExpressionUUID->"03550abf-6de7-494e-87fe-cf4e13e75f3e"],
Cell[2895, 70, 2675, 68, 73, "Input",ExpressionUUID->"28fed0c1-f167-47b3-8abc-54efafd57ee2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5607, 143, 413, 7, 45, "Subsubsection",ExpressionUUID->"7cafa255-d8a8-4c8d-981f-4744a6281eca"],
Cell[6023, 152, 334, 8, 52, "Input",ExpressionUUID->"7a53d6f3-c686-4adb-a9db-ec7423b24770"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6406, 166, 306, 5, 67, "Section",ExpressionUUID->"dd3f03a5-86f1-4699-a528-03b5a62fea5f"],
Cell[6715, 173, 387, 7, 30, "Input",ExpressionUUID->"cadd552a-9686-4611-8564-5f97ad494032"],
Cell[CellGroupData[{
Cell[7127, 184, 722, 12, 45, "Subsubsection",ExpressionUUID->"d6fedb2d-08e7-4a95-aa76-3db462e703e1"],
Cell[7852, 198, 2669, 55, 270, "Output",ExpressionUUID->"a40f3238-2121-44d9-bf72-5acb4e20b11d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10558, 258, 729, 10, 45, "Subsubsection",ExpressionUUID->"f3cf56b9-9f22-47ba-b989-e7ef8d7759c4"],
Cell[11290, 270, 830, 14, 52, "Input",ExpressionUUID->"c42f6f06-c8de-4169-ac4b-a88c33c4707c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12157, 289, 632, 9, 45, "Subsubsection",ExpressionUUID->"f4d36bdb-7509-4c91-a22e-0f2ddf4454f1"],
Cell[12792, 300, 1477, 34, 136, "Input",ExpressionUUID->"91d7bf6a-b9da-4238-99a4-0d623d7d9071"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14306, 339, 782, 12, 45, "Subsubsection",ExpressionUUID->"3ef35be5-7c1c-48d8-8ae0-4316e6c0fb9e"],
Cell[15091, 353, 243, 5, 30, "Input",ExpressionUUID->"fa02659c-0803-4b17-aee1-eecdc02b6a0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15371, 363, 693, 12, 45, "Subsubsection",ExpressionUUID->"f929abd5-4d92-4453-a60b-cc87ccb2b8a3"],
Cell[16067, 377, 1619, 38, 94, "Input",ExpressionUUID->"7a2e6957-82d9-4bf7-b2a8-9dbf881be2c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17723, 420, 695, 12, 45, "Subsubsection",ExpressionUUID->"bc4457a6-e676-43b0-b4f0-e1f1b8ee2a54"],
Cell[18421, 434, 1621, 38, 94, "Input",ExpressionUUID->"e7f7cdbe-820e-46d5-a5fa-fe9eb72036fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20079, 477, 704, 11, 45, "Subsubsection",ExpressionUUID->"fc2efdb9-73a8-48c5-805f-81426c218e86"],
Cell[20786, 490, 959, 24, 52, "Input",ExpressionUUID->"aa2cec88-c642-42c8-a8d8-b398cf422575"]
}, Open  ]]
}, Open  ]],
Cell[21772, 518, 632, 11, 105, "Section",ExpressionUUID->"dbbd5b43-948a-4144-b548-ab8599fe0653"],
Cell[22407, 531, 783, 14, 129, "Section",ExpressionUUID->"18ee179c-88cb-4648-925b-873eed5ac9d7"],
Cell[CellGroupData[{
Cell[23215, 549, 423, 11, 54, "Section",ExpressionUUID->"1d23c2d7-a65a-451d-b6b0-652b960d9f18"],
Cell[23641, 562, 290, 6, 30, "Input",ExpressionUUID->"29dc9455-8760-4b78-85f3-508dd805718a"],
Cell[CellGroupData[{
Cell[23956, 572, 819, 14, 97, "Subsubsection",ExpressionUUID->"1ec997ee-4d6e-4b93-acea-2a4e013504cd"],
Cell[24778, 588, 4444, 114, 439, "Output",ExpressionUUID->"003ad0cb-1c84-471a-8114-2583c613c13e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29259, 707, 413, 7, 45, "Subsubsection",ExpressionUUID->"8b95e8c9-8d23-44a9-ba7d-35054c0552f2"],
Cell[29675, 716, 334, 8, 52, "Input",ExpressionUUID->"34b04fea-fd14-4d66-9e04-f13c44c84e5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30046, 729, 808, 17, 45, "Subsubsection",ExpressionUUID->"f7358229-7e46-4932-9f9d-0280c2167d6c"],
Cell[30857, 748, 3125, 89, 136, "Input",ExpressionUUID->"0c383cb1-2c3d-4161-a8cb-af6ebc5d4f47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34019, 842, 512, 9, 45, "Subsubsection",ExpressionUUID->"72a9d154-3d91-48c1-ac4d-a0bf33b3940f"],
Cell[34534, 853, 586, 10, 30, "Input",ExpressionUUID->"92152023-630b-4a45-9e34-aaf460ba5154"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35157, 868, 611, 11, 45, "Subsubsection",ExpressionUUID->"6520fd56-9f60-47a2-ba86-9283a2d99916"],
Cell[35771, 881, 1420, 35, 94, "Input",ExpressionUUID->"774b453e-77cf-459e-8079-59bf4eec5c28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37228, 921, 608, 10, 45, "Subsubsection",ExpressionUUID->"9dc83fc2-2f65-4b93-a153-58f4829fab03"],
Cell[37839, 933, 1358, 33, 94, "Input",ExpressionUUID->"a8880bcb-4e6b-4517-be83-1a4a6c60536b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39234, 971, 664, 11, 45, "Subsubsection",ExpressionUUID->"54c9a020-dbfd-4905-ac37-1b0c12122fd3"],
Cell[39901, 984, 1458, 35, 94, "Input",ExpressionUUID->"71f5291d-efee-4f5e-9f4f-346819dcf3dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41396, 1024, 455, 6, 45, "Subsubsection",ExpressionUUID->"3419d619-ece2-4939-8b60-bf3a2fbadde4"],
Cell[41854, 1032, 920, 21, 52, "Input",ExpressionUUID->"f80e9bf5-aff6-4404-b86d-9b42637a0702"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42811, 1058, 420, 6, 45, "Subsubsection",ExpressionUUID->"ad06c437-af0b-4c05-bc7e-4d4c28767b74"],
Cell[43234, 1066, 561, 11, 52, "Input",ExpressionUUID->"75cf0133-239d-4a27-adf1-294fa57ec6fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43832, 1082, 519, 8, 45, "Subsubsection",ExpressionUUID->"3c77e848-2131-4cf8-8465-71236adf7a7b"],
Cell[44354, 1092, 467, 8, 30, "Input",ExpressionUUID->"8f6cda3e-f1eb-4a6f-8c02-e3271bbe3b49"],
Cell[44824, 1102, 450, 9, 30, "Input",ExpressionUUID->"c2032a0d-cd2e-4b5d-b2cf-fc10d45cf7a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45311, 1116, 520, 9, 45, "Subsubsection",ExpressionUUID->"a2806c8a-287b-4583-9c97-d6053ea472c6"],
Cell[45834, 1127, 1490, 36, 94, "Input",ExpressionUUID->"2bc30d43-c627-4d03-bad0-60add1091f21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47361, 1168, 568, 10, 45, "Subsubsection",ExpressionUUID->"2ac21f6f-281e-498c-9b41-c4c339d00b44"],
Cell[47932, 1180, 1428, 34, 94, "Input",ExpressionUUID->"4e069087-6657-438e-b060-6fa0deaf6650"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49397, 1219, 681, 12, 45, "Subsubsection",ExpressionUUID->"b8fc7116-d32a-41f3-9ac7-95e84465cf6d"],
Cell[50081, 1233, 1536, 37, 94, "Input",ExpressionUUID->"9ead269b-cfa9-4dd2-8aca-7b91a7baa5bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51654, 1275, 1103, 17, 45, "Subsubsection",ExpressionUUID->"fb49c27f-5cef-4823-ae8c-42b3af1a3efa"],
Cell[52760, 1294, 3936, 109, 199, "Input",ExpressionUUID->"6d93c447-65a7-4370-a702-c2d72cf99ece"],
Cell[56699, 1405, 272, 6, 30, "Input",ExpressionUUID->"afb1d8cb-2f07-491d-a471-8111cc332e24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57008, 1416, 990, 15, 45, "Subsubsection",ExpressionUUID->"904f35e0-6124-4066-bbbc-4d23d97d07a8"],
Cell[58001, 1433, 3766, 84, 115, "Input",ExpressionUUID->"378cef70-64a0-49ac-9946-f6bc60ae6ad7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61816, 1523, 498, 12, 68, "Section",ExpressionUUID->"629b85e5-7023-41b3-aaf1-d8fe16e29078"],
Cell[62317, 1537, 362, 7, 30, "Input",ExpressionUUID->"e1d5f5c8-455a-4783-b241-cfa44e0dc35b"],
Cell[CellGroupData[{
Cell[62704, 1548, 513, 8, 45, "Subsubsection",ExpressionUUID->"40a76f08-e141-4b71-8f1a-e3818c102e4c"],
Cell[63220, 1558, 8497, 216, 439, "Output",ExpressionUUID->"071dcbc4-fa53-45fa-b246-a5bb49ab7961"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71754, 1779, 437, 7, 45, "Subsubsection",ExpressionUUID->"66ec39d3-f2a2-471c-8848-e8ec705c1b9c"],
Cell[72194, 1788, 451, 9, 30, "Input",ExpressionUUID->"83981434-dafe-4960-a4e9-bf3682884827"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72682, 1802, 807, 16, 45, "Subsubsection",ExpressionUUID->"922be7a4-bece-45e6-a553-eb3caca9c64c"],
Cell[73492, 1820, 3417, 94, 136, "Input",ExpressionUUID->"5f1d279f-b2fa-4a28-901f-8b5b20774d0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76946, 1919, 451, 6, 45, "Subsubsection",ExpressionUUID->"76bb90ea-7272-4fcf-9881-a4050486cba2"],
Cell[77400, 1927, 424, 8, 30, "Input",ExpressionUUID->"5792b791-cf61-413e-8b04-bb8f8149d819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77861, 1940, 578, 8, 45, "Subsubsection",ExpressionUUID->"8cd4c60b-587c-4dcf-8db7-2ce336390175"],
Cell[78442, 1950, 780, 13, 52, "Input",ExpressionUUID->"34238de8-ce96-41ad-82ae-241ed4df3228"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79259, 1968, 634, 9, 45, "Subsubsection",ExpressionUUID->"3efd4547-f2a7-4116-9614-d8fca32d3dfb"],
Cell[79896, 1979, 1373, 33, 136, "Input",ExpressionUUID->"a8f360c6-9b7d-41b9-ae10-16eaf83ec5cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81306, 2017, 810, 12, 45, "Subsubsection",ExpressionUUID->"a66bf582-30d9-4f2a-a3f7-82855cf899a0"],
Cell[82119, 2031, 461, 10, 30, "Input",ExpressionUUID->"3b8bdccd-d9e1-40f1-a4fc-b748a4b81c92"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82617, 2046, 883, 13, 45, "Subsubsection",ExpressionUUID->"d55128b2-f81b-4fcb-ae5e-207884c5564b"],
Cell[83503, 2061, 1687, 47, 94, "Input",ExpressionUUID->"629f4d46-8acd-44d5-86d4-b6862ee7be31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85227, 2113, 864, 13, 45, "Subsubsection",ExpressionUUID->"6346f300-180e-48f1-ad3d-60ee267cc866"],
Cell[86094, 2128, 1785, 50, 94, "Input",ExpressionUUID->"1a222187-8f60-49c1-930b-f01397494f54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87916, 2183, 747, 10, 45, "Subsubsection",ExpressionUUID->"77acf173-78f2-4508-8826-5986befdad37"],
Cell[88666, 2195, 1885, 51, 94, "Input",ExpressionUUID->"cc957494-8c37-4fd1-bf09-ce8b7ab3e801"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90588, 2251, 827, 14, 45, "Subsubsection",ExpressionUUID->"a4a594c1-d351-4219-a560-3c82448887c8"],
Cell[91418, 2267, 3418, 93, 136, "Input",ExpressionUUID->"b272fa6c-53d7-4159-b4f4-414ea2752956"],
Cell[94839, 2362, 462, 10, 30, "Input",ExpressionUUID->"327dda21-1028-4ba6-bf19-eb32ad36dc92"],
Cell[95304, 2374, 204, 5, 30, "Input",ExpressionUUID->"2729898d-0af1-4ab7-a085-dd5f4741d78e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95545, 2384, 882, 13, 45, "Subsubsection",ExpressionUUID->"9d1c9121-cb84-481c-922e-44eab3d2a817"],
Cell[96430, 2399, 3769, 83, 94, "Input",ExpressionUUID->"546b46d9-ae99-443b-95aa-a3b7c21ab9d1"],
Cell[100202, 2484, 176, 4, 30, "Input",ExpressionUUID->"eab384ec-164e-4807-99d4-d300076d9756"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100427, 2494, 593, 13, 68, "Section",ExpressionUUID->"4cc410d6-fb31-4b33-99f2-252b84d14d19"],
Cell[101023, 2509, 290, 6, 30, "Input",ExpressionUUID->"4909bf82-52ef-4906-b622-5deff4c766da"],
Cell[CellGroupData[{
Cell[101338, 2519, 508, 8, 45, "Subsubsection",ExpressionUUID->"080e5f5e-1d5d-4398-a968-01fc5e730ca7"],
Cell[101849, 2529, 6845, 167, 439, "Output",ExpressionUUID->"75a8649a-559e-4602-89bf-5905341e690d"],
Cell[108697, 2698, 269, 7, 52, "Input",ExpressionUUID->"8d206631-2b32-47d3-a520-78f38180bee8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109003, 2710, 807, 16, 45, "Subsubsection",ExpressionUUID->"ea88f7f9-7ddd-4680-be40-fd3b981c71aa"],
Cell[109813, 2728, 3323, 92, 136, "Input",ExpressionUUID->"40f56b3d-9881-41bd-a5e8-593f894aef97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113173, 2825, 368, 5, 45, "Subsubsection",ExpressionUUID->"98002df5-2aa4-4f89-aa43-bd9e9b90f4f0"],
Cell[113544, 2832, 494, 9, 30, "Input",ExpressionUUID->"1cf9c1af-86f4-48c6-a788-3d8e2818ec45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114075, 2846, 561, 8, 45, "Subsubsection",ExpressionUUID->"204a8ef6-6b22-470e-a5c5-a2b8a8d1b5a2"],
Cell[114639, 2856, 840, 21, 73, "Input",ExpressionUUID->"542005ba-4fe0-4b0a-8643-d64b25a14bee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115516, 2882, 767, 11, 45, "Subsubsection",ExpressionUUID->"3549dae6-01d6-4f72-8df8-8d0c9a345ce0"],
Cell[116286, 2895, 462, 10, 30, "Input",ExpressionUUID->"91d57728-5d47-4edf-a56b-aaf6d136ed38"],
Cell[116751, 2907, 415, 8, 30, "Input",ExpressionUUID->"0a3542bf-9b24-4935-8134-53d900905de8"]
}, Open  ]],
Cell[117181, 2918, 645, 11, 45, "Subsubsection",ExpressionUUID->"adaa795a-bd0d-45cd-acb9-97df6e1f32d9"],
Cell[CellGroupData[{
Cell[117851, 2933, 602, 11, 37, "Subsubsection",ExpressionUUID->"ebf094e6-b409-4ec0-8317-eb9aa8d2d622"],
Cell[118456, 2946, 1547, 42, 94, "Input",ExpressionUUID->"cf6181c4-3f21-43f9-bcac-50c7cbae9c79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120040, 2993, 677, 12, 45, "Subsubsection",ExpressionUUID->"8beae2c0-4d19-4cb0-b3d7-cef42aa7d377"],
Cell[120720, 3007, 978, 22, 52, "Input",ExpressionUUID->"b9e9207d-ec75-4917-9fbf-d73424de64c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121735, 3034, 547, 8, 45, "Subsubsection",ExpressionUUID->"ab3143de-ea9a-4bc6-a24b-1513e88648bf"],
Cell[122285, 3044, 3422, 93, 136, "Input",ExpressionUUID->"d9ab6cd2-c73b-428d-a0b9-a36ed8b62e45"],
Cell[125710, 3139, 512, 11, 30, "Input",ExpressionUUID->"a7c5dc8a-3643-445f-992f-6af2fde33a01"],
Cell[126225, 3152, 204, 5, 30, "Input",ExpressionUUID->"493fa888-d3ad-490f-96d0-26740a86a506"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126466, 3162, 882, 13, 45, "Subsubsection",ExpressionUUID->"ecf348dc-0b48-42a4-bb01-1483cd91fc47"],
Cell[127351, 3177, 3769, 83, 94, "Input",ExpressionUUID->"4cb55a53-85f0-4e46-a38e-cbbbc97f81bb"],
Cell[131123, 3262, 176, 4, 30, "Input",ExpressionUUID->"2b87b66a-ac95-40ec-9cda-b86033620301"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131348, 3272, 625, 14, 68, "Section",ExpressionUUID->"88e2952f-5570-46e6-a477-fa280c615650"],
Cell[131976, 3288, 382, 7, 30, "Input",ExpressionUUID->"1448e63a-8f5d-47f0-ac1b-983fcd7fd5ca"],
Cell[CellGroupData[{
Cell[132383, 3299, 730, 15, 45, "Subsubsection",ExpressionUUID->"9fb929a4-50f8-4f5b-8e0d-830b6a786a60"],
Cell[133116, 3316, 8508, 215, 440, "Output",ExpressionUUID->"2520146d-b59d-4057-8cc5-de85ccd187b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141661, 3536, 439, 7, 45, "Subsubsection",ExpressionUUID->"6d21d20b-7b09-4f5c-9ae3-ffe289bb1a20"],
Cell[142103, 3545, 452, 9, 30, "Input",ExpressionUUID->"31dcd6ac-380e-4202-947b-d1648d1135d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142592, 3559, 777, 16, 45, "Subsubsection",ExpressionUUID->"d472af5d-6d8e-47d9-ae76-924a5bdb91d2"],
Cell[143372, 3577, 3323, 92, 136, "Input",ExpressionUUID->"5f0b808d-152d-4111-9f14-a0f391b96632"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146732, 3674, 741, 15, 45, "Subsubsection",ExpressionUUID->"996550ac-a7b5-4397-b146-e2e85b8a62a0"],
Cell[147476, 3691, 424, 8, 30, "Input",ExpressionUUID->"c7294db4-6f33-4837-a11a-97872a72bca4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147937, 3704, 557, 8, 45, "Subsubsection",ExpressionUUID->"5de1787d-84c4-4659-ac47-2b87db3537d7"],
Cell[148497, 3714, 334, 7, 52, "Input",ExpressionUUID->"40f54a9d-6657-4432-9041-ac86498b0452"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148868, 3726, 634, 9, 45, "Subsubsection",ExpressionUUID->"a193ed3d-634b-4035-b3cc-f0dcd47fec5e"],
Cell[149505, 3737, 1472, 34, 136, "Input",ExpressionUUID->"65d09efe-9d01-467d-ba4a-2275cff33cae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151014, 3776, 1259, 28, 45, "Subsubsection",ExpressionUUID->"76c5fa34-c5ff-4cd8-825d-50ae7f958e88"],
Cell[152276, 3806, 242, 5, 30, "Input",ExpressionUUID->"199158fd-462c-4f25-9f68-8e6737437e4f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152555, 3816, 987, 14, 45, "Subsubsection",ExpressionUUID->"1cdae954-3b2f-4557-8cf2-d3453de40693"],
Cell[153545, 3832, 1791, 50, 94, "Input",ExpressionUUID->"3fd1629a-d065-4ae7-a534-0e1b59a1dc4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155373, 3887, 962, 14, 45, "Subsubsection",ExpressionUUID->"59721e57-d879-4ddc-9157-e0ab7f63a967"],
Cell[156338, 3903, 1836, 50, 94, "Input",ExpressionUUID->"10bfdb9d-67df-4a5c-bc59-38800a099007"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158211, 3958, 796, 11, 45, "Subsubsection",ExpressionUUID->"79481102-2b7f-426c-86f2-43decad646ac"],
Cell[159010, 3971, 943, 21, 30, "Input",ExpressionUUID->"69f90005-f05a-42a8-af23-17a5e2730ab4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159990, 3997, 861, 14, 45, "Subsubsection",ExpressionUUID->"e4df2cbe-a4ac-4737-93cc-bb9a54d16de6"],
Cell[160854, 4013, 3523, 95, 136, "Input",ExpressionUUID->"e83240ff-18d4-43f4-abb0-2f427312d89c"],
Cell[164380, 4110, 514, 11, 30, "Input",ExpressionUUID->"f94ff8c0-a292-4507-b2fe-3096c9f4c300"],
Cell[164897, 4123, 415, 8, 30, "Input",ExpressionUUID->"80d349b7-98e5-428d-9d5a-debb46070712"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165349, 4136, 882, 13, 45, "Subsubsection",ExpressionUUID->"710fc4e2-d248-4fbe-8360-7298fa2a5bb3"],
Cell[166234, 4151, 3769, 83, 94, "Input",ExpressionUUID->"4df5a11a-5362-4353-abe8-8320f5c3c9bd"],
Cell[170006, 4236, 176, 4, 60, "Input",ExpressionUUID->"e24bc51e-ad26-4c81-97c9-b916abaaf51c"]
}, Open  ]]
}, Open  ]]
}
]
*)


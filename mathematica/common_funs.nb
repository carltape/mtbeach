(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[   1025077,      25116]
NotebookOptionsPosition[    974177,      24461]
NotebookOutlinePosition[    975483,      24505]
CellTagsIndexPosition[    975440,      24502]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DmatDmat", "=", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2"}], "}"}], 
     "]"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"For", " ", 
     RowBox[{"Voigt", ".", " ", 
      StyleBox[
       RowBox[{"C", 
        StyleBox["h",
         FontColor->RGBColor[1, 0, 0]]}]]}], "anged", " ", "from", " ", 
     "Hmat", " ", "Jan", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", 
      SqrtBox["2"], ",", 
      SqrtBox["2"], ",", 
      SqrtBox["2"]}], "}"}], "]"}]}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "from", " ", "SqRtH", " ", "Jan", " ", "2020."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.870451082653311*^9, 3.870451083629214*^9}, {
  3.89269316768466*^9, 3.8926931968474383`*^9}},
 CellLabel->
  "In[2791]:=",ExpressionUUID->"f76e0fb2-f476-4524-9be9-d0e7e52752f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsub\[CapitalSigma]\[CapitalPhi]", ":=", 
   RowBox[{"MatIsub\[CapitalSigma]B", ".", "MatIsubB\[CapitalPhi]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalPhi]\[CapitalSigma]", ":=", 
   RowBox[{"MatIsub\[CapitalPhi]B", ".", "MatIsubB\[CapitalSigma]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalPhi]\[CapitalUpsilon]", ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"MatIsub\[CapitalPhi]B", ".", "MatIsubB\[CapitalUpsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalUpsilon]\[CapitalPhi]", ":=", 
   RowBox[{"MatIsub\[CapitalUpsilon]B", ".", "MatIsubB\[CapitalPhi]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8672895583248796`*^9, 3.867289658587146*^9}, {
  3.8672897123365326`*^9, 3.8672897461094894`*^9}, {3.8672898864650307`*^9, 
  3.8672899043165655`*^9}, {3.867289940032301*^9, 3.8672899536198673`*^9}, {
  3.867508908545532*^9, 3.867508914852187*^9}, {3.8926935537412763`*^9, 
  3.8926935603816576`*^9}},
 CellLabel->
  "In[2793]:=",ExpressionUUID->"89217b1e-4bad-45e2-9f98-9d1920f3bbf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAngle", "[", "U_", "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Tr", "[", "U", "]"}]}], "2"], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "March", " ", "of", " ", "2016"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellLabel->
  "In[2797]:=",ExpressionUUID->"934bf0af-77f0-4dde-9b85-e462b5d9b5ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatM", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13"},
      {"m21", "m22", "m23"},
      {"m31", "m32", "m33"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DummyMatrixSYM", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13"},
      {"m12", "m22", "m23"},
      {"m13", "m23", "m33"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatN", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"n11", "n12", "n13"},
      {"n21", "n22", "n23"},
      {"n31", "n32", "n33"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatU", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"u11", "u12", "u13"},
      {"u21", "u22", "u23"},
      {"u31", "u32", "u33"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6340483684794474`*^9, 3.63404848657211*^9}, {
  3.7893278114069843`*^9, 3.7893278315839815`*^9}, {3.8678505231712728`*^9, 
  3.8678505312496414`*^9}, {3.8678505627133303`*^9, 3.867850568015712*^9}, {
  3.8680607981959457`*^9, 3.8680608147683*^9}, {3.868060864146146*^9, 
  3.868060864902273*^9}, {3.86819529995193*^9, 3.868195334760936*^9}},
 CellLabel->
  "In[2798]:=",ExpressionUUID->"8518a208-0cec-47c6-93c2-8ef654931752"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DummyMatrixSYM6x6", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"c11", "c12", "c13", "c14", "c15", "c16"},
      {"c12", "c22", "c23", "c24", "c25", "c26"},
      {"c13", "c23", "c33", "c34", "c35", "c36"},
      {"c14", "c24", "c34", "c44", "c45", "c46"},
      {"c15", "c25", "c35", "c45", "c55", "c56"},
      {"c16", "c26", "c36", "c46", "c56", "c66"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DummyMatrix6x6", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13", "m14", "m15", "m16"},
      {"m21", "m22", "m23", "m24", "m25", "m26"},
      {"m31", "m32", "m33", "m34", "m35", "m36"},
      {"m41", "m42", "m43", "m44", "m45", "m46"},
      {"m51", "m52", "m53", "m54", "m55", "m56"},
      {"m61", "m62", "m63", "m64", "m65", "m66"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.785356554575347*^9, 3.78535679026956*^9}, {
  3.7853568558996725`*^9, 3.7853570706785283`*^9}, {3.8024068228213253`*^9, 
  3.8024069253013043`*^9}, {3.802406979652315*^9, 3.802406984996315*^9}, {
  3.802438955335802*^9, 3.8024389695118017`*^9}, {3.802451116283245*^9, 
  3.802451118667241*^9}},
 CellLabel->
  "In[2802]:=",ExpressionUUID->"08d3ad1d-7e22-49bd-8212-7d5ce58a4600"],

Cell[CellGroupData[{

Cell["\<\
Reference matrices.  
Logically goes later, with elastic map stuff, but needs to be evaluated now.\
\>", "Section",
 CellChangeTimes->{{3.840461964835967*^9, 3.8404619800509477`*^9}, {
  3.8695174148645554`*^9, 3.8695174166008625`*^9}, {3.892692013255378*^9, 
  3.8926920450910373`*^9}},ExpressionUUID->"4eb1feb6-c2ba-4fb6-b2f3-\
05a6cd1e0841"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlankSlate", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "m", "q", "t", "v"},
       {"g", "b", "h", "n", "r", "u"},
       {"m", "h", "c", "i", "o", "s"},
       {"q", "n", "i", "d", "j", "p"},
       {"t", "r", "o", "j", "e", "k"},
       {"v", "u", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.92601826773911*^9, 3.9260183095875616`*^9}, {
  3.9260188207748556`*^9, 3.9260188305469313`*^9}, {3.9260188617576637`*^9, 
  3.926018920959866*^9}},
 CellLabel->
  "In[2804]:=",ExpressionUUID->"03fae7e2-eb3f-4f13-b56a-901d0bed9640"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Randomalphabet", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"b", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"c", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"d", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"e", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"f", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"g", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"h", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"i", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"j", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"k", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"l", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"m", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"n", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"o", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"p", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"q", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"r", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"s", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"t", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"u", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"v", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"w", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"x", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"y", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
     RowBox[{"z", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9219473948952923`*^9, 3.9219475675090957`*^9}},
 CellLabel->
  "In[2806]:=",ExpressionUUID->"739ae960-aa99-47b6-b1b4-b3a336796465"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"BlankSlate", "/.", "Randomalphabet"}], "]"}]], "Input",
 CellChangeTimes->{{3.921947603609346*^9, 3.9219476215400496`*^9}},
 CellLabel->
  "In[2807]:=",ExpressionUUID->"6427e99d-1db7-4c12-aab9-0e39e8ae0499"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlankSlatePrime", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ax", "gx", "mx", "qx", "tx", "vx"},
       {"gx", "bx", "hx", "nx", "rx", "ux"},
       {"mx", "hx", "cx", "ix", "ox", "sx"},
       {"qx", "nx", "ix", "dx", "jx", "px"},
       {"tx", "rx", "ox", "jx", "ex", "kx"},
       {"vx", "ux", "sx", "px", "kx", "fx"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.8926919421726065`*^9, 3.8926919457655735`*^9}, {
  3.896276816376087*^9, 3.8962769188384495`*^9}, {3.896277140919383*^9, 
  3.8962772061741266`*^9}, {3.9260189041721845`*^9, 3.926018935216722*^9}},
 CellLabel->
  "In[2808]:=",ExpressionUUID->"e6029285-85bd-45c1-a019-631d1bbb8205"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FiveTrace", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a_", "g_", "m_", "q_", "t_", "v_"},
       {"g1_", "b_", "h_", "n_", "r_", "u_"},
       {"m1_", "h1_", "c_", "i_", "o_", "s_"},
       {"q1_", "n1_", "i1_", "d_", "j_", "p_"},
       {"t1_", "r1_", "o1_", "j1_", "e_", "k_"},
       {"v1_", "u1_", "s1_", "p1_", "k1_", "f_"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}], ":=", 
   RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896276926639326*^9, 3.896276931269787*^9}, {
  3.9092524132997627`*^9, 3.909252557071783*^9}},
 CellLabel->
  "In[2809]:=",ExpressionUUID->"2b306b53-3987-4faf-8976-104fc9f825b9"],

Cell[CellGroupData[{

Cell[" Basis is \[DoubleStruckCapitalB]", "Subsubsection",
 CellChangeTimes->{
  3.8695303310658474`*^9, {3.8795189633854427`*^9, 
   3.8795189805213423`*^9}},ExpressionUUID->"d2edaa40-1936-4824-8f6f-\
b557a526c003"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TmatForISO", "=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "0", "0", "0", "0", "0"},
        {"0", "a", "0", "0", "0", "0"},
        {"0", "0", "a", "0", "0", "0"},
        {"0", "0", "0", "a", "0", "0"},
        {"0", "0", "0", "0", "a", "0"},
        {"0", "0", "0", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "May", " ", "30"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForXISO", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "0", "0", "0", "0", "0"},
      {"0", "a", "0", "0", "0", "0"},
      {"0", "0", "c", "0", "0", "0"},
      {"0", "0", "0", "c", "0", "0"},
      {"0", "0", "0", "0", "e", "k"},
      {"0", "0", "0", "0", "k", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForTET", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "a", "0", "0", "0", "0"},
       {"0", "0", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "0", "0"},
       {"0", "0", "0", "0", "e", "k"},
       {"0", "0", "0", "0", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForORTH", "=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "0", "0", "0", "0", "0"},
        {"0", "b", "0", "0", "0", "0"},
        {"0", "0", "c", "0", "0", "0"},
        {"0", "0", "0", "d", "j", "p"},
        {"0", "0", "0", "j", "e", "k"},
        {"0", "0", "0", "p", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"TmatForMONO", "=", 
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a", "g", "0", "0", "0", "0"},
         {"g", "b", "0", "0", "0", "0"},
         {"0", "0", "c", "i", "o", "s"},
         {"0", "0", "i", "d", "j", "p"},
         {"0", "0", "o", "j", "e", "k"},
         {"0", "0", "s", "p", "k", "f"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmatForTRIG", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "m", "0", "0", "0"},
       {"0", "a", "0", "m", "0", "0"},
       {"m", "0", "c", "0", "0", "0"},
       {"0", "m", "0", "c", "0", "0"},
       {"0", "0", "0", "0", "e", "k"},
       {"0", "0", "0", "0", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForCUBE", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "a", "0", "0", "0", "0"},
       {"0", "0", "a", "0", "0", "0"},
       {"0", "0", "0", "d", "0", "0"},
       {"0", "0", "0", "0", "d", "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "May", " ", "30"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8695175115030165`*^9, 3.869517514087134*^9}, 
   3.8695175488134546`*^9, {3.8795188772226877`*^9, 3.8795189350919695`*^9}},
 CellLabel->
  "In[2810]:=",ExpressionUUID->"9531b01c-6e2a-4fec-9a81-e9bec287c966"]
}, Open  ]],

Cell["\<\
A more or less random positive definite 6x6 matrix.  RandomPosDef6x6Matrix \
used to be RandomPosDef6x6Matrix\
\>", "Section",
 CellChangeTimes->{{3.9059564065569935`*^9, 3.905956441579466*^9}, 
   3.9102931796130085`*^9, {3.937263434951132*^9, 3.9372635064609065`*^9}, 
   3.9372635503815827`*^9},ExpressionUUID->"e59a8be4-7a2f-4e3f-9659-\
bc93f2b40b48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SixTuple", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[2817]:=",ExpressionUUID->"024a22b1-c9a1-4ad2-9c35-2827883006f0"],

Cell["Remember Gazis (1963) has stuff on positive definite.", "Subsubsection",
 CellChangeTimes->{{3.905960858546822*^9, 
  3.905960898488211*^9}},ExpressionUUID->"7c2371cc-e09e-474d-9d87-\
105b1c2999f0"],

Cell[BoxData[
 RowBox[{"RandomPosDef6x6Matrix", ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"U6x6", "=", 
     RowBox[{"Orthogonalize", "[", 
      RowBox[{"{", 
       RowBox[{
       "SixTuple", ",", "SixTuple", ",", "SixTuple", ",", "SixTuple", ",", 
        "SixTuple", ",", "SixTuple"}], "}"}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"eigenvalues", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["0",
           FontColor->RGBColor[1, 0, 0]], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["0",
           FontColor->RGBColor[1, 0, 0]], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["0",
           FontColor->RGBColor[1, 0, 0]], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["0",
           FontColor->RGBColor[1, 0, 0]], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["0",
           FontColor->RGBColor[1, 0, 0]], ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["0",
           FontColor->RGBColor[1, 0, 0]], ",", "1"}], "}"}], "]"}]}], "}"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"U6x6", ".", 
     RowBox[{"DiagonalMatrix", "[", "eigenvalues", "]"}], ".", 
     RowBox[{"Transpose", "[", "U6x6", "]"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.9059561357739906`*^9, 3.9059561794883575`*^9}, 
   3.905956234829765*^9, {3.9059563077809877`*^9, 3.905956334986174*^9}, 
   3.937263555103876*^9},
 CellLabel->
  "In[2818]:=",ExpressionUUID->"05a473ea-c385-4e96-a25a-b4128d6d6ee1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matrix6x6", "=", "RandomPosDef6x6Matrix"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "matrix6x6", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.9059563421752677`*^9, 3.905956357358079*^9}, {
   3.905956740937402*^9, 3.9059567532877536`*^9}, {3.905959850859281*^9, 
   3.9059598743503556`*^9}, {3.909880598984758*^9, 3.909880599814158*^9}, {
   3.9115906363606496`*^9, 3.911590660071804*^9}, 3.937263557260035*^9, {
   3.9372704823674326`*^9, 3.9372704835854397`*^9}, {3.937270709905262*^9, 
   3.93727071081528*^9}},
 CellLabel->
  "In[2819]:=",ExpressionUUID->"711c86cd-b31c-41ae-9405-7e9506389c36"],

Cell["New section", "Section",
 CellChangeTimes->{{3.8926920869583063`*^9, 
  3.8926921034595504`*^9}},ExpressionUUID->"ffc94ad8-d63b-4add-9487-\
b4b2cedbb7c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DateSequence", "[", 
    RowBox[{"date_", ",", "WantTime_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WantTime", "\[Equal]", "\"\<yes\>\""}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\"\< \>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
        "\"\<:\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.90631945404169*^9, {3.92055685806048*^9, 3.9205568602459793`*^9}},
 CellLabel->
  "In[2822]:=",ExpressionUUID->"d9a6dd12-7ded-415b-8365-ca49654fd017"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sind", "[", "t_", "]"}], ":=", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cosd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tand", "[", "t_", "]"}], ":=", 
   RowBox[{"Tan", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cotd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"secd", "[", "t_", "]"}], ":=", 
   RowBox[{"Sec", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cscd", "[", "t_", "]"}], ":=", 
   RowBox[{"Csc", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arccosd", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcCos", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arcsind", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcSin", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arctand", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcTan", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"length", "[", "v_", "]"}], ":=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{"v", ".", "v"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], "                "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], "       ", ":=", 
   RowBox[{"N", "[", 
    RowBox[{"arccosd", "[", 
     RowBox[{
      RowBox[{"u", ".", "v"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"length", "[", "u", "]"}], " ", 
        RowBox[{"length", "[", "v", "]"}]}], ")"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"Apt_", ",", "Bpt_", ",", "Cpt_"}], "]"}], ":=", 
   RowBox[{"angle", "[", 
    RowBox[{
     RowBox[{"Apt", "-", "Bpt"}], ",", 
     RowBox[{"Cpt", "-", "Bpt"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"u", ".", "v"}], 
      RowBox[{
       RowBox[{"length", "[", "u", "]"}], " ", 
       RowBox[{"length", "[", "v", "]"}]}]], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "used", " ", "to", " ", "be", " ", "AngleRad"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "   "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UU", "[", 
     RowBox[{"A_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"A", ",", 
       RowBox[{"Cross", "[", 
        RowBox[{"N", ",", "A"}], "]"}], ",", "N"}], "}"}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["The",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["frame",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["whose",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["first",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["third",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["vectors",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["are",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["A",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"N", "."}],
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox["A",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["N",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["must",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["be",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"orthonormal", ".", " ", "The"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["first",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["third",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["columns",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["of",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["UU",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["are",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["A",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["and",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"N", "."}],
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SignedAngle", "[", 
    RowBox[{"A_", ",", "B_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{"Theta", "[", 
    RowBox[{
     RowBox[{"Transpose", " ", "[", 
      RowBox[{"UU", "[", 
       RowBox[{
        RowBox[{"Unit", "[", "A", "]"}], ",", 
        RowBox[{"Unit", "[", "N", "]"}]}], "]"}], "]"}], ".", "B"}], "]"}]}], 
  " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "A", " ", "and", " ", "B", " ", "must", " ", "be", " ", "orthogonal", 
      " ", "to", " ", "N"}], ",", " ", 
     RowBox[{
     "and", " ", "N", " ", "must", " ", "be", " ", "a", " ", "unit", " ", 
      "vector", " ", "WORK", " ", "HERE"}], ",", " ", "REDO"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Theta", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Theta", "[", 
        RowBox[{"1.", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "=", "0.999"}]}],
      ";", " ", 
     StyleBox[
      RowBox[{"CHANGED", " ", "FEB", " ", "3"}],
      FontColor->RGBColor[1, 0, 0]]}], 
    StyleBox[",",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["2024",
     FontColor->RGBColor[1, 0, 0]]}], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "=", "0"}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"CHANGED", " ", "FEB", " ", "3"}], ",", " ", "2024"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], "]"}], "=", "0"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"CHANGED", " ", "F", "EB", " ", "3"}], ",", " ", "2024"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Theta", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], " ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.734628431840602*^9, 3.734628477450066*^9}, {
   3.734628913185296*^9, 3.734628918091556*^9}, {3.7346317198290963`*^9, 
   3.734631725641618*^9}, {3.7460429495891056`*^9, 3.7460429506773715`*^9}, 
   3.864152349189878*^9, {3.875484972852081*^9, 3.8754849785294704`*^9}, {
   3.875485482254735*^9, 3.8754854894004974`*^9}, 3.875485805686556*^9, {
   3.8754863775133533`*^9, 3.8754863855126796`*^9}, {3.875542837017194*^9, 
   3.8755428549486504`*^9}, {3.8755554503560205`*^9, 
   3.8755554509013157`*^9}, {3.8755562751363926`*^9, 3.87555630469481*^9}, {
   3.8755563389314737`*^9, 3.8755563435714965`*^9}, {3.899679074026461*^9, 
   3.8996791123485394`*^9}, {3.8996791720423737`*^9, 
   3.8996791765861464`*^9}, {3.8996792773419695`*^9, 
   3.8996792972129135`*^9}, {3.89967946367607*^9, 3.899679481965351*^9}, {
   3.8996795338039293`*^9, 3.8996795400117626`*^9}, {3.9160150378451653`*^9, 
   3.91601507253194*^9}, {3.91601549010629*^9, 3.9160154905305967`*^9}, {
   3.9160156110412893`*^9, 3.916015612579429*^9}, {3.9160163314218082`*^9, 
   3.9160163638139424`*^9}, {3.9160174659352593`*^9, 3.916017470627825*^9}, 
   3.9205568329734116`*^9},
 CellLabel->
  "In[2823]:=",ExpressionUUID->"ad932059-3f2b-4b94-9763-5975876eaea3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TPxyz0to2pi", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"Theta", "[", "v", "]"}], ",", 
       RowBox[{"2", "\[Pi]"}]}], "]"}], ",", 
     RowBox[{"Phi", "[", "v", "]"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[2844]:=",ExpressionUUID->"881feb94-5608-47d7-a509-a0316aa0ae36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"area", "[", "rect_", "]"}], ":=", 
    RowBox[{"length", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"rect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "-", 
        RowBox[{"rect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", ".", "b"}], "/", 
    RowBox[{"length", "[", "b", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VectorProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"a", ".", "b"}], 
     RowBox[{"b", ".", "b"}]], "b"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlaneProj", "[", 
    RowBox[{"a_", ",", "normal_"}], "]"}], ":=", 
   RowBox[{"a", "-", 
    RowBox[{"VectorProj", "[", 
     RowBox[{"a", ",", "normal"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RightAngle", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"a", "-", "b"}], "]"}]}]}], ",", 
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"a", "-", "b"}], "]"}]}], "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"c", "-", "b"}], "]"}]}]}], ",", 
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"c", "-", "b"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0", "0"},
      {"0", 
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {"0", 
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"   ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0", 
       RowBox[{"Sin", "[", "t", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0", 
       RowBox[{"Cos", "[", "t", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0"},
      {"0", "0", "1"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xrot", "[", "t_", "]"}], ":=", 
   RowBox[{"XRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yrot", "[", "t_", "]"}], ":=", 
   RowBox[{"YRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zrot", "[", "t_", "]"}], ":=", 
   RowBox[{"ZRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rot111", "=", 
   RowBox[{"(", GridBox[{
      {"0", "0", "1"},
      {"1", "0", "0"},
      {"0", "1", "0"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["w", "2"], "+", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "-", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "+", 
           RowBox[{"w", " ", "y"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "+", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "-", 
           RowBox[{"w", " ", "x"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "-", 
           RowBox[{"w", " ", "y"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "+", 
           RowBox[{"w", " ", "x"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]}
      }], "\[NoBreak]", ")"}]}], " ", ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"RotMatrix2", ".", "  ", 
      StyleBox[
       RowBox[{"Q", 
        StyleBox["u",
         FontColor->RGBColor[1, 0, 0]]}]]}], "aternion", " ", 
     RowBox[{"{", 
      RowBox[{"w", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], " ", "must", " ", 
     "have", " ", "unit", " ", "length"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rot", "[", 
    RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"RotMatrixQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cosd", "[", 
       RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
      RowBox[{
       RowBox[{"sind", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], 
       RowBox[{"unit", "[", "v", "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", "v_", "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"v", ".", "v"}]}]], ",", "v"}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "is", " ", 
     SubscriptBox["U", "B"], " ", "in", " ", "some", " ", "of", " ", "the", 
     " ", "tex", " ", "files"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", 
     RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]", "/", "2"}], "]"}], 
        FractionBox["v", 
         SqrtBox[
          RowBox[{"v", ".", "v"}]]]}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rot", "[", 
       RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", "v", "]"}], "]"}], ".", 
       RowBox[{"zrot", "[", "\[Xi]", "]"}], ".", 
       RowBox[{"vertical", "[", "v", "]"}]}]}], ";", "  ", "old"}], ",", " ", 
    RowBox[{
    "but", " ", "the", " ", "two", " ", "rots", " ", "are", " ", 
     "equivalent"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rot2D", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rot2d", "[", "t_", "]"}], ":=", 
   RowBox[{"Rot2D", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROTe3e1toOrthonormalv3v1", "[", 
    RowBox[{"v3_", ",", "v1_"}], "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"v1", ",", 
      RowBox[{"Cross", "[", 
       RowBox[{"v3", ",", "v1"}], "]"}], ",", "v3"}], "}"}], "]"}]}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "v3", " ", "and", " ", "v1", " ", "must", " ", "be", " ", "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UswapVandKnoQualify", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    TagBox[
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "+", "z"}]], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["y", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"x", " ", "y"}], 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", "y"}], 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], " ", ")"}]}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "must", " ", "be", " ", 
     "unit", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UswapVandK", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"z", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", 
          RowBox[{"0", " "}]},
         {"0", 
          RowBox[{"-", "1"}], 
          RowBox[{"0", " "}]},
         {
          RowBox[{"0", " "}], 
          RowBox[{"0", " "}], 
          RowBox[{"-", "1", " "}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["y", "2"]}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}], "-", "z", " "}], 
           RowBox[{"x", " ", 
            RowBox[{"y", "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]}], 
           RowBox[{"x", " "}]},
          {
           RowBox[{"x", " ", 
            RowBox[{"y", "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["x", "2"]}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}], "-", "z"}], 
           RowBox[{"y", " "}]},
          {
           RowBox[{"x", " "}], 
           RowBox[{"y", " "}], 
           RowBox[{"z", " "}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "must", " ", "be", " ", 
     "unit", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CircleOnSphere", "[", 
    RowBox[{"center_", ",", "radius_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ROT", "[", 
       RowBox[{"\[Pi]", ",", 
        RowBox[{"Unit", "[", 
         RowBox[{"center", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ".", 
      RowBox[{"ZRot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "radius", "]"}], ",", "0", ",", 
        RowBox[{"Cos", "[", "radius", "]"}]}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
      RowBox[{".01", "\[Pi]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UsHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
     RowBox[{
      StyleBox["YRot",
       FontColor->RGBColor[1, 0, 0]], "[", "\[Phi]", "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "not", " ", "the", " ", "same", " ", "as", " ", "in", " ", "Section", " ",
      "S4", " ", "of", " ", "Supp", " ", "Info", " ", "for", " ", "TapeTape", 
     " ", "2015"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Us", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", 
      RowBox[{"ArcCos", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UgHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"G", " ", "for", " ", 
      RowBox[{"geology", ".", " ", "Used"}], " ", "to", " ", "be", " ", 
      RowBox[{"U\[Kappa]\[Sigma]\[Phi]", ".", " ", "Inputs"}], " ", "in", " ",
       "radians"}], ";", " ", 
     RowBox[{
      RowBox[{"basis", " ", "should", " ", "be", " ", "north"}], "-", "west", 
      "-", 
      RowBox[{
      "up", " ", "for", " ", "coords", " ", "to", " ", "have", " ", "meaning",
        " ", "strike"}], "-", "rake", "-", "dip"}], ";", " ", 
     RowBox[{"Eq", " ", 
      RowBox[{"(", "26", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2012beach", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ug", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "h_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]h", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "h"}], "}"}], "]"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"G", " ", "for", " ", 
       RowBox[{"geology", ".", " ", "Basis"}], " ", "should", " ", "be", " ", 
       "north"}], "-", "west", "-", 
      RowBox[{
      "up", " ", "for", " ", "coords", " ", "to", " ", "have", " ", "meaning",
        " ", "strike"}], "-", "rake", "-", 
      RowBox[{"cos", 
       RowBox[{"(", "dip", ")"}]}]}], ";"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"yref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefWithUnitNormal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["u", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "w"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["v", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "v", " ", "w"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "w"}], 
        RowBox[{
         RowBox[{"-", "2"}], "v", " ", "w"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["w", "2"]}]}]}
      }], ")"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "'"}], 
     RowBox[{"Reflection", "'"}], " ", 
     RowBox[{"to", " ", "'"}], 
     RowBox[{"Ref", "'"}], " ", "April", " ", "2012"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefWithUnitNormal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["u", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["v", "2"]}]}]}
      }], ")"}]}], ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"changed", " ", "'"}], 
      RowBox[{"Reflection", "'"}], " ", 
      RowBox[{"to", " ", "'"}], 
      RowBox[{"Ref", "'"}], " ", "April", " ", "2012"}], ";", " ", 
     RowBox[{"added", " ", "2", "D", " ", "March", " ", "2016"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"id", "=", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sign", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "<", "0"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyztp", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"cosd", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"sind", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"sind", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"sind", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"cosd", "[", "\[Phi]", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"arccosd", "[", 
    FractionBox["z", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]]], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi", "[", "v_", "]"}], ":=", 
   RowBox[{"Angle", "[", 
    RowBox[{"v", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "==", "0"}], ",", "0", ",", 
      "               ", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"arcsind", "[", 
         FractionBox["y", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]]], "]"}], ",", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", ">=", "0"}], ",", 
          RowBox[{"180", "-", 
           RowBox[{"arcsind", "[", 
            FractionBox["y", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"]}]]], "]"}]}], ",", "\n", 
          "\t\t\t\t           ", 
          RowBox[{
           RowBox[{"-", "180"}], "-", 
           RowBox[{"arcsind", "[", 
            FractionBox["y", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"]}]]], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "changed", " ", "Feb", " ", "2009", " ", "also", " ", "eliminated", " ", 
     "carets"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Theta", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], "==", "0"}], ",", "0", ",", 
       "               ", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"ArcCos", "[", 
          FractionBox["x", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}]]], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           FractionBox["x", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"]}]]], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "*)"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"used", " ", "for", " ", "lune", " ", "coordinates"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta2d", "[", "v_", "]"}], ":=", 
  RowBox[{"theta", "[", 
   RowBox[{"Append", "[", 
    RowBox[{"v", ",", "0"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"phitheta", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", "[", "v", "]"}], ",", 
     RowBox[{"theta", "[", "v", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TPxyz", "[", "v_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Theta", "[", "v", "]"}], ",", 
      RowBox[{"Phi", "[", "v", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TPxyz", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"999", ",", "0"}], "}"}]}], ";", "   ", 
    StyleBox[
     RowBox[{"Deleted", " ", "Feb", " ", "2024"}],
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TPxyz", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"999", ",", "\[Pi]"}], "}"}]}], ";", " ", 
    StyleBox[
     RowBox[{"Deleted", " ", "Feb", " ", "2024"}],
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertical", "[", "p_", "]"}], ":=", 
    RowBox[{
     RowBox[{"zrot", "[", 
      RowBox[{"theta", "[", "p", "]"}], "]"}], ".", 
     RowBox[{"yrot", "[", 
      RowBox[{"-", 
       RowBox[{"phi", "[", "p", "]"}]}], "]"}], ".", 
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", "p", "]"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Changed", " ", "Aug", " ", "2002"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertical", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", 
        RowBox[{
         RowBox[{"vertical", "[", "a", "]"}], ".", "b"}], "]"}]}], "]"}], ".", 
     RowBox[{"vertical", "[", "a", "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "makes", " ", "a", " ", "vertical", " ", "and", " ", "gives", " ", "b", 
    " ", "a", " ", "theta", " ", "coordinate", " ", "of", " ", "zero"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"verticalViaXAxis", "[", "p_", "]"}], ":=", 
    RowBox[{
     RowBox[{"yrot", "[", 
      RowBox[{"-", 
       RowBox[{"phi", "[", "p", "]"}]}], "]"}], ".", 
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", "p", "]"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Changed", " ", "Aug", " ", "2002"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"range", "[", 
    RowBox[{"domain_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"f", "/@", "domain"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListComplement", "[", 
     RowBox[{"universe_", ",", "set_"}], "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"universe", ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"set", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "Mathematica", " ", "Complement", " ", "no", " ", "good", " ", "for", " ", 
    "lists"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"set_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"part", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"remaining", "=", "set"}], ";", "\n", "     ", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"remaining", "!=", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t   ", 
       RowBox[{
        RowBox[{"EqCl", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"remaining", ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{
              RowBox[{"First", "[", "remaining", "]"}], ",", "#"}], "]"}], 
            " ", "&"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"part", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"part", ",", 
           RowBox[{"{", "EqCl", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"remaining", "=", 
         RowBox[{"ListComplement", "[", 
          RowBox[{"remaining", ",", "EqCl"}], "]"}]}]}]}], "]"}], ";", 
     "part"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"QuotientTopology", "[", 
    RowBox[{"domain_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Rangef", "=", 
      RowBox[{"range", "[", 
       RowBox[{"domain", ",", "f"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"Clear", "[", "EqCl", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"EqCl", "[", "RangeValue_", "]"}], ":=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EqCl", "[", 
         RowBox[{"f", "[", 
          RowBox[{"domain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EqCl", "[", 
           RowBox[{"f", "[", 
            RowBox[{"domain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"domain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "domain", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "     ", 
     RowBox[{"EqCl", "/@", "Rangef"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MyFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnsortedUnion", "[", "list_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Union", "[", "list", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "#1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "#2"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CartesianProduct", "[", "ListOfSets_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "ListOfSets", "]"}], "==", "2"}], ",", "\t\t", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListOfSets", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"ListOfSets", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "1"}], "]"}], "]"}], ",", "\n", 
     RowBox[{"MyFlatten", "/@", 
      RowBox[{"CartesianProduct", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"ListOfSets", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"CartesianProduct", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"ListOfSets", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ForSomeMine", "[", 
    RowBox[{"domain_", ",", "predicate_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"predicate", "/@", "domain"}], ",", "True"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ForAllMine", "[", 
    RowBox[{"domain_", ",", "predicate_"}], "]"}], ":=", 
   RowBox[{"!", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"predicate", "/@", "domain"}], ",", "False"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ListIsComplex", "[", "v_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"Head", "/@", "v"}], ",", "Complex"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqualNumbers", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"x", "-", "y"}], "]"}], "<", ".00001"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqualVectors", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"length", "[", 
     RowBox[{"x", "-", "y"}], "]"}], "<", ".00001"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentList", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"EquatorList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"zrot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "181"}], ",", "179", ",", "2"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapEyeward", "[", 
     RowBox[{"x_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"x", "+", 
     RowBox[{"distance", "*", 
      RowBox[{"unit", "[", "eye", "]"}]}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"usually", " ", "distance"}], " ", "=", " ", 
    RowBox[{".01", " ", "is", " ", "enough"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapListEyeward", "[", 
    RowBox[{"list_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapEyeward", "[", 
      RowBox[{"#", ",", "distance", ",", "eye"}], "]"}], "&"}], "/@", 
    "list"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeReal", "[", "z_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "z", "]"}], "==", "0"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "z", "]"}], "]"}], "<", ".00001"}], ",", 
       RowBox[{"Re", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"MakeReal", "/@", "z"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPoly", "[", 
    RowBox[{"i_", ",", "j_", ",", "RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "       ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RangeX", "[", 
         RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
        RowBox[{"RangeY", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "*)"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPolys", "[", 
    RowBox[{"RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BasicPoly", "[", 
        RowBox[{"i", ",", "j", ",", "RangeX", ",", "RangeY"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeX", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeY", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myRange", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "Nsubintervals_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x2", "<=", "x1"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"x1", ",", "x2", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "/", "Nsubintervals"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"myRangeNoSign", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "Nsubintervals_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", "x1", "]"}], "!=", "0"}], "||", 
      RowBox[{
       RowBox[{"Im", "[", "x2", "]"}], "!=", "0"}]}], ",", 
     RowBox[{"myRange", "[", 
      RowBox[{"x1", ",", "x2", ",", "Nsubintervals"}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x1", "<=", "x2"}], ",", 
       RowBox[{"myRange", "[", 
        RowBox[{"x1", ",", "x2", ",", "Nsubintervals"}], "]"}], ",", 
       RowBox[{"myRange", "[", 
        RowBox[{"x2", ",", "x1", ",", "Nsubintervals"}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BothSigns", "[", "list_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"-", "list"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inject", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "nPts_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"i", "/", "nPts"}]}], ")"}], "p1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "/", "nPts"}], ")"}], "p2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "nPts"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintEye", ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<eye = \>\"", ",", 
     RowBox[{"Round", "[", 
      RowBox[{"eye", ",", ".01"}], "]"}], ",", 
     "\"\<;  (\[Theta], \[Phi]\!\(\*SubscriptBox[\()\), \(eye\)]\) = \>\"", 
     ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Theta", "[", "eye", "]"}], ",", 
        RowBox[{"Phi", "[", "eye", "]"}]}], "}"}], "]"}], ",", 
     "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(eye\)]\) = \>\"", ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"length", "[", "eye", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CubeVertices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CubeEdges", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "  ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomDirection", ":=", 
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomDirectionFixed", "=", "RandomDirection"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OLDRandomRotation", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ttt", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppp", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sss", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotMatrixQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"sss", "/", "2"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"sss", "/", "2"}], "]"}], 
          RowBox[{
           RowBox[{"ZRot", "[", "ttt", "]"}], ".", 
           RowBox[{"YRot", "[", "ppp", "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "}"}], "]"}], ".", 
      RowBox[{"ZRot", "[", "ttt", "]"}], ".", 
      RowBox[{"YRot", "[", "ppp", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomRotation", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Uran", "}"}], ",", 
     RowBox[{
      RowBox[{"Uran", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"CircularRealMatrixDistribution", "[", "3", "]"}], "]"}]}], 
      ";", 
      RowBox[{
       RowBox[{"Det", "[", "Uran", "]"}], " ", "Uran"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomUnitMT", ":=", 
    RowBox[{"MatrixFromONcoords", "[", 
     RowBox[{"unit", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", "6"}], "]"}], "]"}], "]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"random", " ", "unit", " ", "moment", " ", "tensor"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomUnitMT", ":=", 
    RowBox[{"Matrix3x3from\[CapitalPhi]coords", "[", 
     RowBox[{"unit", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", "6"}], "]"}], "]"}], "]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox[
     RowBox[{"random", " ", "unit", " ", "moment", " ", "tensor"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[";",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{
    "Matrix3x3from\[CapitalPhi]coords", " ", "used", " ", "to", " ", "be", 
     " ", "MatrixFromONcoords"}], ";", " ", 
    RowBox[{
     RowBox[{"see", " ", "file", " ", "AAcommonMomentTensorFns_", "2018"}], 
     "-", "07", "-", 
     RowBox[{"27", 
      RowBox[{"_SAVE", ".", "nb", "."}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uG", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["2"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["6"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], 
       SqrtBox["3"]]}], "}"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"arc", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RotMatrixQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"#", "/", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"#", "/", "2"}], "]"}], 
           RowBox[{"unit", "[", 
            RowBox[{"Cross", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "}"}], "]"}], ".", 
       "a"}], "&"}], "/@", 
     RowBox[{"myRange", "[", 
      RowBox[{
       RowBox[{"0", "+", 
        RowBox[{"0", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", 
       RowBox[{
        RowBox[{"Angle", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "-", 
        RowBox[{"0", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", "31"}], "]"}]}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Change", " ", "0", " ", "to", " ", "1", " ", "or", " ", "2", " ", "so", 
     " ", "endpoints", " ", "are", " ", "visible"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "M", "]"}], ".", 
    RowBox[{"Flatten", "[", "N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMatrix", "[", "M_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{"M", ",", "M"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitMatrix", "[", "M_", "]"}], ":=", 
   FractionBox["M", 
    RowBox[{"NormMatrix", "[", "M", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AngleMatrix", "[", 
     RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{"M", ",", "N"}], "]"}], 
      RowBox[{
       RowBox[{"NormMatrix", "[", "M", "]"}], 
       RowBox[{"NormMatrix", "[", "N", "]"}]}]], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox["radians",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixAbs", "[", "V_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"Abs", ",", "V", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"MatrixAbs", "[", "V", "]"}], " ", "is", " ", 
     SubscriptBox["\[CapitalPi]", "V"]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpherePolyList", "[", 
     RowBox[{
     "\[Rho]_", ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "\[Phi]1_", ",", 
      "\[Phi]2_", ",", "\[CapitalDelta]\[Theta]_", ",", 
      "\[CapitalDelta]\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{"xyztp", "[", "#", "]"}]}], "&"}], ",", " ", 
      RowBox[{"BasicPolys", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
         "\[Theta]1", ",", "\[Theta]2", ",", "\[CapitalDelta]\[Theta]"}], 
         "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"\[Phi]1", ",", "\[Phi]2", ",", "\[CapitalDelta]\[Phi]"}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarText", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[GreaterEqual]", "0"}], ",", "x", ",", 
       OverscriptBox[
        RowBox[{"-", "x"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "y", ",", 
       OverscriptBox[
        RowBox[{"-", "y"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[GreaterEqual]", "0"}], ",", "z", ",", 
       OverscriptBox[
        RowBox[{"-", "z"}], "_"]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "AinRadians_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"AinRadians", "/", "Degree"}], ",", ".01"}], "]"}], ",", 
      "o"}], "]"}], "//", "DisplayForm"}]}], ";"}]}], "Input",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic,
 CellChangeTimes->{
  3.4892780789458637`*^9, 3.4892781537179947`*^9, 3.489278185963251*^9, {
   3.4950345922209835`*^9, 3.4950346018774004`*^9}, {3.5011818616296425`*^9, 
   3.5011818626904445`*^9}, {3.520005149614954*^9, 3.520005186743019*^9}, {
   3.5228787025265994`*^9, 3.522878716086618*^9}, {3.523572395586929*^9, 
   3.5235725065031223`*^9}, {3.5235726199309196`*^9, 
   3.5235726788522224`*^9}, {3.523573043268858*^9, 3.523573114982183*^9}, {
   3.523913723635171*^9, 3.5239137509196186`*^9}, {3.523913805878515*^9, 
   3.523913806065715*^9}, {3.52415771607572*^9, 3.5241577374165573`*^9}, {
   3.5245987606895313`*^9, 3.5245988112024193`*^9}, {3.5246041379147077`*^9, 
   3.524604143889518*^9}, {3.5275223122177277`*^9, 3.5275223131381297`*^9}, {
   3.5278961648661757`*^9, 3.5278961685761805`*^9}, {3.531153615164811*^9, 
   3.531153615984812*^9}, {3.5330552480452175`*^9, 3.533055281051276*^9}, {
   3.5359904583292646`*^9, 3.535990479217701*^9}, {3.536343561909086*^9, 
   3.5363435629386873`*^9}, {3.543292666839031*^9, 3.543292719379923*^9}, {
   3.5469924224625473`*^9, 3.5469924490318937`*^9}, {3.5519977604570932`*^9, 
   3.5519977614398947`*^9}, {3.557771274368308*^9, 3.5577712872851305`*^9}, {
   3.557771609737693*^9, 3.557771612483298*^9}, {3.55837231696457*^9, 
   3.558372325981386*^9}, {3.5583752865857487`*^9, 3.5583753000329723`*^9}, {
   3.558903374762436*^9, 3.5589033779604416`*^9}, {3.559264638214102*^9, 
   3.5592646392281036`*^9}, {3.56152558249544*^9, 3.5615255833378415`*^9}, {
   3.567712960903683*^9, 3.567712961808485*^9}, 3.57212065450091*^9, {
   3.5745725034873385`*^9, 3.5745725429211073`*^9}, {3.5745726368819714`*^9, 
   3.574572649926094*^9}, {3.5914556336639824`*^9, 3.5914556350939846`*^9}, {
   3.592708592645027*^9, 3.592708593975029*^9}, {3.5928584937596893`*^9, 
   3.592858725568514*^9}, {3.5940571577699823`*^9, 3.594057159789985*^9}, {
   3.5944926563063498`*^9, 3.5944926865583925`*^9}, {3.594492775988516*^9, 
   3.594492776368517*^9}, {3.594492837360602*^9, 3.594492837900603*^9}, {
   3.594492902030691*^9, 3.594492936992742*^9}, {3.594493034604878*^9, 
   3.594493069734926*^9}, {3.594493106114977*^9, 3.59449322455514*^9}, 
   3.59449358324364*^9, 3.594515431065692*^9, {3.5945158044122105`*^9, 
   3.594515805652213*^9}, {3.5947545896350193`*^9, 3.5947546197350607`*^9}, {
   3.594828417439077*^9, 3.594828449759122*^9}, {3.594926309197468*^9, 
   3.5949263218474855`*^9}, {3.594927514981152*^9, 3.5949275153411527`*^9}, {
   3.594929784751333*^9, 3.5949297858113346`*^9}, {3.59492992226153*^9, 
   3.594929926493537*^9}, {3.5949299683435946`*^9, 3.5949300347036858`*^9}, 
   3.5950188480312347`*^9, {3.595034990484455*^9, 3.5950349917844567`*^9}, {
   3.5956466336034193`*^9, 3.5956467549255886`*^9}, {3.5956470300339727`*^9, 
   3.5956470819260454`*^9}, {3.5956471788681808`*^9, 3.595647201638212*^9}, {
   3.595647312358365*^9, 3.5956473913904753`*^9}, {3.595715611870015*^9, 
   3.5957156407100554`*^9}, {3.5957156923101263`*^9, 3.595715708840149*^9}, 
   3.595716187234812*^9, {3.5957170337435017`*^9, 3.595717044763517*^9}, {
   3.597258178496549*^9, 3.5972581787265496`*^9}, {3.599261386127534*^9, 
   3.5992613871575356`*^9}, {3.5992772595141573`*^9, 
   3.5992772602741585`*^9}, {3.599277324544247*^9, 3.599277331914257*^9}, {
   3.603647041856326*^9, 3.603647081556381*^9}, {3.618611067270751*^9, 
   3.6186110728807583`*^9}, {3.6186111460108595`*^9, 3.618611158820877*^9}, {
   3.6186112106309485`*^9, 3.6186112148309546`*^9}, {3.6332226277838993`*^9, 
   3.6332226479739275`*^9}, {3.6332232680633373`*^9, 3.633223271203342*^9}, {
   3.6487904358208184`*^9, 3.648790525907971*^9}, {3.6684483212406683`*^9, 
   3.6684483397506933`*^9}, {3.668448371313237*^9, 3.6684483724032383`*^9}, {
   3.6833964238277674`*^9, 3.6833964249926825`*^9}, {3.6912539493321176`*^9, 
   3.6912539770821705`*^9}, 3.6921210127382526`*^9, {3.692498157175506*^9, 
   3.6924981572067585`*^9}, {3.692498188581808*^9, 3.6924982054881015`*^9}, {
   3.695618698451692*^9, 3.695618699407053*^9}, {3.6989476969098516`*^9, 
   3.6989477407249126`*^9}, {3.69894791067515*^9, 3.6989479132551003`*^9}, {
   3.698948249975572*^9, 3.6989482517006264`*^9}, 3.698948337170746*^9, 
   3.698948387285816*^9, {3.704659163921527*^9, 3.7046591660016465`*^9}, {
   3.7046603495084248`*^9, 3.704660372531743*^9}, {3.7110334365290008`*^9, 
   3.711033451294655*^9}, {3.711037659460438*^9, 3.711037663069871*^9}, {
   3.714850937910308*^9, 3.7148509695003376`*^9}, {3.7180645430460205`*^9, 
   3.718064570108611*^9}, {3.7180666054094276`*^9, 3.71806663069073*^9}, {
   3.722288161654131*^9, 3.7222881635447617`*^9}, {3.7222882068104715`*^9, 
   3.7222882083104744`*^9}, {3.722292009776352*^9, 3.7222920136513596`*^9}, {
   3.7262973003213577`*^9, 3.7262973017744856`*^9}, {3.731373845215251*^9, 
   3.7313738572602186`*^9}, {3.7323744228995304`*^9, 3.732374459087102*^9}, {
   3.734451137662434*^9, 3.7344511824145136`*^9}, {3.734451213118719*^9, 
   3.7344512199530644`*^9}, {3.7344512822894893`*^9, 3.734451306024126*^9}, {
   3.7346172811792326`*^9, 3.734617283601099*^9}, {3.7346177011331806`*^9, 
   3.7346177245082216`*^9}, {3.7346179000710773`*^9, 3.734617907211706*^9}, {
   3.7346179430399103`*^9, 3.734617955993041*^9}, {3.734628196652638*^9, 
   3.7346282214183187`*^9}, {3.734628275902807*^9, 3.734628299449718*^9}, {
   3.7346283505904465`*^9, 3.73462838573114*^9}, 3.734628420246833*^9, 
   3.7346284796375732`*^9, 3.734653704466226*^9, 3.7350941129877977`*^9, {
   3.7460429353723526`*^9, 3.7460429393171883`*^9}, {3.7576449198371625`*^9, 
   3.757644924040283*^9}, {3.7875080058443265`*^9, 3.787508006892823*^9}, {
   3.7875151727983875`*^9, 3.787515179298891*^9}, 3.7875944736793284`*^9, 
   3.7978629561501727`*^9, {3.79786348460015*^9, 3.7978634898001633`*^9}, 
   3.797972350692809*^9, 3.802206037420579*^9, 3.8022061516795697`*^9, 
   3.802301107500579*^9, {3.835511100274585*^9, 3.8355111363709936`*^9}, {
   3.8355114669365406`*^9, 3.8355114776833143`*^9}, {3.835706782705152*^9, 
   3.83570678393762*^9}, {3.840806924469942*^9, 3.8408069461340246`*^9}, {
   3.864832285885053*^9, 3.8648322869635344`*^9}, 3.8648323355424967`*^9, {
   3.864832405951236*^9, 3.864832412172256*^9}, 3.888332438264412*^9, {
   3.8898216396054487`*^9, 3.8898216732425184`*^9}, {3.89090179828717*^9, 
   3.8909018372980156`*^9}, 3.89117664149481*^9, {3.8911768756167774`*^9, 
   3.8911768991600065`*^9}, {3.891176929318083*^9, 3.891176998397329*^9}, {
   3.8911770453957224`*^9, 3.891177046571849*^9}, {3.8911773149290705`*^9, 
   3.8911773159271355`*^9}, {3.8911778590150237`*^9, 3.891177881687895*^9}, {
   3.8964718576248426`*^9, 3.896471905089773*^9}, {3.896472330503767*^9, 
   3.8964723986056166`*^9}, 3.8967444519956017`*^9, {3.8969232095478973`*^9, 
   3.8969232614482207`*^9}, {3.8996784181251864`*^9, 3.899678442047888*^9}, {
   3.8996786202701025`*^9, 3.899678729971366*^9}, 3.90961769505079*^9, 
   3.915937497086033*^9, {3.916015836009313*^9, 3.9160158851145325`*^9}, {
   3.91601674003829*^9, 3.916016769829884*^9}, {3.916209159082572*^9, 
   3.9162091611212053`*^9}, {3.9204696457499886`*^9, 
   3.9204696469581203`*^9}, {3.9204697314762335`*^9, 
   3.9204697323395896`*^9}, {3.9204925481785417`*^9, 3.920492649024543*^9}, 
   3.9204927355704565`*^9, {3.920510500116008*^9, 3.9205105009294157`*^9}, 
   3.9205105348430767`*^9, 3.920543639486643*^9, {3.922976567695962*^9, 
   3.9229765688052177`*^9}, {3.9233581735923214`*^9, 
   3.9233581817531023`*^9}, {3.927989088660079*^9, 3.9279890916573105`*^9}, {
   3.9369163390543604`*^9, 3.9369163402416787`*^9}, 3.936916397834451*^9, {
   3.9369164443675933`*^9, 3.9369164461490135`*^9}, {3.937923590095993*^9, 
   3.937923609558589*^9}, {3.938508881929628*^9, 3.9385088846670084`*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[2845]:=",ExpressionUUID->"538930f2-8506-4ab9-ae43-2498b92e58d2"],

Cell[CellGroupData[{

Cell["\<\
CubePolysBasic. Do not rearrange, on account of coloring later, in SI file.
CylinderPolysPrelim, TriangularPrismPolys, etc are in the AA_MomentTensor \
file.\
\>", "Subsubsection",
 CellChangeTimes->{{3.922975286227056*^9, 3.9229753172244773`*^9}, {
   3.9229765149019194`*^9, 3.9229765272135143`*^9}, {3.923049318732044*^9, 
   3.9230493359423423`*^9}, 3.939672313409404*^9, {3.9397659418194323`*^9, 
   3.9397659863152714`*^9}},ExpressionUUID->"5ce811ad-87c3-4cea-b109-\
56d6d4ab1aee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CubePolysBasic", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"XRot", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "   ", "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"front", " ", "face"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"XRot", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      StyleBox["back",
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"YRot", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "   ", "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      StyleBox["right",
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"YRot", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      StyleBox["left",
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ZRot", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "  ", "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      StyleBox["top",
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ZRot", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], "}"}]}], " ", 
  RowBox[{"(*", " ", 
   StyleBox["bottom",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox["  ",
    FontColor->RGBColor[1, 0, 0]], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.9229753317854805`*^9, 3.9229753409723988`*^9}, 
   3.9229753922206554`*^9, {3.922975456154046*^9, 3.9229755577344866`*^9}, 
   3.9230493105110903`*^9},
 CellLabel->
  "In[2932]:=",ExpressionUUID->"e728c251-a63a-4b60-a28e-a4f15cb7f990"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UnitRight", ":=", 
   RowBox[{"unit", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnitUp", ":=", 
   RowBox[{"unit", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"eye", ",", "UnitRight"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[2933]:=",ExpressionUUID->"849d22bd-f7f8-4f55-8c67-24ff9d9ffafa"],

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Det", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "+", "z"}]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["y", "2"]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}], 
         RowBox[{"x", " ", "y"}], 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}]},
        {
         RowBox[{"x", " ", "y"}], 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["x", "2"]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}], 
         RowBox[{"y", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}]},
        {
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}], 
         RowBox[{"y", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}], 
         RowBox[{"z", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "]"}], 
   ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"], "+", 
      SuperscriptBox["z", "2"]}], "\[Equal]", "1"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}], "2"]], 
     RowBox[{
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["y", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"x", " ", "y"}], 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", "y"}], 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["y", "2"]}], "-", 
            RowBox[{"z", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]}], 
           RowBox[{"x", " ", "y"}], 
           RowBox[{"x", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]},
          {
           RowBox[{"x", " ", "y"}], 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], "-", 
            RowBox[{"z", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]}], 
           RowBox[{"y", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]},
          {
           RowBox[{"x", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}], 
           RowBox[{"y", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}], 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
       "]"}]}]}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], "\[Equal]", "1"}]}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.896744075834582*^9, 3.8967441570249496`*^9}, {
  3.8967443256100492`*^9, 3.8967443265899925`*^9}},
 CellLabel->
  "In[2935]:=",ExpressionUUID->"4d3814d6-2969-448c-b776-ab2a14c58c9d"],

Cell["\<\
DiskOnSphere[v, AngRad, ShiftToEye, eye] is now on sphere of radius \
length[v], but the absolute radius (not the angular radius) of the disk is \
constant.  Changed Feb 2024 and used in making the diagrams for symmetry \
groups.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9162092855361958`*^9, 
  3.9162094878634577`*^9}},ExpressionUUID->"b5017052-3191-4c1d-929a-\
b43461bdcc4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DiskOnSphere0", "[", 
    RowBox[{"v_", ",", "AngRad_"}], "]"}], ":=", "     ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"better", " ", "than", " ", "protruding", " ", "points"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"UswapVandK", "[", "v", "]"}], ".", "#"}], "&"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xyzTP", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", " ", 
             RowBox[{"\[Pi]", "/", "4"}]}], ",", "AngRad"}], "}"}], "]"}], 
         ",", 
         RowBox[{"xyzTP", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}], 
             RowBox[{"\[Pi]", "/", "4"}]}], ",", "AngRad"}], "}"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiskOnSpherePrelim", "[", 
     RowBox[{"v_", ",", "AngRad_", ",", "ShiftToEye_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MapEyeward", "[", 
        RowBox[{"#", ",", "ShiftToEye", ",", "eye"}], "]"}], "&"}], ",", 
      RowBox[{"DiskOnSphere0", "[", 
       RowBox[{"v", ",", "AngRad"}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"v", " ", "is", " ", "point", " ", "on", " ", "SPHERE"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiskOnSphere", "[", 
    RowBox[{"v_", ",", "AngRad_", ",", "ShiftToEye_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"length", "[", "v", "]"}], "#"}], "&"}], ",", 
     RowBox[{"DiskOnSpherePrelim", "[", 
      RowBox[{
       RowBox[{"unit", "[", "v", "]"}], ",", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"length", "[", "v", "]"}]], "AngRad"}], ",", "ShiftToEye", 
       ",", "eye"}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.916209203242505*^9, 3.9162092489362516`*^9}, {
  3.916209504097066*^9, 3.9162095049146347`*^9}, {3.9162097874222775`*^9, 
  3.916209791468397*^9}, {3.9162102100590663`*^9, 3.9162102109075403`*^9}},
 CellLabel->
  "In[2937]:=",ExpressionUUID->"bb9fbcc9-a815-47c2-bfb7-9a3c54eb26a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ShiftToEye", "=", ".02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".85", "]"}], ",", 
     RowBox[{"Polygon", "/@", 
      RowBox[{"SpherePolyList", "[", 
       RowBox[{
       ".9", ",", "0", ",", "360", ",", "0", ",", "180", ",", "10", ",", 
        "10"}], "]"}]}], ",", "        ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"opaque", " ", "sphere"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".58", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "    ", 
          RowBox[{"20", "Degree"}], ",", "ShiftToEye", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Orange", ",", "    ", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1.4"}], "}"}], ",", 
          RowBox[{"20", "Degree"}], ",", "ShiftToEye", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"5", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"30", ",", "70"}], "}"}], "]"}]}]}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.890901943179775*^9, 3.8909020254978876`*^9}, {
   3.8909020751866493`*^9, 3.8909021649637847`*^9}, {3.890902197199705*^9, 
   3.8909022516953754`*^9}, {3.890902585560734*^9, 3.890902598443963*^9}, 
   3.890921850961199*^9, {3.890921962497469*^9, 3.8909219928330564`*^9}, 
   3.891177109012382*^9, {3.8969227292169523`*^9, 3.8969227646068172`*^9}, {
   3.916210010753352*^9, 3.916210078373782*^9}, {3.916210110412654*^9, 
   3.9162101285161858`*^9}, {3.9162102484186883`*^9, 
   3.9162102851697083`*^9}, {3.9162103638931847`*^9, 
   3.9162103652147045`*^9}, {3.916210404574585*^9, 3.9162104242423353`*^9}, {
   3.9162104553141794`*^9, 3.9162104571516857`*^9}},
 CellLabel->
  "In[2940]:=",ExpressionUUID->"52edcace-73c4-4374-8306-5af61c564dc5"],

Cell[CellGroupData[{

Cell["\<\
The 2 - fold rotations are the non-trivial rotation matrices that are \
symmetric.  See the file BC_ReformulationSUPP.pdf\
\>", "Subsubsection",
 CellChangeTimes->{{3.8648653365577154`*^9, 3.864865419665635*^9}, {
  3.864865792939616*^9, 3.864865810449125*^9}, {3.8649212091957426`*^9, 
  3.8649212361049137`*^9}, {3.9118723049315476`*^9, 3.9118725408235197`*^9}, {
  3.911872684043146*^9, 3.911872753862605*^9}, {3.911872864674453*^9, 
  3.911872937129321*^9}, {3.9119249315938425`*^9, 
  3.9119250066677628`*^9}},ExpressionUUID->"e41b2a82-1489-4e66-b60f-\
a0f7c2fcd58e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UswapV1andV2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "]"}], ":=", "    ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"inputs", " ", "must", " ", "be", " ", "unit", " ", "vectors"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "+", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "+", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "+", "z2"}], ")"}], "2"]}]], 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x1", "+", "x2"}], ")"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y1", "+", "y2"}], ")"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z1", "+", "z2"}], ")"}], "2"]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"y1", "+", "y2"}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"z1", "+", "z2"}], ")"}]}]},
       {
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"y1", "+", "y2"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2"}], ")"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y1", "+", "y2"}], ")"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z1", "+", "z2"}], ")"}], "2"]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"y1", "+", "y2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"z1", "+", "z2"}], ")"}]}]},
       {
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"z1", "+", "z2"}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"y1", "+", "y2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"z1", "+", "z2"}], ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2"}], ")"}], "2"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y1", "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z1", "+", "z2"}], ")"}], "2"]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], ";", 
  RowBox[{"v1", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ";", 
  RowBox[{"v2", "=", 
   RowBox[{"{", 
    RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"UswapV1andV2", "[", 
     RowBox[{"v1", ",", "v2"}], "]"}], "==", 
    RowBox[{
     RowBox[{"UswapVandKnoQualify", "[", 
      RowBox[{"unit", "[", 
       RowBox[{"v1", "+", "v2"}], "]"}], "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", 
     RowBox[{"UswapVandKnoQualify", "[", 
      RowBox[{"unit", "[", 
       RowBox[{"v1", "+", "v2"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["x1", "2"], "+", 
       SuperscriptBox["y1", "2"], "+", 
       SuperscriptBox["z1", "2"]}], "\[Equal]", "1"}], "&&", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x2", "2"], "+", 
       SuperscriptBox["y2", "2"], "+", 
       SuperscriptBox["z2", "2"]}], "\[Equal]", "1"}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"UswapV1andV2", "[", 
      RowBox[{"v1", ",", "v2"}], "]"}], ".", "v1"}], "\[Equal]", "v2"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x1", "2"], "+", 
        SuperscriptBox["y1", "2"], "+", 
        SuperscriptBox["z1", "2"]}], "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x2", "2"], "+", 
        SuperscriptBox["y2", "2"], "+", 
        SuperscriptBox["z2", "2"]}], "\[Equal]", "1"}]}], ")"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"UswapV1andV2", "[", 
      RowBox[{"v1", ",", "v2"}], "]"}], ".", "v2"}], "\[Equal]", "v1"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x1", "2"], "+", 
        SuperscriptBox["y1", "2"], "+", 
        SuperscriptBox["z1", "2"]}], "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x2", "2"], "+", 
        SuperscriptBox["y2", "2"], "+", 
        SuperscriptBox["z2", "2"]}], "\[Equal]", "1"}]}], ")"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"UswapV1andV2", "[", 
     RowBox[{"v1", ",", "v2"}], "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"UswapV1andV2", "[", 
      RowBox[{"v1", ",", "v2"}], "]"}], "]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"RotationAngle", "[", 
   RowBox[{"UswapV1andV2", "[", 
    RowBox[{"v1", ",", "v2"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"UswapVandKnoQualify", "[", "v1", "]"}], "==", 
    RowBox[{"UswapV1andV2", "[", 
     RowBox[{"v1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x1", "2"], "+", 
      SuperscriptBox["y1", "2"], "+", 
      SuperscriptBox["z1", "2"]}], "\[Equal]", "1"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"v1", ",", "v2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8648242870847497`*^9, 3.8648243710850663`*^9}, {
   3.864824454487084*^9, 3.864824473281192*^9}, 3.8648245890364633`*^9, {
   3.8648246215743976`*^9, 3.864824679165188*^9}, 3.8648273145841436`*^9, {
   3.864827580386695*^9, 3.864827611193571*^9}, {3.8648276530362587`*^9, 
   3.864827719659754*^9}, 3.864830023941985*^9, {3.864830061897029*^9, 
   3.8648300790987206`*^9}, {3.8648611961774616`*^9, 
   3.8648612036112285`*^9}, {3.8648612978160458`*^9, 
   3.8648613144704094`*^9}, {3.864861351097011*^9, 3.864861497093276*^9}, {
   3.864861992759241*^9, 3.864862025530513*^9}, {3.8648644218151407`*^9, 
   3.864864423524315*^9}, {3.864864694828328*^9, 3.864864869141178*^9}, {
   3.8648649724797688`*^9, 3.864864973577687*^9}, {3.8648650110981503`*^9, 
   3.864865011757657*^9}, {3.8648651845534225`*^9, 3.8648651854994016`*^9}, {
   3.864865281607094*^9, 3.8648652873195796`*^9}, {3.864865482770233*^9, 
   3.864865513363805*^9}, 3.8648657600916705`*^9, {3.9279888797564335`*^9, 
   3.9279889099864435`*^9}, {3.9279891282555428`*^9, 3.927989137341503*^9}, {
   3.9279891738992825`*^9, 3.9279891853095503`*^9}},
 CellLabel->
  "In[2942]:=",ExpressionUUID->"c532158f-afaf-43c0-bf12-75187c6319d5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoordsWrtFrame", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "frame_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", "frame", "]"}], ".", "\[CapitalLambda]"}]}], 
   ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "The", " ", "frame", " ", "vectors", " ", "are", " ", "the", " ", 
      "COLUMNS", " ", "of", " ", "the", " ", "matrix", " ", "\"\<frame.\>\"", 
      " ", "I", " ", "changed", " ", "this", " ", "Nov", " ", "26"}], ",", 
     " ", "2013."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
    "\[Lambda]3"}], "]"}], ";", 
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "+", 
     RowBox[{"b", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "+", 
     RowBox[{"c", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Frame1", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Transpose", " ", "added", " ", "Nov", " ", "26"}], ",", " ", 
     "2013."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"CoordsWrtFrame", "[", 
  RowBox[{"\[CapitalLambda]", ",", "Frame1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5938130191244907`*^9, 3.59381310452661*^9}, {
  3.593813263512833*^9, 3.5938132661028366`*^9}, {3.5938234660811977`*^9, 
  3.5938234707032056`*^9}, {3.5945191585479183`*^9, 3.5945191911104636`*^9}, {
  3.594519344284678*^9, 3.5945193458346806`*^9}},
 CellLabel->
  "In[2950]:=",ExpressionUUID->"c8341bf1-2c2a-48ef-8eb7-97ba3f25ee5d"],

Cell["\<\
Retrieving \[Theta], \[Sigma], \[Phi] from UsHat. Done July 2021, but surely \
this stuff is elsewhere.
The commands conflict with the corresponding (now unevaluated) commands in \
the AAcommonMT file, which may cause problems elsewhere.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7351469804749126`*^9, 3.7351470432719135`*^9}, {
  3.872775088124966*^9, 
  3.8727752132298303`*^9}},ExpressionUUID->"fe045f71-5956-4aa0-87d2-\
dd225fa0ab6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"TPxyz", "[", 
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
   StyleBox[
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "<", "\[Phi]", "<", "\[Pi]"}], ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "<", "\[Theta]", "<", "\[Pi]"}]}], "}"}]}],
    FontColor->RGBColor[1, 0, 0]]}], "]"}]}], "Input",
 CellChangeTimes->{{3.83648642992655*^9, 3.836486442571433*^9}, {
  3.8364865057271433`*^9, 3.8364865138181853`*^9}, {3.83648658537071*^9, 
  3.836486673601779*^9}, {3.8364879208201513`*^9, 3.8364879260160885`*^9}, {
  3.87277526690884*^9, 3.8727752674002438`*^9}, {3.8727753497815475`*^9, 
  3.872775350527766*^9}, {3.8727754038406143`*^9, 3.8727754051797466`*^9}},
 CellLabel->
  "In[2955]:=",ExpressionUUID->"d986cb68-4137-4b11-abac-7b7d06cf618a"],

Cell[BoxData[
 RowBox[{"TPxyz", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.916017138726955*^9, 3.9160171704581575`*^9}},
 CellLabel->
  "In[2958]:=",ExpressionUUID->"5209845c-9e1e-4848-a770-948d7e9d1525"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"\[Theta]OfU", ",", "\[Theta]\[Sigma]\[Phi]OfU"}], "]"}]], "Input",
 CellChangeTimes->{{3.916017253579991*^9, 3.916017256215279*^9}, {
  3.9160911558758507`*^9, 3.9160911568362093`*^9}},
 CellLabel->
  "In[2959]:=",ExpressionUUID->"09c38d9e-0e6b-415c-95f9-753f8965fd18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{"Theta", "[", 
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{"Phi", "[", 
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{"Theta", "[", 
    RowBox[{
     RowBox[{"YRot", "[", 
      RowBox[{"-", 
       RowBox[{"\[Phi]OfU", "[", "U", "]"}]}], "]"}], ".", 
     RowBox[{"ZRot", "[", 
      RowBox[{"-", 
       RowBox[{"\[Theta]OfU", "[", "U", "]"}]}], "]"}], ".", "U", ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Sigma]\[Phi]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]OfU", "[", "U", "]"}], ",", 
     RowBox[{"\[Sigma]OfU", "[", "U", "]"}], ",", 
     RowBox[{"\[Phi]OfU", "[", "U", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836486869359989*^9, 3.8364869089919844`*^9}, {
  3.836487876528364*^9, 3.8364878774081345`*^9}, {3.8364880514561396`*^9, 
  3.8364881574721527`*^9}, {3.9160172021207266`*^9, 3.9160172094719796`*^9}, {
  3.916017521221635*^9, 3.916017526330753*^9}},
 CellLabel->
  "In[2960]:=",ExpressionUUID->"2c9181b5-2552-4a7e-a4c2-532a2fd5a708"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Sigma]\[Phi]0to2\[Pi]", "[", "U_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"\[Theta]OfU", "[", "U", "]"}], ",", 
       RowBox[{"2", "\[Pi]"}]}], "]"}], ",", 
     RowBox[{"\[Sigma]OfU", "[", "U", "]"}], ",", 
     RowBox[{"\[Phi]OfU", "[", "U", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.916507023584488*^9, 3.9165071202579794`*^9}},
 CellLabel->
  "In[2964]:=",ExpressionUUID->"281bb2d6-c2b4-4e1e-9821-edf0a61ba095"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "U", "}"}], ",", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"U", "=", 
       RowBox[{"UsHat", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Pi]"}], "}"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{"U", "-", 
          RowBox[{"UsHat", "[", 
           RowBox[{"\[Theta]\[Sigma]\[Phi]OfU", "[", "U", "]"}], "]"}]}], 
         "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.836487240124071*^9, 3.8364874421120625`*^9}, 
   3.8364876067346945`*^9, {3.836487663232622*^9, 3.836487784128106*^9}, {
   3.836488166898188*^9, 3.836488171633182*^9}, {3.916091210646093*^9, 
   3.916091223861987*^9}, {3.9219468498646994`*^9, 3.921946861650262*^9}},
 CellLabel->
  "In[2965]:=",ExpressionUUID->"4bf6264d-5a05-40d0-942e-eb9b5de12006"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]OfMT", "[", "M_", "]"}], ":=", 
   RowBox[{"\[Theta]OfU", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Uraw", "[", "M", "]"}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"XRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"YRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"ZRot", "[", "\[Pi]", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", 
          RowBox[{"\[Sigma]OfU", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", 
          RowBox[{"\[Theta]OfU", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}]}], " ", "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]OfMT", "[", "M_", "]"}], ":=", 
   RowBox[{"\[Sigma]OfU", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Uraw", "[", "M", "]"}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"XRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"YRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"ZRot", "[", "\[Pi]", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", 
          RowBox[{"\[Sigma]OfU", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", 
          RowBox[{"\[Theta]OfU", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}]}], " ", "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]OfMT", "[", "M_", "]"}], ":=", 
   RowBox[{"\[Phi]OfU", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Uraw", "[", "M", "]"}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"XRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"YRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ".", 
          RowBox[{"ZRot", "[", "\[Pi]", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", 
          RowBox[{"\[Sigma]OfU", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", 
          RowBox[{"\[Theta]OfU", "[", "#", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}]}], " ", "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87269130204867*^9, 3.872691349010004*^9}, {
  3.872691380288148*^9, 3.8726914474369383`*^9}, {3.8726914789667397`*^9, 
  3.872691581251582*^9}, {3.8726917104774637`*^9, 3.8726917467067084`*^9}, {
  3.872692192933426*^9, 3.872692214841975*^9}},
 CellLabel->
  "In[2966]:=",ExpressionUUID->"c58dbe88-ac63-45e0-8c9b-3f7a4208d37a"],

Cell["ARROW2D IS FOR 2-DIMENSIONAL.  REDONE JUNE 2002", "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"2ce80975-ea93-4301-8bfc-9db6f1cf25dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArrowBasic2D", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], " ", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], " ", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"arrow", "[", 
    RowBox[{"tip_", ",", "scale_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"tip", "+", 
      RowBox[{"scale", "\[Times]", 
       RowBox[{
        RowBox[{"rot2d", "[", "theta", "]"}], ".", "#"}]}]}], "&"}], "/@", 
    "ArrowBasic2D"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arrow2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", "scale_"}], "]"}], ":=", 
   RowBox[{"arrow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", "y2"}], "}"}], ",", "scale", ",", 
     RowBox[{"theta", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", "0"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Arrow2DonSphere", "[", 
    RowBox[{"v3_", ",", "v1_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ROTe3e1toOrthonormalv3v1", "[", 
       RowBox[{"v3", ",", "v1"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"scale", "\[Times]", "ArrowBasic2D"}], ")"}]}]}], 
  ";"}]}], "Input",
 PageBreakBelow->Automatic,
 CellChangeTimes->{{3.68338868201423*^9, 3.6833886979685235`*^9}, {
  3.683388799810652*^9, 3.683388831661496*^9}, {3.683388925031291*^9, 
  3.683388936627301*^9}, {3.683396547896555*^9, 3.6833965487526894`*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[2969]:=",ExpressionUUID->"536f4312-dc68-4de8-83b0-57aa762c4cae"],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"Line", "[", "ArrowBasic2D", "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.683388387359335*^9, 3.6833884115524797`*^9}, {
   3.6833885077237625`*^9, 3.683388533888088*^9}, {3.683388885507532*^9, 
   3.683388913453946*^9}, {3.683391790409665*^9, 3.683391797768368*^9}, 
   3.683396514650652*^9, {3.836487819693719*^9, 3.8364878351041117`*^9}},
 CellLabel->
  "In[2972]:=",ExpressionUUID->"46c29b38-1f6d-4c0a-9802-19504d81f070"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CirclePt", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], "+", 
     RowBox[{
      RowBox[{"xrot", "[", "i", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"1", "/", "3"}]}], "}"}]}]}]}], ";"}], "            ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Revised", " ", "July", " ", "2017"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePt", "[", "i", "]"}], ",", 
     RowBox[{"CirclePt", "[", 
      RowBox[{"i", "+", "30"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HalfDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "90"}], ",", "90", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WholeDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UofSN", "[", 
     RowBox[{"S_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"unit", "[", "S", "]"}], ",", 
       RowBox[{"unit", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"N", ",", "S"}], "]"}], "]"}], ",", 
       RowBox[{"unit", "[", "N", "]"}]}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Rotation", " ", "matrix", " ", "that", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}], " ", "to", " ", "S", " ", 
     "and", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}], " ", "to", " ", 
     RowBox[{"N", ".", "  ", "S"}], " ", "and", " ", "N", " ", "are", " ", 
     "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenForArrow", "[", 
    RowBox[{"vector_", ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"1.02", 
       FractionBox["ArrowScale", 
        RowBox[{"length", "[", "vector", "]"}]]}]}], ")"}], "vector"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenLineForArrow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"p2", "-", 
      RowBox[{"1.1", "ArrowScale", " ", 
       RowBox[{"unit", "[", 
        RowBox[{"p2", "-", "p1"}], "]"}]}]}]}], "}"}]}], ";", "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"maybe", " ", "change", " ", "1.28"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7107786899249983`*^9, 3.7107787639572253`*^9}, {
   3.7107788118280177`*^9, 3.7107788181643305`*^9}, {3.710778912245721*^9, 
   3.7107789321648617`*^9}, {3.7107789661808095`*^9, 3.7107790412041025`*^9}, 
   3.7107811120535154`*^9, {3.7107817359922495`*^9, 3.7107817406455126`*^9}, {
   3.71087483028846*^9, 3.710874838160901*^9}, {3.710874879680277*^9, 
   3.7108748932330556`*^9}, 3.7108756004805655`*^9, {3.736194997883952*^9, 
   3.7361950278057995`*^9}, {3.8250052839535685`*^9, 3.825005358245612*^9}, {
   3.8250053918168297`*^9, 3.8250054090252857`*^9}, {3.82500544572526*^9, 
   3.825005524949031*^9}, {3.825005688389964*^9, 3.8250056889926434`*^9}, {
   3.8250057325066743`*^9, 3.825005733949659*^9}, {3.825006716601698*^9, 
   3.8250067918226833`*^9}, {3.8250068912164707`*^9, 3.8250069090635386`*^9}, 
   3.8970688521193123`*^9, {3.8970688908843336`*^9, 3.8970689925358343`*^9}, 
   3.898878212778217*^9},
 CellLabel->
  "In[2973]:=",ExpressionUUID->"d97731d8-9ab1-4150-b011-10494c2caf7e"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "3"}]}], "}"}], "]"}]}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "WholeDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", ".02", "]"}], ",", "Green", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}]}],
        "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7108116645540957`*^9, 3.710811757531419*^9}, {
  3.710874044242437*^9, 3.710874146913313*^9}, {3.7108742293970375`*^9, 
  3.710874235408381*^9}, {3.7108742793288965`*^9, 3.7108743178241005`*^9}, {
  3.710874366080868*^9, 3.71087466840018*^9}, {3.7422518021341333`*^9, 
  3.7422518888995514`*^9}},
 CellLabel->
  "In[2980]:=",ExpressionUUID->"3cedf5ba-9b76-435d-b072-b60a8bc222b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3Dhalf", "[", 
     RowBox[{
     "TipPt_", ",", "Direction_", ",", "Normal_", ",", "ArrowScale_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"Polygon", "/@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TipPt", "+", 
           RowBox[{"ArrowScale", "*", 
            RowBox[{
             RowBox[{"UofSN", "[", 
              RowBox[{"Direction", ",", "Normal"}], "]"}], ".", "#"}]}]}], 
          "&"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Direction", " ", "and", " ", "Normal", " ", "vectors", " ", "must", " ", 
     "be", " ", "perpendicular"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"TipPt_", ",", "Direction_", ",", "ArrowScale_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"Direction", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sign", "[", 
                   RowBox[{"Direction", ".", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}]}]}], "&"}], 
           ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"ZRot", "[", 
                RowBox[{"Theta", "[", "Direction", "]"}], "]"}], ".", 
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "\[Pi]"}], "/", "2"}], "+", 
                 RowBox[{"Phi", "[", "Direction", "]"}]}], "]"}], ".", 
               "#"}]}]}], "&"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "}"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.710779889690693*^9, 3.710779919045374*^9}, {
   3.7107799708053384`*^9, 3.710779974964576*^9}, {3.710780028709654*^9, 
   3.7107800471567097`*^9}, {3.7107807853978124`*^9, 
   3.7107808081331143`*^9}, {3.710780838660859*^9, 3.710780839860928*^9}, {
   3.7107809423407965`*^9, 3.710780944388914*^9}, {3.7107811883588886`*^9, 
   3.7107811918130865`*^9}, 3.710781563014344*^9, {3.7107851253825755`*^9, 
   3.710785151318061*^9}, {3.7107862235734615`*^9, 3.7107862546782465`*^9}, {
   3.710786354039937*^9, 3.710786361413356*^9}, {3.7107864015606537`*^9, 
   3.7107864475902967`*^9}, 3.7107864923428593`*^9, {3.7108747054413085`*^9, 
   3.710874753537052*^9}, {3.7109019519823785`*^9, 3.7109019569566593`*^9}, 
   3.7422539345506487`*^9, {3.7447380617113123`*^9, 3.7447380638050575`*^9}, {
   3.744738109648678*^9, 3.7447381441486034`*^9}, 3.74473868850661*^9},
 CellLabel->
  "In[2981]:=",ExpressionUUID->"71de11ff-a814-40df-a33b-69348878cdca"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"CirclePoint", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "3"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"zrot", "[", "i", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ")"}]}], "]"}]}], ";",
    " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"watch", " ", "out"}], ";", " ", 
      RowBox[{
      "there", " ", "is", " ", "another", " ", "CirclePoint", " ", "in", " ", 
       "the", " ", "streetlight_parhelia", " ", "file"}]}], ",", " ", 
     RowBox[{"for", " ", "Minnaert", " ", "cigar"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CirclePoint", "[", 
       RowBox[{"i", ",", "1"}], "]"}], ",", 
      RowBox[{"CirclePoint", "[", 
       RowBox[{
        RowBox[{"i", "+", "30"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"CenterDisk", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], " ", ":=", 
    RowBox[{"v2", "+", 
     RowBox[{"scale", "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CirclePoint", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "+", 
          RowBox[{"CirclePoint", "[", 
           RowBox[{"180", ",", "1"}], "]"}]}], ")"}], "/", "2"}]}]}]}]}], ";",
    "\n", 
   RowBox[{
    RowBox[{"ConeVertex", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], " ", ":=", 
    RowBox[{"v2", "+", 
     RowBox[{"scale", "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
       RowBox[{"CirclePoint", "[", 
        RowBox[{"0", ",", "0"}], "]"}]}]}]}]}], ";", 
   RowBox[{
    RowBox[{"DiskPoly", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", "#"}]}]}], " ", 
       "&"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"CirclePoint", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ConePolyList", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", "#"}]}]}], " ", 
       "&"}], ",", 
      RowBox[{"ConePoly", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"30", ",", "360", ",", "30"}], "]"}]}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"CircleList", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
          RowBox[{"CirclePoint", "[", 
           RowBox[{
            RowBox[{"#", "+", "30"}], ",", "j"}], "]"}]}]}]}], " ", "&"}], 
      ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "360", ",", "30"}], "]"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"ConePolyList", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"sign", " ", "added", " ", "April", " ", "2011"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
      "\t\t                                                                   \
                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"DiskPoly", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "]"}]}], "}"}], ",",
       "\n", "\t                                             ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"CircleList", "[", 
            RowBox[{"v1", ",", "v2", ",", "scale", ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", "7"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapEyeward", "[", 
              RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
            "                     ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "may", " ", "have", " ", "to", " ", "adjust", " ", "eyeward", 
               " ", "distance", " ", "here"}], ";", " ", 
              StyleBox[
               RowBox[{
               "I", " ", "took", " ", "this", " ", "out", " ", "March", " ", 
                "2011"}],
               FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "+", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"ConeVertex", "[", 
               RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], ",", "\n", 
              "\t\t\t      ", 
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "-", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{
     "v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_", ",", "1"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"ConePolyList", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"sign", " ", "added", " ", "April", " ", "2011"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
      "\t\t                                                                   \
                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"DiskPoly", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "]"}]}], "}"}], ",",
       "\n", "\t                                             ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"CircleList", "[", 
            RowBox[{"v1", ",", "v2", ",", "scale", ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", "7"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapEyeward", "[", 
              RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
            "                     ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "may", " ", "have", " ", "to", " ", "adjust", " ", "eyeward", 
               " ", "distance", " ", "here"}], ";", " ", 
              StyleBox[
               RowBox[{
               "I", " ", "took", " ", "this", " ", "out", " ", "March", " ", 
                "2011"}],
               FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "+", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"ConeVertex", "[", 
               RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], ",", "\n", 
              "\t\t\t      ", 
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "-", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_", ",", 
      RowBox[{"-", "1"}]}], "]"}], ":=", 
    RowBox[{"Arrow3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "v2"}], "-", "v1"}], ",", 
      RowBox[{"v2", "+", 
       RowBox[{"3.2", "scale", "*", 
        RowBox[{"unit", "[", 
         RowBox[{"v1", "-", "v2"}], "]"}]}]}], ",", "scale", ",", "tkns", ",",
       "eye", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfWayIndex", "[", "PtList_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"PtList", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "PtList", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"PtList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"PtList", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "2"]}], "]"}], "<", 
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"#2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"PtList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"PtList", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "2"]}], "]"}]}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfWayArrow", "[", 
     RowBox[{"PtList_", ",", "ArrowScale_", ",", "tkns_", ",", "sign_"}], 
     "]"}], ":=", 
    RowBox[{"Arrow3D", "[", 
     RowBox[{
      RowBox[{"PtList", "[", 
       RowBox[{"[", 
        RowBox[{"HalfWayIndex", "[", "PtList", "]"}], "]"}], "]"}], ",", 
      RowBox[{"PtList", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"HalfWayIndex", "[", "PtList", "]"}], "+", "1"}], "]"}], 
       "]"}], ",", "ArrowScale", ",", 
      RowBox[{".3", "tkns"}], ",", "eye", ",", "sign"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.5005816242648864`*^9, {3.5097430914250536`*^9, 3.5097431414351225`*^9}, {
   3.5123906340047293`*^9, 3.512390671264781*^9}, {3.512390746624885*^9, 
   3.512390747434886*^9}, 3.5123908159849806`*^9, {3.5123908557050357`*^9, 
   3.5123908569650373`*^9}, {3.513262578763157*^9, 3.5132626713805184`*^9}, {
   3.5132627439206448`*^9, 3.5132627869611197`*^9}, {3.513263055063187*^9, 
   3.5132630931116533`*^9}, {3.5132633850193624`*^9, 3.5132633855809636`*^9}, 
   3.5132634755307207`*^9, {3.5132635813145046`*^9, 3.513263610190155*^9}, {
   3.6009722049394665`*^9, 3.6009722059794683`*^9}, {3.7108738247978697`*^9, 
   3.7108738292011223`*^9}},
 CellLabel->
  "In[2983]:=",ExpressionUUID->"0ebdfcfb-3ab9-423d-ba27-9745c116136e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArrowScale", "=", ".25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"Arrow3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "ArrowScale"}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".03", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"ShortenLineForArrow", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          "ArrowScale"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"10", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "90"}], ",", "70"}], "}"}], "]"}]}]}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8250048752904644`*^9, 3.825005150456607*^9}, {
   3.8250055882251663`*^9, 3.825005612758525*^9}, 3.8250057045144186`*^9, {
   3.8643334161124296`*^9, 3.8643334181389666`*^9}},
 CellLabel->
  "In[2984]:=",ExpressionUUID->"e15bfbaa-ebbd-45e2-8f08-07cdedef0c9c"],

Cell[TextData[{
 "POINT P ON THE SPHERE IS VISIBLE FROM THE VIEWPOINT ",
 StyleBox["EYE",
  FontSlant->"Italic"],
 " IFF ",
 StyleBox["SEE[P,EYE]",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["SEE",
  FontSlant->"Italic"],
 " IS NEEDED FOR LAST EXAMPLE IN NUMERAL FILE."
}], "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"a4d85da3-8861-4428-8eef-f7fd2c085d69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeeOnSphere", "[", 
    RowBox[{"p_", ",", "n_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ScalarProj", "[", 
     RowBox[{"p", ",", "eye"}], "]"}], ">", 
    FractionBox[
     SuperscriptBox["n", "2"], 
     RowBox[{"length", "[", "eye", "]"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VisibleSegments", "[", 
    RowBox[{"SegmentList_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"SegmentList", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"see", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&&", 
       RowBox[{"see", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ThirdSegments", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SegmentList", "[", "PointList", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VisibleCurve", "[", 
     RowBox[{
     "PointList_", ",", "n_", ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{"hue", ",", 
      RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
      RowBox[{"Line", "/@", 
       RowBox[{"VisibleSegments", "[", 
        RowBox[{
         RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
         RowBox[{
          RowBox[{"SeeOnSphere", "[", 
           RowBox[{"#1", ",", "n", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
     "}"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"no", " ", "longer", " ", "Graphics3D"}], ",", " ", 
     RowBox[{"May", " ", "2012"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VisibleCurveSegments", "[", 
     RowBox[{"PointList_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"VisibleSegments", "[", 
     RowBox[{
      RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
      RowBox[{
       RowBox[{"SeeOnSphere", "[", 
        RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"No", " ", "hue"}], ",", " ", 
     RowBox[{"no", " ", 
      RowBox[{"thickness", ".", " ", "Map"}], " ", "Line", " ", "onto", " ", 
      RowBox[{"this", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WholeCurve", "[", 
    RowBox[{
    "PointList_", ",", "n_", ",", "eye_", ",", "ThicknessSolid_", ",", 
     "ThicknessDashed_", ",", "hue_"}], "]"}], ":=", "             ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"no", " ", "longer", " ", "Graphics3D"}], ",", " ", 
      RowBox[{"May", " ", "2012"}]}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"Thickness", "[", "ThicknessDashed", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"ThirdSegments", "[", "PointList", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"Thickness", "[", "ThicknessSolid", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"VisibleSegments", "[", 
         RowBox[{
          RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
          RowBox[{
           RowBox[{"SeeOnSphere", "[", 
            RowBox[{"#1", ",", "n", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tpGraphics", "[", 
    RowBox[{
    "v_", ",", "eye_", ",", "ThicknessSolid_", ",", "ThicknessDashed_"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"WholeCurve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zrot", "[", 
           RowBox[{"theta", "[", "v", "]"}], "]"}], ".", 
          RowBox[{"yrot", "[", 
           RowBox[{"-", "#"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"90", 
           RowBox[{"sign", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"sign", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "]"}]}], ",", "1", 
       ",", "eye", ",", "ThicknessSolid", ",", "ThicknessDashed"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", 
         RowBox[{".9", "ThicknessSolid"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"xyztp", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"theta", "[", "v", "]"}], ",", "90"}], "}"}], "]"}]}], 
          "}"}], "]"}]}], "}"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.508994997710577*^9, 3.508995003140585*^9}, {
   3.508995045550643*^9, 3.5089950596506624`*^9}, {3.5089952524409285`*^9, 
   3.508995259730939*^9}, {3.5118744273638315`*^9, 3.5118744292046347`*^9}, {
   3.5118747205039425`*^9, 3.511874734590767*^9}, {3.5118748654593954`*^9, 
   3.511874892166642*^9}, {3.511874992084816*^9, 3.5118750118344507`*^9}, 
   3.511875082190573*^9, 3.51187521798881*^9, {3.511878399458357*^9, 
   3.511878404684366*^9}, {3.546998714978611*^9, 3.5469987978266563`*^9}, {
   3.5469988311471148`*^9, 3.546998862156869*^9}, {3.546999511237503*^9, 
   3.546999533795142*^9}, {3.546999695380224*^9, 3.5469997008090334`*^9}, {
   3.546999780493973*^9, 3.5469998116784267`*^9}, {3.8880663286692147`*^9, 
   3.8880664101525793`*^9}, {3.888067205368599*^9, 3.888067298310684*^9}, 
   3.91594081429216*^9},
 CellLabel->
  "In[2986]:=",ExpressionUUID->"87249965-ad31-40e6-83e4-d40d706478af"],

Cell["EXAMPLE:", "SmallText",
 CellChangeTimes->{{3.5947403421074266`*^9, 3.594740361376954*^9}},
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"200e26b2-9755-499f-b596-12c4e75c917d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1"}], "}"}]}]}], ";", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"WholeCurve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zrot", "[", "#", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "360", ",", "3"}], "]"}]}], ",", "1", ",", "eye", 
      ",", ".003", ",", ".002", ",", "Red"}], "]"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5469995769448175`*^9, 3.5469996772373924`*^9}, {
  3.546999727890681*^9, 3.5469997352070937`*^9}, {3.594740385729488*^9, 
  3.5947404707731094`*^9}, {3.891266849385754*^9, 3.891266860647867*^9}},
 CellLabel->
  "In[2993]:=",ExpressionUUID->"b5674215-07ed-4093-9c64-487d7b493931"],

Cell[TextData[{
 "FOR DOTTING POLYGONAL CURVES. MAKE ",
 StyleBox["SEE",
  FontSlant->"Italic"],
 " = ",
 StyleBox["FALSE&",
  FontSlant->"Italic"],
 " TO DOT THE WHOLE THING. NEED VISIBLE SEGMENTS FOR THIS. \nA SEGMENT IS  \
DELETED IF ONE ENDPOINT FAILS TO SATISFY THE KEEP CONDITION.  MAKE ",
 StyleBox["KEEP",
  FontSlant->"Italic"],
 " = ",
 StyleBox["TRUE",
  FontSlant->"Italic"],
 " ",
 StyleBox["&",
  FontSlant->"Italic"],
 " FOR NO CHANGE."
}], "SmallText",
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"b9ca4c45-f861-4171-8a96-0f3e3e561bc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubdivisionPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"npts", "=", 
      RowBox[{"1", "+", 
       RowBox[{"3", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"length", "[", 
           RowBox[{"x2", "-", "x1"}], "]"}], "/", "tol"}], "]"}]}]}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "+", 
        RowBox[{
         RowBox[{"#", "/", "npts"}], 
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}]}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "npts"}], "]"}]}]}], ")"}]}], ";", 
  RowBox[{
   RowBox[{"PartitionedSegmentList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{"SegmentList", "[", 
    RowBox[{"SubdivisionPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListVisible", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"VisibleSegments", "[", 
    RowBox[{
     RowBox[{"SegmentList", "[", 
      RowBox[{"SubdivisionPoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}], ",", 
     "see"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListThird", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], 
   "                  ", ":=", "     ", 
   RowBox[{"ThirdSegments", "[", 
    RowBox[{"SubdivisionPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListVisible", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DotLineListVisible", "[", 
         RowBox[{"#", ",", "tol", ",", "see"}], "]"}], " ", "&"}], ",", 
       RowBox[{"SegmentList", "[", "PointList", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListThird", "[", 
    RowBox[{"PointList_", ",", "tol_"}], "]"}], "                  ", ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DotLineListThird", "[", 
         RowBox[{"#", ",", "tol"}], "]"}], " ", "&"}], ",", "               ", 
       RowBox[{"SegmentList", "[", "PointList", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLine", "[", 
    RowBox[{
    "PointList_", ",", "tol_", ",", "see_", ",", "keep_", ",", 
     "ThicknessSolid_", ",", "ThicknessDot_"}], "]"}], ":=", 
   RowBox[{"{", " ", "\n", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ThicknessDot", "==", "0"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "ThicknessDot", "]"}], ",", "     ", 
         RowBox[{"Line", "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DotLineListThird", "[", 
             RowBox[{"PointList", ",", "tol"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"keep", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
              RowBox[{"keep", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
        "}"}]}], "]"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "ThicknessSolid", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"DotLineListVisible", "[", 
         RowBox[{"PointList", ",", "tol", ",", "see"}], "]"}]}]}], "}"}]}], 
    "         ", "}"}]}], ";", 
  InterpretationBox[
   TagBox[
    ButtonBox[
     PaneSelectorBox[{
      False->"\<\"https://mail.google.com/mail/u/0/#inbox\"\>", True->
      StyleBox["\<\"https://mail.google.com/mail/u/0/#inbox\"\>", 
       "HyperlinkActive"]}, Dynamic[
       CurrentValue["MouseOver"]],
      BaseStyle->{"Hyperlink"},
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     BaseStyle->"Hyperlink",
     ButtonData->{
       URL["https://mail.google.com/mail/u/0/#inbox"], None},
     ButtonNote->"https://mail.google.com/mail/u/0/#inbox"],
    Annotation[#, "https://mail.google.com/mail/u/0/#inbox", "Hyperlink"]& ],
   "https://mail.google.com/mail/u/0/#inbox"]}]}], "Input",
 CellChangeTimes->{3.9159973535464706`*^9},
 CellLabel->
  "In[2994]:=",ExpressionUUID->"fe33df65-b7e4-4057-8351-809631418ec1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MinceSegment", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"v1", "+", 
       RowBox[{"#", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v2", "-", "v1"}], ")"}], "/", 
         RowBox[{"Ceiling", "[", 
          FractionBox[
           RowBox[{"length", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "tol"], "]"}]}]}]}], ")"}], 
     "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Ceiling", "[", 
       FractionBox[
        RowBox[{"length", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "tol"], "]"}]}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MinceCurve", "[", 
    RowBox[{"PointList_", ",", "tol_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MinceSegment", "[", 
        RowBox[{"#", ",", "tol"}], "]"}], "&"}], "/@", 
      RowBox[{"SegmentList", "[", "PointList", "]"}]}], ",", "1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Redistribute", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "dashlength_"}], "]"}], ":=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"MinceCurve", "[", 
      RowBox[{"PointList", ",", "tol"}], "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"MinceCurve", "[", 
         RowBox[{"PointList", ",", "tol"}], "]"}], "]"}], ",", 
       RowBox[{"Round", "[", 
        FractionBox["dashlength", "tol"], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[3000]:=",ExpressionUUID->"a3ca8ad5-9b3e-410d-9b22-7f64a2f05fcf"],

Cell["\<\
A LIST OF SEGMENTS.  LENGTH OF POINTLIST MAKES A DIFFERENCE FOR ENDS OF \
CURVE. USED FOR CIRCULAR HALOS IN MONTE CARLO.\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{3.6184195825867977`*^9},
 AspectRatioFixed->True,
 FontSize->12,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"e0923b2d-eff1-4b97-9221-4fe41419cd09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DotCurveList", "[", "PointList_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], ",", "3"}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotCurveList", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "dashlength_"}], "]"}], ":=", 
   RowBox[{"DotCurveList", "[", 
    RowBox[{"Redistribute", "[", 
     RowBox[{"PointList", ",", "tol", ",", "dashlength"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[3003]:=",ExpressionUUID->"50e56594-6e13-40ef-b393-cd664693a71d"],

Cell["\<\
NEEDED FOR ATLAS DIAGRAMS, WHOLE SPHERE SIMULATIONS, ORIENTATION \
DISTRIBUTIONS.\
\>", "SmallText",
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"fb61a168-9ebf-4428-a048-832ada1e60de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PreCelSphereList", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eps3", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"length", "[", "eye", "]"}], "2"]]}], ")"}]}], 
    RowBox[{"unit", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eps4", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"length", "[", "eye", "]"}], "2"]]}], ")"}]}], 
    RowBox[{"unit", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"eye", ",", 
       RowBox[{"eps3", "[", "eye", "]"}]}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CenterCelSphere", "[", "eye_", "]"}], ":=", 
   FractionBox["eye", 
    SuperscriptBox[
     RowBox[{"length", "[", "eye", "]"}], "2"]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CelSpherePt", "[", 
    RowBox[{"t_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CenterCelSphere", "[", "eye", "]"}], "+", 
    RowBox[{
     RowBox[{"cosd", "[", "t", "]"}], " ", 
     RowBox[{"eps3", "[", "eye", "]"}]}], "+", 
    RowBox[{
     RowBox[{"sind", "[", "t", "]"}], " ", 
     RowBox[{"eps4", "[", "eye", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreCelSphereList", "[", "eye_", "]"}], ":=", 
    RowBox[{
     RowBox[{"PreCelSphereList", "[", "eye", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"CelSpherePt", "[", 
        RowBox[{"#", ",", "eye"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "90."}], ",", "270"}], "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "180"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.500396498459106*^9, 3.500396681369425*^9}, {
   3.543325224153449*^9, 3.543325226087852*^9}, {3.6890501808053646`*^9, 
   3.6890501873250184`*^9}, 3.7322283707322245`*^9, {3.7322284095522814`*^9, 
   3.7322284315273*^9}},
 CellLabel->
  "In[3005]:=",ExpressionUUID->"51b56216-d987-4780-8a2c-08e0bd3f2a19"],

Cell[CellGroupData[{

Cell["Principal axes as vectors", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.7319457883590517`*^9}},ExpressionUUID->"47c6aa61-2033-4c21-96c7-\
925e0ec5c5e9"],

Cell["\<\
WantArrowColor can be \"TriColor\", \"Custom\", or \"Gray\".
   ArrowColor is some Hue, but only relevant if WantArrowColor = \"Custom\".\
\>", "Text",
 CellChangeTimes->{{3.715714996393337*^9, 3.7157150016902084`*^9}, {
  3.715715819423092*^9, 3.7157159643609123`*^9}},
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"66f73bc8-236c-42bb-8efb-c04d12e63a14"],

Cell[BoxData[
 RowBox[{"ShortenLineForArrow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.2", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   "ArrowScale"}], "]"}]], "Input",
 CellChangeTimes->{{3.8250073829437714`*^9, 3.825007394229742*^9}},
 CellLabel->
  "In[3011]:=",ExpressionUUID->"ae3b2764-c38a-4840-b6ef-299aa552ba96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Paxes", "[", 
   RowBox[{
   "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
    ",", "BBrad_", ",", "ArrowScale_", ",", "tkns_", ",", "WantArrowColor_", 
    ",", "ArrowColor_"}], "]"}], ":=", 
  RowBox[{"{", "      ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"changed", " ", "Sept", " ", "2017"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"t1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"BBrad", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".01", ",", ".8", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "BBrad", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".6", ",", ".9", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "BBrad"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", ".15", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.710884862433217*^9, 3.710885007042824*^9}, {
   3.710885057824211*^9, 3.710885080152393*^9}, {3.710885123496228*^9, 
   3.710885138761883*^9}, {3.710885295230939*^9, 3.710885325262247*^9}, {
   3.7148818954088717`*^9, 3.7148819325808067`*^9}, {3.7148820064247136`*^9, 
   3.7148820424560337`*^9}, {3.715712432333237*^9, 3.7157124636770716`*^9}, {
   3.715713383015217*^9, 3.715713383858967*^9}, {3.715713463359124*^9, 
   3.715713467265382*^9}, {3.715715040315297*^9, 3.7157150468622227`*^9}, 
   3.7157150782528715`*^9, {3.7157152995501757`*^9, 3.7157153238940125`*^9}, 
   3.7157154168004107`*^9, {3.7157155132068825`*^9, 3.7157155339725485`*^9}, {
   3.715715590832035*^9, 3.715715603816439*^9}, 3.7157157965324593`*^9, {
   3.825007157157131*^9, 3.825007194024397*^9}, {3.8250072260371356`*^9, 
   3.825007250068356*^9}, {3.8250072900112967`*^9, 3.8250073013836217`*^9}, {
   3.8250074433354797`*^9, 3.8250074816391563`*^9}, {3.8250075503475633`*^9, 
   3.8250075574354987`*^9}},
 CellLabel->
  "In[3012]:=",ExpressionUUID->"7fe9d587-9bb5-43c7-b9c6-e09424755f9e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{
     RowBox[{"xrot", "[", "20", "]"}], ".", 
     RowBox[{"zrot", "[", "30", "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"WantArrowColor", "=", "True"}], ";", 
   RowBox[{"lengthAxis", "=", "1.2"}], ";", 
   RowBox[{"c", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
   RowBox[{"tkns", "=", ".008"}], ";", 
   RowBox[{"BBrad", "=", ".3"}], ";", 
   RowBox[{"ArrowScale", "=", ".25"}], ";", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Paxes", "[", 
      RowBox[{
      "True", ",", "True", ",", "True", ",", "u", ",", "c", ",", "lengthAxis",
        ",", "BBrad", ",", "ArrowScale", ",", "tkns", ",", "\"\<TriColor\>\"",
        ",", "ArrowColor"}], "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "u", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7108754544001923`*^9, 3.71087548307283*^9}, 
   3.710875547888542*^9, {3.710875625632994*^9, 3.7108756517924924`*^9}, {
   3.71087568574444*^9, 3.7108756886566067`*^9}, {3.710875924482112*^9, 
   3.710875950783614*^9}, 3.7108850241054087`*^9, {3.710885449207987*^9, 
   3.7108855285831556`*^9}, 3.7157160585485964`*^9, {3.740767875026726*^9, 
   3.7407678796829767`*^9}, {3.74225050490302*^9, 3.74225050948112*^9}, {
   3.74225354975469*^9, 3.742253552895356*^9}, {3.7440452247291107`*^9, 
   3.744045249275935*^9}},
 CellLabel->
  "In[3013]:=",ExpressionUUID->"d553a012-8a17-4a70-aa86-6d15822269ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Principal axes as lines, no arrows.", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.731945812149082*^9}},ExpressionUUID->"c792bbd9-bc8e-49b7-b2ca-\
c886b1c9e83a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalAxes", "[", 
    RowBox[{
    "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
     ",", "BBrad_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Thickness", "[", "tkns", "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"lines", ",", " ", 
        RowBox[{"no", " ", "arrows"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".01", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "lengthAxis"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".57", ",", "1", ",", "1"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "lengthAxis"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".15", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "lengthAxis"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504471849812714*^9, 3.5044718903327703`*^9}, {
   3.5044719323628283`*^9, 3.5044719941229134`*^9}, {3.5122275063263364`*^9, 
   3.5122275300227776`*^9}, {3.5122278033508544`*^9, 3.51222780634606*^9}, {
   3.512227916029851*^9, 3.51222798997398*^9}, {3.5122280516876874`*^9, 
   3.512228053700091*^9}, {3.512228085165346*^9, 3.5122281150705976`*^9}, {
   3.5123939753233414`*^9, 3.5123939753533416`*^9}, {3.5183042958838587`*^9, 
   3.518304332216322*^9}, {3.51830439414843*^9, 3.5183044095612564`*^9}, {
   3.522959570528062*^9, 3.522959584538081*^9}, {3.52295998940864*^9, 
   3.5229600030186586`*^9}, {3.5468753296470337`*^9, 
   3.5468753366358457`*^9}, {3.546875437568022*^9, 3.546875439268425*^9}, {
   3.546920669441621*^9, 3.5469206878652525`*^9}, {3.547069861331265*^9, 
   3.547069899816532*^9}, {3.5479172086508427`*^9, 3.547917209774045*^9}, {
   3.559264686152985*^9, 3.5592646885553894`*^9}, {3.5944937685858965`*^9, 
   3.594493777165909*^9}, {3.698767816765506*^9, 3.698767817358539*^9}, 
   3.6987687967186327`*^9, {3.698768832365678*^9, 3.6987688341737814`*^9}, 
   3.698777024974787*^9, {3.69877829283139*^9, 3.698778315407683*^9}, {
   3.7359402899442945`*^9, 3.7359403467568765`*^9}},
 CellLabel->
  "In[3014]:=",ExpressionUUID->"b615f9b9-8447-4173-a1d7-b02210414749"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Misc", "Subsubsection",
 CellChangeTimes->{{3.890060951285735*^9, 3.89006096360441*^9}, {
  3.8900646632339835`*^9, 3.890064697109466*^9}, {3.890064747735567*^9, 
  3.8900647588914742`*^9}, {3.8901807528034043`*^9, 3.89018078437807*^9}, {
  3.8905036241170216`*^9, 3.8905036269409432`*^9}, {3.8905036586702623`*^9, 
  3.8905036597531986`*^9}},ExpressionUUID->"2d37cac6-a1ee-4e47-8a49-\
03656d55fcc5"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Angle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
   RowBox[{"ArcTan", "[", 
    SqrtBox["2"], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8096530121857977`*^9, 3.809653095636608*^9}},
 CellLabel->
  "In[3015]:=",ExpressionUUID->"0ea9075e-1466-42a2-9942-3d9f13185586"]
}, Open  ]],

Cell["Bases for \[DoubleStruckCapitalM]", "Section",
 CellChangeTimes->{{3.891271359057156*^9, 3.8912713842724495`*^9}, 
   3.8912714407128105`*^9},ExpressionUUID->"3e34eae6-03e3-4270-8447-\
664bc273aa88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PHI", "=", 
    RowBox[{"{", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "0", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", "0"},
          {"0", "0", "1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", 
           FractionBox["1", 
            SqrtBox["2"]]},
          {"0", 
           FractionBox["1", 
            SqrtBox["2"]], "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", 
           FractionBox["1", 
            SqrtBox["2"]]},
          {"0", "0", "0"},
          {
           FractionBox["1", 
            SqrtBox["2"]], "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", 
           FractionBox["1", 
            SqrtBox["2"]], "0"},
          {
           FractionBox["1", 
            SqrtBox["2"]], "0", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Added", " ", "March", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SIG", "=", 
    RowBox[{"{", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "0", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", "0"},
          {"0", "0", "1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", "1"},
          {"0", "1", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "1"},
          {"0", "0", "0"},
          {"1", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "1", "0"},
          {"1", "0", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], "}"}]}], ";"}], 
  "       "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UPSILON", "=", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "1", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "0"},
          {"0", "0", "1"},
          {"0", "1", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "0", "1"},
          {"0", "0", "0"},
          {"1", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0", "1", "0"},
          {"1", "0", "0"},
          {"0", "0", "0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"basisBB", ",", "BB"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "1", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eqs", ".", " ", "3"}], " ", "of", " ", "the", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "2", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "0", 
       FractionBox["1", 
        SqrtBox["2"]]},
      {"0", "0", "0"},
      {
       FractionBox["1", 
        SqrtBox["2"]], "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "3", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {
       FractionBox["1", 
        SqrtBox["2"]], "0", "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "4", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}], "0", "0"},
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "5", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], ";", 
   RowBox[{
    RowBox[{"BB", "[", "5", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["6"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", 
         RowBox[{"-", "2"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "May", " ", "30"}], ",", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "6", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", "0"},
       {"0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";", 
   RowBox[{
    RowBox[{"BB", "[", "6", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["3"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "May", " ", "30"}], ",", " ", "2020"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"BB", "[", "5", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       FractionBox["1", 
        SqrtBox["6"]], 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", 
           RowBox[{"-", "2"}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       FractionBox["1", 
        SqrtBox["3"]], 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}]}], 
    ";", " ", 
    RowBox[{
     RowBox[{"BB", "[", "6", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "+", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
       FractionBox["1", 
        SqrtBox["6"]], 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", 
           RowBox[{"-", "2"}]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "+", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], 
       FractionBox["1", 
        SqrtBox["3"]], 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}]}], 
    ";"}], " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basisBB", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BB", "[", "1", "]"}], ",", 
      RowBox[{"BB", "[", "2", "]"}], ",", 
      RowBox[{"BB", "[", "3", "]"}], ",", 
      RowBox[{"BB", "[", "4", "]"}], ",", 
      RowBox[{"BB", "[", "5", "]"}], ",", 
      RowBox[{"BB", "[", "6", "]"}]}], "}"}]}], ";"}], "   "}]}], "Input",
 CellChangeTimes->{{3.938479202743009*^9, 3.9384792039615855`*^9}, {
  3.9384792384168477`*^9, 3.93847923968274*^9}, {3.9384793259213495`*^9, 
  3.938479327155575*^9}, {3.9384793622522087`*^9, 3.9384793635339537`*^9}, {
  3.938533345337144*^9, 3.938533350024481*^9}, {3.9385334512395253`*^9, 
  3.9385334532248545`*^9}, {3.938533540002449*^9, 3.938533542532996*^9}, {
  3.938533633218026*^9, 3.9385336345785313`*^9}, {3.9385336938084593`*^9, 
  3.938533695183666*^9}, {3.9385376322752185`*^9, 3.9385376337445884`*^9}, {
  3.9385376652088995`*^9, 3.938537667149568*^9}, {3.938537703969797*^9, 
  3.938537705221687*^9}, {3.938537798519554*^9, 3.9385377997403865`*^9}, {
  3.938538115664974*^9, 3.938538130796236*^9}, {3.938538188808611*^9, 
  3.938538232054196*^9}},
 CellLabel->
  "In[3016]:=",ExpressionUUID->"76ed97da-d514-46c4-a217-392631c2fd37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BasisName", "[", "UPSILON", "]"}], "=", 
   "\"\<\[CapitalUpsilon]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisName", "[", "SIG", "]"}], "=", "\"\<\[CapitalSigma]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisName", "[", "PHI", "]"}], "=", "\"\<\[CapitalPhi]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisName", "[", "basisBB", "]"}], "=", 
   "\"\<\!\(\*StyleBox[\"\[DoubleStruckCapitalB]\",FontSize->14]\)\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{3.9385382365693283`*^9},
 CellLabel->
  "In[3027]:=",ExpressionUUID->"ce2b15fc-7c25-48dc-8991-25702ee9d5e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalUpsilon]coords", "[", "matrix3x3_", "]"}], ":=", 
    RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
     RowBox[{"matrix3x3", ",", "UPSILON"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalSigma]coords", "[", "matrix3x3_", "]"}], ":=", 
    RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
     RowBox[{"matrix3x3", ",", "SIG"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]coords", "[", "matrix3x3_", "]"}], ":=", 
    RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
     RowBox[{"matrix3x3", ",", "PHI"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Bcoords", "[", "matrix3x3_", "]"}], ":=", 
    RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
     RowBox[{"matrix3x3", ",", "basisBB"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{3.938538239131222*^9},
 CellLabel->
  "In[3031]:=",ExpressionUUID->"432012bb-a525-43dc-99bd-deb7a3699092"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix3x3from\[CapitalUpsilon]coords", "[", "SixTuple_", "]"}], ":=", 
    RowBox[{"Matrix3x3fromBasisCoords", "[", 
     RowBox[{"SixTuple", ",", "UPSILON"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix3x3from\[CapitalSigma]coords", "[", "SixTuple_", "]"}], ":=", 
    RowBox[{"Matrix3x3fromBasisCoords", "[", 
     RowBox[{"SixTuple", ",", "SIG"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix3x3from\[CapitalPhi]coords", "[", "SixTuple_", "]"}], ":=", 
    RowBox[{"Matrix3x3fromBasisCoords", "[", 
     RowBox[{"SixTuple", ",", "PHI"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix3x3fromBcoords", "[", "SixTuple_", "]"}], ":=", 
   RowBox[{"Matrix3x3fromBasisCoords", "[", 
    RowBox[{"SixTuple", ",", "basisBB"}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Oct", " ", "2024"}], ";", " ", 
    RowBox[{
    "just", " ", "to", " ", "avoid", " ", "lots", " ", "of", " ", "changes", 
     " ", "elsewhere"}]}], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.93864683209581*^9, 3.9386468409854736`*^9}},
 CellLabel->
  "In[3035]:=",ExpressionUUID->"ce5a8221-4d15-4f0c-aeb8-4ad3c6eb7b9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix3x3fromBasisCoords", "[", 
     RowBox[{"SixTuple_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SixTuple", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"basis", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "6"}], "}"}]}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"used", " ", "to", " ", "be", " ", "MatrixFromBasisCoords"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
    RowBox[{"matrix3x3_", ",", "basis_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"BasisVectorsAreOrthogonal", "[", "basis", "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"InnerProductMatrix", "[", 
         RowBox[{"matrix3x3", ",", 
          FractionBox[
           RowBox[{"basis", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"NormMatrix", "[", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "2"]]}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "6"}], "}"}]}], "]"}], ",", "\"\<ERROR\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisInnerProd", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "basis_"}], "]"}], ":=", 
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{
     RowBox[{"basis", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"basis", "[", 
      RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisVectorsAreOrthogonal", "[", "basis_", "]"}], ":=", 
   RowBox[{"ForAllMine", "[", 
    RowBox[{
     RowBox[{"CartesianProduct", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", "6", "]"}], ",", 
        RowBox[{"Range", "[", "6", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "||", 
       RowBox[{
        RowBox[{"BasisInnerProd", "[", 
         RowBox[{"#", ",", "basis"}], "]"}], "==", "0"}]}], "&"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9368354027868834`*^9, 3.9368354051459775`*^9}, {
   3.936836066948736*^9, 3.9368360783537774`*^9}, {3.9379228944237356`*^9, 
   3.9379229262062798`*^9}, {3.937923085273768*^9, 3.9379231348110332`*^9}, {
   3.937926722540243*^9, 3.937926765323659*^9}, 3.9384737507534437`*^9, 
   3.9384737948937473`*^9, 3.9384740683999224`*^9, 3.938474268041644*^9},
 CellLabel->
  "In[3039]:=",ExpressionUUID->"0d99ee7c-54f3-49fc-ac59-9248e7366b6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SixtupleOfTs", "=", 
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2", ",", "t3", ",", "t4", ",", "t5", ",", "t6"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix3x3", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m1", "m6", "m5"},
      {"m6", "m2", "m4"},
      {"m5", "m4", "m3"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basis", "=", "SIG"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Basis is \>\"", ",", 
    RowBox[{"BasisName", "[", "basis", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
   RowBox[{
    RowBox[{"Matrix3x3fromBasisCoords", "[", 
     RowBox[{"SixtupleOfTs", ",", "basis"}], "]"}], ",", "basis"}], "]"}], "==",
   "SixtupleOfTs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix3x3fromBasisCoords", "[", 
   RowBox[{
    RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
     RowBox[{"matrix3x3", ",", "basis"}], "]"}], ",", "basis"}], "]"}], "==", 
  "matrix3x3"}]}], "Input",
 CellChangeTimes->{{3.806339821768931*^9, 3.8063398226979356`*^9}, {
   3.8063398678008013`*^9, 3.8063398699612007`*^9}, {3.8094786816006403`*^9, 
   3.80947880111825*^9}, {3.9367520903257055`*^9, 3.936752108651574*^9}, {
   3.9367521408843956`*^9, 3.936752172690422*^9}, {3.936752288358433*^9, 
   3.936752288936496*^9}, {3.9367524426671205`*^9, 3.936752443948451*^9}, {
   3.9367551405510454`*^9, 3.9367551801917677`*^9}, {3.93675522083625*^9, 
   3.9367553119979267`*^9}, {3.936755353556038*^9, 3.936755370835786*^9}, 
   3.9368010446690903`*^9, 3.936801372831601*^9, {3.9368014128731823`*^9, 
   3.936801477460049*^9}, {3.9368015830694575`*^9, 3.9368016204959555`*^9}, {
   3.9368016643996086`*^9, 3.936801729098673*^9}, 3.93680199281528*^9, {
   3.936802072949255*^9, 3.936802087651613*^9}, {3.936803704639126*^9, 
   3.9368037124076786`*^9}, 3.936831731706181*^9, {3.936832034149101*^9, 
   3.9368320415390263`*^9}, 3.936835321198797*^9, 3.936835457768692*^9, {
   3.936891092686557*^9, 3.9368910937177277`*^9}, {3.9368911475401*^9, 
   3.9368911484462547`*^9}, 3.9379232352066135`*^9, 3.937923317997578*^9, {
   3.9384736616502523`*^9, 3.938473671774214*^9}, {3.9384740947176514`*^9, 
   3.938474100298148*^9}, {3.938474322571162*^9, 3.93847432352415*^9}, {
   3.938474389227068*^9, 3.938474394024048*^9}, {3.938537858281492*^9, 
   3.938537895640482*^9}, 3.938537958154184*^9},
 CellLabel->
  "In[3043]:=",ExpressionUUID->"a601fbab-de3d-4f8a-ac7f-04ef9a3f69d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisAnalysis", "[", "basis_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Basis = \>\"", ",", 
      RowBox[{"BasisName", "[", "basis", "]"}], ",", "\"\< = \>\"", ",", 
      RowBox[{"MatrixForm", "/@", "basis"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(\>\"", ",", 
       RowBox[{"BasisName", "[", "basis", "]"}], ",", 
       "\"\<\[LeftDoubleBracket]i\[RightDoubleBracket]\[CenterDot]\>\"", ",", 
       RowBox[{"BasisName", "[", "basis", "]"}], ",", 
       "\"\<\[LeftDoubleBracket]j\[RightDoubleBracket]) = \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"InnerProductMatrix", "[", 
           RowBox[{
            RowBox[{"basis", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", 
            RowBox[{"basis", "[", 
             RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "6"}], "}"}]}], "]"}], "]"}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Are the \>\"", ",", 
       RowBox[{"BasisName", "[", "basis", "]"}], ",", 
       "\"\< basis elements pairwise orthogonal? \>\"", ",", 
       RowBox[{"BasisVectorsAreOrthogonal", "[", "basis", "]"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Coords", "=", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"matrix", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"m1", "m6", "m5"},
        {"m6", "m2", "m4"},
        {"m5", "m4", "m3"}
       }], "\[NoBreak]", ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Matrix from \>\"", ",", 
      RowBox[{"BasisName", "[", "basis", "]"}], ",", "\"\< coords \>\"", ",", 
      "Coords", ",", "\"\< is \>\"", ",", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Matrix3x3fromBasisCoords", "[", 
        RowBox[{"Coords", ",", "basis"}], "]"}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"BasisName", "[", "basis", "]"}], ",", "\"\< coords of \>\"", 
      ",", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Matrix3x3fromBasisCoords", "[", 
        RowBox[{"Coords", ",", "basis"}], "]"}], "]"}], ",", "\"\< are \>\"", 
      ",", 
      RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
       RowBox[{
        RowBox[{"Matrix3x3fromBasisCoords", "[", 
         RowBox[{"Coords", ",", "basis"}], "]"}], ",", "basis"}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"BasisName", "[", "basis", "]"}], ",", "\"\< coords of \>\"", 
      ",", 
      RowBox[{"MatrixForm", "[", "matrix3x3", "]"}], ",", "\"\< are \>\"", 
      ",", 
      RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
       RowBox[{"matrix3x3", ",", "basis"}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ColumnForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CoordsOf3x3matrixWRTbasis", "[", 
        RowBox[{"#", ",", "basis"}], "]"}], "&"}], "/@", "basis"}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.9368020276884136`*^9, 3.9368020556543217`*^9}, {
   3.936802092871321*^9, 3.936802106340849*^9}, {3.936802198243*^9, 
   3.9368023410766783`*^9}, {3.9368024495187397`*^9, 
   3.9368024965153494`*^9}, {3.9368025518428144`*^9, 
   3.9368025804627123`*^9}, {3.93680261152153*^9, 3.9368026221563826`*^9}, {
   3.9368027108085737`*^9, 3.93680275098682*^9}, {3.9368028014564314`*^9, 
   3.9368028159612083`*^9}, {3.9368029685734224`*^9, 
   3.9368030566606503`*^9}, {3.9368031167324686`*^9, 
   3.9368031675734043`*^9}, {3.9368032024767475`*^9, 3.936803213428589*^9}, {
   3.936803624952909*^9, 3.936803625905963*^9}, {3.9368036669288588`*^9, 
   3.9368036708659716`*^9}, {3.936803744603359*^9, 3.9368038422327404`*^9}, {
   3.9368040669770126`*^9, 3.9368040682581244`*^9}, {3.9368076653339334`*^9, 
   3.9368076864024053`*^9}, {3.936831839072514*^9, 3.936831872569418*^9}, {
   3.936832184167626*^9, 3.9368322989745226`*^9}, {3.936832331064745*^9, 
   3.9368323392983313`*^9}, {3.936834637573592*^9, 3.9368346676189814`*^9}, {
   3.9368347070684395`*^9, 3.9368347776596365`*^9}, 3.9368348323728247`*^9, {
   3.936834920912923*^9, 3.9368349444109464`*^9}, {3.9368351499999323`*^9, 
   3.936835178796879*^9}, {3.9368352282223763`*^9, 3.9368352404554605`*^9}, 
   3.936835643099081*^9, {3.9368380837948565`*^9, 3.9368381119918394`*^9}, {
   3.936838146514989*^9, 3.9368381511794157`*^9}, {3.9379232418438096`*^9, 
   3.937923244063123*^9}, {3.93819005356861*^9, 3.938190059823618*^9}, {
   3.93847368929383*^9, 3.938473702334338*^9}, {3.9384741584917216`*^9, 
   3.9384741601636333`*^9}},
 CellLabel->
  "In[3049]:=",ExpressionUUID->"e488ea37-5571-44ff-9c40-b665b0ee8428"],

Cell["The basis PHI", "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 
   3.794684828874474*^9}},ExpressionUUID->"dd48014b-7549-43f4-b6f6-\
8927d7dbc520"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Matrix3x3from\[CapitalPhi]coords used to be MatrixFromONcoords; see \
file AAcommonMomentTensorFns_2018-07-27_SAVE.nb.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BasisAnalysis", "[", "PHI", "]"}]}], "Input",
 CellChangeTimes->{{3.936835678580455*^9, 3.9368356880169296`*^9}, {
   3.936889283962455*^9, 3.9368893006003933`*^9}, {3.9368893562557096`*^9, 
   3.9368893778291445`*^9}, {3.9368895269906564`*^9, 3.936889539249151*^9}, {
   3.9368895736611753`*^9, 3.936889588911113*^9}, {3.936889626233445*^9, 
   3.936889746139569*^9}, {3.936907017673685*^9, 3.936907133704217*^9}, 
   3.937923279380011*^9, 3.937923455422411*^9, 3.9379236351906614`*^9, 
   3.9384737170642433`*^9, {3.938474180145894*^9, 3.938474180817515*^9}, {
   3.9384791097373357`*^9, 3.938479113191087*^9}, {3.9385087900332575`*^9, 
   3.938508794837741*^9}, 3.9385088876086164`*^9, 3.9385334430642967`*^9, {
   3.9385376200870004`*^9, 3.9385376221023645`*^9}},
 CellLabel->
  "In[3050]:=",ExpressionUUID->"2148e89d-1fbd-4476-bbdd-1c97e2280827"],

Cell["The basis SIG.  (Used to be SkewCoords.)", "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 3.794684828874474*^9}, {3.806339797064885*^9, 
   3.8063397985369205`*^9}, {3.9383696208214316`*^9, 
   3.9383696515846972`*^9}},ExpressionUUID->"d53e857d-a0bb-498d-9417-\
5ae0858b6cc4"],

Cell[BoxData[
 RowBox[{"BasisAnalysis", "[", "SIG", "]"}]], "Input",
 CellChangeTimes->{{3.9368077100030737`*^9, 3.9368077112375517`*^9}, {
   3.936835329807231*^9, 3.936835356243685*^9}, {3.936889793588727*^9, 
   3.936889818215957*^9}, 3.9379232818999996`*^9, 3.9379234915516205`*^9, 
   3.9383696542408333`*^9, 3.9384737271046686`*^9, {3.938474191941589*^9, 
   3.93847419322258*^9}, {3.9384791831467457`*^9, 3.938479185896494*^9}, {
   3.938508263679431*^9, 3.93850828582898*^9}, 3.938533605968514*^9, 
   3.9385376960682516`*^9, {3.938538022089698*^9, 3.9385380225116034`*^9}},
 CellLabel->
  "In[3052]:=",ExpressionUUID->"51e43bc0-576e-4016-a5a2-28da4c938d33"],

Cell["The basis UPSILON", "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 3.794684828874474*^9}, {3.806339797064885*^9, 
   3.8063397985369205`*^9}, {3.8063398400729437`*^9, 
   3.80633984421693*^9}},ExpressionUUID->"a76a64c5-9e99-43d4-9e8f-\
14c80d8336e2"],

Cell[BoxData[
 RowBox[{"BasisAnalysis", "[", "UPSILON", "]"}]], "Input",
 CellChangeTimes->{{3.9368077518019476`*^9, 3.936807800092454*^9}, 
   3.936830894684266*^9, {3.936889847494671*^9, 3.936889851244424*^9}, 
   3.9368899012865057`*^9, {3.9368900510953283`*^9, 3.9368900632820735`*^9}, 
   3.9379232836864023`*^9, 3.937923500787054*^9, 3.938473733933612*^9, {
   3.9384741967845936`*^9, 3.9384741973468633`*^9}, {3.938479227604554*^9, 
   3.938479229416833*^9}, {3.9385081113226433`*^9, 3.938508116987282*^9}, 
   3.938533675824847*^9, {3.9385376509327917`*^9, 3.9385376544979324`*^9}},
 CellLabel->
  "In[3053]:=",ExpressionUUID->"3295499c-3608-4464-9092-1fc180cc0c82"],

Cell[CellGroupData[{

Cell["The basis \[DoubleStruckCapitalB]", "Section",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.7946848091634655`*^9, 
   3.794684814362468*^9}},ExpressionUUID->"fbc91086-0fe9-41da-a16a-\
35f42ac68b2d"],

Cell[BoxData[
 RowBox[{"BasisAnalysis", "[", "basisBB", "]"}]], "Input",
 CellChangeTimes->{{3.792971206733848*^9, 3.7929713022003465`*^9}, {
   3.792971408071004*^9, 3.792971440387087*^9}, {3.792971498549478*^9, 
   3.792971499440118*^9}, 3.792972692948264*^9, {3.7929727241080465`*^9, 
   3.7929727262955894`*^9}, {3.792972763426332*^9, 3.7929727864596667`*^9}, {
   3.793302127686242*^9, 3.793302210883026*^9}, {3.793452169745813*^9, 
   3.793452205234699*^9}, {3.7934534711802993`*^9, 3.793453503105508*^9}, {
   3.7934875097186317`*^9, 3.7934875184076557`*^9}, {3.7940628516347594`*^9, 
   3.794062915122757*^9}, 3.7940668797157593`*^9, {3.794303579755892*^9, 
   3.794303673207573*^9}, 3.7946837182844687`*^9, {3.794683831532472*^9, 
   3.7946838327474766`*^9}, {3.795368427569252*^9, 3.795368457449376*^9}, {
   3.7954159482798815`*^9, 3.7954159499048824`*^9}, {3.7998533351296206`*^9, 
   3.7998534017979136`*^9}, {3.7998594859163437`*^9, 
   3.7998594916854353`*^9}, {3.7998596087056255`*^9, 
   3.7998596116364765`*^9}, {3.7999471922765937`*^9, 
   3.7999472010435143`*^9}, {3.799947251311059*^9, 3.7999472826775537`*^9}, {
   3.7999474305174685`*^9, 3.79994753957263*^9}, {3.7999477903421464`*^9, 
   3.7999478574073067`*^9}, {3.8303041767764983`*^9, 3.83030423992684*^9}, {
   3.8303043151804295`*^9, 3.8303043233750134`*^9}, {3.9368310725631824`*^9, 
   3.9368311145621977`*^9}, {3.9368312353798733`*^9, 
   3.9368312433951297`*^9}, {3.936890108701807*^9, 3.936890126762275*^9}, {
   3.9368901606180525`*^9, 3.9368901854123816`*^9}, 3.9379232857363005`*^9, 
   3.937923505078833*^9, 3.938473741735504*^9, {3.9384742103766484`*^9, 
   3.9384742113763466`*^9}, {3.938479318185652*^9, 3.938479344812746*^9}, {
   3.9385070053049955`*^9, 3.9385070130107107`*^9}, 3.9385335131710167`*^9, 
   3.938537784628649*^9, {3.938538385115758*^9, 3.938538385553322*^9}},
 CellLabel->
  "In[3054]:=",ExpressionUUID->"46a2ebc9-0228-4d4c-8c56-8399d41cb10c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixRep6x6wrtON", "[", 
     RowBox[{"L_", ",", "OrthonormalBasis_"}], "]"}], ":=", "  ", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"OrthonormalBasis", "[", 
          RowBox[{"[", "jj", "]"}], "]"}], "]"}], ",", 
        RowBox[{"OrthonormalBasis", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "6", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", "arbitrary", " ", 
     "linear", " ", "transformation", " ", "of", " ", 
     StyleBox["\[DoubleStruckCapitalM]",
      FontSize->14], " ", "wrt", " ", "an", " ", "arbitrary", " ", 
     "ORTHONORMAL", " ", 
     RowBox[{"basis", 
      StyleBox[".",
       FontFamily->"Courier New",
       FontSize->16]}]}],
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9054541569908037`*^9, 3.905454199643653*^9}, {
   3.9054542432497015`*^9, 3.9054542509236183`*^9}, {3.9054543036118217`*^9, 
   3.905454374075982*^9}, {3.905454573164611*^9, 3.9054545831178226`*^9}, {
   3.905549151119404*^9, 3.905549151646422*^9}, 3.9381056601247787`*^9},
 CellLabel->
  "In[3055]:=",ExpressionUUID->"abe0271b-0f60-4be6-93fc-0ccf29911f6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixRep6x6wrtBB", "[", "L_", "]"}], ":=", "  ", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "jj", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "ii", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "6", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", "arbitrary", " ", 
     "linear", " ", "transformation", " ", "L", " ", "of", " ", 
     StyleBox["\[DoubleStruckCapitalM]",
      FontSize->14], " ", "wrt", " ", 
     RowBox[{"BB", ".", " ", "Used"}], " ", "to", " ", "be", " ", 
     RowBox[{"MatrixOfLwrtBB", 
      StyleBox[".",
       FontFamily->"Courier New",
       FontSize->16]}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontFamily->"Courier New",
    FontSize->16], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9054541569908037`*^9, 3.905454199643653*^9}, {
   3.9054542432497015`*^9, 3.9054542509236183`*^9}, {3.9054543036118217`*^9, 
   3.905454374075982*^9}, {3.905454573164611*^9, 3.9054545831178226`*^9}, {
   3.905538159109384*^9, 3.905538227137513*^9}, {3.9055382615747943`*^9, 
   3.9055383032917795`*^9}, {3.905549132575621*^9, 3.9055491402381487`*^9}, {
   3.9379241381555915`*^9, 3.937924172171902*^9}, 3.937924273122218*^9, 
   3.938105542756998*^9},
 CellLabel->
  "In[3056]:=",ExpressionUUID->"bc6b4512-e875-4057-8803-105bd3f48744"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixRep6x6wrtBB", "[", "L", "]"}], "==", 
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "1", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "1", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "2", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "1", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "3", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "1", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "4", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "1", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "5", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "1", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "6", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "1", "]"}]}], "]"}]},
     {
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "1", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "2", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "2", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "2", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "3", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "2", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "4", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "2", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "5", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "2", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "6", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "2", "]"}]}], "]"}]},
     {
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "1", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "3", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "2", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "3", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "3", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "3", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "4", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "3", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "5", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "3", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "6", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "3", "]"}]}], "]"}]},
     {
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "1", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "4", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "2", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "4", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "3", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "4", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "4", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "4", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "5", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "4", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "6", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "4", "]"}]}], "]"}]},
     {
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "1", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "5", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "2", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "5", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "3", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "5", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "4", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "5", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "5", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "5", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "6", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "5", "]"}]}], "]"}]},
     {
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "1", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "6", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "2", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "6", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "3", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "6", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "4", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "6", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "5", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "6", "]"}]}], "]"}], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "6", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "6", "]"}]}], "]"}]}
    }], "\[NoBreak]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixRep6x6wrtBB", "[", "L", "]"}], "==", 
  RowBox[{"MatrixRep6x6wrtON", "[", 
   RowBox[{"L", ",", "basisBB"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9055489169821434`*^9, 3.9055491110077467`*^9}, 
   3.9379242684969444`*^9, {3.9379243024341583`*^9, 3.937924315215464*^9}, 
   3.938105562171355*^9, {3.9381076667700834`*^9, 3.938107667928094*^9}},
 CellLabel->
  "In[3057]:=",ExpressionUUID->"c1d934b2-12d0-4a28-906f-a460f548d299"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixRep6x6wrt\[CapitalPhi]\[CapitalPhi]", "[", "L_", "]"}], ":=", 
   RowBox[{"MatrixRep6x6wrtON", "[", 
    RowBox[{"L", ",", "PHI"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.938107759643248*^9, 3.93810777984397*^9}, {
   3.938107838618681*^9, 3.9381078548200474`*^9}, 3.9385093341593795`*^9},
 CellLabel->
  "In[3059]:=",ExpressionUUID->"0ad09230-a17c-4a21-a8b8-266807a928c1"],

Cell[CellGroupData[{

Cell[TextData[{
 "About",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SubscriptBox["I", 
     RowBox[{"basis2", ",", " ", "basis1"}]]}], TraditionalForm]],
  ExpressionUUID->"afbe8088-a89a-4a74-b245-aae537bb518d"]
}], "Section",
 CellChangeTimes->{{3.787197726442168*^9, 3.787197770686696*^9}, {
   3.795401347998807*^9, 3.795401349373804*^9}, {3.795401395854579*^9, 
   3.795401396917082*^9}, {3.8103239795180693`*^9, 3.810323986236885*^9}, 
   3.8228372108987193`*^9, {3.8303049300878143`*^9, 3.8303049392078156`*^9}, {
   3.830304980037236*^9, 3.830304986020372*^9}, {3.859817796177543*^9, 
   3.8598178007004504`*^9}, {3.867366385422104*^9, 3.8673664433153315`*^9}, 
   3.867371580977296*^9},ExpressionUUID->"cec9ed71-2ae3-4c98-af0d-\
3c82e9eeabfc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatIsubCAbasisCisON", "[", 
     RowBox[{"C_", ",", "A_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", "jj", "]"}], "]"}], ",", 
        RowBox[{"C", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"WATCH", " ", 
     RowBox[{"ORDER", "!"}], " ", "The", " ", "matrix", " ", "takes", " ", 
     "A", " ", "coords", " ", "to", " ", "C", " ", "coords"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatIsubBA", "[", "A_", "]"}], ":=", 
   RowBox[{"MatIsubCAbasisCisON", "[", 
    RowBox[{"basisBB", ",", "A"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795366787317892*^9, 3.7953667943027153`*^9}, {
   3.795366833447504*^9, 3.795366939628875*^9}, {3.7953673232631545`*^9, 
   3.795367324122529*^9}, {3.795919663676679*^9, 3.795919670739746*^9}, {
   3.802450546075781*^9, 3.8024506182744646`*^9}, {3.803754326680868*^9, 
   3.8037543353577757`*^9}, 3.8228366196756544`*^9, 3.822838989604717*^9, {
   3.822840724552447*^9, 3.8228407372844496`*^9}, 3.822841698660452*^9, {
   3.8228417817634478`*^9, 3.822841872708436*^9}, {3.8228419410124397`*^9, 
   3.822842021445455*^9}, {3.830312227032202*^9, 3.830312229200873*^9}, {
   3.8673666779686127`*^9, 3.867366692313542*^9}},
 CellLabel->
  "In[3060]:=",ExpressionUUID->"d9acef4f-2ad8-4133-9a1b-971805d1e7d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"CC", ",", "AA"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"CC", ",", "AA"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8672205594402385`*^9, 3.8672206241220703`*^9}},
 CellLabel->
  "In[3062]:=",ExpressionUUID->"9e8807b2-199e-4b35-bc77-b0af214703c9"],

Cell[CellGroupData[{

Cell["About \[DoubleStruckCapitalB] and PHI", "Subsubsection",
 CellChangeTimes->{{3.867285596562114*^9, 
  3.8672856476990128`*^9}},ExpressionUUID->"0cb2f32c-dc03-4541-ac48-\
87a82522382a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsubB\[CapitalPhi]", "=", 
   RowBox[{"MatIsubBA", "[", "PHI", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalPhi]B", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Inverse", "[", "MatIsubB\[CapitalPhi]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalPhi]\)]\)\>\"", ",", "20"}], 
     "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsubB\[CapitalPhi]", "]"}], ",", 
    "\"\< = \!\(\*FractionBox[\(\(1\)\(\\\ \)\), SqrtBox[\(6\)]]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       SqrtBox["6"], "MatIsubB\[CapitalPhi]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalPhi]\[CapitalBeta]\)]\)\>\"", 
      ",", "20"}], "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsub\[CapitalPhi]B", "]"}], ",", 
    "\"\< = \!\(\*FractionBox[\(\(1\)\(\\\ \)\), SqrtBox[\(6\)]]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       SqrtBox["6"], "MatIsub\[CapitalPhi]B"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsubB\[CapitalPhi]", ".", 
      RowBox[{"Transpose", "[", "MatIsubB\[CapitalPhi]", "]"}]}], "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalPhi]\)]\)\>\"", ",", "20"}],
        "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalPhi]\)]\)\>\"", ",", "20"}],
        "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"basisBB", ",", "PHI"}], "]"}], "==", 
  "MatIsubB\[CapitalPhi]"}]}], "Input",
 CellChangeTimes->{{3.8674238775364203`*^9, 3.8674239012806163`*^9}, {
   3.867423966045786*^9, 3.8674239669779453`*^9}, {3.8675048395136385`*^9, 
   3.867504864822561*^9}, {3.86750499042251*^9, 3.8675049931585855`*^9}, 
   3.8675052805497017`*^9, {3.8675053367256155`*^9, 3.8675053496876936`*^9}, {
   3.867505898359041*^9, 3.8675059222292833`*^9}, {3.867537677814142*^9, 
   3.8675376813118553`*^9}, {3.8689909196809654`*^9, 3.868990983958818*^9}, {
   3.8689910155002775`*^9, 3.868991036874382*^9}, 3.868991085459549*^9},
 CellLabel->
  "In[3064]:=",ExpressionUUID->"0c0ac51a-a676-48c9-842a-596c46257f10"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   StyleBox[
    SqrtBox["6"],
    FontColor->RGBColor[1, 0, 0]], "MatIsub\[CapitalPhi]B"}], "]"}]], "Input",
 CellChangeTimes->{{3.86753761950867*^9, 3.867537686934974*^9}, 
   3.867537763024304*^9},
 CellLabel->
  "In[3070]:=",ExpressionUUID->"8ec4bac9-9939-44d6-b95a-31fe8e55b5b1"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{"basisBB", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"PHI", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det B vs PHI = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Det", "[", "%", "]"}], ",", "16", ",", "Bold"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7998539003260736`*^9, 3.799853907962598*^9}, {
  3.8675377480491495`*^9, 3.8675377584917784`*^9}},
 CellLabel->
  "In[3071]:=",ExpressionUUID->"32c25af3-dab8-44d8-a5ef-fa0cc4ed1c44"]
}, Open  ]],

Cell[CellGroupData[{

Cell["About \[DoubleStruckCapitalB] and UPSILON", "Subsubsection",
 CellChangeTimes->{{3.867285596562114*^9, 3.8672856476990128`*^9}, {
  3.867285756906685*^9, 
  3.867285760775693*^9}},ExpressionUUID->"d42709bc-4616-456e-a660-\
aace75bb1ec7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatIsubBA", "[", "UPSILON", "]"}], "==", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{
      RowBox[{"UPSILON", "[", 
       RowBox[{"[", "jj", "]"}], "]"}], ",", 
      RowBox[{"basisBB", "[", 
       RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[3073]:=",ExpressionUUID->"16912d60-c00d-41f9-9e0d-260efe533b0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsubB\[CapitalUpsilon]", "=", 
   RowBox[{"MatIsubBA", "[", "UPSILON", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalUpsilon]\)]\)\>\"", ",", 
      "20"}], "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsubB\[CapitalUpsilon]", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsubB\[CapitalUpsilon]", ".", 
      RowBox[{"Transpose", "[", "MatIsubB\[CapitalUpsilon]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalUpsilon]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalUpsilon]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalUpsilon]B", "=", 
   RowBox[{"Inverse", "[", "MatIsubB\[CapitalUpsilon]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"UPSILON", ",", "basisBB"}], "]"}], "==", 
  "MatIsub\[CapitalUpsilon]B"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367560925995*^9, 
   3.867367563097133*^9}, {3.8673677650840683`*^9, 3.867367828773975*^9}},
 CellLabel->
  "In[3074]:=",ExpressionUUID->"9ba8539d-96cd-4718-8cb6-2aa282c2570c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["About \[DoubleStruckCapitalB] and SIG", "Subsubsection",
 CellChangeTimes->{{3.867285596562114*^9, 3.8672856476990128`*^9}, {
  3.867285756906685*^9, 3.867285760775693*^9}, {3.867286937694174*^9, 
  3.8672869391817236`*^9}},ExpressionUUID->"e75384d0-529a-4ede-9f98-\
37ce2e3a81fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatIsubB\[CapitalSigma]", "=", 
   RowBox[{"MatIsubBA", "[", "SIG", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalSigma]\)]\)\>\"", ",", "20"}],
      "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsubB\[CapitalSigma]", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsubB\[CapitalSigma]", ".", 
      RowBox[{"Transpose", "[", "MatIsubB\[CapitalSigma]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalSigma]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(B\[CapitalSigma]\)]\)\>\"", ",", 
        "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsub\[CapitalSigma]B", "=", 
   RowBox[{"Inverse", "[", "MatIsubB\[CapitalSigma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatIsubCAbasisCisON", "[", 
   RowBox[{"SIG", ",", "basisBB"}], "]"}], "==", 
  "MatIsub\[CapitalSigma]B"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367426452508*^9, 
   3.8673674302558823`*^9}, {3.8673674854886894`*^9, 3.867367507069461*^9}, {
   3.8673675765083055`*^9, 3.867367577314044*^9}, {3.8673676634915085`*^9, 
   3.8673677143245993`*^9}},
 CellLabel->
  "In[3079]:=",ExpressionUUID->"ad5e7803-5779-4a27-b407-8b09657db841"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalSigma]\[CapitalPhi]\)]\)\>\"", 
      ",", "20"}], "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "MatIsub\[CapitalSigma]\[CapitalPhi]", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsub\[CapitalSigma]\[CapitalPhi]", ".", 
      RowBox[{
      "Transpose", "[", "MatIsub\[CapitalSigma]\[CapitalPhi]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \
\(\[CapitalSigma]\[CapitalPhi]\)]\)\>\"", ",", "20"}], "]"}], " ", ",", 
      "\"\< is orthogonal\>\""}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \
\(\[CapitalSigma]\[CapitalPhi]\)]\)\>\"", ",", "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367560925995*^9, 
   3.867367563097133*^9}, {3.8673677650840683`*^9, 3.867367828773975*^9}, {
   3.8673695037197523`*^9, 3.8673696463256173`*^9}},
 CellLabel->
  "In[3084]:=",ExpressionUUID->"077b904a-2520-48d4-8831-1e4b0c2254fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \
\(\[CapitalPhi]\[CapitalUpsilon]\)]\)\>\"", ",", "20"}], "]"}], ",", 
    "\"\< = \>\"", ",", 
    RowBox[{
    "MatrixForm", "[", "MatIsub\[CapitalPhi]\[CapitalUpsilon]", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatIsub\[CapitalPhi]\[CapitalUpsilon]", ".", 
      RowBox[{
      "Transpose", "[", "MatIsub\[CapitalPhi]\[CapitalUpsilon]", "]"}]}], 
     "\[Equal]", 
     RowBox[{"IdentityMatrix", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalPhi]\[CapitalUpsilon]\)]\)\>\
\"", ",", "20"}], "]"}], " ", ",", "\"\< is orthogonal\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(I\), \(\[CapitalPhi]\[CapitalUpsilon]\)]\)\>\
\"", ",", "20"}], "]"}], " ", ",", 
      "\"\< is \!\(\*StyleBox[\"NOT\",FontColor->RGBColor[1, 0, 0]]\) \
orthogonal\>\""}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8223370219553375`*^9, 3.822337048790354*^9}, {
   3.8223371790501204`*^9, 3.8223372615796795`*^9}, {3.822337416566486*^9, 
   3.8223374508078156`*^9}, {3.8228366230756655`*^9, 3.82283662437967*^9}, {
   3.82283768795273*^9, 3.8228376886047297`*^9}, {3.8228416733004513`*^9, 
   3.822841673860448*^9}, {3.822842064132448*^9, 3.8228420678594475`*^9}, {
   3.8228421059264417`*^9, 3.8228421242754536`*^9}, {3.8228421582354364`*^9, 
   3.822842182124468*^9}, {3.8228422373074694`*^9, 3.8228422408434763`*^9}, {
   3.822842528467477*^9, 3.8228425768484726`*^9}, {3.867219913851116*^9, 
   3.867219932989612*^9}, {3.8672200144461913`*^9, 3.867220044781727*^9}, 
   3.8672857889040937`*^9, {3.867285831755039*^9, 3.8672859488765697`*^9}, {
   3.867286127856537*^9, 3.867286130099129*^9}, {3.867286182835456*^9, 
   3.867286184637553*^9}, {3.8672862484758034`*^9, 3.8672862535416756`*^9}, {
   3.8673668574361453`*^9, 3.8673670522289762`*^9}, {3.8673671446783004`*^9, 
   3.867367262175789*^9}, {3.8673673043185205`*^9, 3.867367310094583*^9}, {
   3.867367356841792*^9, 3.8673673609974427`*^9}, {3.867367560925995*^9, 
   3.867367563097133*^9}, {3.8673677650840683`*^9, 3.867367828773975*^9}, {
   3.8673695037197523`*^9, 3.8673696463256173`*^9}, {3.867369730599429*^9, 
   3.867369772408881*^9}, {3.8675088656287785`*^9, 3.8675088780365252`*^9}, 
   3.8675089224212227`*^9},
 CellLabel->
  "In[3086]:=",ExpressionUUID->"298bfd05-7152-4a55-a624-c3cda0b80b04"],

Cell[BoxData[{
 RowBox[{"MatIsub\[CapitalSigma]\[CapitalPhi]", "==", 
  "MatIsub\[CapitalPhi]\[CapitalUpsilon]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]coords", "[", 
   RowBox[{"Matrix3x3from\[CapitalPhi]coords", "[", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "}"}], "]"}], "]"}], "==", 
  RowBox[{"\[CapitalPhi]coords", "[", 
   RowBox[{"Matrix3x3from\[CapitalUpsilon]coords", "[", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "}"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.867370665212576*^9, 3.867370667602152*^9}, 
   3.8673707182018137`*^9, {3.8674224710242405`*^9, 3.8674224806918745`*^9}, {
   3.9379235264314575`*^9, 3.9379235341417885`*^9}, 3.9385081233520036`*^9, 
   3.9385082662553587`*^9, {3.938508840268605*^9, 3.938508842076245*^9}},
 CellLabel->
  "In[3088]:=",ExpressionUUID->"e07777d1-6c6b-4192-8d27-d6341a2cacd3"],

Cell[CellGroupData[{

Cell[TextData[{
 "Cmat is the Voigt matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"[", "T", "]"}], "\[CapitalSigma]\[CapitalUpsilon]"], 
   TraditionalForm]],ExpressionUUID->"1d50f1b1-d553-4d60-8d6a-adb47a62e8bb"]
}], "Section",
 CellChangeTimes->{{3.867286754560062*^9, 
  3.8672868398618746`*^9}},ExpressionUUID->"b345cf33-615b-41d4-85fa-\
227e4a4e5a1c"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Dmat", ".", "DummyMatrixSYM6x6", ".", "Dmat"}], "]"}]], "Input",
 CellChangeTimes->{{3.8024510451592445`*^9, 3.802451082315242*^9}, {
  3.8024511488112445`*^9, 3.8024511606672454`*^9}},
 CellLabel->
  "In[3090]:=",ExpressionUUID->"b21aaec9-5953-4f11-9959-a2a8628d8c64"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
   "MatIsub\[CapitalPhi]\[CapitalSigma]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalUpsilon]\[CapitalPhi]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8675054826094866`*^9, 3.867505528901866*^9}, {
   3.867505576450199*^9, 3.867505635786346*^9}, 3.8675059482551575`*^9, {
   3.8675064870282907`*^9, 3.867506504506162*^9}, {3.867506591525571*^9, 
   3.8675066040396967`*^9}, 3.8793839000463696`*^9, 3.8795209510822954`*^9},
 CellLabel->
  "In[3091]:=",ExpressionUUID->"e5a0d4a5-ad63-43fc-949d-e6099e5a7c0a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PHImatOfCmat", "[", "Cmat_", "]"}], ":=", 
    RowBox[{"Dmat", ".", "Cmat", ".", "Dmat"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["converts",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["Voigt",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["matrix",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["PHI",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"rep", ".", "  ", "Used"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["be",
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox["TmatPHIofCmat",
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CmatOfPHImat", "[", "PHImat_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", "Dmat", "]"}], ".", "PHImat", ".", 
     RowBox[{"Inverse", "[", "Dmat", "]"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"CmatOfTmatPHI", ".", " ", "PHImat"}], " ", "is", " ", "matrix", 
     " ", "of", " ", "T", " ", "wrt", " ", 
     RowBox[{"PHI", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TmatOfPHImat", "[", "PHImat_", "]"}], ":=", 
    RowBox[{
    "MatIsubB\[CapitalPhi]", ".", "PHImat", ".", "MatIsub\[CapitalPhi]B"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"TmatOfTmatPHI", ".", " ", "Converts"}], " ", "PHI", " ", "rep", 
     " ", "to", " ", "BB", " ", 
     RowBox[{"rep", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PHImatOfTmat", "[", "Tmat_", "]"}], "  ", ":=", 
    RowBox[{
    "MatIsub\[CapitalPhi]B", ".", "Tmat", ".", "MatIsubB\[CapitalPhi]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["Used",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["be",
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox[
     RowBox[{"TmatPHIofTmat", ".", " ", "Converts"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["BB",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["rep",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["PHI",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"rep", "."}],
     FontColor->RGBColor[1, 0, 0]]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TmatOfCmat", "[", "Cmat_", "]"}], ":=", "   ", 
    RowBox[{"TmatOfPHImat", "[", 
     RowBox[{"PHImatOfCmat", "[", "Cmat", "]"}], "]"}]}], " ", ";"}], 
  "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "Matrix", " ", "of", " ", "T", " ", "WITH", " ", "RESPECT", " ", "TO", 
      " ", "BB"}], ",", " ", 
     RowBox[{"not", " ", "PHI"}], ",", " ", 
     RowBox[{"as", " ", "of", " ", "April", " ", "2020"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmatOfTmat", "[", "Tmat_", "]"}], ":=", " ", 
   RowBox[{"CmatOfPHImat", "[", 
    RowBox[{"PHImatOfTmat", "[", "Tmat", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7953750044632454`*^9, 3.7953751328030357`*^9}, {
   3.7953889720337257`*^9, 3.7953889918172436`*^9}, {3.795389551262293*^9, 
   3.7953895524966764`*^9}, {3.795879415234042*^9, 3.795879435815293*^9}, 
   3.7958796612479677`*^9, {3.7958798492137775`*^9, 3.7958800140518255`*^9}, {
   3.7958996800892086`*^9, 3.795899704625201*^9}, {3.7958998731522045`*^9, 
   3.7958998747615805`*^9}, {3.7958999602850904`*^9, 
   3.7958999605194187`*^9}, {3.7959001336718845`*^9, 3.79590014014124*^9}, {
   3.795919502805686*^9, 3.795919534827535*^9}, {3.7959195650670433`*^9, 
   3.795919608042267*^9}, 3.7959199546424837`*^9, {3.795919990866382*^9, 
   3.7959199993669405`*^9}, {3.8005595408933063`*^9, 
   3.8005595416892996`*^9}, {3.802450569649781*^9, 3.8024505717617846`*^9}, {
   3.8024506113074613`*^9, 3.8024506138574615`*^9}, {3.8037544161090603`*^9, 
   3.8037544266315613`*^9}, {3.8225180564271407`*^9, 
   3.8225181226001234`*^9}, {3.822842177358448*^9, 3.8228421781044416`*^9}, {
   3.822842233556468*^9, 3.8228422353484793`*^9}, {3.867422569097678*^9, 
   3.8674225807551503`*^9}, {3.8674226529587946`*^9, 
   3.8674226956101046`*^9}, {3.867422741880661*^9, 3.867422771961698*^9}, {
   3.8674228099623847`*^9, 3.8674228559558897`*^9}, {3.8674229107406983`*^9, 
   3.8674229213865747`*^9}, {3.8674229614734364`*^9, 3.867422984702016*^9}, {
   3.8674230258095217`*^9, 3.867423147585737*^9}, {3.9284296393510723`*^9, 
   3.928429658277397*^9}},
 CellLabel->
  "In[3092]:=",ExpressionUUID->"f9a45f13-729d-4179-9bf3-1c89496710d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"TmatOfCmat", "[", "BlankSlate", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9206593707850723`*^9, 3.9206594004554567`*^9}, {
  3.920659447180769*^9, 3.92065945242286*^9}, {3.920659501362877*^9, 
  3.9206595024452815`*^9}},
 CellLabel->
  "In[3098]:=",ExpressionUUID->"9f53e9f9-ba8d-41bf-979e-5c5a273dc2e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TmatOfCmatExplicit", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a_", "g_", "m_", "q_", "t_", "v_"},
       {"gdum_", "b_", "h_", "n_", "r_", "u_"},
       {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
       {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
       {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
       {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}], ":=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"2", " ", "d"}], 
       RowBox[{"2", " ", "j"}], 
       RowBox[{"2", " ", "p"}], 
       RowBox[{"n", "-", "q"}], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "i"}], "+", "n", "+", "q"}], 
        SqrtBox["3"]], 
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        RowBox[{"(", 
         RowBox[{"i", "+", "n", "+", "q"}], ")"}]}]},
      {
       RowBox[{"2", " ", "j"}], 
       RowBox[{"2", " ", "e"}], 
       RowBox[{"2", " ", "k"}], 
       RowBox[{"r", "-", "t"}], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "o"}], "+", "r", "+", "t"}], 
        SqrtBox["3"]], 
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        RowBox[{"(", 
         RowBox[{"o", "+", "r", "+", "t"}], ")"}]}]},
      {
       RowBox[{"2", " ", "p"}], 
       RowBox[{"2", " ", "k"}], 
       RowBox[{"2", " ", "f"}], 
       RowBox[{"u", "-", "v"}], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "s"}], "+", "u", "+", "v"}], 
        SqrtBox["3"]], 
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        RowBox[{"(", 
         RowBox[{"s", "+", "u", "+", "v"}], ")"}]}]},
      {
       RowBox[{"n", "-", "q"}], 
       RowBox[{"r", "-", "t"}], 
       RowBox[{"u", "-", "v"}], 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "-", 
          RowBox[{"2", " ", "g"}]}], ")"}]}], 
       FractionBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", "b", "-", 
         RowBox[{"2", " ", "h"}], "+", 
         RowBox[{"2", " ", "m"}]}], 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]], 
       FractionBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", "b", "+", "h", "-", "m"}], 
        SqrtBox["6"]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "i"}], "+", "n", "+", "q"}], 
        SqrtBox["3"]], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "o"}], "+", "r", "+", "t"}], 
        SqrtBox["3"]], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "s"}], "+", "u", "+", "v"}], 
        SqrtBox["3"]], 
       FractionBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", "b", "-", 
         RowBox[{"2", " ", "h"}], "+", 
         RowBox[{"2", " ", "m"}]}], 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]], 
       RowBox[{
        FractionBox["1", "6"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", 
          RowBox[{"4", " ", "c"}], "+", 
          RowBox[{"2", " ", "g"}], "-", 
          RowBox[{"4", " ", "h"}], "-", 
          RowBox[{"4", " ", "m"}]}], ")"}]}], 
       FractionBox[
        RowBox[{"a", "+", "b", "-", 
         RowBox[{"2", " ", "c"}], "+", 
         RowBox[{"2", " ", "g"}], "-", "h", "-", "m"}], 
        RowBox[{"3", " ", 
         SqrtBox["2"]}]]},
      {
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        RowBox[{"(", 
         RowBox[{"i", "+", "n", "+", "q"}], ")"}]}], 
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        RowBox[{"(", 
         RowBox[{"o", "+", "r", "+", "t"}], ")"}]}], 
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        RowBox[{"(", 
         RowBox[{"s", "+", "u", "+", "v"}], ")"}]}], 
       FractionBox[
        RowBox[{
         RowBox[{"-", "a"}], "+", "b", "+", "h", "-", "m"}], 
        SqrtBox["6"]], 
       FractionBox[
        RowBox[{"a", "+", "b", "-", 
         RowBox[{"2", " ", "c"}], "+", 
         RowBox[{"2", " ", "g"}], "-", "h", "-", "m"}], 
        RowBox[{"3", " ", 
         SqrtBox["2"]}]], 
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", "c", "+", 
          RowBox[{"2", " ", "g"}], "+", 
          RowBox[{"2", " ", "h"}], "+", 
          RowBox[{"2", " ", "m"}]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9206596219778776`*^9, 3.9206596239880576`*^9}, {
  3.9206596621786194`*^9, 3.9206596764733286`*^9}, {3.9206598054524517`*^9, 
  3.920659811403736*^9}},
 CellLabel->
  "In[3100]:=",ExpressionUUID->"f69038f3-41c0-40bb-8395-65c41e8a7e60"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"TmatOfCmatExplicit", "[", "BlankSlate", "]"}], "==", 
   RowBox[{"TmatOfCmat", "[", "BlankSlate", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9206597022478523`*^9, 3.9206597636069193`*^9}, {
  3.920659822001299*^9, 3.9206598458623486`*^9}},
 CellLabel->
  "In[3101]:=",ExpressionUUID->"aaeab46a-8d05-488a-b424-ffb67e8a4fa5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"CmatOfPHImat", "[", "BlankSlate", "]"}], "==", 
   RowBox[{
   "MatIsub\[CapitalSigma]\[CapitalPhi]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalPhi]\[CapitalUpsilon]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"PHImatOfCmat", "[", "BlankSlate", "]"}], "==", 
   RowBox[{
   "MatIsub\[CapitalPhi]\[CapitalSigma]", ".", "BlankSlate", ".", 
    "MatIsub\[CapitalUpsilon]\[CapitalPhi]"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.8672894638798146`*^9, {3.867289499477764*^9, 3.867289523916507*^9}, {
   3.8672897884970455`*^9, 3.8672897977045193`*^9}, {3.867289839540888*^9, 
   3.867289877687159*^9}, {3.8672899831392703`*^9, 3.8672899853949924`*^9}, {
   3.8673686618243175`*^9, 3.867368666042246*^9}, {3.8673687079958086`*^9, 
   3.8673687356169786`*^9}, 3.8674226632605314`*^9, 3.8674227437856913`*^9, {
   3.8793838471067133`*^9, 3.879383857242484*^9}, 3.87938390163206*^9, {
   3.879520957229377*^9, 3.8795209605367355`*^9}},
 CellLabel->
  "In[3102]:=",ExpressionUUID->"70f72333-c30f-429c-8ff6-f2b71d5017a1"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"PHImatOfCmat", "[", "BlankSlate", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8793492862496014`*^9, 3.8793493114218435`*^9}, 
   3.8793839008413453`*^9, 3.879520956163597*^9},
 CellLabel->
  "In[3105]:=",ExpressionUUID->"61c5dc0e-ae5f-48e1-9889-f592f148ed50"],

Cell[CellGroupData[{

Cell["\<\
RulesAlphabetToCijklSymbols is in the Mathematica file SSM_basic\
\>", "Subsubsection",
 CellChangeTimes->{{3.867369288863291*^9, 
  3.8673693254749193`*^9}},ExpressionUUID->"fa8a0f60-4997-4fa8-8bfa-\
ea52aba81010"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"CmatOfTmat", "[", "BlankSlate", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"False", ",", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"CmatOfTmat", "[", "BlankSlate", "]"}], "/.", 
      "RulesAlphabetToCijklSymbols"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7959453635296783`*^9, 3.7959454164893646`*^9}, {
   3.7959454552629433`*^9, 3.7959454662796974`*^9}, {3.795961027299603*^9, 
   3.7959610273152227`*^9}, 3.795962412759187*^9, {3.867424174882802*^9, 
   3.8674241834478035`*^9}, {3.8793838601554785`*^9, 3.879383860747717*^9}, {
   3.8795209639663415`*^9, 3.879520964859394*^9}},
 CellLabel->
  "In[3106]:=",ExpressionUUID->"103736c1-95c8-4eb5-bcca-95c4161c7546"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"TmatOfPHImat", "[", "BlankSlate", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"PHImatOfTmat", "[", "BlankSlate", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"TmatOfPHImat", "[", 
    RowBox[{"PHImatOfTmat", "[", "BlankSlate", "]"}], "]"}], "==", 
   "BlankSlate"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7953749033181624`*^9, 3.7953749341658196`*^9}, {
   3.7953751559926095`*^9, 3.795375247696466*^9}, {3.7953889565316896`*^9, 
   3.7953889937391214`*^9}, {3.7958795361596828`*^9, 3.795879559148263*^9}, 
   3.7958796107318354`*^9, {3.7958800755763187`*^9, 3.7958800888283515`*^9}, {
   3.795880274435199*^9, 3.7958803435734634`*^9}, {3.795961026986538*^9, 
   3.795961026986538*^9}, {3.867422815122315*^9, 3.867422819617917*^9}, {
   3.8674229122947893`*^9, 3.867422919156949*^9}, {3.879383861847763*^9, 
   3.8793838642525916`*^9}, {3.8795209658724985`*^9, 3.8795209679770184`*^9}},
 CellLabel->
  "In[3108]:=",ExpressionUUID->"aece23e7-71ae-4a25-bc57-46205291257e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
PHI ref matrix for TET. Agrees with Nye, if converted to a Voigt matrix. \
\>", "Subsubsection",
 CellChangeTimes->{{3.8799833765747557`*^9, 3.8799834026568413`*^9}, {
   3.8799853340089417`*^9, 3.8799853602540836`*^9}, 3.8799901034703074`*^9, {
   3.8799901806652436`*^9, 
   3.8799901884277353`*^9}},ExpressionUUID->"5797dcf3-8039-430e-b18c-\
49d941a57d4a"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"PHImatOfTmat", "[", "TmatForTET", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"PHImatOfTmat", "[", "TmatForTET", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "dp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "d"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "ap"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "e"}], "+", "f", "-", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "cp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "d"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "gp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "e"}], "+", 
         RowBox[{"2", " ", "f"}], "-", 
         RowBox[{
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "hp"}], ",", 
     RowBox[{"c", "\[Rule]", "fp"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8799829114662285`*^9, 3.8799829200118*^9}, {
  3.8799829600041866`*^9, 3.879983136564511*^9}, {3.8799832804990153`*^9, 
  3.8799833121638136`*^9}},
 CellLabel->
  "In[3112]:=",ExpressionUUID->"92be8de0-4e68-4c62-8dcf-15be033705cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
PHI ref matrix for XISO. Agrees with Nye,  if converted to a Voigt matrix\
\>", "Subsubsection",
 CellChangeTimes->{{3.8799833765747557`*^9, 3.8799834026568413`*^9}, {
   3.8799853340089417`*^9, 3.8799853602540836`*^9}, 3.8799901034703074`*^9, {
   3.8799901464102473`*^9, 3.8799901485484657`*^9}, 
   3.8799902015422077`*^9},ExpressionUUID->"40d94ada-c93f-483c-a4d9-\
54c7757fcefe"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"PHImatOfTmat", "[", "TmatForXISO", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "c"}], "+", "e", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"f", "+", 
         RowBox[{
          SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "c"}], "+", "e", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"f", "+", 
          RowBox[{
           SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"PHImatOfTmat", "[", "TmatForXISO", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "dp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "c"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "ap"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "e"}], "+", "f", "-", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "cp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c"}], "+", "e", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", 
            RowBox[{
             SqrtBox["2"], " ", "k"}]}], ")"}]}]}], ")"}]}], "\[Rule]", 
      "gp"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "e"}], "+", 
         RowBox[{"2", " ", "f"}], "-", 
         RowBox[{
          SqrtBox["2"], " ", "k"}]}], ")"}]}], "\[Rule]", "hp"}], ",", 
     RowBox[{"c", "\[Rule]", 
      RowBox[{"ap", "-", "gp"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8799829114662285`*^9, 3.8799829200118*^9}, {
   3.8799829600041866`*^9, 3.879983136564511*^9}, {3.8799832804990153`*^9, 
   3.8799833121638136`*^9}, {3.8799902178776665`*^9, 3.879990228209791*^9}, {
   3.8799903062921405`*^9, 3.8799903065165663`*^9}, {3.8799904548009925`*^9, 
   3.8799904876858587`*^9}, 3.87999051985126*^9, {3.8799905550192986`*^9, 
   3.879990601510868*^9}},
 CellLabel->
  "In[3114]:=",ExpressionUUID->"9b2e4320-6250-4aa3-8554-20d7af7bf997"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Illustrating the stupidity of the Voigt matrix :", "Subsubsection",
 CellChangeTimes->{{3.8674252179498053`*^9, 
  3.8674252490959473`*^9}},ExpressionUUID->"3bfc0de3-f2b8-4b85-a4f1-\
3b1acb545c32"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"CmatOfTmat", "[", 
    RowBox[{"Inverse", "[", "TmatForISO", "]"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Inverse", "[", 
    RowBox[{"CmatOfTmat", "[", "TmatForISO", "]"}], "]"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.867424409755003*^9, 3.867424448223033*^9}, {
  3.8674245019797096`*^9, 3.8674245516291513`*^9}, {3.867425201274107*^9, 
  3.867425202484928*^9}},
 CellLabel->
  "In[3117]:=",ExpressionUUID->"0c797c23-f03e-4505-b509-b8c11dcbcc1b"],

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["2", "a"], "+", 
      FractionBox["1", "f"]}], ")"}]}], "-", 
   RowBox[{
    FractionBox["1", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "a"]}], "+", 
      FractionBox["1", "f"]}], ")"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"a", "+", 
     RowBox[{"2", " ", "f"}]}], 
    RowBox[{"3", " ", "a", " ", "f"}]], "-", 
   FractionBox[
    RowBox[{"a", "-", "f"}], 
    RowBox[{"3", " ", "a", " ", "f"}]]}], "]"}]}], "Input",
 CellChangeTimes->{{3.867424809915476*^9, 3.8674248696879025`*^9}},
 CellLabel->
  "In[3119]:=",ExpressionUUID->"0740e436-ae9c-446d-88b5-d000301a243d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
To make Tmat6x6 wrt BB with prescribed eigenvalues and eigenvectors.
TmatFromEigensystem is Eq 49 of TapeTape2021.\
\>", "Subsubsection",
 CellChangeTimes->{{3.787197726442168*^9, 3.787197770686696*^9}, {
   3.795401347998807*^9, 3.795401349373804*^9}, {3.795401395854579*^9, 
   3.795401396917082*^9}, {3.8103239795180693`*^9, 3.810323986236885*^9}, 
   3.8228372108987193`*^9, {3.8303049300878143`*^9, 3.8303049392078156`*^9}, {
   3.830304980037236*^9, 3.830304986020372*^9}, {3.859817796177543*^9, 
   3.8598178007004504`*^9}},ExpressionUUID->"851e819e-da03-4188-b1a2-\
429438ad4c34"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TmatFromEigensystem", "[", 
     RowBox[{"eigenvalues_", ",", "ONeigenbasis_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"MatIsubBA", "[", "ONeigenbasis", "]"}], ".", 
     RowBox[{"DiagonalMatrix", "[", "eigenvalues", "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"MatIsubBA", "[", "ONeigenbasis", "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "can", " ", "use", " ", "transpose", " ", "for", " ", "inverse", " ", 
     "since", " ", "both", " ", "bases", " ", "are", " ", "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7870791907239304`*^9, 3.7870792131643147`*^9}, {
   3.78707926612812*^9, 3.787079276628847*^9}, {3.78707931432423*^9, 
   3.7870793282170777`*^9}, {3.787079386915492*^9, 3.787079418174843*^9}, {
   3.787174157038745*^9, 3.7871741751208296`*^9}, {3.787197822014477*^9, 
   3.787197823093233*^9}, {3.7874211823027673`*^9, 3.7874211948918324`*^9}, {
   3.787421288287093*^9, 3.7874212994628763`*^9}, {3.7874213635202894`*^9, 
   3.787421401309622*^9}, 3.787421632737559*^9, {3.7876191608151164`*^9, 
   3.78761916184641*^9}, {3.787619198418244*^9, 3.7876192016690817`*^9}, {
   3.7899211567301893`*^9, 3.7899211818581886`*^9}, 3.793301249051502*^9, {
   3.7953665075680714`*^9, 3.7953665279919496`*^9}, 3.79536918243423*^9, {
   3.7954014306081686`*^9, 3.795401479369706*^9}, {3.795401565572303*^9, 
   3.7954015669004307`*^9}, {3.7959196932589183`*^9, 
   3.7959196995562644`*^9}, {3.822837531444727*^9, 3.822837554611735*^9}, {
   3.8228415596134377`*^9, 3.8228415829734592`*^9}, {3.822842420036468*^9, 
   3.8228424334594793`*^9}, {3.8228425034054985`*^9, 
   3.8228425042364845`*^9}, {3.822842639997469*^9, 3.822842650003476*^9}},
 CellLabel->
  "In[3121]:=",ExpressionUUID->"0f9519fe-9f2f-435b-bb72-3e32d06c1411"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PerturbMatrix", "[", 
    RowBox[{"E_", ",", "\[Epsilon]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"NormMatrix", "[", "E", "]"}], 
    RowBox[{"UnitMatrix", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]", " ", "id"}], "+", "E"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ee", "[", "i_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
  "             ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Do", " ", "we", " ", "still", " ", "use", " ", 
     RowBox[{"this", "?"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5749038704093246`*^9, 3.5749038714389257`*^9}, 
   3.610078692301519*^9, {3.7272865085525017`*^9, 3.727286509536893*^9}, {
   3.7272865541932344`*^9, 3.7272865694588857`*^9}, 3.7272869264638147`*^9, {
   3.7272872008722215`*^9, 3.7272872020753593`*^9}, 3.7272872353879166`*^9, 
   3.727287602030487*^9, 3.727287717365075*^9, {3.7281501410739164`*^9, 
   3.7281501423395524`*^9}, {3.7281623875371757`*^9, 3.728162388709013*^9}, {
   3.7281690716170063`*^9, 3.728169123210819*^9}, {3.72816923714858*^9, 
   3.7281692496486063`*^9}, {3.7282618949543705`*^9, 
   3.7282619156419115`*^9}, {3.735093991409483*^9, 3.7350940133001375`*^9}, {
   3.783828835946253*^9, 3.7838288901712627`*^9}, {3.783829013980239*^9, 
   3.7838290238842545`*^9}, {3.7851055697346044`*^9, 3.785105595503805*^9}, {
   3.787618986520867*^9, 3.787618990052096*^9}, {3.7876190618316555`*^9, 
   3.787619090352497*^9}, {3.7892904629653034`*^9, 3.789290520709303*^9}, {
   3.7892905589343014`*^9, 3.7892905667433023`*^9}, {3.789290625151305*^9, 
   3.7892906764063063`*^9}, {3.789290708069253*^9, 3.789290750966256*^9}, {
   3.789325932352135*^9, 3.789326010993147*^9}, {3.7893260507401457`*^9, 
   3.7893261166551437`*^9}, {3.789326172961135*^9, 3.7893262276151466`*^9}, 
   3.7920838752549553`*^9, {3.7920839721319504`*^9, 3.7920839949329505`*^9}, {
   3.792084571843971*^9, 3.792084618692974*^9}, {3.7926932738631516`*^9, 
   3.7926933000864353`*^9}, {3.7926934301064825`*^9, 3.7926934587043133`*^9}, 
   3.7926972292626867`*^9, {3.7926972940818186`*^9, 3.7926972963005657`*^9}, {
   3.7926975018218307`*^9, 3.7926975068847575`*^9}, 3.7932184750873737`*^9, {
   3.8063397604949217`*^9, 3.8063397640569277`*^9}, 3.8673684483258467`*^9},
 CellLabel->
  "In[3122]:=",ExpressionUUID->"b277b81b-1eb1-4fee-9f7d-3874d5d72893"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The basis ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalB]", "G"], TraditionalForm]],
  ExpressionUUID->"fcb3f993-ae76-4ab1-9440-dbb3966921d2"],
 ", now \[DoubleStruckCapitalB](t). It is associated with Eq 86 of the 2021 \
paper.  "
}], "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.794683154123476*^9, 3.7946831576924734`*^9}, {3.7946833220424733`*^9, 
   3.7946833237544775`*^9}, {3.7946837462184734`*^9, 3.794683769356474*^9}, {
   3.794841657127206*^9, 3.794841694811201*^9}, {3.797269165118969*^9, 
   3.7972691718759594`*^9}, 3.803158199590596*^9, {3.812639695246354*^9, 
   3.8126397287929697`*^9}, 3.823464391493653*^9, {3.8303047112616014`*^9, 
   3.8303047301803045`*^9}, {3.830304818826724*^9, 3.830304818996112*^9}, {
   3.869493960629203*^9, 
   3.8694939621415377`*^9}},ExpressionUUID->"945ce26c-6d9d-4c9b-9ac1-\
becddb36b96a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"e12", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], ",", 
      RowBox[{"Sin", "[", "t", "]"}], ",", "0", ",", "0", ",", "0", ",", 
      "0"}], "}"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", ".", " ", "80"}], " ", "of", " ", "the", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.792549025211895*^9, 3.7925490545424857`*^9}, {
  3.7929689430004215`*^9, 3.7929689431879063`*^9}, {3.8303042715499687`*^9, 
  3.830304286231732*^9}},
 CellLabel->
  "In[3124]:=",ExpressionUUID->"729b81f5-632d-4b57-baee-178eda01d242"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"B12", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"BB", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"BB", "[", "2", "]"}]}]}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eqs", ".", " ", "79"}], " ", "of", " ", "the", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B34", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "t", "]"}], 
     RowBox[{"BB", "[", "3", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "t", "]"}], 
     RowBox[{"BB", "[", "4", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B56", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "t", "]"}], 
     RowBox[{"BB", "[", "5", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "t", "]"}], 
     RowBox[{"BB", "[", "6", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791476069750719*^9, 3.791476283865715*^9}, {
  3.7929689331717095`*^9, 3.792968963923811*^9}, {3.792971526302543*^9, 
  3.792971539319728*^9}, {3.7929718514829907`*^9, 3.7929718664079885`*^9}, {
  3.793005330964329*^9, 3.7930053506080875`*^9}, {3.799853527478767*^9, 
  3.7998535574548087`*^9}, {3.8303042540290203`*^9, 3.8303042568863325`*^9}},
 CellLabel->
  "In[3125]:=",ExpressionUUID->"0d84ac36-cf05-49bc-bdda-568220551ed9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basisBBprime", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BB", "[", "1", "]"}], ",", 
      RowBox[{"BB", "[", "2", "]"}], ",", 
      RowBox[{"BB", "[", "3", "]"}], ",", 
      RowBox[{"BB", "[", "4", "]"}], ",", 
      RowBox[{"B56", "[", "t", "]"}], ",", 
      RowBox[{"B56", "[", 
       RowBox[{"t", "+", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}], " ", ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "April", " ", "8"}], ",", " ", 
     RowBox[{"again", " ", "May", " ", "5"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.795400997482085*^9, 3.7954010394102793`*^9}, {
   3.795455781850463*^9, 3.7954557834285736`*^9}, {3.799853964292367*^9, 
   3.7998539722038054`*^9}, 3.801446362442513*^9, {3.8096359769624186`*^9, 
   3.8096360177928095`*^9}},
 CellLabel->
  "In[3128]:=",ExpressionUUID->"c5ca278b-4a41-425d-8a4f-f2b7c443521d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"basisBBprime", "[", "0", "]"}], "==", "basisBB"}]], "Input",
 CellChangeTimes->{{3.812639768128487*^9, 3.8126397778611374`*^9}},
 CellLabel->
  "In[3130]:=",ExpressionUUID->"ab240050-f9ac-44ea-9a6d-1da939874dd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "t", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"basisBBprime", "[", "t", "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"basisBB", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det \!\(\*SubscriptBox[\(B\), \(G\)]\)(t) vs B = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Det", "[", "%", "]"}], "]"}], ",", "16", ",", "Bold"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.79344954370986*^9, 3.7934496694736104`*^9}, {
   3.793451627286451*^9, 3.7934516406458263`*^9}, {3.7934516821660285`*^9, 
   3.7934517034019246`*^9}, {3.7934517491268597`*^9, 3.793451751345609*^9}, {
   3.793453729261668*^9, 3.7934537380288243`*^9}, {3.7934537769397087`*^9, 
   3.7934538604334373`*^9}, {3.794683792332466*^9, 3.7946837981714735`*^9}, 
   3.7954557881473236`*^9, {3.7998540106877403`*^9, 3.7998540175468564`*^9}, {
   3.809636070462882*^9, 3.8096360783384867`*^9}},
 CellLabel->
  "In[3131]:=",ExpressionUUID->"5569ce1d-aa2a-4633-a374-77a033528a8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The basis ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalB]", 
     RowBox[{"90", " "}]], "or", " "}], TraditionalForm]],ExpressionUUID->
  "ab69eb5f-bd85-4154-8fb0-9ff6ad15ff77"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalB]", 
    RowBox[{"4", " "}]], TraditionalForm]],ExpressionUUID->
  "36515f13-e133-46ad-9de7-b2474b4a64ff"]
}], "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.794683154123476*^9, 3.7946831576924734`*^9}, {3.7946833220424733`*^9, 
   3.7946833237544775`*^9}, {3.7946837462184734`*^9, 3.794683747483473*^9}, {
   3.7946838558674765`*^9, 3.794683857675473*^9}, {3.797269182952962*^9, 
   3.797269220739962*^9}},ExpressionUUID->"155e7ff7-c59e-4166-bd4b-\
a32a83e6cd4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basisBB90", "[", 
    RowBox[{"s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BB", "[", "1", "]"}], ",", 
     RowBox[{"BB", "[", "2", "]"}], ",", 
     RowBox[{"B34", "[", "s", "]"}], ",", 
     RowBox[{"B34", "[", 
      RowBox[{"s", "+", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
     RowBox[{"B56", "[", "t", "]"}], ",", 
     RowBox[{"B56", "[", 
      RowBox[{"t", "+", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.795455797259076*^9, 3.79545581022783*^9}, {
   3.795456627572991*^9, 3.795456692117715*^9}, 3.7969072961588326`*^9},
 CellLabel->
  "In[3135]:=",ExpressionUUID->"11fe316f-103b-4e34-a65b-deb74a1dd419"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"t", ",", "s"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{"basisBB", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"basisBB90", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det B90 vs B = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Det", "[", "%", "]"}], "]"}], ",", "16", ",", "Bold"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7934497052597537`*^9, 3.79344971118163*^9}, {
   3.7934497558269396`*^9, 3.793449771266013*^9}, {3.7934499942923307`*^9, 
   3.793450050362846*^9}, {3.793451648145828*^9, 3.793451660492625*^9}, {
   3.793451726779973*^9, 3.7934517601268587`*^9}, {3.7934535700194063`*^9, 
   3.7934535960396256`*^9}, 3.794154351971694*^9, 3.7943215636928205`*^9, 
   3.794683543723474*^9, {3.7946835825554776`*^9, 3.7946835864904833`*^9}, 
   3.794684621582464*^9, {3.7946846526034727`*^9, 3.7946846528424673`*^9}, 
   3.7954567124101295`*^9, 3.7954567482260647`*^9, 3.7964324896122494`*^9},
 CellLabel->
  "In[3137]:=",ExpressionUUID->"e1c1b702-7195-4009-8e4f-e28927eeb16e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"t", ",", "u", ",", "v"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"basisBBprime", "[", "t", "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"basisBB90", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det B90 vs Bprime(t) = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Det", "[", "%", "]"}], "]"}], ",", "16", ",", "Bold"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7934544526059313`*^9, 3.7934544612934318`*^9}, 
   3.7941543519256926`*^9, {3.7943216031825104`*^9, 3.7943216060575085`*^9}, {
   3.7946836021074734`*^9, 3.7946836153704734`*^9}, 3.7946846088414774`*^9, {
   3.794684657003474*^9, 3.7946846572754717`*^9}, 3.7954567471791906`*^9},
 CellLabel->
  "In[3140]:=",ExpressionUUID->"c3580ea5-0d51-4d60-a2c0-61cf0385f3f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The basis ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalB]", 
     RowBox[{"120", " "}]], "or", " "}], TraditionalForm]],ExpressionUUID->
  "d3df8955-ebaa-4d96-973b-d04806681276"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalB]", 
    RowBox[{"3", " "}]], TraditionalForm]],ExpressionUUID->
  "eecbfc97-264d-46b6-906b-cc805e9fee0d"]
}], "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.794683154123476*^9, 3.7946831576924734`*^9}, {3.7946833220424733`*^9, 
   3.7946833237544775`*^9}, {3.7946837462184734`*^9, 3.794683747483473*^9}, {
   3.7946838558674765`*^9, 3.794683857675473*^9}, {3.797269182952962*^9, 
   3.797269220739962*^9}, {3.797269255123962*^9, 
   3.797269259714961*^9}},ExpressionUUID->"6fd174e2-56bc-425a-8ccf-\
1a8a9a8944b1"],

Cell[BoxData[{
 RowBox[{"DateSequence", "[", 
  RowBox[{
   RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"t", ",", "u", ",", "v"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"evec", "[", 
     RowBox[{"\[Theta]_", ",", "u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"v", "+", 
           RowBox[{"\[Pi]", "/", "2"}], "+", "\[Pi]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{"v", "+", 
           RowBox[{"\[Pi]", "/", "2"}], "+", "\[Pi]"}], "]"}]}], ",", "0", 
        ",", "0"}], "}"}]}], "+", "\[IndentingNewLine]", 
     "                                  ", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", "u", "]"}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "u", "]"}]}], 
         RowBox[{"Sin", "[", 
          RowBox[{"v", "+", 
           RowBox[{"\[Pi]", "/", "2"}], "+", "\[Pi]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"v", "+", 
           RowBox[{"\[Pi]", "/", "2"}], "+", "\[Pi]"}], "]"}]}], ",", "0", 
        ",", "0"}], "}"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"I", " ", "replaced", " ", "v", " ", "by", " ", "v"}], "+", 
     RowBox[{"\[Pi]", "/", "2"}], "+", 
     RowBox[{"\[Pi]", " ", "April", " ", "22"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"evec", "[", 
     RowBox[{"\[Theta]_", ",", "u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], 
         RowBox[{"Cos", "[", "v", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], 
         RowBox[{"Sin", "[", "v", "]"}]}], ",", "0", ",", "0"}], "}"}]}], "+",
      "\[IndentingNewLine]", "                                  ", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", "u", "]"}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "u", "]"}]}], 
         RowBox[{"Sin", "[", "v", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "u", "]"}], 
         RowBox[{"Cos", "[", "v", "]"}]}], ",", "0", ",", "0"}], "}"}]}]}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Back", " ", "to", " ", "the", " ", "old"}], ",", " ", 
     RowBox[{"April", " ", "23"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"emat", "[", 
    RowBox[{"\[Theta]_", ",", "u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Matrix3x3fromBcoords", "[", 
    RowBox[{"evec", "[", 
     RowBox[{"\[Theta]", ",", "u", ",", "v"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basisBB120", "[", 
    RowBox[{"t_", ",", "u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"emat", "[", 
      RowBox[{"0", ",", "      ", "u", ",", "v"}], "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
        RowBox[{
        "this", " ", "and", " ", "next", " ", "are", " ", "basis", " ", "for",
          " ", "one", " ", "2", "D", " ", "invt", " ", "subspace"}], ";", " ", 
        RowBox[{"same", " ", "u", " ", "and", " ", "v"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"emat", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", "u", ",", "v"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"emat", "[", 
      RowBox[{"0", ",", "      ", 
       RowBox[{"u", "+", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", "v"}], "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
        RowBox[{
        "this", " ", "and", " ", "next", " ", "are", " ", "basis", " ", "for",
          " ", "one", " ", "2", "D", " ", "invt", " ", "subspace"}], ";", " ", 
        RowBox[{"same", " ", "u", " ", "and", " ", "v"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"emat", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"u", "+", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", "v"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"B56", "[", "t", "]"}], ",", 
     RowBox[{"B56", "[", 
      RowBox[{"t", "+", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB120Coords", "[", 
    RowBox[{"E_", ",", "t_", ",", "u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{"E", ",", 
       RowBox[{
        RowBox[{"basisBB120", "[", 
         RowBox[{"t", ",", "u", ",", "v"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix3x3from120coords", "[", 
    RowBox[{"SixTuple_", ",", "t_", ",", "u_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SixTuple", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{
       RowBox[{"basisBB120", "[", 
        RowBox[{"t", ",", "u", ",", "v"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7937357459125376`*^9, 3.793735793625535*^9}, {
   3.793739362488526*^9, 3.7937393657855253`*^9}, {3.79373955867653*^9, 
   3.7937395654165382`*^9}, {3.7937400109375286`*^9, 
   3.7937400117525263`*^9}, {3.793740267784527*^9, 3.7937402689375267`*^9}, {
   3.7937408870975347`*^9, 3.79374094418453*^9}, {3.794154312300692*^9, 
   3.7941543397736926`*^9}, {3.7946835015964756`*^9, 
   3.7946835191644726`*^9}, {3.7954802776954603`*^9, 
   3.7954803424398203`*^9}, {3.795480383791212*^9, 3.7954804173276253`*^9}, {
   3.796050884346697*^9, 3.7960509233522844`*^9}, {3.7960509801450005`*^9, 
   3.7960509807231274`*^9}, 3.79605164164644*^9, {3.7964970448602505`*^9, 
   3.7964970655347786`*^9}, {3.79656484960405*^9, 3.796564894923724*^9}, {
   3.7965649250032167`*^9, 3.7965649382709017`*^9}, {3.7965996342368813`*^9, 
   3.796599659958395*^9}, {3.7966510583233438`*^9, 3.7966510985643387`*^9}, {
   3.8103233571924515`*^9, 3.810323360832456*^9}, {3.9379235386766167`*^9, 
   3.9379235423833847`*^9}, {3.9385070214501*^9, 3.9385070478686533`*^9}},
 CellLabel->
  "In[3143]:=",ExpressionUUID->"0d359d9a-93ab-42f0-8198-41d1c75b762c"],

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"emat", "[", 
    RowBox[{"\[Theta]", ",", "u", ",", "v"}], "]"}], "==", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     RowBox[{"emat", "[", 
      RowBox[{"0", ",", "u", ",", "v"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"emat", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", "u", ",", "v"}], "]"}]}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<emat[\[Theta],u,v] = \>\"", ",", 
    FractionBox[
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     SqrtBox["2"]], ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"emat", "[", 
       RowBox[{"0", ",", "u", ",", "v"}], "]"}]}], "]"}], ",", "\"\< + \>\"", 
    ",", 
    FractionBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     SqrtBox["2"]], ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      SqrtBox["2"], 
      RowBox[{"emat", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], ",", "u", ",", "v"}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.833722350805732*^9, 3.833722564661749*^9}, {
  3.8337226575398073`*^9, 3.8337227176578064`*^9}},
 CellLabel->
  "In[3151]:=",ExpressionUUID->"04f56cc1-d98e-4d22-90fc-ea6ad6011b38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emat", "[", 
   RowBox[{"\[Theta]", ",", 
    RowBox[{"u", "+", 
     RowBox[{"\[Pi]", "/", "2"}]}], ",", "v"}], "]"}], "==", 
  RowBox[{"emat", "[", 
   RowBox[{
    RowBox[{"\[Theta]", "+", "\[Pi]"}], ",", 
    RowBox[{
     RowBox[{"-", "u"}], "+", 
     RowBox[{"\[Pi]", "/", "2"}]}], ",", 
    RowBox[{"v", "+", "\[Pi]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.801446166988923*^9, 3.8014461965226326`*^9}, {
  3.8014464644028263`*^9, 3.801446549125843*^9}},
 CellLabel->
  "In[3153]:=",ExpressionUUID->"31272d1f-bc12-4598-8f76-0b8a006bd20f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"basisBB120", "[", 
   RowBox[{"t", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"basisBBprime", "[", "t", "]"}]}]], "Input",
 CellChangeTimes->{{3.812641054381525*^9, 3.812641086360612*^9}},
 CellLabel->
  "In[3154]:=",ExpressionUUID->"1271df57-0464-454e-9813-978c99c22c4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"t", ",", "u", ",", "v"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{"basisBB", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"basisBB120", "[", 
         RowBox[{"t", ",", "u", ",", "v"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det B120 vs B = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Det", "[", "%", "]"}], "]"}], ",", "16", ",", "Bold"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7934497052597537`*^9, 3.79344971118163*^9}, {
   3.7934497558269396`*^9, 3.793449771266013*^9}, {3.7934499942923307`*^9, 
   3.793450050362846*^9}, {3.793451648145828*^9, 3.793451660492625*^9}, {
   3.793451726779973*^9, 3.7934517601268587`*^9}, {3.7934535700194063`*^9, 
   3.7934535960396256`*^9}, 3.794154351971694*^9, 3.7943215636928205`*^9, 
   3.794683543723474*^9, {3.7946835825554776`*^9, 3.7946835864904833`*^9}},
 CellLabel->
  "In[3155]:=",ExpressionUUID->"c24f321a-59c9-4886-9eca-b889cbab742e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"t", ",", "u", ",", "v"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"basisBBprime", "[", "t", "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"basisBB120", "[", 
         RowBox[{"t", ",", "u", ",", "v"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det B120 vs Bprime(t) = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Det", "[", "%", "]"}], "]"}], ",", "16", ",", "Bold"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7934544526059313`*^9, 3.7934544612934318`*^9}, 
   3.7941543519256926`*^9, {3.7943216031825104`*^9, 3.7943216060575085`*^9}, {
   3.7946836021074734`*^9, 3.7946836153704734`*^9}},
 CellLabel->
  "In[3158]:=",ExpressionUUID->"795ba8c9-579e-4e7a-b568-6d7610ab444b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox[
   RowBox[{"basisBB180", " ", "or", " "}], TraditionalForm]],ExpressionUUID->
  "ba4698fc-66ec-45df-911f-45e4299d8114"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalB]", 
     RowBox[{"2", " "}]], "(", 
    RowBox[{"r", ",", "U"}], ")"}], TraditionalForm]],ExpressionUUID->
  "47166f1d-4a17-4f62-848b-b5941cfc80f2"],
 ".  Recreated 2021-02-02.  I cannot find the original."
}], "Subsubsection",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.794683154123476*^9, 3.7946831576924734`*^9}, {3.7946833220424733`*^9, 
   3.7946833237544775`*^9}, {3.7946837462184734`*^9, 3.794683747483473*^9}, {
   3.7946838558674765`*^9, 3.794683857675473*^9}, {3.797269182952962*^9, 
   3.797269220739962*^9}, {3.797269255123962*^9, 3.797269259714961*^9}, {
   3.8212310484378867`*^9, 3.8212311231586432`*^9}, {3.821231491312621*^9, 
   3.8212314998102884`*^9}},ExpressionUUID->"ee8d4926-3b29-4b1f-b923-\
0ce402d83cfe"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"B12", "[", "r", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8212311458952236`*^9, 3.821231162447826*^9}},
 CellLabel->
  "In[3161]:=",ExpressionUUID->"25e41851-7a52-487a-a747-e469fc33f374"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"basisBB180", "[", 
    RowBox[{"r_", ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"u33_", "u34_", "u35_", "u36_"},
        {"u43_", "u44_", "u45_", "u46_"},
        {"u53_", "u54_", "u55_", "u56_"},
        {"u63_", "u64_", "u65_", "u66_"}
       }], "\[NoBreak]", ")"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"B12", "[", "r", "]"}], ",", 
     RowBox[{"B12", "[", 
      RowBox[{"r", "+", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u33", " ", 
       RowBox[{"BB", "[", "3", "]"}]}], "+", 
      RowBox[{"u43", " ", 
       RowBox[{"BB", "[", "4", "]"}]}], "+", 
      RowBox[{"u53", " ", 
       RowBox[{"BB", "[", "5", "]"}]}], "+", 
      RowBox[{"u63", " ", 
       RowBox[{"BB", "[", "6", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u34", " ", 
       RowBox[{"BB", "[", "3", "]"}]}], "+", 
      RowBox[{"u44", " ", 
       RowBox[{"BB", "[", "4", "]"}]}], "+", 
      RowBox[{"u54", " ", 
       RowBox[{"BB", "[", "5", "]"}]}], "+", 
      RowBox[{"u64", " ", 
       RowBox[{"BB", "[", "6", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u35", " ", 
       RowBox[{"BB", "[", "3", "]"}]}], "+", 
      RowBox[{"u45", " ", 
       RowBox[{"BB", "[", "4", "]"}]}], "+", 
      RowBox[{"u55", " ", 
       RowBox[{"BB", "[", "5", "]"}]}], "+", 
      RowBox[{"u65", " ", 
       RowBox[{"BB", "[", "6", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u36", " ", 
       RowBox[{"BB", "[", "3", "]"}]}], "+", 
      RowBox[{"u46", " ", 
       RowBox[{"BB", "[", "4", "]"}]}], "+", 
      RowBox[{"u56", " ", 
       RowBox[{"BB", "[", "5", "]"}]}], "+", 
      RowBox[{"u66", " ", 
       RowBox[{"BB", "[", "6", "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8212311269004097`*^9, 3.8212311427361603`*^9}, {
   3.821231174769563*^9, 3.8212313785102544`*^9}, {3.821231410406969*^9, 
   3.821231451537038*^9}, 3.821232138032281*^9, {3.82123219147689*^9, 
   3.8212322558658094`*^9}, {3.821232515948262*^9, 3.8212326027294445`*^9}, {
   3.821232635291624*^9, 3.821232640101018*^9}, {3.8212341651956716`*^9, 
   3.821234264971924*^9}, {3.8212343248751593`*^9, 3.8212345663458815`*^9}, {
   3.8212345975080194`*^9, 3.8212346718829365`*^9}, {3.8212347545019903`*^9, 
   3.821234757382532*^9}},
 CellLabel->
  "In[3162]:=",ExpressionUUID->"99c880ad-d319-497f-86a7-88a1cb6c37c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MM", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m1", "m6", "m5"},
      {"m6", "m2", "m4"},
      {"m5", "m4", "m3"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Dmat = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "Dmat", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<PHI coords = \>\"", ",", 
    RowBox[{"\[CapitalPhi]coords", "[", "MM", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<SIG coords = \>\"", ",", 
    RowBox[{"\[CapitalSigma]coords", "[", "MM", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<UPS coords = \>\"", ",", 
    RowBox[{"\[CapitalUpsilon]coords", "[", "MM", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", ".", 
   RowBox[{"\[CapitalSigma]coords", "[", "MM", "]"}]}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Dmat", " ", "converts", " ", "SIG", " ", "coords", " ", "to", " ", "PHI",
      " ", "coords"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", ".", "Dmat", ".", 
   RowBox[{"\[CapitalSigma]coords", "[", "MM", "]"}]}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Dmat", ".", "Dmat"}], " ", "converts", " ", "SIG", " ", 
     "coords", " ", "to", " ", "UPSILON", " ", "coords"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", ".", 
   RowBox[{"\[CapitalPhi]coords", "[", "MM", "]"}]}], "  ", "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Dmat", " ", "converts", " ", "PHI", " ", "coords", " ", "to", " ", 
     "UPSILON", " ", "coords"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", ".", 
   RowBox[{"\[CapitalPhi]coords", "[", "MM", "]"}]}], "\[Equal]", 
  RowBox[{"\[CapitalUpsilon]coords", "[", "MM", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8036018513053675`*^9, 3.8036019731593695`*^9}, {
  3.803602156712367*^9, 3.8036022873033676`*^9}, {3.803602450889368*^9, 
  3.8036024770793676`*^9}, {3.803602576919368*^9, 3.803602641783369*^9}, {
  3.8036027259773674`*^9, 3.8036027526313677`*^9}, {3.80360279744837*^9, 
  3.8036028843433676`*^9}, {3.803847746428496*^9, 3.8038477724166265`*^9}, {
  3.8039327857619047`*^9, 3.8039328448498373`*^9}, {3.803932910066354*^9, 
  3.8039329128917575`*^9}, {3.8039329777404137`*^9, 3.803932978219943*^9}, {
  3.938508127524601*^9, 3.9385081309952965`*^9}, {3.9385082687560225`*^9, 
  3.9385082749003687`*^9}, {3.9385088446568766`*^9, 3.9385088495780735`*^9}},
 CellLabel->
  "In[3163]:=",ExpressionUUID->"f7dbdcef-d72a-4082-81b3-2b55021bab31"]
}, Open  ]],

Cell[CellGroupData[{

Cell["UprightBasisForMono", "Subsection",
 CellChangeTimes->{{3.8253364057042108`*^9, 
  3.8253364380455217`*^9}},ExpressionUUID->"6d01061b-90c8-4227-a068-\
d78f7e7bc29c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OrthBasisR4", "=", 
   RowBox[{"Orthogonalize", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 0]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrthBasisR4InjectToR6", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
    "OrthBasisR4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UprightBasisForMono", "[", "r_", "]"}], ":=", 
   RowBox[{"Matrix3x3fromBcoords", "/@", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "r", "]"}], ",", 
          RowBox[{"Sin", "[", "r", "]"}], ",", "0", ",", "0", ",", "0", ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"r", "+", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"r", "+", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", "0", ",", "0", ",", 
          "0", ",", "0"}], "}"}]}], "}"}], ",", "OrthBasisR4InjectToR6"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8253367302131453`*^9, {3.8253368499678707`*^9, 3.8253368631895604`*^9}, {
   3.825336899830675*^9, 3.825336926742775*^9}, {3.8253370270613775`*^9, 
   3.8253370930618467`*^9}, 3.937923550046212*^9, 3.938507052810915*^9},
 CellLabel->
  "In[3172]:=",ExpressionUUID->"33b96e9a-efb5-4a50-93b2-90b78dd514fc"],

Cell[CellGroupData[{

Cell[TextData[{
 "Next can also be verified by hand. See the pdf \
AdjointOfMatrixMultiplication in the folder moment_tensor_tex.\n",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " can handle the dim = 7 case, but it takes a minute or two."
}], "Subsubsection",
 CellChangeTimes->{{3.8680609006377597`*^9, 3.8680609192136903`*^9}, {
  3.8681964864711866`*^9, 3.868196521352729*^9}, {3.868196560982214*^9, 
  3.8681966251274524`*^9}, {3.9009490334176984`*^9, 
  3.9009490538427887`*^9}},ExpressionUUID->"3ada8765-2d0a-4d0b-b7c1-\
033d836ff049"],

Cell["You cannot make the nn, mm, uu local", "Subsubsection",
 CellChangeTimes->{{3.920555475776504*^9, 
  3.920555515322421*^9}},ExpressionUUID->"ac118f02-e63c-45cb-a057-\
c67b70f4850f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"mm", ",", "nn", ",", "uu"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MatM", ",", "MatN", ",", "MatU", ",", "dim"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MatM", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"mm", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MatN", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"nn", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MatU", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"uu", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", "MatU", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", "MatM", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", "MatN", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"InnerProductMatrix", "[", 
         RowBox[{
          RowBox[{"MatU", ".", "MatM"}], ",", 
          "                                    ", "MatN"}], "]"}], "\[Equal]",
         "\[IndentingNewLine]", "                          ", 
        RowBox[{"InnerProductMatrix", "[", "           ", 
         RowBox[{"MatM", ",", 
          RowBox[{
           RowBox[{"Transpose", "[", "MatU", "]"}], ".", "MatN"}]}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"InnerProductMatrix", "[", 
         RowBox[{
          RowBox[{"MatM", ".", "MatU"}], ",", 
          "                                    ", "MatN"}], "]"}], "\[Equal]",
         "\[IndentingNewLine]", "                          ", 
        RowBox[{"InnerProductMatrix", "[", 
         RowBox[{"MatM", ",", "           ", 
          RowBox[{"MatN", ".", 
           RowBox[{"Transpose", "[", "MatU", "]"}]}]}], "]"}]}], "]"}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.900948177211215*^9, 3.9009482928557262`*^9}, 
   3.900948413062004*^9, {3.9009484875083623`*^9, 3.900948501868631*^9}, {
   3.9009485404841948`*^9, 3.90094857813116*^9}, 3.900948982127963*^9, 
   3.9009490615683813`*^9, {3.9205538269630523`*^9, 3.920553925860951*^9}, {
   3.920554215138669*^9, 3.9205542231957884`*^9}, 3.920554258545663*^9, {
   3.9205542896874485`*^9, 3.9205543153489437`*^9}, {3.9205543700585785`*^9, 
   3.920554428073925*^9}, {3.9205549646015854`*^9, 3.9205550157040234`*^9}, {
   3.9205555287588263`*^9, 3.92055556802346*^9}},
 CellLabel->
  "In[3175]:=",ExpressionUUID->"9c755011-740f-4c83-af24-31d1d54da6ca"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ubar", "Section",
 CellChangeTimes->{{3.786989398332937*^9, 3.786989431446933*^9}, {
   3.7882873576013203`*^9, 3.788287430546523*^9}, {3.7882875200590954`*^9, 
   3.788287522154357*^9}, 3.7882875600948887`*^9, {3.7925494271381817`*^9, 
   3.792549428856931*^9}, {3.7934518661129727`*^9, 3.7934518928034935`*^9}, {
   3.794682808395474*^9, 3.7946828114194746`*^9}, {3.794682964314475*^9, 
   3.7946829672924786`*^9}, {3.794683067676476*^9, 3.794683073309477*^9}, {
   3.794683154123476*^9, 3.7946831576924734`*^9}, {3.7946833220424733`*^9, 
   3.7946833237544775`*^9}, {3.7946837462184734`*^9, 3.794683747483473*^9}, {
   3.794684746267477*^9, 
   3.7946847474664717`*^9}},ExpressionUUID->"63cdc5c6-bfdf-49ea-83ab-\
543749b7a87a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UbarLT", "[", 
     RowBox[{"E_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"U", ".", "E", ".", 
     RowBox[{"Transpose", "[", "U", "]"}]}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"the", " ", "linear", " ", "transformation"}], ",", " ", 
     RowBox[{"not", " ", "the", " ", "matrix"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixUbar", "[", 
     RowBox[{"U_", ",", "OrthonormalBasis_"}], "]"}], ":=", 
    RowBox[{"MatrixRep6x6wrtON", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"U", ".", "#", ".", 
        RowBox[{"Transpose", "[", "U", "]"}]}], "&"}], ",", 
      "OrthonormalBasis"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "the", " ", "6", " ", "x", " ", "6", " ", "orthogonal", " ", "matrix", 
     " ", "determined", " ", "by", " ", "the", " ", "rotation", " ", "matrix",
      " ", "U", " ", "and", " ", "OrthonormalBasis"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixUbar", "[", "U_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"MatrixUbar", "[", 
     RowBox[{"U", ",", "basisBB"}], "]"}], "]"}]}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Now", " ", "April", " ", "8", " ", "it", " ", "is", " ", "wrt", " ", 
     "basis", " ", "BB"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7958791746946397`*^9, 3.7958791800076823`*^9}, {
   3.795879275619272*^9, 3.795879295717781*^9}, {3.7959197125426645`*^9, 
   3.7959197175431323`*^9}, {3.7959199222184706`*^9, 
   3.7959199404231796`*^9}, {3.804031233155677*^9, 3.8040312529706345`*^9}, {
   3.804031302296573*^9, 3.804031330476095*^9}, {3.804031369026539*^9, 
   3.804031378411557*^9}, 3.804640386652455*^9, {3.8103239236799192`*^9, 
   3.810323924442877*^9}, {3.867886130445979*^9, 3.8678861398496437`*^9}, {
   3.9053760815443454`*^9, 3.9053760868351393`*^9}, {3.9054541192968645`*^9, 
   3.905454120558413*^9}, 3.93810565476266*^9},
 CellLabel->
  "In[3177]:=",ExpressionUUID->"d73a6891-40b1-4ecf-85cd-19445f4acadb"],

Cell[CellGroupData[{

Cell["\<\
The file Mathematica file ES_Derivations has facts about Ubar.  But there is \
lots more somewhere else (unknown).\
\>", "Subsubsection",
 CellChangeTimes->{{3.8384731742339373`*^9, 3.838473247567941*^9}, {
  3.9053760998265142`*^9, 
  3.9053761199053135`*^9}},ExpressionUUID->"ca3cb7c9-38c0-455e-9158-\
a7b6d6df130e"],

Cell["PartialCheckOfEquivalence", "Subsubsection",
 CellChangeTimes->{{3.8384731742339373`*^9, 3.838473247567941*^9}, {
  3.894028181757844*^9, 
  3.8940281925128717`*^9}},ExpressionUUID->"2ba2f25d-c258-4e9f-aca9-\
51a8df9fe9c3"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "BlankSlate", "]"}]], "Input",
 CellChangeTimes->{{3.894028878407129*^9, 3.8940288858225355`*^9}},
 CellLabel->
  "In[3180]:=",ExpressionUUID->"d5502b3c-58ac-4283-aaae-b0c1d3c01c6a"]
}, Open  ]]
}, Open  ]],

Cell[BoxData["U"], "Input",
 CellChangeTimes->{3.9205560555803385`*^9},
 CellLabel->
  "In[3181]:=",ExpressionUUID->"68c5b8cf-1b40-4d82-be53-d64100eee7fc"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "U", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"UsHat", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", "BlankSlate", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"FiveTrace", "[", "BlankSlate", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"FiveTrace", "[", 
        RowBox[{
         RowBox[{"MatrixUbar", "[", "U", "]"}], ".", "BlankSlate", ".", 
         RowBox[{"Transpose", "[", 
          RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}], "]"}], "]"}], "]"}],
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixUbar", "[", "U", "]"}], ".", "BlankSlate", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"6", ",", "6"}], "]"}], "]"}], "]"}], "]"}], "]"}], ";"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894028360241869*^9, 3.894028543070813*^9}, {
  3.8940285767188063`*^9, 3.8940286323970823`*^9}, {3.8940286906255465`*^9, 
  3.8940287312620325`*^9}, {3.894028764176894*^9, 3.8940287703819647`*^9}, {
  3.894028958353622*^9, 3.894028974237206*^9}, {3.9205557845027914`*^9, 
  3.9205558666094*^9}, {3.9205559299283314`*^9, 3.920555991221853*^9}, {
  3.9205561342685823`*^9, 3.9205562165850163`*^9}, {3.9205563721355076`*^9, 
  3.920556379036504*^9}, {3.9205565049439707`*^9, 3.920556570154853*^9}, {
  3.92055670485048*^9, 3.920556705432579*^9}, {3.9205567478726425`*^9, 
  3.920556748437316*^9}, {3.9260176412436867`*^9, 3.926017642940507*^9}, {
  3.9260179942231216`*^9, 3.926017995587433*^9}, {3.926018048628498*^9, 
  3.9260180583837185`*^9}, {3.926018976626875*^9, 3.926018977555295*^9}},
 CellLabel->
  "In[3182]:=",ExpressionUUID->"468d7371-2337-4a3d-945c-a599b4a775a1"],

Cell["\<\
Another section. Don\[CloseCurlyQuote]t worry about error message here. (CHI \
has not been defined.)\
\>", "Subsubsection",
 CellChangeTimes->{{3.8384731742339373`*^9, 3.838473247567941*^9}, {
  3.894028154431406*^9, 3.8940281598714275`*^9}, {3.8988664233674593`*^9, 
  3.8988664526837983`*^9}},ExpressionUUID->"a0e68b50-595b-46a7-8f63-\
1568f8f4e04e"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"MatrixRep6x6wrtON", "[", 
   RowBox[{"L", ",", "CHI"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.802450139005786*^9, 3.8024501479947824`*^9}, 
   3.804031283330595*^9, {3.867885097954606*^9, 3.867885100353168*^9}, 
   3.938105657670601*^9},
 CellLabel->
  "In[3183]:=",ExpressionUUID->"321eacc1-d0d2-4b37-8744-9f0ccc70e984"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Xi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"MatrixUbar", "[", 
    RowBox[{"ZRot", "[", "\[Xi]", "]"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Det = \>\"", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Det", "[", "%", "]"}], "]"}], ",", "16", ",", "Bold"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7934522184549675`*^9, 3.793452246145506*^9}, {
  3.793453628122664*^9, 3.793453629028885*^9}, {3.793453662749178*^9, 
  3.7934536687960415`*^9}, {3.7962251939063883`*^9, 3.796225195359475*^9}},
 CellLabel->
  "In[3184]:=",ExpressionUUID->"6871f14d-8a31-477a-8ea7-7cdfaed0bdeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PHI", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "==", 
  RowBox[{"basisBB", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.802465302923792*^9, 3.802465326140793*^9}},
 CellLabel->
  "In[3187]:=",ExpressionUUID->"20747988-13a8-457b-94ee-ba93c0a7d530"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "u", "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "u", "]"}]}], "0", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", "u", "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "u", "]"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"Sin", "[", "u", "]"}], 
       RowBox[{"Cos", "[", "v", "]"}], " "}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "u", "]"}]}], " ", 
       RowBox[{"Sin", "[", "v", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "u", "]"}], " ", 
       RowBox[{"Cos", "[", "v", "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "u", "]"}]}], " ", 
       RowBox[{"Sin", "[", "v", "]"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"Sin", "[", "u", "]"}], " ", 
       RowBox[{"Sin", "[", "v", "]"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "u", "]"}], 
       RowBox[{"Cos", "[", "v", "]"}], " "}], 
      RowBox[{
       RowBox[{"Cos", "[", "u", "]"}], " ", 
       RowBox[{"Sin", "[", "v", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "u", "]"}], " ", 
       RowBox[{"Cos", "[", "v", "]"}]}], "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "t", "]"}]}]},
     {"0", "0", "0", "0", 
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "\[Equal]", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "u", "]"}]}], 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "u", "]"}], 
        RowBox[{"Rot2D", "[", "v", "]"}]}], ",", "                      ", 
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], 
        RowBox[{"Rot2D", "[", "v", "]"}]}], ",", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Rot2D", "[", "t", "]"}]}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.820766070611104*^9, 3.8207661340921197`*^9}, {
  3.8207662067640624`*^9, 3.820766220859327*^9}, {3.820766263035267*^9, 
  3.820766433293189*^9}, {3.8207664826536255`*^9, 3.820766496093046*^9}},
 CellLabel->
  "In[3188]:=",ExpressionUUID->"84f87e6b-c025-4003-84d5-e4727a2ae788"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"MatIsubCAbasisCisON", "[", 
    RowBox[{"basisBB", ",", 
     RowBox[{"basisBBprime", "[", "t", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[3189]:=",ExpressionUUID->"f3cce53e-1e9b-4770-88f0-ed2a5c0adea4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"s", ",", "t", ",", "u", ",", "v"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\!\(\*StyleBox[\"[\",FontFamily->\"Courier \
New\",FontSize->16]\)\!\(\*StyleBox[\"I\",FontFamily->\"Courier \
New\",FontSize->16]\)]\!\(\*SubscriptBox[\(\[DoubleStruckCapitalB]\
\[DoubleStruckCapitalB]G\), \(\[Placeholder]\)]\) = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"MatIsubCAbasisCisON", "[", 
       RowBox[{"basisBB", ",", 
        RowBox[{"basisBBprime", "[", "t", "]"}]}], "]"}], "]"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\!\(\*StyleBox[\"[\",FontFamily->\"Courier \
New\",FontSize->16]\)\!\(\*StyleBox[\"I\",FontFamily->\"Courier \
New\",FontSize->16]\)]\!\(\*SubscriptBox[\(\[DoubleStruckCapitalB]\
\[DoubleStruckCapitalB]4\), \(\[Placeholder]\)]\) = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"MatIsubCAbasisCisON", "[", 
       RowBox[{"basisBB", ",", 
        RowBox[{"basisBB90", "[", 
         RowBox[{"s", ",", "t"}], "]"}]}], "]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\!\(\*StyleBox[\"[\",FontFamily->\"Courier \
New\",FontSize->16]\)\!\(\*StyleBox[\"I\",FontFamily->\"Courier \
New\",FontSize->16]\)]\[DoubleStruckCapitalB]\[DoubleStruckCapitalB]3 = \>\"",
     ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"MatIsubCAbasisCisON", "[", 
       RowBox[{"basisBB", ",", 
        RowBox[{"basisBB120", "[", 
         RowBox[{"t", ",", "u", ",", "v"}], "]"}]}], "]"}], "]"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"MatIsubCAbasisCisON", "[", 
    RowBox[{"basisBB", ",", 
     RowBox[{"basisBB120", "[", 
      RowBox[{"t", ",", "u", ",", "v"}], "]"}]}], "]"}], "==", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"Cos", "[", "u", "]"}], "0", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "u", "]"}]}], "0", "0", "0"},
      {"0", 
       RowBox[{"Cos", "[", "u", "]"}], "0", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "u", "]"}]}], "0", "0"},
      {
       RowBox[{
        RowBox[{"Sin", "[", "u", "]"}], 
        RowBox[{"Cos", "[", "v", "]"}], " "}], 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "u", "]"}]}], " ", 
        RowBox[{"Sin", "[", "v", "]"}]}], 
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], " ", 
        RowBox[{"Cos", "[", "v", "]"}]}], 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "u", "]"}]}], " ", 
        RowBox[{"Sin", "[", "v", "]"}]}], "0", "0"},
      {
       RowBox[{
        RowBox[{"Sin", "[", "u", "]"}], " ", 
        RowBox[{"Sin", "[", "v", "]"}]}], 
       RowBox[{
        RowBox[{"Sin", "[", "u", "]"}], 
        RowBox[{"Cos", "[", "v", "]"}], " "}], 
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], " ", 
        RowBox[{"Sin", "[", "v", "]"}]}], 
       RowBox[{
        RowBox[{"Cos", "[", "u", "]"}], " ", 
        RowBox[{"Cos", "[", "v", "]"}]}], "0", "0"},
      {"0", "0", "0", "0", 
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {"0", "0", "0", "0", 
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Cos", "[", "t", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\!\(\*StyleBox[\"[\",FontFamily->\"Courier \
New\",FontSize->16]\)\!\(\*StyleBox[\"I\",FontFamily->\"Courier \
New\",FontSize->16]\)]\[DoubleStruckCapitalB]\[CapitalPhi] \
=\!\(\*FractionBox[\(1\), SqrtBox[\(6\)]]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       StyleBox[
        SqrtBox["6"],
        FontColor->RGBColor[1, 0, 0]], "MatIsubB\[CapitalPhi]"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\!\(\*StyleBox[\"[\",FontFamily->\"Courier \
New\",FontSize->16]\)\!\(\*StyleBox[\"I\",FontFamily->\"Courier \
New\",FontSize->16]\)]\[CapitalPhi]\[DoubleStruckCapitalB]\!\(\*StyleBox[\(\*\
StyleBox[\" \",FontFamily->\"Courier New\",FontSize->16]\\\ \
\)]\)=\!\(\*FractionBox[\(1\), SqrtBox[\(6\)]]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       StyleBox[
        SqrtBox["6"],
        FontColor->RGBColor[1, 0, 0]], "MatIsub\[CapitalPhi]B"}], "]"}], 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797269314685961*^9, 3.7972695235069695`*^9}, {
   3.7972695835389566`*^9, 3.797269609986969*^9}, {3.797269651458982*^9, 
   3.7972696965949697`*^9}, {3.7998613299141417`*^9, 3.799861330797509*^9}, {
   3.79986137479871*^9, 3.799861396378675*^9}, {3.79986148510837*^9, 
   3.7998615289090967`*^9}, {3.7998618515499716`*^9, 
   3.7998618897890944`*^9}, {3.8024505576117926`*^9, 
   3.8024505616667786`*^9}, {3.802450598555465*^9, 3.8024506020594654`*^9}, {
   3.8037543883581457`*^9, 3.80375439891851*^9}, {3.820763072488456*^9, 
   3.820763104447444*^9}, {3.820763149663265*^9, 3.820763179696353*^9}, {
   3.822517898120772*^9, 3.8225179152839375`*^9}, {3.822836628924662*^9, 
   3.8228366369326553`*^9}, {3.8228376903907347`*^9, 3.822837706462726*^9}, {
   3.8228416770704455`*^9, 3.822841679310445*^9}, 3.8228421761424456`*^9, 
   3.8228422321294775`*^9, {3.8232715645801463`*^9, 3.8232715846978045`*^9}, {
   3.8232716236682415`*^9, 3.823271624471115*^9}, {3.8232720805991664`*^9, 
   3.823272100188128*^9}, {3.823272133419839*^9, 3.8232721344548035`*^9}, {
   3.823273449542813*^9, 3.8232734601547165`*^9}, {3.82327350915032*^9, 
   3.8232735375317354`*^9}, {3.8232735692641196`*^9, 3.823273592218644*^9}},
 CellLabel->
  "In[3190]:=",ExpressionUUID->"5c9aa968-89c9-440c-9ae0-24d88c81c918"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"MatIsubCAbasisCisON", "[", 
     RowBox[{
      RowBox[{"basisBBprime", "[", "t", "]"}], ",", "basisBB"}], "]"}], ".", 
    "TmatForXISO", " ", ".", 
    RowBox[{"MatIsubCAbasisCisON", "[", 
     RowBox[{"basisBB", ",", 
      RowBox[{"basisBBprime", "[", "t", "]"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7972698187389708`*^9, 3.7972698460989685`*^9}, {
  3.7972698769639688`*^9, 3.797269882738969*^9}, {3.797269934195972*^9, 
  3.797269966642969*^9}, {3.79727042360497*^9, 3.797270432323969*^9}, {
  3.7972705193649683`*^9, 3.7972705219389687`*^9}, {3.8024505644657845`*^9, 
  3.8024505654097834`*^9}, {3.802450605938469*^9, 3.802450607025461*^9}, {
  3.803754401890184*^9, 3.8037544052177134`*^9}, {3.8228366424516554`*^9, 
  3.822836643183669*^9}, {3.822837707803722*^9, 3.8228377145557375`*^9}, {
  3.822841680635439*^9, 3.82284168145045*^9}},
 CellLabel->
  "In[3197]:=",ExpressionUUID->"9c03d7fe-1fb4-4b66-a298-cecec1a4dee1"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MatIsubCAbasisCisON", "[", 
     RowBox[{
      RowBox[{"basisBBprime", "[", "t", "]"}], ",", "basisBB"}], "]"}], ".", 
    "TmatForXISO", " ", ".", 
    RowBox[{"MatIsubCAbasisCisON", "[", 
     RowBox[{"basisBB", ",", 
      RowBox[{"basisBBprime", "[", "t", "]"}]}], "]"}]}], "==", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "a", "0", "0", "0", "0"},
       {"0", "0", "c", "0", "0", "0"},
       {"0", "0", "0", "c", "0", "0"},
       {"0", "0", "0", "0", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"e", "+", "f", "+", 
           RowBox[{"\[Rho]\[Infinity]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"t", "-", "\[Theta]\[Infinity]"}], ")"}]}], "]"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "\[Rho]\[Infinity]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"t", "-", "\[Theta]\[Infinity]"}], ")"}]}], "]"}]}]},
       {"0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "\[Rho]\[Infinity]", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"t", "-", "\[Theta]\[Infinity]"}], ")"}]}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"e", "+", "f", "-", 
           RowBox[{"\[Rho]\[Infinity]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"t", "-", "\[Theta]\[Infinity]"}], ")"}]}], "]"}]}]}], 
          ")"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "]"}]], "Input",
 CellChangeTimes->{{3.797270017873972*^9, 3.7972700259859686`*^9}, {
  3.797270320756969*^9, 3.7972703412519693`*^9}, {3.797270446923973*^9, 
  3.7972704820379725`*^9}, {3.7972705297119694`*^9, 3.7972705361009727`*^9}, {
  3.7972705698779716`*^9, 3.7972705791719704`*^9}, {3.7972708204529724`*^9, 
  3.7972708422759695`*^9}, {3.797270881797974*^9, 3.797270884724973*^9}, {
  3.7990730096746984`*^9, 3.7990730118096914`*^9}, {3.8024505662197714`*^9, 
  3.8024505678747835`*^9}, {3.8024506089634647`*^9, 3.8024506103794622`*^9}, {
  3.803754409856354*^9, 3.8037544112614365`*^9}, {3.817157221494367*^9, 
  3.8171572256175656`*^9}, {3.8171573008439393`*^9, 3.817157305322055*^9}, {
  3.8228366444286647`*^9, 3.822836645180666*^9}, {3.8228377160927253`*^9, 
  3.822837716861725*^9}, {3.822841682657445*^9, 3.822841683949455*^9}},
 CellLabel->
  "In[3198]:=",ExpressionUUID->"2e66e4c2-367c-462c-a785-9390444f4e22"],

Cell["Groups", "Section",
 CellChangeTimes->{{3.891270807831238*^9, 
  3.891270822166829*^9}},ExpressionUUID->"714d7cce-0d99-471b-a256-\
3bcfb0bee6d5"],

Cell[CellGroupData[{

Cell["Another section", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.692743015099022*^9}, {3.6927430809897823`*^9, 
  3.6927430825835347`*^9}},ExpressionUUID->"2ee3df54-cd5f-4575-9b30-\
e1780b5de184"],

Cell[TextData[{
 StyleBox["GPGENBY",
  FontSlant->"Italic"],
 "[A] IS THE GROUP GENERATED BY THE GROUP ELEMENTS IN THE SET A. ",
 StyleBox["GPGENBY",
  FontSlant->"Italic"],
 "[A] MUST BE FINITE."
}], "SmallText",
 CellMargins->{{Inherited, -120}, {Inherited, Inherited}},
 Evaluatable->False,
 CellChangeTimes->{
  3.6481670178008776`*^9, {3.9342095592035327`*^9, 3.934209568891412*^9}},
 AspectRatioFixed->True,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"91559a53-1dca-4f5a-95fb-52dacbe04791"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AllProducts", "[", "a_", "]"}], ":=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ".", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ",", 
           RowBox[{"CartesianProduct", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], "]"}]}], "]"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"#1", "==", "#2"}], "]"}], "&"}]}], "]"}]}], " ", ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "DeleteDuplicates", " ", "added", " ", "July", " ", "2024.", " ", 
      "Necessary", " ", "for", " ", 
      RowBox[{"GpGenBy", "[", 
       RowBox[{"{", 
        RowBox[{"ZRot", "[", 
         RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "5"}]}], "]"}], "}"}], "]"}]}], ",", " ", 
     RowBox[{"for", " ", "example"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GpGenBy", "[", "a_", "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{"AllProducts", ",", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GyroidGp", "         ", "=", 
    RowBox[{"GpGenBy", "[", 
     RowBox[{"{", 
      RowBox[{"rot111", ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}]}], "}"}], "]"}]}], ";"}], 
  "                                                     ", 
  RowBox[{"(*", "  ", 
   StyleBox["432",
    FontColor->RGBColor[1, 0, 0]], "     ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RhombohedralWithAxis111", "=", 
   RowBox[{"GpGenBy", "[", 
    RowBox[{"{", 
     RowBox[{"-", "rot111"}], "}"}], "]"}]}], 
  "                                                   ", 
  RowBox[{"(*", "  ", 
   OverscriptBox[
    StyleBox["3",
     FontColor->RGBColor[1, 0, 0]], "_"], "    ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.648165708751521*^9, 3.648165709741522*^9}, {
   3.648165806971656*^9, 3.6481658505517163`*^9}, {3.648166181349723*^9, 
   3.648166192669739*^9}, {3.6481670034308577`*^9, 3.648167052760926*^9}, {
   3.648167152391063*^9, 3.6481671593210726`*^9}, {3.6481672835312443`*^9, 
   3.6481672853812466`*^9}, {3.802218073317542*^9, 3.80221808757255*^9}, {
   3.8901806879380407`*^9, 3.8901806966381187`*^9}, 3.9297189498590703`*^9},
 CellLabel->
  "In[3199]:=",ExpressionUUID->"5205819f-fdaa-4552-8951-c0c94d0b34cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymGroup", "=", 
    RowBox[{"{", 
     RowBox[{"id", ",", "rot111", ",", 
      RowBox[{"rot111", ".", "rot111"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1", "0"},
         {"1", "0", "0"},
         {"0", "0", "1"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "1"},
         {"0", "1", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "1"},
         {"0", "1", "0"},
         {"1", "0", "0"}
        }], "\[NoBreak]", ")"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"the", " ", "six", " ", "3", "x3", " ", "permuation", " ", 
      RowBox[{"matrices", ".", " ", "Some"}], " ", "have", " ", "det"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"-", "1."}], " ", "SymmetricGroup", " ", "is", " ", "a", " ", 
      "built", " ", "in", " ", "function", " ", "in", " ", "Mathematica", " ",
       "9", " ", "but", " ", "does", " ", "not", " ", "consist", " ", "of", 
      " ", "matrices"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5943106282172747`*^9, 3.5943106401872916`*^9}, {
   3.594516111236637*^9, 3.5945161384566746`*^9}, {3.594740781706049*^9, 
   3.5947408108980904`*^9}, {3.5947408519681473`*^9, 3.594740863092165*^9}, {
   3.6404473398060217`*^9, 3.640447367056059*^9}, {3.6481657435815687`*^9, 
   3.648165757631588*^9}, 3.6481670178008776`*^9, {3.9065157464557877`*^9, 
   3.9065157480696125`*^9}},
 CellLabel->
  "In[3203]:=",ExpressionUUID->"3d39e96c-f379-4feb-bf29-c14777d72c7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GyroidImitation", "=", 
   RowBox[{"1.", 
    RowBox[{"{", 
     RowBox[{"id", ",", "rot111", ",", 
      RowBox[{"rot111", ".", "rot111"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", "rot111"}], ",", 
      RowBox[{
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", "rot111", ".", "rot111"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", "rot111"}], ",", 
      RowBox[{
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", "rot111", ".", "rot111"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ZRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{
       RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", "rot111"}], ",", 
      RowBox[{
       RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", "rot111", ".", "rot111"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurvilinearCube", "=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"SegmentList", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1.", 
             RowBox[{
              RowBox[{"GyroidImitation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ".", 
              RowBox[{"unit", "[", "#", "]"}]}]}], "&"}], "/@", 
           RowBox[{"arc", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "31", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "GyroidImitation", "]"}]}], "}"}]}], "]"}], 
     ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7983353825458164`*^9, 3.7983354258408175`*^9}, {
   3.7983355241938143`*^9, 3.798335530304815*^9}, {3.7983359133298144`*^9, 
   3.7983359255698147`*^9}, {3.7983362221248164`*^9, 3.798336235280817*^9}, {
   3.7983368251058135`*^9, 3.798336833424816*^9}, {3.7983369117308054`*^9, 
   3.7983369350408163`*^9}, {3.7983369656168137`*^9, 
   3.7983370262088056`*^9}, {3.7983938803303766`*^9, 3.798393881649962*^9}, 
   3.7984656310619216`*^9, {3.7984659968978586`*^9, 3.7984660182464657`*^9}, 
   3.802206127895568*^9},
 CellLabel->
  "In[3204]:=",ExpressionUUID->"8e904876-de83-461e-8d66-fb75d8b5ff84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Another section", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 
  3.692743015099022*^9}},ExpressionUUID->"db466874-671a-4e36-af8c-\
9570c4b8be36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]vsSimpleLast", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Lambda]3", "==", "\[Lambda]1"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "0", "1"},
            {"0", "1", "0"}
           }], "\[NoBreak]", ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
          "}"}]}], ",", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "0", "1"},
            {"0", "1", "0"}
           }], "\[NoBreak]", ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      "                                                                       \
                                 ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Lambda]3", "==", "\[Lambda]2"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0", "0", "1"},
              {"0", "1", "0"},
              {"1", "0", "0"}
             }], "\[NoBreak]", ")"}], ".", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
            "}"}]}], ",", 
          RowBox[{
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0", "0", "1"},
              {"0", "1", "0"},
              {"1", "0", "0"}
             }], "\[NoBreak]", ")"}], ".", 
           RowBox[{"{", 
            RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        "                                                                     \
                                                                              \
                      ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["Added",
     FontColor->RGBColor[1, 0, 0]], " ", 
    StyleBox["March",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["2021.",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["EigensysteAsPairs",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["was",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["modified",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["at",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["the",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["same",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["time",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["to",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["take",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["care",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["of",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["crack",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["matrices",
     FontColor->RGBColor[1, 0, 0]]}], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox["*)",
    FontColor->RGBColor[1, 0, 0]]}]}]], "Input",
 CellChangeTimes->{{3.824776702326624*^9, 3.8247767138639174`*^9}, {
   3.8247768350373755`*^9, 3.8247770297888775`*^9}, {3.8247770845114746`*^9, 
   3.8247771456388206`*^9}, {3.824777177982217*^9, 3.824777204242546*^9}, {
   3.8247788801780396`*^9, 3.8247788926207905`*^9}, {3.824778985916909*^9, 
   3.8247790793091335`*^9}, 3.8247957617373705`*^9, {3.875022009873817*^9, 
   3.875022052975492*^9}},
 CellLabel->
  "In[3206]:=",ExpressionUUID->"ed697781-4024-4f38-ba65-20e5915896fb"],

Cell[BoxData[
 RowBox[{"\[Lambda]vsSimpleLast", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.824777226187039*^9, 3.8247772365371685`*^9}, {
   3.8247772702587233`*^9, 3.8247773005627203`*^9}, 3.8247957328420057`*^9},
 CellLabel->
  "In[3207]:=",ExpressionUUID->"a604a19e-aed4-4c05-a311-fa8b232385df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]vsOrthogonalized", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]vsSimpleLast", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Orthogonalize", "[", 
      RowBox[{
       RowBox[{"\[Lambda]vsSimpleLast", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.824777413001976*^9, 3.824777545140653*^9}, {
   3.824777916602479*^9, 3.8247779251322455`*^9}, 3.8247779602540054`*^9, 
   3.824778037620552*^9, {3.82477814611897*^9, 3.8247781512521353`*^9}, {
   3.8247957551889315`*^9, 3.824795757424863*^9}, 3.824795859496504*^9, 
   3.824796400274746*^9},
 CellLabel->
  "In[3208]:=",ExpressionUUID->"22036b23-f167-48db-bc31-40e14284cb65"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"\[Lambda]vsOrthogonalized", "[", 
   RowBox[{"Eigensystem", "[", "ChrisMat", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.824777989385561*^9, 3.8247780134677453`*^9}, {
   3.8247780675377655`*^9, 3.8247780691747055`*^9}, {3.8247781022850866`*^9, 
   3.8247781102640667`*^9}, 3.824795861966935*^9, 3.8247963970872326`*^9},
 CellLabel->
  "In[3209]:=",ExpressionUUID->"c87bd770-1a33-44b3-8e0f-a77830ef7eed"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Orthogonalize", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "e", ",", "f"}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Element]", "Reals"}], ",", 
      RowBox[{"b", "\[Element]", "Reals"}], ",", 
      RowBox[{"c", "\[Element]", "Reals"}], ",", 
      RowBox[{"d", "\[Element]", "Reals"}], ",", 
      RowBox[{"e", "\[Element]", "Reals"}], ",", 
      RowBox[{"f", "\[Element]", "Reals"}], ","}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.875022395938527*^9, 3.875022398007325*^9}, {
  3.875022474895655*^9, 3.8750225023297615`*^9}, {3.8750225444584603`*^9, 
  3.875022651778858*^9}, {3.875022707701624*^9, 3.875022708998804*^9}},
 CellLabel->
  "In[3210]:=",ExpressionUUID->"41dd80a5-abd7-4761-a251-de6f2ba78e08"]
}, Open  ]],

Cell["\<\
EigensystemAsPairs[M] cannot be expected to work properly if M is symbolic, \
since the sorting will be according to the symbols.
The same applies to all commands in the following paragraph.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8750221751475487`*^9, 3.8750222385254803`*^9}, {
  3.8750234508819776`*^9, 
  3.87502346789835*^9}},ExpressionUUID->"e56136c8-6da3-4a07-bd09-\
12f88ded5f88"],

Cell["This can be done better", "Subsection",
 CellChangeTimes->{{3.8912709526902437`*^9, 
  3.8912709665109525`*^9}},ExpressionUUID->"5aa02f85-cd5b-4206-8d6e-\
d9c5336a82e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]vsAsPairs", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "v1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]2", ",", "v2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]3", ",", "v3"}], "}"}]}], "}"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxisCandidate", "[", "u_", "]"}], ":=", 
    RowBox[{"MakeReal", "[", 
     RowBox[{"unit", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"\[Lambda]vsAsPairs", "[", 
          RowBox[{"Eigensystem", "[", "u", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}],
        "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "the", " ", "eigenvector", " ", "with", " ", "eigenvalue", " ", "1.", " ",
      "MakeReal", " ", "added", " ", "July", " ", "2021"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxisCandidate", "[", "u_", "]"}], ":=", 
    RowBox[{"MakeReal", "[", 
     RowBox[{"unit", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"\[Lambda]vsAsPairs", "[", 
          RowBox[{"Eigensystem", "[", "u", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}], "<", 
           ".0001"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "eigenvector", " ", "with", " ", "eigenvalue", " ", "1.", 
       " ", "MakeReal", " ", "added", " ", "July", " ", "2021.", " ", "Added",
        " ", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}]}], "<", 
      RowBox[{
      ".000001", " ", "Feb", " ", "2024", " ", "to", " ", "accommodate", " ", 
       "matrices", " ", "that", " ", "were", " ", "not", " ", "quiet", " ", 
       "rotations"}]}], ",", " ", 
     RowBox[{"specifically", " ", "from", " ", "MSAT"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wperp", "[", "u_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
     "\[IndentingNewLine]", "                            ", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "                            ", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnitRotationAxis", "[", "u_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RotationAngle", "[", "u", "]"}], "\[Equal]", "\[Pi]"}], ",", 
      RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
      RowBox[{
       RowBox[{"Sign", "[", 
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Wperp", "[", "u", "]"}], ",", 
           RowBox[{"u", ".", 
            RowBox[{"Wperp", "[", "u", "]"}]}], ",", 
           RowBox[{"RotationAxisCandidate", "[", "u", "]"}]}], "}"}], "]"}], 
        "]"}], 
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}]}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"added", " ", "rot", " ", "angle"}], " ", "=", " ", 
     RowBox[{"\[Pi]", " ", "case", " ", "June", " ", "2022"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxis", "[", "u_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"RotationAngle", "[", "u", "]"}], "/", "2"}], "]"}], 
     RowBox[{"UnitRotationAxis", "[", "u", "]"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "Sept", " ", "2021"}], ",", " ", "CHECK"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxisExplicit", "[", GridBox[{
       {"u11_", "u12_", "u13_"},
       {"u21_", "u22_", "u23_"},
       {"u31_", "u32_", "u33_"}
      }], "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "u11", "+", "u22", "+", "u33"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}]], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u32", "-", "u23"}], ",", 
       RowBox[{"u13", "-", "u31"}], ",", 
       RowBox[{"u21", "-", "u12"}]}], "}"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"In", " ", "RotationAxisExplicit"}], ",", " ", 
     RowBox[{"U", " ", "must", " ", "be", " ", "a", " ", 
      RowBox[{"rotation", ".", " ", "The"}], " ", "rotation", " ", "angle", 
      " ", "cannot", " ", "be", " ", 
      RowBox[{"\[Pi]", ".", " ", "If"}], " ", "U", " ", "is", " ", 
      "numerical"}], ",", " ", 
     RowBox[{
     "then", " ", "the", " ", "rotation", " ", "angle", " ", "should", " ", 
      "not", " ", "be", " ", "too", " ", "close", " ", "to", " ", "\[Pi]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAngle", "[", 
     RowBox[{"U1_", ",", "U2_"}], "]"}], ":=", 
    RowBox[{"RotationAngle", "[", 
     RowBox[{"U2", ".", 
      RowBox[{"Transpose", "[", "U1", "]"}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"added", " ", "May", " ", "2019"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QuatOfU", "[", "u_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"length", "[", 
         RowBox[{"RotationAxis", "[", "u", "]"}], "]"}], "2"]}]], ",", 
     RowBox[{"RotationAxis", "[", "u", "]"}]}], "}"}]}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"w", " ", "automatically", " ", "non"}], "-", "negative"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.511625132793008*^9, 3.511625133666609*^9}, 
   3.511625437102738*^9, 3.511658711102789*^9, {3.5133060509992743`*^9, 
   3.513306053620079*^9}, {3.514402628816926*^9, 3.514402638551343*^9}, 
   3.514737096677024*^9, {3.52449593206017*^9, 3.5244959443061914`*^9}, {
   3.593024989853939*^9, 3.593024993383944*^9}, {3.5944959807015743`*^9, 
   3.594495981311575*^9}, {3.5944978762042255`*^9, 3.5944978908242455`*^9}, {
   3.5948752078132*^9, 3.594875251485263*^9}, {3.597341194101532*^9, 
   3.5973412871088943`*^9}, {3.668214368625022*^9, 3.6682143785850363`*^9}, {
   3.66821441045508*^9, 3.668214437855118*^9}, {3.668214532395248*^9, 
   3.668214560285287*^9}, 3.688343419048484*^9, 3.688343462925025*^9, 
   3.6924864795048723`*^9, {3.702399132582429*^9, 3.7023991392718105`*^9}, {
   3.7312525407227335`*^9, 3.7312526536292048`*^9}, {3.731252701098009*^9, 
   3.731252890067167*^9}, {3.7312529518172874`*^9, 3.7312530159111195`*^9}, {
   3.7312536726467733`*^9, 3.7312536828655915`*^9}, {3.731253811100219*^9, 
   3.731253819647109*^9}, {3.766956117792843*^9, 3.7669562337486477`*^9}, {
   3.809280661288514*^9, 3.8092806908727427`*^9}, {3.809281007866161*^9, 
   3.80928101514627*^9}, {3.8247782400753574`*^9, 3.8247782463973207`*^9}, 
   3.8247789673356752`*^9, 3.824795869716941*^9, {3.824796031161685*^9, 
   3.824796053196067*^9}, {3.8247961434888515`*^9, 3.8247961471154227`*^9}, 
   3.824796398181033*^9, {3.8365057024268017`*^9, 3.836505711427083*^9}, {
   3.8365057644941273`*^9, 3.836505803582756*^9}, {3.8408067473155355`*^9, 
   3.840806770631511*^9}, {3.8408070026593657`*^9, 3.840807004212391*^9}, {
   3.8408070351707993`*^9, 3.8408070849942217`*^9}, {3.8408077179280095`*^9, 
   3.8408077231244807`*^9}, {3.840808262612259*^9, 3.8408082845161905`*^9}, {
   3.8409094299917917`*^9, 3.840909447527794*^9}, {3.8409098942958803`*^9, 
   3.840909926484829*^9}, {3.840909976278035*^9, 3.8409099834446497`*^9}, {
   3.840986267359144*^9, 3.840986277377967*^9}, {3.8409863930701075`*^9, 
   3.840986503775838*^9}, {3.8409865565950923`*^9, 3.8409866075671387`*^9}, {
   3.8409866775203466`*^9, 3.840986689505313*^9}, {3.8409872109270697`*^9, 
   3.840987234591056*^9}, {3.84098735889954*^9, 3.8409873599344845`*^9}, {
   3.864340045229498*^9, 3.8643401643216968`*^9}, {3.8726106960254965`*^9, 
   3.87261071011981*^9}, {3.872610741487389*^9, 3.8726107570672193`*^9}, {
   3.8726108096031027`*^9, 3.872610814114208*^9}, {3.8726109727021885`*^9, 
   3.872610994322111*^9}, {3.8750228925887227`*^9, 3.8750229038793135`*^9}, {
   3.892692673266036*^9, 3.8926926806412*^9}, {3.892692717013853*^9, 
   3.892692737869045*^9}, 3.916512748334036*^9, 3.9165128166375127`*^9, {
   3.916513527126193*^9, 3.916513641804758*^9}, 3.916513810603492*^9, 
   3.9165139346834106`*^9},
 CellLabel->
  "In[3211]:=",ExpressionUUID->"d2c8d33c-0e1a-421a-b987-1c05df1578dc"],

Cell["\<\
Mathematica occasionally fails to find the correct eigenvectors for double \
couples. (See the file EigensystemBugForWolfram.) 
The following commands should be avoided, or at least checked, when M is a \
double couple.\
\>", "Text",
 CellChangeTimes->{{3.5949166905740185`*^9, 3.594916758664112*^9}, 
   3.875023492718404*^9},
 FontSize->14,
 FontColor->RGBColor[
  1, 0, 0],ExpressionUUID->"5c141cbe-3f41-420b-a13c-76d4bb8bc9fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"\[Lambda]vsAsPairs", "[", 
       RowBox[{"\[Lambda]vsOrthogonalized", "[", 
        RowBox[{"Eigensystem", "[", "M", "]"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "Mathematica", " ", "cannot", " ", "always", " ", "find", " ", 
      "eigenvectors", " ", "of", " ", "double", " ", "couples", " ", 
      "correctly"}], ",", " ", 
     RowBox[{
     "so", " ", "look", " ", "here", " ", "when", " ", "problems", " ", 
      "arise"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P1", "[", "M_", "]"}], ":=", 
    RowBox[{
     RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "P1", " ", "is", " ", "the", " ", "eigenvector", " ", "with", " ", 
     "biggest", " ", 
     RowBox[{"eigenvalue", "."}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P2", "[", "M_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"P1", "[", "M", "]"}], ",", 
          RowBox[{
           RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"P3", "[", "M", "]"}]}], "}"}], "]"}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P3", "[", "M_", "]"}], ":=", 
    RowBox[{
     RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", "  ", 
   StyleBox[
    RowBox[{
    "P3", " ", "is", " ", "the", " ", "eigenvector", " ", "with", " ", 
     "smallest", " ", 
     RowBox[{"eigenvalue", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]1ofM", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]2ofM", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]3ofM", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", "M_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]1ofM", "[", "M", "]"}], ",", 
        RowBox[{"\[Lambda]2ofM", "[", "M", "]"}], ",", 
        RowBox[{"\[Lambda]3ofM", "[", "M", "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"#1", ">", "#2"}], " ", "&"}]}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]ofM", "[", "M_", "]"}], ":=", 
    RowBox[{"Unit", "[", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]1ofM", "[", "M", "]"}], ",", 
         RowBox[{"\[Lambda]2ofM", "[", "M", "]"}], ",", 
         RowBox[{"\[Lambda]3ofM", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"#1", ">", "#2"}], "&"}]}], "]"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NORMALIZED", " ", "2012"}], "-", "11", "-", "22"}], ";", " ", 
      "somehow"}], ",", " ", 
     RowBox[{"without", " ", "the", " ", "sorting"}], ",", " ", 
     RowBox[{
     "the", " ", "entries", " ", "are", " ", "not", " ", "in", " ", "order", 
      " ", "for", " ", "some", " ", "crack", " ", 
      RowBox[{"tensors", ".", " ", "The"}], " ", "order", " ", "may", " ", 
      "not", " ", "be", " ", "correct", " ", "for", " ", "symbolic", " ", 
      "calculations"}], ",", " ", 
     RowBox[{
     "even", " ", "with", " ", "Mathematica", " ", "assumptions", " ", 
      "being", " ", "applied"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Uraw", "[", "M_", "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P1", "[", "M", "]"}], ",", 
      RowBox[{"P2", "[", "M", "]"}], ",", 
      RowBox[{"P3", "[", "M", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DCforM", "[", "M_", "]"}], ":=", 
    RowBox[{"\[CapitalLambda]subU", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"Uraw", "[", "M", "]"}]}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      StyleBox[
       RowBox[{"n", 
        StyleBox["ot",
         FontColor->RGBColor[1, 0, 0]]}]], " ", "closest", " ", "DC"}], ",", 
     " ", 
     RowBox[{"not", " ", "normalized"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", "M_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Uraw", "[", "M", "]"}], ".", 
      RowBox[{"yrot", "[", "45", "]"}]}]}], ";"}], "*)"}], "          ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"Eq", " ", 
       RowBox[{"(", "26", ")"}], " ", "of", " ", "TapeTapeBeach"}], ";", " ", 
      RowBox[{
      "the", " ", "first", " ", "and", " ", "third", " ", "frame", " ", 
       "vectors", " ", "of", " ", "V", " ", "are", " ", 
       RowBox[{"(", 
        RowBox[{"N", ",", "S"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "N"}], ",", 
         RowBox[{"-", "S"}]}], ")"}], ".", " ", 
       RowBox[{"(", 
        RowBox[{"S", ",", "N"}], ")"}]}], " ", "or", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "S"}], ",", 
        RowBox[{"-", "N"}]}], ")"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintUdata", "[", "M_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(U\), \(RAW\)]\)[M] = {P1,P2,P3} = \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ",", ".001"}], "]"}], "]"}], ",", 
       "\"\<, \!\(\*SubscriptBox[\(U\), \
\(RAW\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(RAW\)], \(T\)]\) = \>\"",
        ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Uraw", "[", "M", "]"}], "]"}], ".", 
          RowBox[{"Uraw", "[", "M", "]"}]}], "]"}], "]"}], ",", 
       "\"\<, det \!\(\*SubscriptBox[\(U\), \(RAW\)]\) = \>\"", ",", 
       RowBox[{"Det", "[", 
        RowBox[{"Uraw", "[", "M", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(U\), \(CAN\)]\)[M] = \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Ucan", "[", "M", "]"}], ",", ".001"}], "]"}], "]"}], ",", 
       "\"\<, \!\(\*SubscriptBox[\(U\), \
\(CAN\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(CAN\)], \(T\)]\) = \>\"",
        ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Ucan", "[", "M", "]"}], ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Ucan", "[", "M", "]"}], "]"}]}], "]"}], "]"}], ",", 
       "\"\<, det \!\(\*SubscriptBox[\(U\), \(CAN\)]\) = \>\"", ",", 
       RowBox[{"Det", "[", 
        RowBox[{"Ucan", "[", "M", "]"}], "]"}]}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BeachballForM", "[", 
   RowBox[{"M_", ",", "c_", ",", "BBrad_"}], "]"}], ":=", 
  RowBox[{"BeachBall", "[", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"\[CapitalLambda]ofM", "[", "M", "]"}], "]"}], ",", 
    RowBox[{"Uraw", "[", "M", "]"}], ",", "c", ",", "BBrad"}], "]"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "added", " ", "Chop", " ", "May", " ", "2018", " ", "due", " ", "to", " ",
      "double", " ", "couple", " ", "problems"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5093955617346*^9, 3.5093956488847203`*^9}, {
   3.5093966955561647`*^9, 3.5093967281262097`*^9}, {3.50939680107631*^9, 
   3.509396808796321*^9}, {3.5094034704952726`*^9, 3.509403630755494*^9}, {
   3.5094052339777064`*^9, 3.50940525132773*^9}, {3.5097247108236847`*^9, 
   3.509724710843684*^9}, {3.5097247438337297`*^9, 3.5097248140038266`*^9}, {
   3.50972484512387*^9, 3.5097248686639023`*^9}, {3.5097253274145355`*^9, 
   3.5097253598845797`*^9}, {3.509725414714656*^9, 3.509725421744665*^9}, {
   3.509725477094742*^9, 3.509725550344843*^9}, {3.509730446767604*^9, 
   3.5097304593376207`*^9}, {3.509730648537882*^9, 3.5097306649879045`*^9}, {
   3.5097310495984354`*^9, 3.5097310525584393`*^9}, {3.509731149978574*^9, 
   3.5097311721786046`*^9}, {3.5097386461289186`*^9, 
   3.5097387055390005`*^9}, {3.509738742899052*^9, 3.5097387836791086`*^9}, {
   3.50976718615437*^9, 3.5097672806345005`*^9}, {3.5098042015502777`*^9, 
   3.509804400660552*^9}, {3.5101993779124537`*^9, 3.51019950759548*^9}, {
   3.5101995383963346`*^9, 3.510199633026099*^9}, {3.510199715441043*^9, 
   3.5101997657823305`*^9}, {3.510199800944792*^9, 3.5101998073876033`*^9}, {
   3.510199844593668*^9, 3.5101999038737717`*^9}, {3.5101999544178596`*^9, 
   3.5101999745262947`*^9}, {3.5102001017601166`*^9, 3.510200130666967*^9}, {
   3.5102004217166743`*^9, 3.51020042517988*^9}, {3.5102004808875775`*^9, 
   3.510200489202392*^9}, {3.5102460071585693`*^9, 3.5102460729750843`*^9}, {
   3.510246114159156*^9, 3.51024611628076*^9}, {3.510363189787038*^9, 
   3.51036319690065*^9}, {3.5103640464937315`*^9, 3.5103640484749346`*^9}, {
   3.510772975664796*^9, 3.510772977544798*^9}, {3.510939725024397*^9, 
   3.510939770420476*^9}, {3.511622781619308*^9, 3.5116228029133453`*^9}, {
   3.51162285734184*^9, 3.5116228920987005`*^9}, {3.5116252490132103`*^9, 
   3.5116252551752205`*^9}, {3.5116420095352383`*^9, 3.5116420648373346`*^9}, 
   3.5116420958501883`*^9, {3.5116421457078753`*^9, 3.511642188015149*^9}, {
   3.5116422669668865`*^9, 3.511642273565698*^9}, {3.5116431630456486`*^9, 
   3.5116431815784807`*^9}, {3.5116432151497393`*^9, 
   3.5116432191745462`*^9}, {3.511643565061549*^9, 3.5116436303944635`*^9}, {
   3.5116436633261204`*^9, 3.5116436980985813`*^9}, {3.5116439905054913`*^9, 
   3.511644032438364*^9}, {3.511644738725196*^9, 3.511644739676797*^9}, {
   3.511645516715352*^9, 3.511645526418569*^9}, {3.511663172856595*^9, 
   3.5116631848998156`*^9}, {3.5123913190856752`*^9, 3.512391320195677*^9}, 
   3.514737078222192*^9, {3.5157290708393345`*^9, 3.515729071931337*^9}, {
   3.515730441698127*^9, 3.515730448546539*^9}, {3.5249708309603434`*^9, 
   3.5249709233004704`*^9}, {3.5249709608705225`*^9, 3.5249711125107317`*^9}, 
   3.5249720959220886`*^9, {3.525013335390806*^9, 3.5250133827056885`*^9}, {
   3.5250137157506695`*^9, 3.525013738635909*^9}, {3.5579324320829763`*^9, 
   3.5579325376639605`*^9}, {3.557932615960497*^9, 3.5579327727875705`*^9}, {
   3.557932936260256*^9, 3.5579329385690594`*^9}, {3.5579335132740617`*^9, 
   3.557933526721285*^9}, 3.5579335764541717`*^9, {3.557933682237956*^9, 
   3.557933688509167*^9}, {3.557933728429637*^9, 3.557933729896039*^9}, {
   3.5579338380510283`*^9, 3.5579338394550304`*^9}, 3.5602215933973017`*^9, {
   3.560223301509659*^9, 3.560223307409667*^9}, {3.562531042626876*^9, 
   3.5625310451540804`*^9}, {3.5625310996605754`*^9, 
   3.5625311319058313`*^9}, {3.562613918610786*^9, 3.5626139271908007`*^9}, {
   3.5626141997544765`*^9, 3.562614260906583*^9}, {3.5626149918926573`*^9, 
   3.562615021002308*^9}, {3.5783365397936935`*^9, 3.578336555483715*^9}, {
   3.580500080629549*^9, 3.580500096447976*^9}, {3.5806611998286266`*^9, 
   3.5806613041616087`*^9}, {3.5944965658423977`*^9, 3.594496576492412*^9}, {
   3.594496608982457*^9, 3.5944966093724575`*^9}, {3.5944966911845713`*^9, 
   3.594496692754574*^9}, {3.594496728468626*^9, 3.5944967291186275`*^9}, {
   3.594497682829956*^9, 3.5944978229821506`*^9}, {3.594753965528139*^9, 
   3.594754031765232*^9}, {3.5947540663077793`*^9, 3.5947540891418133`*^9}, {
   3.5948711541024694`*^9, 3.5948711603624783`*^9}, {3.595217323377353*^9, 
   3.595217326837358*^9}, {3.5952173994894595`*^9, 3.595217464063551*^9}, 
   3.595217561323685*^9, 3.595217906776163*^9, {3.7358712079498863`*^9, 
   3.735871264871873*^9}, {3.7584800000879974`*^9, 3.7584800394478645`*^9}, {
   3.824796249790343*^9, 3.824796307873204*^9}, 3.8711354352349615`*^9, {
   3.875023291881778*^9, 3.875023293874007*^9}, 3.875023372876873*^9, 
   3.8750234362002745`*^9, 3.8750258248290725`*^9, {3.918582445631399*^9, 
   3.918582482928029*^9}, 3.9185826762240987`*^9, {3.918582876831859*^9, 
   3.9185828777444725`*^9}, {3.918583086127241*^9, 3.918583088591036*^9}},
 CellLabel->
  "In[3220]:=",ExpressionUUID->"cdc2df6c-9ec9-48ab-8610-db53d39dc134"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"quaternion", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Sqrt]", 
      RowBox[{"Chop", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"length", "[", "v", "]"}], "2"]}], "]"}]}], ",", "v"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lengthWV", "[", 
    RowBox[{"{", 
     RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
   RowBox[{"length", "[", 
    RowBox[{"{", 
     RowBox[{"w", ",", 
      RowBox[{"length", "[", "v", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotAxisOfWV", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"w", "\[GreaterEqual]", "0"}], ",", "v", ",", 
      RowBox[{"{", 
       RowBox[{"999", ",", "999", ",", "999"}], "}"}]}], "]"}]}], ";"}], 
  "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "had", " ", "to", " ", "be", " ", "changed", " ", "from", " ", "RotAxis",
       " ", "so", " ", "as", " ", "not", " ", "to", " ", "conflict", " ", 
      "with", " ", "CRYSTALLOGRAPHIC", " ", "GROUPS"}], ",", " ", 
     RowBox[{"04", "-", "04", "-", "2011"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotAngOfWV", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"w", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"2", 
       RowBox[{"arcsind", "[", 
        RowBox[{"length", "[", "v", "]"}], "]"}]}], ",", "999"}], "]"}]}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "had", " ", "to", " ", "be", " ", "changed", " ", "from", " ", 
      "RotAngle", " ", "so", " ", "as", " ", "not", " ", "to", " ", 
      "conflict", " ", "with", " ", "CRYSTALLOGRAPHIC", " ", "GROUPS"}], ",", 
     " ", 
     RowBox[{"04", "-", "04", "-", "2011"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  "        "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WVproduct", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w1_", ",", 
       RowBox[{"{", 
        RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"w2_", ",", 
       RowBox[{"{", 
        RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"w1", " ", "w2"}], "-", 
      RowBox[{"x1", " ", "x2"}], "-", 
      RowBox[{"y1", " ", "y2"}], "-", 
      RowBox[{"z1", " ", "z2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"w2", " ", "x1"}], "+", 
        RowBox[{"w1", " ", "x2"}], "-", 
        RowBox[{"y2", " ", "z1"}], "+", 
        RowBox[{"y1", " ", "z2"}]}], ",", 
       RowBox[{
        RowBox[{"w2", " ", "y1"}], "+", 
        RowBox[{"w1", " ", "y2"}], "+", 
        RowBox[{"x2", " ", "z1"}], "-", 
        RowBox[{"x1", " ", "z2"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "x2"}], " ", "y1"}], "+", 
        RowBox[{"x1", " ", "y2"}], "+", 
        RowBox[{"w2", " ", "z1"}], "+", 
        RowBox[{"w1", " ", "z2"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WVproduct", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "q3_"}], "]"}], ":=", 
   RowBox[{"WVproduct", "[", 
    RowBox[{
     RowBox[{"WVproduct", "[", 
      RowBox[{"q1", ",", "q2"}], "]"}], ",", "q3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wPositivePt", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sign", "[", "w", "]"}], 
     RowBox[{"{", 
      RowBox[{"w", ",", "v"}], "}"}]}]}], ";"}], "    "}]}], "Input",
 CellChangeTimes->{{3.5054402308477435`*^9, 3.505440252282181*^9}, {
   3.5054403043706717`*^9, 3.505440407720852*^9}, {3.5054405825362186`*^9, 
   3.5054405838934207`*^9}, {3.505440613985873*^9, 3.5054406262162943`*^9}, 
   3.505440693546012*^9, 3.5114658714374523`*^9, {3.5114663897079563`*^9, 
   3.5114663966187677`*^9}, {3.5114677692039614`*^9, 
   3.5114677702335634`*^9}, {3.5116236451588135`*^9, 3.511623653317628*^9}, {
   3.5116246389429464`*^9, 3.51162464689896*^9}, {3.511624713729477*^9, 
   3.511624776566386*^9}, {3.5116250129535985`*^9, 3.5116250364940395`*^9}, {
   3.5116250730449033`*^9, 3.511625079877715*^9}, {3.511625130858604*^9, 
   3.511625139407419*^9}, {3.5133049124156895`*^9, 3.5133049570629673`*^9}, {
   3.5133051334368744`*^9, 3.513305134248076*^9}, {3.5133062472788167`*^9, 
   3.513306265733649*^9}, {3.513308973765971*^9, 3.513308989428399*^9}, {
   3.514737018708088*^9, 3.51473703671052*^9}, {3.5147371022150335`*^9, 
   3.514737120467066*^9}, 3.5223807941244354`*^9, {3.5223808283544827`*^9, 
   3.52238083368449*^9}, {3.5930249376838675`*^9, 3.5930249617339*^9}, {
   3.5944962535439587`*^9, 3.5944962585839653`*^9}, {3.594496331438069*^9, 
   3.5944963320380697`*^9}, {3.5944963698281217`*^9, 3.594496377268132*^9}, 
   3.594497511455717*^9},
 CellLabel->
  "In[3233]:=",ExpressionUUID->"f37a34d1-4b59-4b04-82e1-06f1b970ad6f"],

Cell["Elastic map stuff", "Section",
 CellChangeTimes->{{3.8912669075101666`*^9, 
  3.891266927159681*^9}},ExpressionUUID->"dfeb9470-90fa-4772-b627-\
3c73965cea3b"],

Cell["\<\
First is material added October 2024. Some was moved from SSM_basic.\
\>", "Section",
 CellChangeTimes->{{3.8912669075101666`*^9, 3.891266927159681*^9}, {
  3.9384749530044513`*^9, 
  3.9384750413004284`*^9}},ExpressionUUID->"226e4501-8e51-4195-8c9e-\
e1ecaa821059"],

Cell[CellGroupData[{

Cell["\<\
The CsToSymbolsRules just allows for more compact and more idiomatic  \
formatting .\
\>", "Subsubsection",
 CellChangeTimes->{{3.936457968687147*^9, 3.9364580044920235`*^9}, {
  3.938368910162955*^9, 
  3.938368912163732*^9}},ExpressionUUID->"f586061a-134a-40ce-b71c-\
80ac478175db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "c", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CsToSymbolsRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1111"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1122"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1133"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1123"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1113"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1112"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2222"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2233"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2223"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2213"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2212"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3333"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3323"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3313"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3312"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2323"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2313"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2312"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1313"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1312"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1212"]}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
       "the", " ", "rest", " ", "are", " ", "out", " ", "of", " ", "Voigt", 
        " ", "order"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1121"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "3", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1131"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "3", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1132"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2221"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2211"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "3", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2231"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "3", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2232"]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3311"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3322"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2311"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2322"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2333"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1311"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1322"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1333"]}], ",", " ", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1323"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1211"]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1222"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1233"]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "2", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1223"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "1213"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3111"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3122"]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3133"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3211"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3222"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "3233"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2122"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2", ",", "2"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2111"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "3", ",", "3"}], "}"}], "]"}], "\[Rule]", 
      SubscriptBox["c", "2133"]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7271231694723997`*^9, 3.727123192097444*^9}, {
   3.7273222855989637`*^9, 3.7273223240209246`*^9}, {3.727322355052221*^9, 
   3.727322505177529*^9}, 3.7844932606724296`*^9, {3.784507102396552*^9, 
   3.7845071163211365`*^9}, {3.784507213691094*^9, 3.7845072554323387`*^9}, {
   3.784507362714534*^9, 3.7845074092270594`*^9}, 3.784507461896552*^9, {
   3.784507504297629*^9, 3.7845075261142983`*^9}, {3.784507558106136*^9, 
   3.784507623606986*^9}, {3.784507656708209*^9, 3.7845076835856147`*^9}, {
   3.7845077176853247`*^9, 3.7845077841176558`*^9}, {3.784507857225442*^9, 
   3.784507869243431*^9}, {3.7845079102676177`*^9, 3.7845079785469227`*^9}, {
   3.784508014489888*^9, 3.784508069913365*^9}, {3.784508891860853*^9, 
   3.7845089093947926`*^9}, 3.7845090432908716`*^9, {3.7845091012080207`*^9, 
   3.784509208087411*^9}, {3.784509309524125*^9, 3.7845093578893137`*^9}, {
   3.7845094057000127`*^9, 3.7845094242489643`*^9}, {3.804191734368883*^9, 
   3.8041917639557905`*^9}, {3.8041918138107743`*^9, 3.804191837607046*^9}, {
   3.8041918759353004`*^9, 3.804191951858446*^9}, {3.8041919919356165`*^9, 
   3.8041920194096537`*^9}, {3.8041920615182624`*^9, 3.804192106240076*^9}, {
   3.8042026497031827`*^9, 3.804202669751649*^9}, {3.804202703382084*^9, 
   3.8042027155092535`*^9}, {3.8042027575609837`*^9, 3.804202768017223*^9}, {
   3.8042028047112155`*^9, 3.804202814664892*^9}, {3.804202859184841*^9, 
   3.8042028717791476`*^9}, {3.8042029111293955`*^9, 
   3.8042029328689594`*^9}, {3.804203067022374*^9, 3.804203068756748*^9}, {
   3.804210314108553*^9, 3.804210348539711*^9}, {3.804210422566741*^9, 
   3.8042104681525235`*^9}, {3.80947814136057*^9, 3.8094781466565886`*^9}, {
   3.9351092439599905`*^9, 3.935109303191965*^9}, {3.9363810078657007`*^9, 
   3.936381027905816*^9}},
 CellLabel->
  "In[3240]:=",ExpressionUUID->"a2727605-7936-47b1-b4c6-d2a7d502f2ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
VoigtStrictOrder[{i, j, k, l}] is True if i \[LessEqual] j, k \[LessEqual] l, \
and if the pairs {i, j} and {k, l} follow the order {1, 1} \[Precedes] {2, 2} \
\[Precedes] {3, 3} \[Precedes] {2, 3} \[Precedes] {1, 3} \[Precedes] {1, 2}.\
\>", "Subsubsection",
 CellChangeTimes->{{3.936974405042311*^9, 3.936974529166264*^9}, {
  3.9369745691935577`*^9, 3.936974606518217*^9}, {3.93697464407672*^9, 
  3.9369747031955643`*^9}, {3.936974861545603*^9, 3.9369749284167986`*^9}, {
  3.9369749672720823`*^9, 3.9369749687563305`*^9}, {3.9375202408361893`*^9, 
  3.9375202547489295`*^9}, {3.937520291850054*^9, 3.9375203415146885`*^9}, {
  3.9375204452705297`*^9, 3.9375204458646574`*^9}, {3.9375220436730013`*^9, 
  3.937522163303053*^9}, {3.9375788404316607`*^9, 
  3.9375788424648013`*^9}},ExpressionUUID->"2eea26a1-dcea-469c-b699-\
80a6628a781c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "VoigtStrictOrder", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VoigtStrictOrder", "[", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "}"}], "]"}], ":=", 
   "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VoigtStrictOrder", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"VoigtStrictOrder", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"VoigtStrictOrder", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"VoigtStrictOrder", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"VoigtStrictOrder", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], "]"}], "=", 
       "True"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"                                                                    \
   ", 
  RowBox[{
   RowBox[{
    RowBox[{"VoigtStrictOrder", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "3", ",", "3"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"VoigtStrictOrder", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "2", ",", "3"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"VoigtStrictOrder", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "1", ",", "3"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{"VoigtStrictOrder", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2", ",", "1", ",", "2"}], "}"}], "]"}], "=", 
       "True"}]}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"                                                                    \
                                                                           ", 
  RowBox[{
   RowBox[{
    RowBox[{"VoigtStrictOrder", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "2", ",", "3"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"VoigtStrictOrder", "[", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "1", ",", "3"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"VoigtStrictOrder", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "1", ",", "2"}], "}"}], "]"}], "=", 
      "True"}]}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"                                                                    \
                                                                              \
                                                                    ", 
  RowBox[{
   RowBox[{
    RowBox[{"VoigtStrictOrder", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "1", ",", "3"}], "}"}], "]"}], "=", 
    RowBox[{
     RowBox[{"VoigtStrictOrder", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "1", ",", "2"}], "}"}], "]"}], "=", 
     "True"}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"                                                                    \
                                                                              \
                                                                              \
                                                              ", 
  RowBox[{
   RowBox[{
    RowBox[{"VoigtStrictOrder", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "1", ",", "2"}], "}"}], "]"}], "=", 
    "True"}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"xxx", ";"}]}], "Input",
 CellChangeTimes->{{3.784497782885748*^9, 3.784497842587477*^9}, {
   3.784497910729776*^9, 3.784498164218346*^9}, 3.784498209102256*^9, {
   3.784498462195044*^9, 3.7844984655075445`*^9}, {3.7844985063037047`*^9, 
   3.784498578382766*^9}, {3.7844987313042936`*^9, 3.7844987697025375`*^9}, {
   3.7845066288996935`*^9, 3.7845066359465694`*^9}, {3.7845067430132246`*^9, 
   3.7845067562809706`*^9}, {3.7847752958894863`*^9, 
   3.7847752972645087`*^9}, {3.936916836223019*^9, 3.9369168465664406`*^9}, {
   3.9369168812188406`*^9, 3.93691689218777*^9}, {3.9369200784241705`*^9, 
   3.9369201182401056`*^9}, 3.936922596592682*^9, 3.936922645718173*^9, {
   3.9369732302475443`*^9, 3.936973231263678*^9}, {3.93697333008634*^9, 
   3.9369733311799107`*^9}, {3.9370683517222652`*^9, 3.937068442702183*^9}, {
   3.937068613340556*^9, 3.937068630620325*^9}, {3.937068686098802*^9, 
   3.937068744452563*^9}, {3.9371880756879005`*^9, 3.9371882225645604`*^9}, {
   3.937188259918994*^9, 3.9371883433793526`*^9}, {3.938510733424489*^9, 
   3.93851088391787*^9}, {3.9385109341314816`*^9, 3.9385109557900743`*^9}},
 CellLabel->
  "In[3242]:=",ExpressionUUID->"13bd5a17-d2e1-4942-9c8d-0cab9fa6d59c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The function Canonical expresses the usual symmetries of elastic constants. \
\>", "Subsubsection",
 CellChangeTimes->{{3.9364580555510726`*^9, 3.936458087243639*^9}, {
   3.9364594172057176`*^9, 3.936459420268038*^9}, {3.9370888830239573`*^9, 
   3.9370888904347196`*^9}, 3.9370944822227564`*^9, {3.9374984047119856`*^9, 
   3.93749841152352*^9}},ExpressionUUID->"c24d55ee-3cb1-4405-b870-\
72131b8838d0"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"Canonical", ",", "ve1", ",", "ve2", ",", "ve3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ve1", "[", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", ">", "j"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "i", ",", "k", ",", "l"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ve2", "[", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"k", ">", "l"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "l", ",", "k"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ve3", "[", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"VoigtStrictOrder", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "l", ",", "i", ",", "j"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Canonical", "[", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "}"}], "]"}], ":=", 
   RowBox[{"ve3", "[", 
    RowBox[{"ve2", "[", 
     RowBox[{"ve1", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9363674420424995`*^9, 3.9363676533693366`*^9}, {
   3.9363684524067163`*^9, 3.936368611884406*^9}, {3.936368657285797*^9, 
   3.9363686737996593`*^9}, {3.9363687373467026`*^9, 3.936368744939726*^9}, {
   3.937068201617675*^9, 3.9370682429274883`*^9}, 3.9370886073708076`*^9, {
   3.9370888239796333`*^9, 3.937088865710456*^9}, {3.9371563434895163`*^9, 
   3.9371563534929805`*^9}, {3.937166376532138*^9, 3.9371663856349*^9}, {
   3.9371664208880744`*^9, 3.93716642188795*^9}, {3.937168407896409*^9, 
   3.9371684333176665`*^9}, {3.9371700531987677`*^9, 3.937170060940386*^9}, {
   3.9371701557211437`*^9, 3.937170156706785*^9}, 3.9374983510188384`*^9, 
   3.937498428129425*^9},
 CellLabel->
  "In[3250]:=",ExpressionUUID->"8caae1c9-f736-447b-a16c-0086feb83659"],

Cell[BoxData[
 RowBox[{"Canonical", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "3", ",", "2", ",", "2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9363686185243225`*^9, 3.936368630757394*^9}, {
   3.936368772954534*^9, 3.936368809185692*^9}, {3.93645811808631*^9, 
   3.9364581262109795`*^9}, {3.9370683052116413`*^9, 3.9370683100860434`*^9}, 
   3.937088558517226*^9, 3.9374983527215495`*^9},
 CellLabel->
  "In[3255]:=",ExpressionUUID->"5f6caf70-7ef5-4743-8df2-bfe752ce2685"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The elastic ",
 StyleBox["map",
  FontSlant->"Italic"],
 " (not a 6x6 matrix) ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["L",
     FontWeight->"Bold",
     FontSlant->"Plain"], "c"], TraditionalForm]],ExpressionUUID->
  "66e812d0-e819-43ae-b40a-58a19b5a1c73"],
 " = Lbold[c]."
}], "Section",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, 3.7860464260899963`*^9, {3.78676211788239*^9, 
   3.7867621397703743`*^9}, {3.7867625740263863`*^9, 3.786762606202387*^9}, {
   3.786821685564948*^9, 3.7868217195969477`*^9}, 3.7892903646702075`*^9, {
   3.9370939105317674`*^9, 3.937093913547152*^9}, {3.9371886324292483`*^9, 
   3.9371886344445777`*^9}, {3.9372478584828024`*^9, 3.9372479026359797`*^9}, 
   3.9374983631881638`*^9, {3.937498554266716*^9, 3.937498652190052*^9}, {
   3.9375789295889597`*^9, 3.9375789763519526`*^9}, {3.937601452894419*^9, 
   3.9376014603628793`*^9}, {3.9376014972183647`*^9, 3.93760154376361*^9}, {
   3.9376015744497356`*^9, 3.937601575012282*^9}, {3.938053456762128*^9, 
   3.9380534639510527`*^9}},ExpressionUUID->"13cf7320-b5ed-4ac9-8103-\
8f514e041cff"],

Cell["\<\
Do not use Lbold[c] and BlankSlate together, since both involve c. Use \
BlankSlatePrime instead.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9381133772211018`*^9, 
  3.9381134481600065`*^9}},ExpressionUUID->"41c2ec94-2670-49fc-b090-\
77ac9da59a78"],

Cell[CellGroupData[{

Cell[TextData[{
 "The 3 x 3 matrix Fmat is computed using all 81 of the c[{i, j, k, l}], but \
they are immediately changed to c[Canonical[{i, j, k, l}]].\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["L",
     FontWeight->"Bold",
     FontSlant->"Plain"], "c"], TraditionalForm]],ExpressionUUID->
  "aa999f6d-9c49-4399-9745-0ecd1654be23"],
 " is the elastic ",
 StyleBox["map",
  FontSlant->"Italic"],
 " with elastic constants ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "]"}], "  ", 
    RowBox[{"(", 
     RowBox[{"shortened", " ", "to", " ", 
      SubscriptBox["c", "ijkl"]}]}]}], TraditionalForm]],ExpressionUUID->
  "6167fcd1-940b-408b-9daa-e76185d5df05"],
 ")."
}], "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, 3.7860464260899963`*^9, {3.78676211788239*^9, 
   3.7867621397703743`*^9}, {3.7867625740263863`*^9, 3.786762606202387*^9}, {
   3.786821685564948*^9, 3.7868217195969477`*^9}, 3.7892903646702075`*^9, {
   3.9370939105317674`*^9, 3.937093913547152*^9}, {3.9371886324292483`*^9, 
   3.9371886344445777`*^9}, {3.9372478584828024`*^9, 3.9372479026359797`*^9}, 
   3.9374983631881638`*^9, {3.937498554266716*^9, 3.937498652190052*^9}, {
   3.9375789295889597`*^9, 3.9375789763519526`*^9}, {3.937601452894419*^9, 
   3.9376014603628793`*^9}, {3.9376016161965985`*^9, 
   3.9376016260868087`*^9}, {3.9380534788570995`*^9, 
   3.938053485435607*^9}},ExpressionUUID->"f7aba39f-2c1b-4a72-83e6-\
b7e1742a87f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ff", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}], ",", "Emat_", ",", "c_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{"Canonical", "[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "kk", ",", "ll"}], "}"}], "]"}], "]"}], 
       RowBox[{"Emat", "[", 
        RowBox[{"[", 
         RowBox[{"kk", ",", "ll"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ll", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", " ", 
      RowBox[{"(", "2", ")"}], " ", "of", " ", 
      RowBox[{"TT2021", ".", " ", "Changed"}], " ", "July", " ", "10"}], ",", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "2020", " ", "and", " ", "again", " ", "2024.", " ", "Like", " ", 
          "Aki"}], " ", "&"}], " ", "Rich", " ", "eq", " ", 
        RowBox[{"2.18", ".", " ", "Also"}], " ", "like", " ", "Mehrabadi"}], 
       " ", "&"}], " ", "Cowin", " ", "Eq", " ", 
      RowBox[{"(", "2.1", ")"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Fmat", "[", 
     RowBox[{"Emat_", ",", "c_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", "Emat", ",", "c"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "the", " ", "stress", " ", "associated", " ", "with", " ", "strain", " ", 
     "Emat"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lbold", "[", "c_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Fmat", "[", 
      RowBox[{"#", ",", "c"}], "]"}], "&"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9369756973142233`*^9, 3.9369757340918684`*^9}, 
   3.937088648118313*^9, {3.937091581765115*^9, 3.93709160209136*^9}, {
   3.937091641088229*^9, 3.9370916616169424`*^9}, 3.9370937047972565`*^9, {
   3.937188675549257*^9, 3.9371886857040753`*^9}, {3.937189666971014*^9, 
   3.937189668095929*^9}, {3.937189703305475*^9, 3.937189763661784*^9}, {
   3.9371901233498325`*^9, 3.937190125905694*^9}, {3.937190248229363*^9, 
   3.9371902561810064`*^9}, {3.937190354445588*^9, 3.9371903630810795`*^9}, {
   3.93719039317594*^9, 3.9371903956130795`*^9}, {3.9371906649743977`*^9, 
   3.9371906974741826`*^9}, {3.9372451618292947`*^9, 3.937245163565798*^9}, {
   3.937245449850624*^9, 3.937245549467992*^9}, {3.9372455804642754`*^9, 
   3.937245588526491*^9}, {3.9372474341936307`*^9, 3.9372474346170444`*^9}, {
   3.9372475454930096`*^9, 3.937247546961996*^9}, {3.937247600335273*^9, 
   3.937247604589718*^9}, {3.937247925814021*^9, 3.93724792662643*^9}, 
   3.937498365625142*^9, 3.937498896122916*^9, {3.937506471677727*^9, 
   3.9375065213598857`*^9}, {3.937522510478756*^9, 3.9375225135408106`*^9}, {
   3.9383690242385683`*^9, 3.9383690262702985`*^9}, {3.938369130252198*^9, 
   3.938369149802656*^9}},
 CellLabel->
  "In[3256]:=",ExpressionUUID->"9cd76e62-22fb-4468-9015-6bba38704344"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Emat", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"e11", "e12", "e13"},
      {"e12", "e22", "e23"},
      {"e13", "e23", "e33"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[3259]:=",ExpressionUUID->"13b6e91d-9aae-4767-977a-c2aa1d1e2135"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Next is a friendlier description of the elastic map ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["L",
     FontWeight->"Bold",
     FontSlant->"Plain"], "c"], TraditionalForm]],ExpressionUUID->
  "1da475ab-2749-468f-a322-4555704d8905"],
 ". \nRemember that Fmat is the stress arising from strain Emat in the \
material described by ",
 StyleBox["c",
  FontSlant->"Italic"],
 ". \nSo ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["L",
     FontWeight->"Bold",
     FontSlant->"Plain"], "c"], TraditionalForm]],ExpressionUUID->
  "c9db4cf8-5115-4df0-9194-e8183aefcb0c"],
 " is the function that takes strain to stress."
}], "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, 3.7860464260899963`*^9, {3.78676211788239*^9, 
   3.7867621397703743`*^9}, {3.7867625740263863`*^9, 3.786762606202387*^9}, {
   3.786821685564948*^9, 3.7868217195969477`*^9}, 3.7892903646702075`*^9, {
   3.9370939105317674`*^9, 3.937093913547152*^9}, {3.9371886324292483`*^9, 
   3.9371886344445777`*^9}, {3.9372478584828024`*^9, 3.9372479026359797`*^9}, 
   3.9374983631881638`*^9, {3.937498554266716*^9, 3.937498652190052*^9}, {
   3.937522613211907*^9, 3.9375226458807535`*^9}, {3.9375792350269423`*^9, 
   3.9375792426737933`*^9}, {3.937601693119392*^9, 3.937601693947529*^9}, 
   3.938053510877491*^9, {3.9381869444076757`*^9, 3.9381869670632243`*^9}, {
   3.9381870345745907`*^9, 3.9381870852829823`*^9}, {3.9381871202872505`*^9, 
   3.9381871423965464`*^9}, {3.9381880776101556`*^9, 
   3.938188085954548*^9}},ExpressionUUID->"7e017654-1c81-4826-acde-\
eec61e4dbe5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Lbold", "[", "c", "]"}], "[", "Emat", "]"}], "==", 
  RowBox[{"Fmat", "[", 
   RowBox[{"Emat", ",", "c"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9381867724542336`*^9, 3.938186773563918*^9}, {
  3.9381868644735765`*^9, 3.9381868692078156`*^9}},
 CellLabel->
  "In[3260]:=",ExpressionUUID->"437ab04c-2a82-4c35-940d-f6dc016a507a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Lc", "=", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<L\>\"", ",", "Bold", ",", "13"}], "]"}], ",", 
      "\"\<c\>\""}], "]"}], "//", "DisplayForm"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9381042235164957`*^9, 3.938104236601861*^9}},
 CellLabel->
  "In[3261]:=",ExpressionUUID->"25d7e6cf-9c95-4a71-81f7-9056c4a61091"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The elastic map ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["L",
     FontWeight->"Bold",
     FontSlant->"Plain"], "c"], TraditionalForm]],ExpressionUUID->
  "53d83ec1-7c99-452e-b10b-1b77e8828120"],
 " acting on the strain Emat:"
}], "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, 3.7860464260899963`*^9, {3.78676211788239*^9, 
   3.7867621397703743`*^9}, {3.7867625740263863`*^9, 3.786762606202387*^9}, {
   3.786821685564948*^9, 3.7868217195969477`*^9}, 3.7892903646702075`*^9, {
   3.9370939105317674`*^9, 3.937093913547152*^9}, {3.9371886324292483`*^9, 
   3.9371886344445777`*^9}, {3.9372478584828024`*^9, 3.9372479026359797`*^9}, 
   3.9374983631881638`*^9, {3.937498554266716*^9, 3.937498652190052*^9}, {
   3.937522613211907*^9, 3.9375226458807535`*^9}, {3.9375792350269423`*^9, 
   3.9375792426737933`*^9}, {3.937601693119392*^9, 3.937601693947529*^9}, 
   3.938053510877491*^9},ExpressionUUID->"e37544bb-f331-4e96-8636-\
05c77d2265d9"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"Lc", ",", 
   RowBox[{"MatrixForm", "[", "Emat", "]"}], ",", "\"\< = \>\"", ",", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"Lbold", "[", "c", "]"}], "[", "Emat", "]"}], "]"}], "/.", 
    "CsToSymbolsRules"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9370080018957524`*^9, 3.937008023585924*^9}, {
   3.937008114750965*^9, 3.93700814175415*^9}, {3.9370083852390995`*^9, 
   3.9370083862088428`*^9}, 3.9374987408771706`*^9, {3.937499004008086*^9, 
   3.93749906491171*^9}, {3.937499118908457*^9, 3.9374991275574703`*^9}, {
   3.938104050720699*^9, 3.938104110387807*^9}, {3.938104159840455*^9, 
   3.9381041786166496`*^9}, 3.9381042607637615`*^9, {3.938134130868621*^9, 
   3.9381341319153824`*^9}, {3.9381867612354546`*^9, 
   3.9381867621574297`*^9}, {3.938186893503778*^9, 3.9381868949254494`*^9}},
 CellLabel->
  "In[3262]:=",ExpressionUUID->"9a48d026-2e3b-4862-b0a9-66f7da439d86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"[", 
     SubscriptBox[
      StyleBox["L",
       FontWeight->"Bold",
       FontSlant->"Plain"], "c"], "]"}], "\[CapitalSigma]\[CapitalUpsilon]"], 
   TraditionalForm]],ExpressionUUID->"ac9691da-aa6c-4058-a06b-fb9e53da03c9"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["L",
     FontWeight->"Bold",
     FontSlant->"Plain"], "c"], TraditionalForm]],ExpressionUUID->
  "1c0af859-b395-4b3d-8b62-a603ef385751"],
 " with respect to the bases \[CapitalSigma] and \[CapitalUpsilon]."
}], "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, 3.7860464260899963`*^9, {3.78676211788239*^9, 
   3.7867621397703743`*^9}, {3.7867625740263863`*^9, 3.786762606202387*^9}, {
   3.786821685564948*^9, 3.7868217195969477`*^9}, 3.7892903646702075`*^9, {
   3.9370939105317674`*^9, 3.937093913547152*^9}, {3.9371886324292483`*^9, 
   3.9371886344445777`*^9}, {3.9372478584828024`*^9, 3.9372479026359797`*^9}, 
   3.9374983631881638`*^9, {3.937498554266716*^9, 3.937498652190052*^9}, {
   3.9374992287921057`*^9, 3.937499361612458*^9}, {3.9375791866531878`*^9, 
   3.9375792039320908`*^9}, {3.9375792772434688`*^9, 
   3.9375793240490856`*^9}, {3.938053543405729*^9, 
   3.938053548108766*^9}},ExpressionUUID->"7b1d197c-0f00-4ccd-acec-\
0902cf5a8916"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "MatrixRep6x6wrt\[CapitalSigma]\[CapitalUpsilon]", "[", "L_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"NormMatrix", "[", 
         RowBox[{"SIG", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "]"}], "2"]], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"UPSILON", "[", 
          RowBox[{"[", "jj", "]"}], "]"}], "]"}], ",", 
        RowBox[{"SIG", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"jj", ",", "6"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9375225214010277`*^9, 3.937522524278025*^9}, {
   3.937522733231109*^9, 3.9375227341997213`*^9}, 3.9381059167531743`*^9, {
   3.938301789856938*^9, 3.9383017959344034`*^9}},
 CellLabel->
  "In[3263]:=",ExpressionUUID->"ec0b5774-808b-4f6d-a937-67732454574c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"[", 
     SubscriptBox[
      StyleBox["L",
       FontWeight->"Bold",
       FontSlant->"Plain"], "c"], "]"}], "\[CapitalSigma]\[CapitalUpsilon]"], 
   TraditionalForm]],ExpressionUUID->"c8cfff69-c455-451e-b3be-c6c28a3bc765"],
 " is the Voigt matrix determined by the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "ijkl"], TraditionalForm]],ExpressionUUID->
  "ac85097c-ea5e-4c04-ba34-e10ea066175c"],
 "."
}], "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, 3.7860464260899963`*^9, {3.78676211788239*^9, 
   3.7867621397703743`*^9}, {3.7867625740263863`*^9, 3.786762606202387*^9}, {
   3.786821685564948*^9, 3.7868217195969477`*^9}, 3.7892903646702075`*^9, {
   3.9370939105317674`*^9, 3.937093913547152*^9}, {3.9371886324292483`*^9, 
   3.9371886344445777`*^9}, {3.9372478584828024`*^9, 3.9372479026359797`*^9}, 
   3.9374983631881638`*^9, {3.937498554266716*^9, 3.937498652190052*^9}, {
   3.9374992287921057`*^9, 3.937499361612458*^9}, {3.938053554139363*^9, 
   3.938053554139363*^9}},ExpressionUUID->"5b15b7e6-70ab-48e7-8532-\
ab16f6898eda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<[\>\"", ",", "Lc", ",", 
    "\"\<\!\(\*SubscriptBox[\(]\), \(\[CapitalSigma]\[CapitalUpsilon]\)]\) = \
\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"MatrixRep6x6wrt\[CapitalSigma]\[CapitalUpsilon]", "[", 
      RowBox[{"Lbold", "[", "c", "]"}], "]"}], "]"}], ",", "\"\< = \>\"", ",",
     "\[IndentingNewLine]", 
    "                                                ", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"MatrixRep6x6wrt\[CapitalSigma]\[CapitalUpsilon]", "[", 
       RowBox[{"Lbold", "[", "c", "]"}], "]"}], "/.", "CsToSymbolsRules"}], 
     "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.937492310303388*^9, 3.9374923250830917`*^9}, {
   3.937492362782078*^9, 3.9374923652036695`*^9}, {3.93749239601333*^9, 
   3.937492425261335*^9}, {3.9374975088527484`*^9, 3.9374975167105207`*^9}, {
   3.9374975671999445`*^9, 3.937497570058777*^9}, {3.9374977161479073`*^9, 
   3.937497759702103*^9}, {3.937498742548744*^9, 3.937498744423287*^9}, 
   3.9374995256084304`*^9, 3.9374996021766624`*^9, {3.9381044528965487`*^9, 
   3.9381045192968345`*^9}, {3.9381058726331434`*^9, 3.9381058984699154`*^9}},
 CellLabel->
  "In[3264]:=",ExpressionUUID->"a6b0e431-5fcb-4a0a-8af7-733c6694f93b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Here is the detailed calculation of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"[", 
     SubscriptBox[
      StyleBox["L",
       FontWeight->"Bold",
       FontSlant->"Plain"], "c"], "]"}], "\[CapitalSigma]\[CapitalUpsilon]"], 
   TraditionalForm]],ExpressionUUID->"11df0c98-4c64-43c5-bf00-2be8740fb5e8"],
 " for one given entry. Try changing r and s."
}], "Subsubsection",
 CellChangeTimes->{{3.937499701472819*^9, 3.937499731283301*^9}, {
  3.937499875084845*^9, 3.9374998871302876`*^9}, {3.9375793981659393`*^9, 
  3.9375794019001865`*^9}, {3.9380535673722982`*^9, 
  3.9380535673722982`*^9}},ExpressionUUID->"e32a18a0-089c-433b-963f-\
e5ecf12db08b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", "4"}], ";", 
  RowBox[{"s", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<(r,s) = \>\"", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "s"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\[CapitalUpsilon]\[LeftDoubleBracket]s\[RightDoubleBracket] = \>\"", 
    ",", "\"\<\[CapitalUpsilon]\[LeftDoubleBracket]\>\"", ",", "s", ",", 
    "\"\<\[RightDoubleBracket] = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"UPSILON", "[", 
      RowBox[{"[", "s", "]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "Lc", ",", 
    "\"\<(\[CapitalUpsilon]\[LeftDoubleBracket]s\[RightDoubleBracket]) = \
\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      RowBox[{"Lbold", "[", "c", "]"}], "[", 
      RowBox[{"UPSILON", "[", 
       RowBox[{"[", "s", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\[CapitalSigma]\[LeftDoubleBracket]r\[RightDoubleBracket] = \>\"", 
    ",", "\"\<\[CapitalSigma]\[LeftDoubleBracket]\>\"", ",", "r", ",", 
    "\"\<\[RightDoubleBracket] = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"SIG", "[", 
      RowBox[{"[", "r", "]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<(\>\"", ",", "Lc", ",", 
    "\"\<(\[CapitalUpsilon]\[LeftDoubleBracket]s\[RightDoubleBracket]))\
\[CenterDot]\[CapitalSigma]\[LeftDoubleBracket]r\[RightDoubleBracket] = \>\"",
     ",", 
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{
      RowBox[{"SIG", "[", 
       RowBox[{"[", "r", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Lbold", "[", "c", "]"}], "[", 
       RowBox[{"UPSILON", "[", 
        RowBox[{"[", "s", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<(r,s) = \>\"", ",", "\"\<(\>\"", ",", "r", ",", "\"\<,\>\"", ",", 
     "s", ",", "\"\<) entry of [\>\"", ",", "Lc", ",", 
     "\"\<[c]\!\(\*SubscriptBox[\(]\), \
\(\[CapitalSigma]\[CapitalUpsilon]\)]\) is (\>\"", ",", "Lc", ",", 
     "\"\<(\[CapitalUpsilon]\[LeftDoubleBracket]s\[RightDoubleBracket]))\
\[CenterDot]\[CapitalSigma]\[LeftDoubleBracket]r\[RightDoubleBracket]/|\
\[CapitalSigma]\[LeftDoubleBracket]r\[RightDoubleBracket]\!\(\*SuperscriptBox[\
\(|\), \(\(2\)\(\\\ \)\)]\) = \>\"", ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"NormMatrix", "[", 
         RowBox[{"SIG", "[", 
          RowBox[{"[", "r", "]"}], "]"}], "]"}], "2"]], 
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"SIG", "[", 
         RowBox[{"[", "r", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Lbold", "[", "c", "]"}], "[", 
         RowBox[{"UPSILON", "[", 
          RowBox[{"[", "s", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<[\>\"", ",", "Lc", ",", 
     "\"\<\!\(\*SubscriptBox[\(]\), \(\[CapitalSigma]\[CapitalUpsilon]\)]\) = \
\>\"", ",", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"MatrixRep6x6wrt\[CapitalSigma]\[CapitalUpsilon]", "[", 
        RowBox[{"Lbold", "[", "c", "]"}], "]"}], ",", 
       RowBox[{"Background", "->", 
        RowBox[{"{", 
         RowBox[{"None", ",", "None", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r", ",", "s"}], "}"}], "->", "Pink"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "True"}]}], "]"}]}], "]"}], ";"}], 
  "     "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"r", ",", "s"}], "]"}], ";"}], "    "}]}], "Input",
 CellChangeTimes->{{3.9374924808028207`*^9, 3.937492508863533*^9}, {
   3.9374925443785334`*^9, 3.9374925777993183`*^9}, {3.937492615873325*^9, 
   3.9374926202009535`*^9}, {3.9374926558229623`*^9, 
   3.9374926771800213`*^9}, {3.93749277757533*^9, 3.9374928808791776`*^9}, 
   3.9374930111484365`*^9, {3.9374930695327463`*^9, 3.9374930723449154`*^9}, {
   3.937493112075308*^9, 3.9374931267772207`*^9}, {3.937493163242132*^9, 
   3.937493296089714*^9}, {3.9374933382413416`*^9, 3.937493355958994*^9}, {
   3.937493394314553*^9, 3.9374934594987106`*^9}, 3.937493518899172*^9, {
   3.937493563084737*^9, 3.9374935717094593`*^9}, {3.9374940607335453`*^9, 
   3.937494147775921*^9}, 3.937494178783839*^9, {3.9374942204814625`*^9, 
   3.9374943438995934`*^9}, {3.9374943990857563`*^9, 3.937494422771096*^9}, {
   3.9374944920198593`*^9, 3.937494542883377*^9}, {3.9374945772147875`*^9, 
   3.9374945943990026`*^9}, 3.9374946244731784`*^9, {3.9374948860553474`*^9, 
   3.937494920458067*^9}, {3.9374949526848125`*^9, 3.9374950161520967`*^9}, {
   3.937495046181736*^9, 3.9374950919755726`*^9}, {3.937495131111952*^9, 
   3.9374951323618307`*^9}, {3.937495162764814*^9, 3.9374952457884393`*^9}, {
   3.9374954545918784`*^9, 3.9374954557346783`*^9}, {3.937495509686166*^9, 
   3.9374956216199603`*^9}, {3.9374956557201033`*^9, 
   3.9374956585786552`*^9}, {3.9374972239911203`*^9, 3.937497224865932*^9}, {
   3.9374975928392534`*^9, 3.9374976620938597`*^9}, {3.9374978493257504`*^9, 
   3.9374979686954403`*^9}, {3.937498745704362*^9, 3.9374987523906565`*^9}, 
   3.937499529076714*^9, {3.937510465275893*^9, 3.937510471634907*^9}, {
   3.937523206957111*^9, 3.937523209003785*^9}, {3.937523257574234*^9, 
   3.937523270995718*^9}, {3.9375233124301786`*^9, 3.9375233595694666`*^9}, 
   3.9375233954419107`*^9, {3.937523469246505*^9, 3.9375235317403607`*^9}, {
   3.9375236690521564`*^9, 3.9375236824893885`*^9}, 3.937523751032709*^9, 
   3.937523796122567*^9, 3.937523931923187*^9, 3.937523966857929*^9, 
   3.9375240258259673`*^9, {3.937524078603755*^9, 3.9375241178182774`*^9}, {
   3.9375242451803637`*^9, 3.9375243303467803`*^9}, 3.9375243712995296`*^9, {
   3.9375244378243933`*^9, 3.9375245076000624`*^9}, {3.937579587836729*^9, 
   3.9375795964770627`*^9}, {3.9375796374575953`*^9, 3.937579702753916*^9}, {
   3.9375797349947853`*^9, 3.937579767823323*^9}, {3.937579843895743*^9, 
   3.9375798572395077`*^9}, {3.9375799337954764`*^9, 3.93757995393451*^9}, {
   3.9375800859634523`*^9, 3.9375801612772045`*^9}, {3.937580267034111*^9, 
   3.9375803005955334`*^9}, {3.9376018230946364`*^9, 3.937601840436455*^9}, {
   3.937601884308863*^9, 3.9376018959326596`*^9}, {3.9376019956547365`*^9, 
   3.9376020247960033`*^9}, {3.9376021146097274`*^9, 3.93760213182377*^9}, 
   3.937602187336607*^9, {3.9376022457408166`*^9, 3.9376022499313974`*^9}, {
   3.9376023031856565`*^9, 3.937602324941513*^9}, {3.938053604620064*^9, 
   3.9380536766960263`*^9}, {3.9381045968302565`*^9, 
   3.9381045975489388`*^9}, {3.938104636161827*^9, 3.938104663035673*^9}, {
   3.9381047229854493`*^9, 3.938104747415124*^9}, 3.93810590694516*^9},
 CellLabel->
  "In[3265]:=",ExpressionUUID->"e1fa8d95-3727-4686-8cef-870d3eacd115"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["L",
  FontWeight->"Bold"],
 " should be an elastic map (a ",
 StyleBox["function",
  FontSlant->"Italic"],
 "):"
}], "Subsubsection",
 CellChangeTimes->{{3.9381298200050793`*^9, 3.938129843430339*^9}, {
  3.938187343969285*^9, 
  3.9381873458753295`*^9}},ExpressionUUID->"1266a1bd-6019-4bc9-bc43-\
a9c0d226e965"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VoigtMatrix", "[", "L_", "]"}], ":=", 
   RowBox[{
   "MatrixRep6x6wrt\[CapitalSigma]\[CapitalUpsilon]", "[", "L", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9381298038913956`*^9, 3.938129806360367*^9}, 
   3.9381300117780075`*^9},
 CellLabel->
  "In[3274]:=",ExpressionUUID->"6f9ad221-e2aa-45cd-aaa9-4432d0c88931"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"VoigtMatrix", "[", 
   RowBox[{"Lbold", "[", "c", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9381336506403904`*^9, 3.9381336911303873`*^9}},
 CellLabel->
  "In[3275]:=",ExpressionUUID->"5012bcee-ce94-4683-97a5-e457060c6be8"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"CmatOfTmat", "[", "BlankSlatePrime", "]"}], "==", 
   RowBox[{"VoigtMatrix", "[", 
    RowBox[{"LboldWhoseBBrepIs", "[", "BlankSlatePrime", "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9381145916168675`*^9, 3.938114591773178*^9}, {
   3.9381146502442427`*^9, 3.938114692143407*^9}, {3.9381300813729253`*^9, 
   3.938130088481593*^9}, 3.938507453188325*^9, 3.9385079261910276`*^9, 
   3.938647519595801*^9},
 CellLabel->
  "In[3276]:=",ExpressionUUID->"0396f90c-4bff-4a60-bfad-2ad9a220540f"],

Cell[CellGroupData[{

Cell[TextData[{
 "LboldWhose\[CapitalSigma]\[CapitalUpsilon]repIs[matrix6x6]   is the elastic \
map (a ",
 StyleBox["function",
  FontSlant->"Italic"],
 ") whose matrix representation with respect to \[CapitalSigma]\
\[CapitalUpsilon] is matrix6x6.\nLboldWhoseBBrepIs[matrix6x6]  is the elastic \
map (a ",
 StyleBox["function",
  FontSlant->"Italic"],
 ") whose matrix representation with respect to \[DoubleStruckCapitalB]\
\[DoubleStruckCapitalB] is matrix6x6.\n\
LboldWhose\[CapitalPhi]\[CapitalPhi]repIs[matrix6x6] is the elastic map (a ",
 StyleBox["function",
  FontSlant->"Italic"],
 ") whose matrix representation with respect to PHI is matrix6x6."
}], "Subsubsection",
 CellChangeTimes->{{3.9372707567010655`*^9, 3.9372707895592966`*^9}, {
   3.937270837585775*^9, 3.937270867429165*^9}, {3.9373209958963933`*^9, 
   3.9373210226952963`*^9}, {3.937498785603298*^9, 3.9374987881185246`*^9}, {
   3.9376024948626165`*^9, 3.937602501555869*^9}, {3.9376025450279756`*^9, 
   3.9376025588405848`*^9}, {3.938104826657297*^9, 3.938104832118305*^9}, {
   3.938107315085473*^9, 3.9381073162736025`*^9}, {3.938114972782508*^9, 
   3.9381149909621973`*^9}, {3.9381876503779078`*^9, 3.938187689755134*^9}, {
   3.938301162964666*^9, 3.938301171234125*^9}, 3.93830121421758*^9, 
   3.938507458672393*^9, 3.9385079393424144`*^9, 3.9385084811063967`*^9, {
   3.938508517531844*^9, 3.938508525123283*^9}, {3.9385092315770226`*^9, 
   3.9385092433864036`*^9}, 3.938647454291342*^9, 3.9386475220651245`*^9, 
   3.9386475662790003`*^9},ExpressionUUID->"868d699b-3511-42a2-be67-\
59f7b092f8ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "LboldWhose\[CapitalSigma]\[CapitalUpsilon]repIs", "[", "matrix6x6_", 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"Matrix3x3from\[CapitalSigma]coords", "[", 
      RowBox[{"matrix6x6", ".", 
       RowBox[{"\[CapitalUpsilon]coords", "[", "#", "]"}]}], "]"}], "&"}]}], 
   ";"}], "    ", 
  RowBox[{"(*", " ", 
   RowBox[{"used", " ", "to", " ", "be", " ", "LboldOfCmat"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LboldWhoseBBrepIs", "[", "matrix6x6_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Matrix3x3fromBcoords", "[", 
      RowBox[{"matrix6x6", ".", 
       RowBox[{"Bcoords", "[", "#", "]"}]}], "]"}], "&"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   RowBox[{"used", " ", "to", " ", "be", " ", "LboldOfTmat"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "LboldWhose\[CapitalPhi]\[CapitalPhi]repIs", "[", "matrix6x6_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Matrix3x3from\[CapitalPhi]coords", "[", 
     RowBox[{"matrix6x6", ".", 
      RowBox[{"\[CapitalPhi]coords", "[", "#", "]"}]}], "]"}], "&"}]}], 
  "      ", 
  RowBox[{"(*", " ", 
   RowBox[{"used", " ", "to", " ", "be", " ", "LboldOfPHImat"}], " ", "*)"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.937504474039488*^9, 3.937504529099631*^9}, {
   3.9376012343754654`*^9, 3.9376012351565504`*^9}, 3.937923674518159*^9, {
   3.9379237818852334`*^9, 3.9379237831977916`*^9}, {3.9383701872554502`*^9, 
   3.9383702057233725`*^9}, {3.938507057785968*^9, 3.9385070692242775`*^9}, 
   3.9385074616435504`*^9, 3.9385079551408596`*^9, 3.9385081329423227`*^9, 
   3.938508277187709*^9, 3.9385085388946905`*^9, {3.938508850963269*^9, 
   3.9385088534852095`*^9}, 3.9385092677231455`*^9, {3.938509613164064*^9, 
   3.9385096419528804`*^9}, {3.938509708104446*^9, 3.938509732087044*^9}, 
   3.938647455447571*^9, 3.938647524503016*^9, 3.938647568716381*^9},
 CellLabel->
  "In[3277]:=",ExpressionUUID->"44beb491-f80c-41fc-8c5e-708f7f2640a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matrix6x6", "=", "RandomPosDef6x6Matrix"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixRep6x6wrt\[CapitalSigma]\[CapitalUpsilon]", "[", 
   RowBox[{
   "LboldWhose\[CapitalSigma]\[CapitalUpsilon]repIs", "[", "matrix6x6", "]"}],
    "]"}], "==", "matrix6x6"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixRep6x6wrtBB", "[", 
   RowBox[{"LboldWhoseBBrepIs", "[", "matrix6x6", "]"}], "]"}], "==", 
  "matrix6x6"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixRep6x6wrt\[CapitalPhi]\[CapitalPhi]", "[", 
   RowBox[{
   "LboldWhose\[CapitalPhi]\[CapitalPhi]repIs", "[", "matrix6x6", "]"}], 
   "]"}], "==", "matrix6x6"}]}], "Input",
 CellChangeTimes->{{3.9372622690263968`*^9, 3.9372622938264256`*^9}, {
   3.9372623327623625`*^9, 3.93726242181866*^9}, {3.9372624578972564`*^9, 
   3.937262468915716*^9}, {3.9372628863580923`*^9, 3.937262927137624*^9}, {
   3.937263086160249*^9, 3.9372630865040274`*^9}, {3.9372632556740446`*^9, 
   3.9372632854273963`*^9}, 3.937263565880803*^9, 3.937269641962509*^9, 
   3.937269822079908*^9, {3.937269858429288*^9, 3.9372698599760027`*^9}, {
   3.937270431731015*^9, 3.9372704585600677`*^9}, {3.937270696872554*^9, 
   3.93727070277812*^9}, 3.9372708799434814`*^9, {3.9374987949298725`*^9, 
   3.937498795632903*^9}, {3.9376075011155806`*^9, 3.9376075240670023`*^9}, {
   3.938105677891055*^9, 3.9381056788305387`*^9}, {3.9381068965640574`*^9, 
   3.9381068987837486`*^9}, {3.9381074012697225`*^9, 
   3.9381074017696943`*^9}, {3.9381078801783085`*^9, 3.938107883881507*^9}, {
   3.9381876302835555`*^9, 3.9381876316755037`*^9}, 3.9385074355471315`*^9, 
   3.938507918830943*^9, 3.9385084218046227`*^9, 3.9385092239284344`*^9, 
   3.938509339477417*^9, 3.9386474296057744`*^9, 3.9386475105013885`*^9, 
   3.938647571153532*^9},
 CellLabel->
  "In[3280]:=",ExpressionUUID->"bec5492e-d574-4098-bb1b-322c4cae1c7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The left-hand side of the double equality test (below) expresses Eqs (2.1) \
and (2.2) of Mehrabadi & Cowin. 
The right-hand side expresses Eq (2.3) of Mehrabadi & Cowin, but with the 6 x \
6 matrix symmetric and with the 3 x 3 matrices included, as opposed to just \
their six-tuples.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9370950765490265`*^9, 3.9370951361047115`*^9}, {
   3.9370951685952144`*^9, 3.937095275534882*^9}, {3.937095347925953*^9, 
   3.9370953506130033`*^9}, {3.937246590146881*^9, 3.9372465968190875`*^9}, {
   3.9372480739534426`*^9, 3.9372480761876125`*^9}, 3.937580494943178*^9, {
   3.937580901266246*^9, 3.9375809049231386`*^9}, 
   3.938104925021053*^9},ExpressionUUID->"6c650f1b-931d-4b61-94cf-\
226a86e04597"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Emat", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"e11", "e12", "e13"},
      {"e12", "e22", "e23"},
      {"e13", "e23", "e33"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Matrix3x3from\[CapitalSigma]coords", "[", 
   RowBox[{"{", 
    RowBox[{
    "t11", ",", "t22", ",", "t33", ",", "t23", ",", "t13", ",", "t12"}], 
    "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalUpsilon]coords", "[", "Emat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Lbold", "[", "c", "]"}], "[", "Emat", "]"}], "==", 
   RowBox[{"Matrix3x3from\[CapitalSigma]coords", "[", 
    RowBox[{
     RowBox[{"VoigtMatrix", "[", 
      RowBox[{"Lbold", "[", "c", "]"}], "]"}], ".", 
     RowBox[{"\[CapitalUpsilon]coords", "[", "Emat", "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.937008361376049*^9, {3.9370087367019167`*^9, 3.9370087838349104`*^9}, {
   3.937008814428221*^9, 3.937008902561659*^9}, {3.9370089519947815`*^9, 
   3.937008975759253*^9}, {3.937089824719488*^9, 3.9370898431770315`*^9}, {
   3.937245720418708*^9, 3.9372457508220825`*^9}, 3.9374159344642076`*^9, 
   3.9374987537654605`*^9, {3.9379236801188145`*^9, 3.9379236842010746`*^9}, 
   3.9381299143014975`*^9, {3.9385080992140884`*^9, 3.9385081015356865`*^9}, {
   3.938508281886742*^9, 3.9385082827861104`*^9}},
 CellLabel->
  "In[3284]:=",ExpressionUUID->"a6fdbf5f-6245-471b-b67a-e103d19a6861"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"LboldWhoseBBrepIs", "[", "BlankSlate", "]"}], "[", "Emat", "]"}],
    "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.938188889320717*^9, 3.938188935009838*^9}, {
   3.938189042263445*^9, 3.9381890732278214`*^9}, {3.9381902632286205`*^9, 
   3.9381902711417184`*^9}, {3.9381907401298037`*^9, 3.9381907408671217`*^9}, 
   3.93850743932859*^9, 3.9385079203411407`*^9, {3.938510132502591*^9, 
   3.9385101339179716`*^9}, 3.938647513236718*^9},
 CellLabel->
  "In[3288]:=",ExpressionUUID->"318aa2c4-b024-42d2-8905-3c696be4ff3b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"LboldWhoseBBrepIs", "[", "BlankSlate", "]"}], "[", "Emat", "]"}],
    "==", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        FractionBox["1", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{"e11", "-", "e22"}], ")"}]}], "+", 
          RowBox[{"e", " ", 
           RowBox[{"(", 
            RowBox[{"e11", "+", "e22", "-", 
             RowBox[{"2", " ", "e33"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "f", 
           RowBox[{"(", 
            RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"], " ", "j", 
           RowBox[{"(", 
            RowBox[{"e33", "-", "e11"}], ")"}]}], "+", " ", 
          RowBox[{
           SqrtBox["2"], "k", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "e11"}], " ", "+", 
             RowBox[{"2", "  ", "e22"}], " ", "-", " ", "e33"}], " ", ")"}]}],
           "-", 
          RowBox[{
           SqrtBox["6"], " ", "p", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "e11"}], " ", "+", " ", "e33"}], " ", ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "e12", " ", "i"}], "-", 
             RowBox[{"3", " ", "e13", " ", "n"}], "+", 
             RowBox[{
              SqrtBox["3"], " ", "e12", " ", "o"}], "-", 
             RowBox[{"3", " ", "e23", " ", "q"}], "+", 
             RowBox[{
              SqrtBox["3"], " ", "e13", " ", "r"}], "+", 
             RowBox[{
              SqrtBox["6"], " ", "e12", " ", "s"}], "+", 
             RowBox[{
              SqrtBox["3"], " ", "e23", " ", "t"}], "+", 
             RowBox[{
              SqrtBox["6"], " ", "e13", " ", "u"}], "+", 
             RowBox[{
              SqrtBox["6"], " ", "e23", " ", "v"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"c", " ", "e12"}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "e13", " ", "h"}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "i"}], "+", 
           RowBox[{"6", " ", "e23", " ", "m"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}], " ", "o"}], "+", 
           RowBox[{
            SqrtBox["6"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "s"}]}], 
          ")"}]}]}], 
       RowBox[{
        RowBox[{"b", " ", "e13"}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "e23", " ", "g"}], "+", 
           RowBox[{"6", " ", "e12", " ", "h"}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "n"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}], " ", "r"}], "+", 
           RowBox[{
            SqrtBox["6"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "u"}]}], 
          ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"c", " ", "e12"}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "e13", " ", "h"}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "i"}], "+", 
           RowBox[{"6", " ", "e23", " ", "m"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}], " ", "o"}], "+", 
           RowBox[{
            SqrtBox["6"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "s"}]}], 
          ")"}]}]}], 
       RowBox[{
        FractionBox["1", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "e11"}], "+", "e22"}], ")"}]}], "+", 
          RowBox[{"e", " ", 
           RowBox[{"(", 
            RowBox[{"e11", "+", "e22", "-", 
             RowBox[{"2", " ", "e33"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "f"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"], " ", "e22", " ", "j"}], "-", 
          RowBox[{"2", " ", 
           SqrtBox["3"], " ", "e33", " ", "j"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "e11", " ", "k"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "e22", " ", "k"}], "-", 
          RowBox[{
           SqrtBox["2"], " ", "e33", " ", "k"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["6"], " ", "e22", " ", "p"}], "+", 
          RowBox[{
           SqrtBox["6"], " ", "e33", " ", "p"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "e12", " ", "i"}], "+", 
             RowBox[{"3", " ", "e13", " ", "n"}], "+", 
             RowBox[{
              SqrtBox["3"], " ", "e12", " ", "o"}], "+", 
             RowBox[{"3", " ", "e23", " ", "q"}], "+", 
             RowBox[{
              SqrtBox["3"], " ", "e13", " ", "r"}], "+", 
             RowBox[{
              SqrtBox["6"], " ", "e12", " ", "s"}], "+", 
             RowBox[{
              SqrtBox["3"], " ", "e23", " ", "t"}], "+", 
             RowBox[{
              SqrtBox["6"], " ", "e13", " ", "u"}], "+", 
             RowBox[{
              SqrtBox["6"], " ", "e23", " ", "v"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"a", " ", "e23"}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "e13", " ", "g"}], "+", 
           RowBox[{"6", " ", "e12", " ", "m"}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "q"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}], " ", "t"}], "+", 
           RowBox[{
            SqrtBox["6"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "v"}]}], 
          ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"b", " ", "e13"}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "e23", " ", "g"}], "+", 
           RowBox[{"6", " ", "e12", " ", "h"}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "n"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}], " ", "r"}], "+", 
           RowBox[{
            SqrtBox["6"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "u"}]}], 
          ")"}]}]}], 
       RowBox[{
        RowBox[{"a", " ", "e23"}], "+", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "e13", " ", "g"}], "+", 
           RowBox[{"6", " ", "e12", " ", "m"}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "q"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}], " ", "t"}], "+", 
           RowBox[{
            SqrtBox["6"], " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "v"}]}], 
          ")"}]}]}], 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"e", " ", 
            RowBox[{"(", 
             RowBox[{"e11", "+", "e22", "-", 
              RowBox[{"2", " ", "e33"}]}], ")"}]}], 
           SqrtBox["3"]]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "f"}], 
          SqrtBox["3"]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"e11", "-", "e22"}], ")"}], " ", "j"}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"e11", "+", "e22", "-", 
             RowBox[{"2", " ", "e33"}]}], ")"}], " ", "k"}], 
          SqrtBox["6"]], "-", 
         RowBox[{
          SqrtBox[
           FractionBox["2", "3"]], " ", 
          RowBox[{"(", 
           RowBox[{"e11", "+", "e22", "+", "e33"}], ")"}], " ", "k"}], "-", 
         RowBox[{"2", " ", "e12", " ", "o"}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "e11"}], "+", "e22"}], ")"}], " ", "p"}], 
          SqrtBox["2"]], "-", 
         RowBox[{"2", " ", "e13", " ", "r"}], "+", 
         RowBox[{
          SqrtBox["2"], " ", "e12", " ", "s"}], "-", 
         RowBox[{"2", " ", "e23", " ", "t"}], "+", 
         RowBox[{
          SqrtBox["2"], " ", "e13", " ", "u"}], "+", 
         RowBox[{
          SqrtBox["2"], " ", "e23", " ", "v"}]}], 
        SqrtBox["3"]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.93851002012313*^9, 3.938510027153137*^9}, {
   3.9385100662074957`*^9, 3.9385100844594994`*^9}, 3.9385101809782443`*^9, {
   3.938510253098028*^9, 3.9385102712319417`*^9}, {3.9385104076611233`*^9, 
   3.938510582373983*^9}, {3.938510616538643*^9, 3.9385106293832717`*^9}, 
   3.9386475145489764`*^9},
 CellLabel->
  "In[3289]:=",ExpressionUUID->"0d655f09-3313-4730-a341-d1d87043acbb"],

Cell[CellGroupData[{

Cell["\<\
The entries should give the elastic constants of the elastic map when \
BlankSlate is considered to be the \[DoubleStruckCapitalB]\
\[DoubleStruckCapitalB]-matrix of the elastic map:\
\>", "Subsubsection",
 CellChangeTimes->{{3.9364658397341566`*^9, 3.9364659462735744`*^9}, {
   3.936466016100202*^9, 3.936466016490756*^9}, {3.9374998177961774`*^9, 
   3.9374998207332087`*^9}, 3.9376008555342827`*^9, {3.9383280263525352`*^9, 
   3.9383280445773563`*^9}, {3.9383285941834593`*^9, 3.938328620309209*^9}, {
   3.9383287240950356`*^9, 3.9383287268768377`*^9}, {3.9383287576391315`*^9, 
   3.9383289022046576`*^9}},ExpressionUUID->"9c9aa8ad-ef4f-4f06-b196-\
52753ffcbe4d"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"VoigtMatrix", "[", 
    RowBox[{"LboldWhoseBBrepIs", "[", "BlankSlate", "]"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "BlankSlate", "]"}]}], "Input",
 CellChangeTimes->{{3.938188306979189*^9, 3.9381884172897124`*^9}, {
   3.9381885005051193`*^9, 3.938188539707215*^9}, {3.9381907835755053`*^9, 
   3.938190784092493*^9}, {3.9383287472184696`*^9, 3.9383287537490125`*^9}, 
   3.9385074411488733`*^9, 3.9385079215684905`*^9, 3.9386475156114607`*^9},
 CellLabel->
  "In[3290]:=",ExpressionUUID->"213cac8a-3063-4bc7-b6c3-0975e3298317"]
}, Open  ]],

Cell["\<\
rsOFijkl and cOfCmat are in SSM_basic.  No longer used, though.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9387341061389384`*^9, 3.9387341492150126`*^9}, {
  3.938735497521783*^9, 
  3.9387355035682187`*^9}},ExpressionUUID->"0dee9b80-fe5d-418a-8cf8-\
b6e369f200bf"],

Cell["End of section \[OpenCurlyDoubleQuote]material added October 2024\
\[CloseCurlyDoubleQuote]", "Section",
 CellChangeTimes->{{3.8912669075101666`*^9, 3.891266927159681*^9}, {
  3.9384749530044513`*^9, 3.9384750413004284`*^9}, {3.938475085315934*^9, 
  3.9384751236483088`*^9}},ExpressionUUID->"208529dc-759f-48ef-9c28-\
cd38475af3e9"],

Cell["Choose one:", "Subsubsection",
 CellChangeTimes->{{3.925601811044715*^9, 3.925601824434246*^9}, {
  3.9257488503924894`*^9, 
  3.925748854783537*^9}},ExpressionUUID->"975a51dc-c4ac-4fd2-b041-\
e165dd601877"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatrixNote", "[", "Tmat_", "]"}], ":=", "99"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMatrixNote", "[", "Tmat_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MatrixNote", "[", "Tmat", "]"}], "!=", "99"}], ",", 
     RowBox[{"MatrixNote", "[", "Tmat", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMatrixNote", "[", "Tmat_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MatrixNote", "[", "Tmat", "]"}], "==", "99"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tmat", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Tmat", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"MatrixNote", "[", "Tmat", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.925688164704471*^9, 3.9256881940755043`*^9}, {
  3.925748745261198*^9, 3.925748756446292*^9}},
 CellLabel->
  "In[3292]:=",ExpressionUUID->"5585fec0-08a4-4fa1-b6e1-853bb03869b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u0", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"ArcTan", "[", 
     SqrtBox["8"], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[3295]:=",ExpressionUUID->"379551da-0d24-4997-825e-22abff2b3f53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatFor180", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "0", "0", "0", "0"},
       {"g", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "i", "o", "s"},
       {"0", "0", "i", "d", "j", "p"},
       {"0", "0", "o", "j", "e", "k"},
       {"0", "0", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";", "             ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"now", " ", "same", " ", "as", " ", "TmatForMONO"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatFor90", "=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "0", "0", "0", "0", "0"},
        {"0", "a", "0", "0", "0", "0"},
        {"0", "0", "c", "i", "0", "0"},
        {"0", "0", "i", "d", "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmatFor120", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "m", 
        RowBox[{"-", "h"}], "0", "0"},
       {"0", "a", "h", "m", "0", "0"},
       {"m", "h", "c", "0", "0", "0"},
       {
        RowBox[{"-", "h"}], "m", "0", "c", "0", "0"},
       {"0", "0", "0", "0", "e", "k"},
       {"0", "0", "0", "0", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"signs", " ", "changed", " ", "on", " ", 
     RowBox[{"h", "'"}], "s", " ", "May", " ", "24"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForMONO0", "=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "0", "0", "0", "0", "0"},
        {"0", "b", "0", "0", "0", "0"},
        {"0", "0", "c", "i", "o", "s"},
        {"0", "0", "i", "d", "j", "p"},
        {"0", "0", "o", "j", "e", "k"},
        {"0", "0", "s", "p", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7953744520852685`*^9, 3.795374454960286*^9}, 
   3.79596100087488*^9, {3.7959838284027205`*^9, 3.795983829527687*^9}, {
   3.7959838609251833`*^9, 3.7959838622538643`*^9}, {3.7959839541457205`*^9, 
   3.7959839642693224`*^9}, 3.7959840227771044`*^9, 3.79598452672563*^9, {
   3.7959848848176503`*^9, 3.7959849148650465`*^9}, {3.7959851158950143`*^9, 
   3.7959851702928147`*^9}, 3.795985448518567*^9, 3.7959855066698093`*^9, 
   3.7959860993419456`*^9, 3.79604884834536*^9, {3.7967762292685328`*^9, 
   3.7967762440831776`*^9}, {3.7968261816027203`*^9, 
   3.7968262018080163`*^9}, {3.7968262997880745`*^9, 3.7968263167756653`*^9}, 
   3.796827376611505*^9, {3.7968282467528577`*^9, 3.796828279898879*^9}, 
   3.7968292145701294`*^9, {3.7968482177372456`*^9, 3.7968482429749823`*^9}, 
   3.796998568317684*^9, {3.7976953979956765`*^9, 3.797695406938676*^9}, {
   3.7976954483626614`*^9, 3.797695463162678*^9}, {3.798920694824332*^9, 
   3.7989207038145237`*^9}, {3.799375682985893*^9, 3.7993757088594627`*^9}, {
   3.7993757661204233`*^9, 3.799375783971814*^9}, {3.799511474938888*^9, 
   3.799511518850753*^9}, {3.79985499456671*^9, 3.7998550346970577`*^9}, {
   3.799856762408558*^9, 3.7998567828425803`*^9}, {3.817688038021026*^9, 
   3.8176881190035496`*^9}, {3.8177395753893156`*^9, 3.8177395918142257`*^9}, 
   3.8295654110391808`*^9, {3.8295727365255275`*^9, 3.829572752493272*^9}, {
   3.830372156309249*^9, 3.830372157513705*^9}, 3.869517362756138*^9, {
   3.8695175237776747`*^9, 3.869517534894392*^9}, 3.869517574753809*^9, 
   3.879383897712828*^9, 3.879520998109213*^9, {3.892691906808166*^9, 
   3.892691907906199*^9}},
 CellLabel->
  "In[3296]:=",ExpressionUUID->"1c3c3d4c-0a03-4174-b3d8-5e9fedaa21f6"],

Cell[CellGroupData[{

Cell["Reference matrices for Voigt", "Subsubsection",
 CellChangeTimes->{{3.8795185962277193`*^9, 
  3.8795186210359235`*^9}},ExpressionUUID->"db7e9f79-1ff1-4af4-bb9f-\
989bf86415ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmatForISO", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "g", "0", "0", "0"},
       {"g", "a", "g", "0", "0", "0"},
       {"g", "g", "a", "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"a", "-", "g"}], "2"], "0", "0"},
       {"0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "-", "g"}], "2"], "0"},
       {"0", "0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "-", "g"}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"from", " ", "Nye"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForXISO", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "g", "h", "0", "0", "0"},
      {"g", "a", "h", "0", "0", "0"},
      {"h", "h", "c", "0", "0", "0"},
      {"0", "0", "0", "d", "0", "0"},
      {"0", "0", "0", "0", "d", "0"},
      {"0", "0", "0", "0", "0", 
       FractionBox[
        RowBox[{"a", "-", "g"}], "2"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForTET", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "g", "h", "0", "0", "0"},
      {"g", "a", "h", "0", "0", "0"},
      {"h", "h", "c", "0", "0", "0"},
      {"0", "0", "0", "d", "0", "0"},
      {"0", "0", "0", "0", "d", "0"},
      {"0", "0", "0", "0", "0", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForTET", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"a", "g", "h", "0", "0", "0"},
      {"g", "a", "h", "0", "0", "0"},
      {"h", "h", "c", "0", "0", "0"},
      {"0", "0", "0", "d", "0", "0"},
      {"0", "0", "0", "0", "d", "0"},
      {"0", "0", "0", "0", "0", "f"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForORTH", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "m", "0", "0", "0"},
       {"g", "b", "h", "0", "0", "0"},
       {"m", "h", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "0", "0"},
       {"0", "0", "0", "0", "e", "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CmatForMONO", "=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"a", "g", "m", "0", "0", "v"},
        {"g", "b", "h", "0", "0", "u"},
        {"m", "h", "c", "0", "0", "s"},
        {"0", "0", "0", "d", "j", "0"},
        {"0", "0", "0", "j", "e", "0"},
        {"v", "u", "s", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879384909581035*^9, 3.879384917580553*^9}, {
   3.8793849982088284`*^9, 3.879385094369027*^9}, {3.879385152601957*^9, 
   3.879385262537035*^9}, {3.8793856206788435`*^9, 3.8793856277596006`*^9}, {
   3.879385703625926*^9, 3.879385720133737*^9}, 3.8793857530122814`*^9, {
   3.879385929975525*^9, 3.8793859871420965`*^9}, {3.8793861790705943`*^9, 
   3.8793862725383635`*^9}, {3.879386497097413*^9, 3.879386520308134*^9}, {
   3.8793865672130256`*^9, 3.8793866072223167`*^9}, {3.879387123461567*^9, 
   3.879387130245008*^9}, {3.892691990423703*^9, 3.8926919945327406`*^9}},
 CellLabel->
  "In[3301]:=",ExpressionUUID->"a3d9e0d0-d9d3-473c-b17c-34902243049d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reference groups", "Section",
 CellChangeTimes->{{3.840461964835967*^9, 
  3.8404619800509477`*^9}},ExpressionUUID->"5014b577-eade-44d5-9877-\
0b6fb524d0f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D6", "=", 
    RowBox[{"GpGenBy", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"ZRot", "[", 
          RowBox[{"\[Pi]", "/", "6"}], "]"}], ".", 
         RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
         RowBox[{"ZRot", "[", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}]}], "]"}]}], "}"}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"not", " ", "reference", " ", "groups"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D8", "=", 
   RowBox[{"GpGenBy", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "8"}], "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "8"}], "]"}]}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "D6", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "D8", "]"}]}], "Input",
 CellChangeTimes->{{3.8401441104581175`*^9, 3.8401441377511044`*^9}, {
  3.840144282135108*^9, 3.840144298919106*^9}, {3.8416713012861648`*^9, 
  3.8416713187262363`*^9}, {3.8416993803767624`*^9, 3.8416993909225245`*^9}, {
  3.841882447782524*^9, 3.8418824604691615`*^9}},
 CellLabel->
  "In[3308]:=",ExpressionUUID->"4dafd9f5-cf41-48ce-ba43-77f35832351a"],

Cell[BoxData[{
 RowBox[{"D6", "==", 
  RowBox[{"GpGenBy", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
     RowBox[{"ZRot", "[", 
      RowBox[{"\[Pi]", "/", "3"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"D8", "==", 
  RowBox[{"GpGenBy", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
     RowBox[{"ZRot", "[", 
      RowBox[{"\[Pi]", "/", "4"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.841882345534013*^9, 3.841882439446643*^9}},
 CellLabel->
  "In[3312]:=",ExpressionUUID->"058665eb-b880-4b38-8e3e-537583ce449c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RefGp", "[", "MONO", "]"}], "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"{", 
     RowBox[{"id", ",", 
      RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefGp", "[", "ORTH", "]"}], "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"{", 
     RowBox[{"id", ",", 
      RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
      RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefGp", "[", "TET", "]"}], "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{"id", ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{"ZRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"3", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
       RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "4"}], "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}], ",", 
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}], ".", 
        RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "4"}], "]"}]}]}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefGp", "[", "TRIG", "]"}], "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{"id", ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], ",", 
       RowBox[{"ZRot", "[", 
        RowBox[{"4", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "]"}], ".", 
        RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "3"}], "]"}]}], ",", 
       RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"\[Pi]", "/", "3"}], "]"}], ".", 
        RowBox[{"YRot", "[", "\[Pi]", "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "3"}], "]"}]}]}], "}"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefGp", "[", "CUBE", "]"}], "=", "GyroidGp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefGp", "[", "TRIV", "]"}], "=", 
   RowBox[{"{", "id", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8228729599121466`*^9, 3.822873006340947*^9}, {
   3.8228730403927703`*^9, 3.8228730656584606`*^9}, {3.822873103335533*^9, 
   3.8228731394154854`*^9}, {3.8228734879765654`*^9, 3.822873495799737*^9}, {
   3.822960259767858*^9, 3.822960299615061*^9}, {3.823022640128541*^9, 
   3.823022654476619*^9}, {3.823031056844345*^9, 3.823031104937643*^9}, {
   3.823044936132269*^9, 3.823045038665047*^9}, {3.8230892123482857`*^9, 
   3.8230893603690815`*^9}, {3.8230894871835327`*^9, 3.823089487964769*^9}, {
   3.8231003744186*^9, 3.8231003909767714`*^9}, {3.823100528824229*^9, 
   3.823100561836717*^9}, {3.840462210542076*^9, 3.8404622304620776`*^9}, {
   3.840463402222063*^9, 3.8404634161260805`*^9}, 3.9162116329058113`*^9, {
   3.9162116778314157`*^9, 3.9162117041637115`*^9}, {3.9162118187061048`*^9, 
   3.9162118415765395`*^9}},
 CellLabel->
  "In[3314]:=",ExpressionUUID->"1833f63b-5540-4e88-877f-bfe1e4c82895"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefGp", "[", "TRIG", "]"}], "==", 
  RowBox[{"GpGenBy", "[", 
   RowBox[{"{", "  ", 
    RowBox[{
     RowBox[{"zrot", "[", "120", "]"}], ",", 
     RowBox[{"yrot", "[", "180", "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9299776105530615`*^9, 3.9299776138337708`*^9}},
 CellLabel->
  "In[3320]:=",ExpressionUUID->"e15ef17f-5dd4-4a87-b01f-2dbe440afb24"],

Cell[TextData[{
 "The group ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalG]", "\[CapitalSigma]"], 
   TraditionalForm]],ExpressionUUID->"c6ca1afb-aeca-4d7c-b3dd-6ac3039f3dba"],
 ".  See Eq. (10) of TapeTape2024."
}], "Section",
 CellChangeTimes->{{3.840461964835967*^9, 3.8404619800509477`*^9}, {
  3.916321708109026*^9, 3.9163217605345125`*^9}, {3.916321858979931*^9, 
  3.916321871294159*^9}},ExpressionUUID->"9f89590c-a30a-412c-9426-\
e3964188c53f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bbG", "[", "TRIG", "]"}], ":=", "D6"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bbG", "[", "CUBE", "]"}], ":=", 
     RowBox[{"RefGp", "[", "CUBE", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bbG", "[", "TET", "]"}], ":=", "D8"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bbG", "[", "ORTH", "]"}], ":=", 
     RowBox[{"RefGp", "[", "CUBE", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.91632191568777*^9, 3.916322075929294*^9}},
 CellLabel->
  "In[3321]:=",ExpressionUUID->"f0d35e3d-6776-4ed1-a006-2bfe05a2cda5"],

Cell["Does not include \[CapitalSigma] = XISO", "Subsubsection",
 CellChangeTimes->{{3.9214257609232645`*^9, 
  3.921425788869177*^9}},ExpressionUUID->"7b19875e-d322-4df6-b1e8-\
5dad627068b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "MONO", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "ORTH", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", "GyroidGp"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "TET", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"TwoFoldPts", "[", "MONO", "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ZRot", "[", 
         RowBox[{"j", " ", 
          RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "8"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TwoFoldPts", "[", "TRIG", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ZRot", "[", 
        RowBox[{"j", " ", 
         RowBox[{"\[Pi]", "/", "3"}]}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Do", " ", "not", " ", "add", " ", 
     RowBox[{"TwoFoldPts", "[", "MONO", "]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPts", "[", "CUBE", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"TwoFoldPts", "[", "ORTH", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", ".", 
         RowBox[{"Unit", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "1"}], "}"}], "]"}]}], "&"}], "/@", 
       "GyroidGp"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8908569024595046`*^9, 3.8908569243633738`*^9}, {
   3.890868930171404*^9, 3.890868996937446*^9}, {3.890899403547298*^9, 
   3.8908994320031805`*^9}, 3.9055166889896483`*^9, {3.9214242877387843`*^9, 
   3.921424329619275*^9}, {3.9214253920863223`*^9, 3.92142539859562*^9}, {
   3.9214255274618587`*^9, 3.921425578247308*^9}, 3.9214256102283726`*^9, {
   3.9214256702131834`*^9, 3.9214256808816786`*^9}},
 CellLabel->
  "In[3325]:=",ExpressionUUID->"ad5d1134-4a6a-437a-9902-ecf0c3f30e2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrderTwoRots", "[", "group_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"group", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"RotationAngle", "[", "#", "]"}], "==", "\[Pi]"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldPtsNew", "[", "group_", "]"}], ":=", 
   RowBox[{"Unit", "/@", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Eigenvectors", "[", "#", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"OrderTwoRots", "[", "group", "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"Eigenvectors", "[", "#", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"OrderTwoRots", "[", "group", "]"}]}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.930065353623907*^9, 3.930065357326722*^9}},
 CellLabel->
  "In[3331]:=",ExpressionUUID->"8815a845-0e32-4da4-84f7-9f376ed00181"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPtsNew", "[", 
    RowBox[{"RefGp", "[", "MONO", "]"}], "]"}], "]"}], "==", 
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPts", "[", "MONO", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPtsNew", "[", 
    RowBox[{"RefGp", "[", "ORTH", "]"}], "]"}], "]"}], "==", 
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPts", "[", "ORTH", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPtsNew", "[", 
    RowBox[{"RefGp", "[", "TET", "]"}], "]"}], "]"}], "==", 
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPts", "[", "TET", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPtsNew", "[", 
    RowBox[{"RefGp", "[", "TRIG", "]"}], "]"}], "]"}], "==", 
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPts", "[", "TRIG", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPtsNew", "[", 
    RowBox[{"RefGp", "[", "CUBE", "]"}], "]"}], "]"}], "==", 
  RowBox[{"Sort", "[", 
   RowBox[{"TwoFoldPts", "[", "CUBE", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9300651415798593`*^9, 3.9300652153697023`*^9}, {
  3.930065254554018*^9, 3.9300653146735*^9}},
 CellLabel->
  "In[3333]:=",ExpressionUUID->"50ca0582-d26d-4c98-b635-7621b85dd4b4"],

Cell[BoxData[
 RowBox[{"True", " "}]], "Input",
 CellChangeTimes->{{3.930069957825759*^9, 3.930069957825759*^9}},
 CellLabel->
  "In[3338]:=",ExpressionUUID->"86a03460-9212-4bfe-8b9c-fd982938602e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ThreeFoldPts", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreeFoldPts", "[", "TRIG", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "MONO", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreeFoldPts", "[", "CUBE", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", ".", 
       RowBox[{"Unit", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "]"}]}], "&"}], "/@", 
     "GyroidGp"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.905816471320741*^9, 3.9058165145521955`*^9}, {
   3.9058165452092314`*^9, 3.9058165943266106`*^9}, 3.905817167897272*^9, 
   3.905867659058076*^9, {3.9214244363225937`*^9, 3.9214244416785975`*^9}, {
   3.9214260952071595`*^9, 3.921426100452551*^9}, 3.9214261314957514`*^9},
 CellLabel->
  "In[3339]:=",ExpressionUUID->"8204e680-917c-4efe-90bd-4afec6c06118"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FourFoldPts", "[", "\[CapitalSigma]_", "]"}], ":=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"FourFoldPts", "[", "XISO", "]"}], ":=", 
     RowBox[{"TwoFoldPts", "[", "MONO", "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FourFoldPts", "[", "TET", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "MONO", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FourFoldPts", "[", "CUBE", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "ORTH", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.921424480453865*^9, 3.921424495760112*^9}, {
  3.921424549350401*^9, 3.9214245669488926`*^9}, {3.921424862084874*^9, 
  3.9214248908035374`*^9}, {3.9214258789268675`*^9, 3.921425881141945*^9}, {
  3.921425911344849*^9, 3.9214259724175043`*^9}, {3.9214377617463303`*^9, 
  3.9214377657371616`*^9}},
 CellLabel->
  "In[3342]:=",ExpressionUUID->"758e8289-feda-48e9-9320-7988a580484e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NfoldPts", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"TwoFoldPts", "[", "\[CapitalSigma]", "]"}], ",", 
      RowBox[{"ThreeFoldPts", "[", "\[CapitalSigma]", "]"}], ",", 
      RowBox[{"FourFoldPts", "[", "\[CapitalSigma]", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.899396778508934*^9, 3.8993968187605324`*^9}, {
  3.899396849864477*^9, 3.8993968574003305`*^9}, {3.8993968899777756`*^9, 
  3.899396959785018*^9}, {3.9214243450133142`*^9, 3.9214243675456576`*^9}, {
  3.921425175509695*^9, 3.9214251850862303`*^9}, {3.9214252270918555`*^9, 
  3.921425252226563*^9}, {3.921425288837182*^9, 3.921425307349572*^9}},
 CellLabel->
  "In[3345]:=",ExpressionUUID->"e50cb6d8-f75b-4d64-af83-484cfbe97cd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "MONO", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "ORTH", "]"}], ":=", 
   RowBox[{"TwoFoldPts", "[", "ORTH", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "CUBE", "]"}], ":=", 
   RowBox[{"FourFoldPts", "[", "CUBE", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestSymPts", "[", "TRIV", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.899402732022479*^9, 3.8994028408693123`*^9}, {
  3.8994028908215237`*^9, 3.899402895060714*^9}, {3.899471478313981*^9, 
  3.8994714852100477`*^9}, {3.921424965392544*^9, 3.9214249743403172`*^9}, {
  3.9214250097394934`*^9, 3.921425024952317*^9}, {3.921426034835005*^9, 
  3.921426079110966*^9}},
 CellLabel->
  "In[3346]:=",ExpressionUUID->"08ce8bb4-29d1-49df-90b2-7e3acc538284"],

Cell["\<\
TwoFoldGraphics. The inputs tkns and hue were added October 2023.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
  3.898446061119554*^9, 3.8984460688078213`*^9}, {3.9054366809602823`*^9, 
  3.905436707521919*^9}},ExpressionUUID->"7ba55eb9-e89c-44a1-9a54-\
a65a9f3320a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", 
     ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
         "]"}]}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "&"}], "/@", 
       RowBox[{"TwoFoldPts", "[", "\[CapitalSigma]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"SeeOnSphere", "[", 
        RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_", 
     ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"hue", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"U", ".", 
              RowBox[{"ZRot", "[", 
               RowBox[{"t", " ", 
                RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", 
              RowBox[{"unit", "[", 
               RowBox[{"Cross", "[", 
                RowBox[{"eye", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"-", "1"}], ",", "3", ",", ".005"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"SeeOnSphere", "[", 
             RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "]"}], ",", 
         RowBox[{"Polygon", "/@", 
          RowBox[{"DiskOnSphere", "[", 
           RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
           "]"}]}]}], "}"}], "&"}], "/@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"U", ".", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"SeeOnSphere", "[", 
          RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890899490390075*^9, 3.890899502954034*^9}, 
   3.8908995591774964`*^9, {3.8908997071597233`*^9, 3.8908997453863373`*^9}, {
   3.8908997811065435`*^9, 3.8908998022105646`*^9}, 3.8908998510077267`*^9, {
   3.8908999164420085`*^9, 3.8908999421866255`*^9}, {3.8909003981002264`*^9, 
   3.890900402179165*^9}, {3.890901022485944*^9, 3.8909010390562124`*^9}, 
   3.8909010858517847`*^9, 3.8909011806016836`*^9, {3.890901297154953*^9, 
   3.8909013056411057`*^9}, {3.890902344922923*^9, 3.890902378687098*^9}, 
   3.890902495482194*^9, 3.890902550492345*^9, {3.8909026366728916`*^9, 
   3.8909026546957426`*^9}, {3.890902722096571*^9, 3.89090278436241*^9}, 
   3.890902881059866*^9, {3.890902967555865*^9, 3.890902972473795*^9}, 
   3.890903038602707*^9, {3.890903162756205*^9, 3.8909031700523252`*^9}, {
   3.8909032133737907`*^9, 3.890903252090414*^9}, {3.8909034487289705`*^9, 
   3.8909034738781333`*^9}, 3.890903526620658*^9, {3.8909035625493526`*^9, 
   3.890903671063106*^9}, {3.890903776287823*^9, 3.890903780214381*^9}, {
   3.8909038545148315`*^9, 3.8909038714065056`*^9}, {3.891217032452718*^9, 
   3.8912170899402494`*^9}, {3.891217127226694*^9, 3.8912171492887955`*^9}, {
   3.8912171807010746`*^9, 3.891217183008232*^9}, {3.8912179993718243`*^9, 
   3.891218008792474*^9}, 3.891218417633298*^9, {3.8959338377555275`*^9, 
   3.895933902076391*^9}, {3.895935089867797*^9, 3.895935109322997*^9}, {
   3.895935468763073*^9, 3.89593549650836*^9}, {3.895935630556337*^9, 
   3.8959356742826347`*^9}, {3.8959357771308928`*^9, 
   3.8959357777875686`*^9}, {3.895935853642667*^9, 3.895935855240994*^9}, {
   3.8959369197205296`*^9, 3.8959369397848854`*^9}, {3.8959370432110496`*^9, 
   3.8959370795038967`*^9}, 3.8959371950658674`*^9, {3.895937229784996*^9, 
   3.895937235625312*^9}, {3.895937480681276*^9, 3.8959374874491243`*^9}, {
   3.8959375395453167`*^9, 3.89593756620135*^9}, {3.89593762581762*^9, 
   3.8959376559449635`*^9}, {3.8959377410170145`*^9, 3.895937741690278*^9}, {
   3.8959378143133492`*^9, 3.8959378278327293`*^9}, {3.8959379330507975`*^9, 
   3.8959379349861574`*^9}, {3.8959381221215353`*^9, 3.8959381918002725`*^9}, 
   3.895938222745496*^9, {3.8959382812741175`*^9, 3.89593828183339*^9}, {
   3.8959501380864735`*^9, 3.895950179943906*^9}, {3.89595021036965*^9, 
   3.8959502425473046`*^9}, {3.8960469853728423`*^9, 
   3.8960469942216854`*^9}, {3.896473147053547*^9, 3.896473155931282*^9}, {
   3.8964732359704037`*^9, 3.896473353675417*^9}, 3.896473384424013*^9, 
   3.896473481193104*^9, {3.896879443694662*^9, 3.8968794456409054`*^9}, 
   3.896879501065666*^9, {3.8975113735175643`*^9, 3.8975113764204564`*^9}, {
   3.8993870990048714`*^9, 3.8993871090680494`*^9}, 3.903039636078458*^9, {
   3.9054366111380796`*^9, 3.9054366611522875`*^9}},
 CellLabel->
  "In[3350]:=",ExpressionUUID->"cfe7223a-97eb-4261-a174-00ae341b30ba"],

Cell[CellGroupData[{

Cell["\<\
TwoFoldGraphics with center and radius.  The input tkns was added August \
2023. The input hue was added October 2023\
\>", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
   3.8993985004398685`*^9, 3.8993985398149786`*^9}, 3.8993986532867675`*^9, 
   3.8994279032052794`*^9, {3.900853420490844*^9, 3.9008534475667114`*^9}, {
   3.9054351447284336`*^9, 3.9054351583268037`*^9}, {3.905436756527512*^9, 
   3.9054367635361648`*^9}},ExpressionUUID->"82845610-7b09-48b4-8890-\
11b993725e08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "center_", ",", "radius_", ",", 
     "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_", ",", "tkns_", ",", 
     "hue_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"hue", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"center", "+", 
            RowBox[{"radius", "\[Times]", 
             RowBox[{"U", ".", "#"}]}]}], "&"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DiskOnSphere", "[", 
              RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}],
               "]"}], "&"}], "/@", 
            RowBox[{"TwoFoldPts", "[", "\[CapitalSigma]", "]"}]}], ")"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "center_", ",", "radius_", ",", "AngRadDisk_", 
     ",", "ShiftToEye_", ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"hue", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{
            RowBox[{"center", "+", 
             RowBox[{"#", " ", "radius"}]}], ",", ".01", ",", "eye"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"U", ".", 
            RowBox[{"ZRot", "[", "t", " ", "]"}], ".", 
            RowBox[{"unit", "[", 
             RowBox[{"Cross", "[", 
              RowBox[{"eye", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
             RowBox[{"3", 
              RowBox[{"\[Pi]", "/", "2"}]}], ",", 
             RowBox[{".005", "\[Pi]"}]}], "}"}]}], "]"}]}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"center", "+", 
            RowBox[{"#", " ", "radius"}]}], "&"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DiskOnSphere", "[", 
              RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}],
               "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"U", ".", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"U", ".", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}]}], "}"}]}], ")"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.896923633673681*^9, 3.8969237081370544`*^9}, 
   3.8969237557071543`*^9, 3.896924329277*^9, 3.896924407230274*^9, {
   3.8969663241029897`*^9, 3.8969663279744196`*^9}, 3.8969664032576046`*^9, {
   3.898449335305853*^9, 3.898449339042554*^9}, {3.8985307641921387`*^9, 
   3.8985307695316443`*^9}, {3.898613949823719*^9, 3.8986139545794497`*^9}, {
   3.898640099334127*^9, 3.8986401429097567`*^9}, {3.8986496428018894`*^9, 
   3.8986496438836613`*^9}, {3.899386406441304*^9, 3.8993864113502884`*^9}, 
   3.8993867005043635`*^9, 3.899387133162531*^9, {3.899398559961319*^9, 
   3.899398561960492*^9}, 3.899398646248892*^9, {3.8994091066821976`*^9, 
   3.899409120343955*^9}, {3.8994278040398955`*^9, 3.8994278757502055`*^9}, {
   3.8994283655261693`*^9, 3.89942839269563*^9}, {3.8994284612715874`*^9, 
   3.8994284712059803`*^9}, 3.899767092985012*^9, 3.90051345460507*^9, 
   3.9008525646263585`*^9, 3.9008526682120905`*^9, {3.9008528205545053`*^9, 
   3.9008528211647263`*^9}, {3.9008534115686245`*^9, 3.90085341429609*^9}, {
   3.9008534584962406`*^9, 3.9008534610695105`*^9}, {3.900853985280548*^9, 
   3.9008539869890933`*^9}, {3.9054349994394126`*^9, 3.90543502956444*^9}, {
   3.905435060223624*^9, 3.905435062771002*^9}},
 CellLabel->
  "In[3352]:=",ExpressionUUID->"0e6496d9-2038-4ce8-b8c7-2f4affda3d75"]
}, Open  ]],

Cell["ThreeFoldGraphics.  (tkns is irrelevant.)", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
   3.8993985004398685`*^9, 3.8993985398149786`*^9}, 3.8993986532867675`*^9, 
   3.8994279032052794`*^9, {3.900853420490844*^9, 3.9008534475667114`*^9}, {
   3.900962922763859*^9, 3.900962944348444*^9}, 3.902325382436557*^9, {
   3.905435169356355*^9, 3.9054351706889925`*^9}, {3.905816898183816*^9, 
   3.9058169365665803`*^9}, {3.9058170661198144`*^9, 3.905817079255905*^9}, {
   3.921426216767933*^9, 
   3.9214262174433813`*^9}},ExpressionUUID->"6b58937f-4cf9-4911-a96b-\
83e8c6c69808"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ThreeFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", 
     ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
         "]"}]}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "&"}], "/@", 
       RowBox[{"ThreeFoldPts", "[", "\[CapitalSigma]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"SeeOnSphere", "[", 
        RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9058168122002726`*^9, 3.9058168137201395`*^9}, {
   3.9058168633536606`*^9, 3.905816869688035*^9}, {3.90581695168895*^9, 
   3.9058169539439754`*^9}, {3.9058172470329885`*^9, 3.9058172737696204`*^9}, 
   3.9058173115932837`*^9},
 CellLabel->
  "In[3354]:=",ExpressionUUID->"1241e5e9-fe9a-46b0-b769-a6276efd9b0d"],

Cell["\<\
FourFoldGraphics.  Increase ShiftToEye if you want to plot 4-fold over \
2-fold.  (tkns is irrelevant.)\
\>", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
   3.8993985004398685`*^9, 3.8993985398149786`*^9}, 3.8993986532867675`*^9, 
   3.8994279032052794`*^9, {3.900853420490844*^9, 3.9008534475667114`*^9}, {
   3.900962922763859*^9, 3.900962944348444*^9}, 3.902325382436557*^9, {
   3.905435169356355*^9, 3.9054351706889925`*^9}, {3.905816898183816*^9, 
   3.9058169365665803`*^9}, {3.9058170661198144`*^9, 3.905817079255905*^9}, {
   3.921426216767933*^9, 3.9214262174433813`*^9}, {3.9214262486685143`*^9, 
   3.9214262497851706`*^9}, {3.921426335279295*^9, 
   3.9214263795742545`*^9}},ExpressionUUID->"e9b6dc6c-115f-4ca5-b3b9-\
ad6cccac662e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FourFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", 
     ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
         "]"}]}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "&"}], "/@", 
       RowBox[{"FourFoldPts", "[", "\[CapitalSigma]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"SeeOnSphere", "[", 
        RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9058168122002726`*^9, 3.9058168137201395`*^9}, {
   3.9058168633536606`*^9, 3.905816869688035*^9}, {3.90581695168895*^9, 
   3.9058169539439754`*^9}, {3.9058172470329885`*^9, 3.9058172737696204`*^9}, 
   3.9058173115932837`*^9, {3.9214262598446636`*^9, 3.921426268424547*^9}},
 CellLabel->
  "In[3355]:=",ExpressionUUID->"42a39a91-16e1-4a1f-83de-1bb9408d044e"],

Cell["\<\
Again, tkns was added as an input August 2023. Hue was added as input October \
2023\
\>", "Subsubsection",
 CellChangeTimes->{{3.8960220640154767`*^9, 3.8960221052628317`*^9}, {
   3.8993985004398685`*^9, 3.8993985398149786`*^9}, 3.8993986532867675`*^9, 
   3.8994279032052794`*^9, {3.900853420490844*^9, 3.9008534475667114`*^9}, {
   3.900962922763859*^9, 3.900962944348444*^9}, 3.902325382436557*^9, {
   3.905435169356355*^9, 
   3.9054351706889925`*^9}},ExpressionUUID->"b946f69c-9b36-4a27-9684-\
7c47d7794f24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NfoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", 
     ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"DiskOnSphere", "[", 
         RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
         "]"}]}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "&"}], "/@", 
       RowBox[{"NfoldPts", "[", "\[CapitalSigma]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"SeeOnSphere", "[", 
        RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NfoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_", 
     ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye", ",", 
     "tkns", ",", "hue"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9085713981590824`*^9, 3.90857140880894*^9}, 
   3.908571512468541*^9, {3.908571549026561*^9, 3.908571558690651*^9}, {
   3.908571604528036*^9, 3.9085716283016596`*^9}, {3.908571678960893*^9, 
   3.908571695809544*^9}},
 CellLabel->
  "In[3356]:=",ExpressionUUID->"c683eb0f-556e-4201-aa62-0783eb180af2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NfoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "U_", ",", "center_", ",", "radius_", ",", 
     "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_", ",", "tkns_", ",", 
     "hue_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"hue", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"center", "+", 
            RowBox[{"radius", "\[Times]", 
             RowBox[{"U", ".", "#"}]}]}], "&"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DiskOnSphere", "[", 
              RowBox[{"#", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}],
               "]"}], "&"}], "/@", 
            RowBox[{"NfoldPts", "[", "\[CapitalSigma]", "]"}]}], ")"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NfoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U_", ",", "center_", ",", "radius_", ",", "AngRadDisk_", 
     ",", "ShiftToEye_", ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}], ":=", 
   RowBox[{"TwoFoldGraphics", "[", 
    RowBox[{
    "XISO", ",", "U", ",", "center", ",", "radius", ",", "AngRadDisk", ",", 
     "ShiftToEye", ",", "eye", ",", "tkns", ",", "hue"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.899475593028944*^9, 3.899475610854124*^9}, {
  3.8994756583400946`*^9, 3.899475707102071*^9}, {3.9008534831271477`*^9, 
  3.9008535276338453`*^9}, {3.905432267375147*^9, 3.905432334743061*^9}, {
  3.905435094642767*^9, 3.905435135536477*^9}},
 CellLabel->
  "In[3358]:=",ExpressionUUID->"025b6aae-f003-4ba8-91aa-536fd25872ba"],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", 
     SubscriptBox["U", "1"], ")"}], " ", "=", " "}], TraditionalForm]],
  ExpressionUUID->"b81747ff-3042-444e-9978-240c0930e7de"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", 
    SubscriptBox["U", "2"], ")"}], TraditionalForm]],ExpressionUUID->
  "1b5bab87-02d4-4e98-8371-e652572173e0"],
 "."
}], "Subsubsection",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 3.8667357799594383`*^9}, {
  3.896036615602913*^9, 
  3.8960366485895214`*^9}},ExpressionUUID->"75409e28-bd2d-490f-8905-\
4e92068cd9b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "XISO"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}], ")"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "||", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}], ")"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "TET"}], "]"}], "  ", ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"D8", ",", "              ", 
     RowBox[{
      RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "ORTH"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"GyroidGp", ",", 
     RowBox[{
      RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SameSigmaSubspace", "[", 
    RowBox[{"U1_", ",", "U2_", ",", "CUBE"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"GyroidGp", ",", 
     RowBox[{
      RowBox[{"Transpose", "[", "U1", "]"}], ".", "U2"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8905072829496317`*^9, 3.890507397485277*^9}, {
  3.8905074780992627`*^9, 3.890507479088288*^9}, {3.890517409694439*^9, 
  3.890517526294508*^9}, {3.8905176167280684`*^9, 3.8905176185161695`*^9}, {
  3.8905182312955985`*^9, 3.890518239562536*^9}, {3.9023254182770863`*^9, 
  3.9023254236208177`*^9}},
 CellLabel->
  "In[3360]:=",ExpressionUUID->"3969960d-a7ba-45a5-a6e8-450adaef1977"],

Cell["Example.", "Subsubsection",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 3.8667357799594383`*^9}, {
  3.896036615602913*^9, 3.8960366485895214`*^9}, {3.896036848620084*^9, 
  3.8960368535309277`*^9}},ExpressionUUID->"797ae50f-cd0a-4cf4-9495-\
d9fd6a02ab2e"],

Cell[BoxData[{
 RowBox[{"SameSigmaSubspace", "[", 
  RowBox[{"id", ",", "rot111", ",", "XISO"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SameSigmaSubspace", "[", 
  RowBox[{
   RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", 
   RowBox[{"ZRot", "[", "t", "]"}], ",", "XISO"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8960367272269616`*^9, 3.8960367344237366`*^9}, {
  3.896036771653099*^9, 3.896036785319456*^9}, {3.8960368168904586`*^9, 
  3.896036829561874*^9}},
 CellLabel->
  "In[3364]:=",ExpressionUUID->"f2e852cc-4101-4891-831c-e2c608fe211c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UTforTwoFoldGraphics", "[", 
    RowBox[{"\[CapitalSigma]_", ",", "dummy1_", ",", "dummy2_", ",", "nm1"}], 
    "]"}], ":=", "UforNM1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UTforTwoFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "    ", "Tmat_", ",", "   ", "dummy_", ",", 
     "nm2"}], "]"}], ":=", 
   RowBox[{"UT", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UTforTwoFoldGraphics", "[", 
    RowBox[{
    "\[CapitalSigma]_", ",", "    ", "Tmat_", ",", "         ", 
     "\[CapitalSigma]n_", ",", " ", "nm3"}], "]"}], ":=", 
   RowBox[{"UT", "[", 
    RowBox[{
     RowBox[{"ClosestToPrior", "[", 
      RowBox[{
       RowBox[{"Prior\[CapitalSigma]", "[", 
        RowBox[{"\[CapitalSigma]", ",", "\[CapitalSigma]n"}], "]"}], ",", 
       "Tmat", ",", "\[CapitalSigma]n"}], "]"}], ",", "\[CapitalSigma]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9076872324656067`*^9, 3.9076873320553503`*^9}, {
   3.9076874024788713`*^9, 3.907687433978501*^9}, {3.9077932666617613`*^9, 
   3.9077932683653164`*^9}, {3.907807304279706*^9, 3.907807315191391*^9}, 
   3.907860006492757*^9, {3.907956388528017*^9, 3.907956439213915*^9}, 
   3.9079576132710643`*^9, 3.9079577130638123`*^9, {3.9109868538518677`*^9, 
   3.91098696461057*^9}},
 CellLabel->
  "In[3366]:=",ExpressionUUID->"b449c363-b347-4745-abdb-d7eca3deb486"],

Cell[CellGroupData[{

Cell[TextData[{
 "The closest elastic map to Tmat in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "U", ")"}], 
   TraditionalForm]],ExpressionUUID->"8e4b1f3b-9011-4f03-bf3a-54bfe5481b7c"],
 "."
}], "Section",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 
  3.8667357799594383`*^9}},ExpressionUUID->"9ef33130-6f64-43af-b2b8-\
5487952d722d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"substitutions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "ap"}], ",", 
     RowBox[{"b", "\[Rule]", "bp"}], ",", "\[IndentingNewLine]", 
     RowBox[{"c", "\[Rule]", "cp"}], ",", 
     RowBox[{"d", "\[Rule]", "dp"}], ",", 
     RowBox[{"e", "\[Rule]", "ep"}], ",", 
     RowBox[{"f", "\[Rule]", "fp"}], ",", 
     RowBox[{"g", "\[Rule]", "gp"}], ",", 
     RowBox[{"h", "\[Rule]", "hp"}], ",", 
     RowBox[{"i", "\[Rule]", "ip"}], ",", 
     RowBox[{"j", "\[Rule]", "jp"}], ",", 
     RowBox[{"k", "\[Rule]", "kp"}], ",", 
     RowBox[{"m", "\[Rule]", "mp"}], ",", 
     RowBox[{"n", "\[Rule]", "np"}], ",", 
     RowBox[{"o", "\[Rule]", "op"}], ",", 
     RowBox[{"p", "\[Rule]", "pp"}], ",", 
     RowBox[{"q", "\[Rule]", "qp"}], ",", 
     RowBox[{"r", "\[Rule]", "rp"}], ",", 
     RowBox[{"s", "\[Rule]", "sp"}], ",", 
     RowBox[{"t", "\[Rule]", "tp"}], ",", 
     RowBox[{"u", "\[Rule]", "up"}], ",", 
     RowBox[{"v", "\[Rule]", "vp"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.869518280609372*^9},
 CellLabel->
  "In[3369]:=",ExpressionUUID->"31d2f149-6858-4f2f-80ab-fce0187427f0"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"BlankSlate", "/.", "substitutions"}], "]"}]], "Input",
 CellChangeTimes->{{3.869518234927585*^9, 3.8695182693431835`*^9}, 
   3.8793838653603854`*^9, 3.879520971029767*^9},
 CellLabel->
  "In[3370]:=",ExpressionUUID->"e3961900-d415-4752-9abd-9dadab0b6dcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixUbar", "[", "U", "]"}], ".", 
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
       RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", "id", ",", 
      "\[CapitalSigma]"}], "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.837707973295394*^9, 3.837707999043233*^9}, {
  3.837708047967713*^9, 3.837708133270465*^9}, {3.8377081670288773`*^9, 
  3.837708182094732*^9}, {3.838315519596882*^9, 3.838315527532865*^9}, {
  3.8702365608069167`*^9, 3.8702365684027057`*^9}},
 CellLabel->
  "In[3371]:=",ExpressionUUID->"05feb303-451b-4030-bbca-765dff325d97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{"Tmat_", ",", 
      StyleBox["id",
       FontColor->RGBColor[1, 0, 0]], ",", "TRIV"}], "]"}], ":=", "Tmat"}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"These", " ", "are", " ", "the", " ", "P", 
     RowBox[{"(", 
      RowBox[{"T", ",", 
       RowBox[{
        SubscriptBox["V", "\[CapitalSigma]"], 
        RowBox[{"(", "I", ")"}]}]}], ")"}], " ", "in", " ", "the", " ", 
     "2022", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "0", "0", "0", "0"},
       {"g", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "i", "o", "s"},
       {"0", "0", "i", "d", "j", "p"},
       {"0", "0", "o", "j", "e", "k"},
       {"0", "0", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "ORTH"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "j", "p"},
       {"0", "0", "0", "j", "e", "k"},
       {"0", "0", "0", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "TRIG"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", "0"},
        {
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "TET"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0"},
        {"0", "0", "c", "0", "0", "0"},
        {"0", "0", "0", "d", "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "CUBE"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0", "0"},
        {"0", "0", 
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0"},
        {"0", "0", "0", 
         FractionBox[
          RowBox[{"d", "+", "e"}], "2"], "0", "0"},
        {"0", "0", "0", "0", 
         FractionBox[
          RowBox[{"d", "+", "e"}], "2"], "0"},
        {"0", "0", "0", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"a_", "g_", "m_", "q_", "t_", "v_"},
          {"gdum_", "b_", "h_", "n_", "r_", "u_"},
          {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
          {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
          {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
          {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      StyleBox["id",
       FontColor->RGBColor[1, 0, 0]], ",", "XISO"}], "]"}], ":=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0"},
        {"0", "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0", "0"},
        {"0", "0", "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";", 
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"a_", "g_", "m_", "q_", "t_", "v_"},
          {"gdum_", "b_", "h_", "n_", "r_", "u_"},
          {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
          {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
          {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
          {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", 
      StyleBox["Udum_",
       FontColor->RGBColor[1, 0, 0]], ",", "ISO"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0", "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0"},
       {"0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.8365909720971985`*^9, 3.83659100273319*^9}, {
   3.836591362316605*^9, 3.836591369832106*^9}, {3.837537582893462*^9, 
   3.8375376419816647`*^9}, {3.837537681816289*^9, 3.8375377605041833`*^9}, {
   3.8375381993641057`*^9, 3.837538212538134*^9}, {3.837538755170615*^9, 
   3.837538794523321*^9}, {3.8375388308072205`*^9, 3.8375389016620283`*^9}, {
   3.8375389425372505`*^9, 3.8375389432091637`*^9}, {3.837540045005973*^9, 
   3.8375400469122224`*^9}, {3.838315531679864*^9, 3.838315537160882*^9}, 
   3.838315656107436*^9, 3.843934250463087*^9, {3.8667358194495106`*^9, 
   3.8667358360281563`*^9}, {3.9355072144691315`*^9, 3.935507217001179*^9}},
 CellLabel->
  "In[3372]:=",ExpressionUUID->"2fb2e220-2d61-4789-a767-d90b23b892a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Should be equivalent to  \[Beta]Tinitial[Tmat, ISO].  ", "Subsubsection",
 CellChangeTimes->{{3.913672270744788*^9, 3.91367234776458*^9}, {
  3.913735566336107*^9, 3.913735625905148*^9}, {3.9257597865447426`*^9, 
  3.9257598314863353`*^9}},ExpressionUUID->"ad26e51f-b01c-419e-820d-\
c95f067ae1c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]ISO", "[", 
    TagBox["T_",
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "]"}], ":=", 
   TagBox[
    RowBox[{"ArcCos", "[", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         FractionBox["1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "4"}], "]"}], "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "5"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"T", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "6"}], "]"}], "]"}], "2"]}]], 
      RowBox[{"NormMatrix", "[", "T", "]"}]], "]"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.913671086604125*^9, 3.913671101306885*^9}, {
  3.913671245643692*^9, 3.913671256957487*^9}},
 CellLabel->
  "In[3379]:=",ExpressionUUID->"7d7cef3f-dcd8-496e-ad51-b9ea784f5db8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Showing that T - P(T, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "I", ")"}], 
     ")"}], " ", "is", " ", "in", " ", "the", " ", "orthogonal", " ", 
    "complement", " ", "of", " "}], TraditionalForm]],ExpressionUUID->
  "e1b5ba29-4f26-44eb-b59a-5ba7ab25dff9"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "I", ")"}], 
   TraditionalForm]],ExpressionUUID->"0eb21725-b6e6-4eb8-8870-25b55902132d"],
 "."
}], "Subsection",
 CellChangeTimes->{{3.8308789530168915`*^9, 3.83087898811546*^9}, {
  3.8308935163729024`*^9, 3.830893517812665*^9}, {3.831220557951639*^9, 
  3.8312205908628683`*^9}, {3.834238953506115*^9, 3.83423896707609*^9}, {
  3.8383167214963245`*^9, 3.8383167503428793`*^9}, {3.866735695183169*^9, 
  3.866735708456449*^9}, {3.8667357567527437`*^9, 3.8667357799594383`*^9}, {
  3.8695305090838656`*^9, 3.8695305579811907`*^9}, {3.869530616652195*^9, 
  3.869530697665429*^9}},ExpressionUUID->"3734f772-ecbf-4140-b5da-\
47be01d3670c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "ap", ",", "bp", ",", "cp", ",", "dp", ",", "ep", ",", "fp", ",", "gp", 
    ",", "hp", ",", "ip", ",", "jp", ",", "kp", ",", "mp", ",", "np", ",", 
    "op", ",", "pp", ",", "qp", ",", "rp", ",", "sp", ",", "tp", ",", "up", 
    ",", "vp", ",", "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", 
    ",", "g", ",", "h", ",", "i", ",", "j", ",", "k", ",", "m", ",", "n", ",",
     "o", ",", "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", 
    "v"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"ap", "gp", "mp", "qp", "tp", "vp"},
         {"gp", "bp", "hp", "np", "rp", "up"},
         {"mp", "hp", "cp", "ip", "op", "sp"},
         {"qp", "np", "ip", "dp", "jp", "pp"},
         {"tp", "rp", "op", "jp", "ep", "kp"},
         {"vp", "up", "sp", "pp", "kp", "fp"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "TRIV"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "gp", "0", "0", "0", "0"},
        {"gp", "bp", "0", "0", "0", "0"},
        {"0", "0", "cp", "ip", "op", "sp"},
        {"0", "0", "ip", "dp", "jp", "pp"},
        {"0", "0", "op", "jp", "ep", "kp"},
        {"0", "0", "sp", "pp", "kp", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "MONO"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "0", "0", "0", "0", "0"},
        {"0", "bp", "0", "0", "0", "0"},
        {"0", "0", "cp", "0", "0", "0"},
        {"0", "0", "0", "dp", "jp", "pp"},
        {"0", "0", "0", "jp", "ep", "kp"},
        {"0", "0", "0", "pp", "kp", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "ORTH"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "0", "0", "0", "0", "0"},
        {"0", "ap", "0", "0", "0", "0"},
        {"0", "0", "cp", "0", "0", "0"},
        {"0", "0", "0", "dp", "0", "0"},
        {"0", "0", "0", "0", "ep", "kp"},
        {"0", "0", "0", "0", "kp", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "TET"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"ap", "0", "0", "0", "0", "0"},
        {"0", "ap", "0", "0", "0", "0"},
        {"0", "0", "ap", "0", "0", "0"},
        {"0", "0", "0", "dp", "0", "0"},
        {"0", "0", "0", "0", "dp", "0"},
        {"0", "0", "0", "0", "0", "fp"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
     RowBox[{"BlankSlate", "-", 
      RowBox[{"ProjToVSigOfU", "[", 
       RowBox[{
        TagBox["BlankSlate",
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]], ",", 
        StyleBox["id",
         FontColor->RGBColor[1, 0, 0]], ",", "CUBE"}], "]"}]}]}], "]"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ap", "0", "mp", "0", "0", "0"},
       {"0", "ap", "0", "mp", "0", "0"},
       {"mp", "0", "cp", "0", "0", "0"},
       {"0", "mp", "0", "cp", "0", "0"},
       {"0", "0", "0", "0", "ep", "kp"},
       {"0", "0", "0", "0", "kp", "fp"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "TRIG"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ap", "0", "0", "0", "0", "0"},
       {"0", "ap", "0", "0", "0", "0"},
       {"0", "0", "cp", "0", "0", "0"},
       {"0", "0", "0", "cp", "0", "0"},
       {"0", "0", "0", "0", "ep", "kp"},
       {"0", "0", "0", "0", "kp", "fp"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "XISO"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"InnerProductMatrix", "[", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"ap", "0", "0", "0", "0", "0"},
       {"0", "ap", "0", "0", "0", "0"},
       {"0", "0", "ap", "0", "0", "0"},
       {"0", "0", "0", "ap", "0", "0"},
       {"0", "0", "0", "0", "ap", "0"},
       {"0", "0", "0", "0", "0", "fp"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
    RowBox[{"BlankSlate", "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       TagBox["BlankSlate",
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "ISO"}], "]"}]}]}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8357470335862246`*^9, 3.835747067090229*^9}, {
   3.835747115315954*^9, 3.8357471615552735`*^9}, {3.837538599934983*^9, 
   3.8375386539001265`*^9}, {3.837540159405265*^9, 3.83754016470214*^9}, {
   3.8375583418439856`*^9, 3.837558438579998*^9}, {3.837558501128033*^9, 
   3.8375586004360185`*^9}, {3.837558641252023*^9, 3.837558713524046*^9}, {
   3.837558745863897*^9, 3.8375587812040415`*^9}, {3.8383155413188667`*^9, 
   3.838315552789873*^9}, {3.866215101200475*^9, 3.866215102255923*^9}, {
   3.8694962599420996`*^9, 3.869496341514533*^9}, {3.869517940108182*^9, 
   3.869518209525943*^9}, {3.869518348948544*^9, 3.869518353996106*^9}, 
   3.8695183957165785`*^9, {3.8695184629823313`*^9, 3.86951847191269*^9}, {
   3.869518524624955*^9, 3.869518525001154*^9}, {3.879383866703079*^9, 
   3.8793838860420074`*^9}, {3.87952097209367*^9, 3.879520984119149*^9}},
 CellLabel->
  "In[3380]:=",ExpressionUUID->"7be5dfaf-bb36-46aa-98f9-c5e770c53485"],

Cell[TextData[{
 "DistToV\[CapitalSigma]ofU is  ",
 StyleBox["d",
  FontSlant->"Italic"],
 "(T, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["V", "\[CapitalSigma]"], "(", "U", ")"}], ")"}], "  ", 
    "in", "  ", "TapeTape2022"}], TraditionalForm]],ExpressionUUID->
  "e6a704c4-325b-4160-97d3-711279f941ac"]
}], "Subsubsection",
 CellChangeTimes->{{3.8694959455413094`*^9, 
  3.8694960529664993`*^9}},ExpressionUUID->"6d5ad732-8bf7-402b-8d3a-\
01c810f344f6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Amat", "[", 
    RowBox[{"Tmat_", ",", "U_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
    RowBox[{"MatrixUbar", "[", "U", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
     RowBox[{"Tmat_", ",", "U_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
    RowBox[{"NormMatrix", "[", 
     RowBox[{
      RowBox[{"Amat", "[", 
       RowBox[{"Tmat", ",", "U"}], "]"}], "-", 
      RowBox[{"ProjToVSigOfU", "[", 
       RowBox[{
        RowBox[{"Amat", "[", 
         RowBox[{"Tmat", ",", "U"}], "]"}], ",", 
        StyleBox["id",
         FontColor->RGBColor[1, 0, 0]], ",", "\[CapitalSigma]"}], "]"}]}], 
     "]"}]}], "      ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Independent", " ", "of", " ", "U", " ", "for", " ", 
       "\[CapitalSigma]"}], " ", "=", " ", 
      RowBox[{"ISO", "."}]}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], "*)"}], ";"}], "  "}]}], "Input",
 CellChangeTimes->{{3.8357448915238466`*^9, 3.835744967570093*^9}, {
   3.8357450479859734`*^9, 3.835745074145976*^9}, {3.835745147649985*^9, 
   3.8357451824179897`*^9}, {3.835745240369624*^9, 3.8357452601139994`*^9}, {
   3.835747326226262*^9, 3.835747327426262*^9}, {3.836493385688408*^9, 
   3.8364933907773094`*^9}, {3.8375211999204063`*^9, 3.837521299663314*^9}, {
   3.837521428127365*^9, 3.8375214513513784`*^9}, {3.837538288469763*^9, 
   3.837538328350992*^9}, {3.837538997078642*^9, 3.8375389982192793`*^9}, {
   3.8375390638392706`*^9, 3.8375390685423822`*^9}, {3.8375419187174435`*^9, 
   3.837541920311195*^9}, {3.8375419703826494`*^9, 3.8375419907156963`*^9}, {
   3.837543100696145*^9, 3.837543101758645*^9}, {3.8375432689255123`*^9, 
   3.8375432754895744`*^9}, 3.838315537907877*^9, {3.8383164982723083`*^9, 
   3.8383165307639246`*^9}, 3.8411596871528597`*^9, 3.8416739537202744`*^9, {
   3.858003176569495*^9, 3.8580031850152383`*^9}, {3.85800325373061*^9, 
   3.8580033334280252`*^9}, {3.8580034529027033`*^9, 3.858003501589068*^9}, {
   3.8580035433430667`*^9, 3.858003544484513*^9}, {3.8598424439287043`*^9, 
   3.859842457438259*^9}, {3.8599875005919046`*^9, 3.859987502181564*^9}, {
   3.869495810654622*^9, 3.8694958194467974`*^9}, 3.8694960878445487`*^9, 
   3.86953084944965*^9, {3.921960014977957*^9, 3.921960146889106*^9}, {
   3.921960194887344*^9, 3.92196020184474*^9}, {3.9219603783528366`*^9, 
   3.9219603930635233`*^9}},
 CellLabel->
  "In[3389]:=",ExpressionUUID->"7a02722a-8930-47a3-a853-8195a584f120"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Phi]"}], "}"}], "]"}], "==", 
   RowBox[{
    RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
    RowBox[{"YRot", "[", "\[Phi]", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.903078293152074*^9, 3.903078377432186*^9}},
 CellLabel->
  "In[3391]:=",ExpressionUUID->"8060ecd3-c0e7-4bee-9188-310f4b8bce2b"],

Cell["\<\
The angular version of the monoclinic distance function, and now for \
arbitrary \[CapitalSigma].\
\>", "Subsubsection",
 CellChangeTimes->{{3.894975366356778*^9, 3.8949753938899574`*^9}, {
  3.9264649416619015`*^9, 
  3.926464983548662*^9}},ExpressionUUID->"41fb8a5e-b571-4bfc-ae10-\
4882de4ba9c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AlphaOfU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    FractionBox[
     RowBox[{"NormMatrix", "[", 
      RowBox[{"ProjToVSigOfU", "[", 
       RowBox[{"Tmat", ",", "U", ",", "\[CapitalSigma]"}], "]"}], "]"}], 
     RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Alpha", "[", 
    RowBox[{"Tmat_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], ",", 
     "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"AlphaOfU", "[", 
    RowBox[{"Tmat", ",", 
     RowBox[{"UsHat", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ",", "\[CapitalSigma]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Alpha", "[", 
    RowBox[{"Tmat_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[CapitalSigma]_"}],
     "]"}], ":=", 
   RowBox[{"AlphaOfU", "[", 
    RowBox[{"Tmat", ",", 
     RowBox[{"UsHat", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0.99", ",", "\[Phi]"}], "}"}], "]"}], ",", 
     "\[CapitalSigma]"}], "]"}]}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"only", " ", "for", " ", "\[CapitalSigma]"}], " ", "=", " ", 
     RowBox[{"MONO", " ", "or", " ", "XISO"}]}],
    FontColor->GrayLevel[0]], " ", "*)"}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.895071633568805*^9, 3.8950716671685653`*^9}, {
   3.8950717236841736`*^9, 3.8950717451846266`*^9}, {3.895074000188815*^9, 
   3.895074037390315*^9}, {3.895089916119768*^9, 3.8950899178789697`*^9}, {
   3.917475672565323*^9, 3.917475725466157*^9}, {3.917525218973399*^9, 
   3.9175252391448927`*^9}, {3.9175252821322746`*^9, 3.9175253595790663`*^9}, 
   3.917525780796855*^9, {3.9175258430688066`*^9, 3.9175258520781507`*^9}, {
   3.920210113439783*^9, 3.92021013124683*^9}, {3.920210166101883*^9, 
   3.920210203729867*^9}, {3.9202102542871647`*^9, 3.9202102632601137`*^9}, {
   3.9219405110383854`*^9, 3.921940512375058*^9}, 3.9407140567393713`*^9},
 CellLabel->
  "In[3392]:=",ExpressionUUID->"5b0e8ceb-9a9a-4f5a-b88e-9453c59feddb"],

Cell[CellGroupData[{

Cell["\<\
MaxAlphaSubSigma and MinAlphaSubSigma are used in getting contours for cp. \
Examples are in the file BC_Sep6_TETwithISO.\
\>", "Subsubsection",
 CellChangeTimes->{{3.91442727974992*^9, 3.914427295601121*^9}, {
  3.9144292710510087`*^9, 3.9144292859059343`*^9}, {3.9144295541299706`*^9, 
  3.914429626166131*^9}, {3.91754073119768*^9, 3.917540745307045*^9}, {
  3.926687029286502*^9, 
  3.9266870461047635`*^9}},ExpressionUUID->"58b73080-3e63-4e52-a43a-\
8c4e067dbd66"],

Cell["\<\
You can define custom variants by (no underline, no semicolon-equal).\
\>", "Subsubsection",
 CellChangeTimes->{{3.91458237511664*^9, 3.914582464032797*^9}, {
  3.9145825014424725`*^9, 3.9145825195713696`*^9}, {3.917540772338996*^9, 
  3.9175407760332956`*^9}},ExpressionUUID->"f968018b-67dc-43aa-953a-\
3192ab076f0e"]
}, Open  ]],

Cell["\<\
Just brute force. Good enough for getting contours and MaxForScaling.  And \
Mathematica has trouble with NMaximize.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9175406141633153`*^9, 3.917540676334525*^9}, {
   3.917550569330822*^9, 3.917550593061283*^9}, 
   3.927156631217106*^9},ExpressionUUID->"0a76e4fe-510b-4adf-9b7d-\
a86e5b66ff4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AlphaSubSigmaTable", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"AlphaOfU", "[", 
      RowBox[{"Tmat", ",", "RandomRotation", ",", "\[CapitalSigma]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", "5000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"MaxAlphaSubSigma", ",", "MinAlphaSubSigma"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxAlphaSubSigma", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MaxAlphaSubSigma", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"AlphaSubSigmaTable", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "]"}], "/", 
     "Degree"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinAlphaSubSigma", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MinAlphaSubSigma", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"AlphaSubSigmaTable", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "]"}], "/", 
     "Degree"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.920489694976289*^9, 3.9204897837391653`*^9}, {
   3.9204898599803905`*^9, 3.9204898611584597`*^9}, {3.9204899155729604`*^9, 
   3.9204899230044775`*^9}, {3.92048998498238*^9, 3.9204900097897415`*^9}, {
   3.9204900767862787`*^9, 3.920490077194627*^9}, {3.920490210213154*^9, 
   3.920490306758027*^9}, {3.9204904070174885`*^9, 3.920490408240369*^9}, {
   3.920509051148344*^9, 3.920509051947177*^9}, {3.9205092295481925`*^9, 
   3.9205092323314686`*^9}, {3.92599837978135*^9, 3.9259983855106764`*^9}, {
   3.9259984532482243`*^9, 3.925998466767654*^9}, {3.925999869605427*^9, 
   3.925999891069739*^9}, {3.9260021737055583`*^9, 3.926002184889187*^9}, 
   3.926002231468638*^9, {3.926002804397115*^9, 3.9260028055624466`*^9}, 
   3.926687374941324*^9, 3.9271566059651947`*^9},
 CellLabel->
  "In[3395]:=",ExpressionUUID->"6751929c-09d5-4b36-8754-df9a18c2f497"],

Cell[TextData[{
 "contours[Tmat,  \[CapitalSigma]] will give contours of ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Alpha]", "\[CapitalSigma]", 
    StyleBox["T",
     FontWeight->"Bold",
     FontSlant->"Plain"]], TraditionalForm]],ExpressionUUID->
  "254fa8a3-1cf2-4d03-babf-4377b9ce3b86"],
 " starting from zero, with only about 8 being actual ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Alpha]", "\[CapitalSigma]", 
    StyleBox["T",
     FontWeight->"Bold",
     FontSlant->"Plain"]], TraditionalForm]],ExpressionUUID->
  "cc156f64-0240-4877-b326-ce59a93d5e71"],
 " values.\nThe contour values are integral if DelAlpha[Tmat,  \
\[CapitalSigma]] > 4. Otherwise they are multiples of 0.1. In that case the \
legends need to be checked."
}], "Subsubsection",
 CellChangeTimes->{{3.926001886423913*^9, 3.926002046947153*^9}, {
   3.9260025103909426`*^9, 3.926002579558688*^9}, {3.9260026353226624`*^9, 
   3.9260027373215833`*^9}, {3.926002907926779*^9, 3.9260029773881917`*^9}, 
   3.9260030200247707`*^9, {3.9260030843218927`*^9, 3.926003119728031*^9}, {
   3.9260034375008836`*^9, 3.9260034494348364`*^9}, {3.9261057458844695`*^9, 
   3.9261057724230666`*^9}, 3.926105862144303*^9, {3.9261059001502266`*^9, 
   3.9261060560077796`*^9}, {3.926106176091177*^9, 
   3.926106178432305*^9}},ExpressionUUID->"b2e3b68f-fa71-4a40-87ef-\
d8244a29e4cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DelAlpha", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MaxAlphaSubSigma", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "-", 
    RowBox[{"MinAlphaSubSigma", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"delNfn", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DelAlpha", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ">", "5"}], ",", 
     RowBox[{"Ceiling", "[", 
      FractionBox[
       RowBox[{"DelAlpha", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "10"], "]"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                 ", 
     RowBox[{".1", 
      RowBox[{"Ceiling", "[", 
       FractionBox[
        RowBox[{"10", " ", 
         RowBox[{"DelAlpha", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], "10"], "]"}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contours", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"delNfn", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "+", 
      RowBox[{"MaxAlphaSubSigma", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], ",", 
     RowBox[{"delNfn", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.925999929854009*^9, 3.92599995346038*^9}, {
   3.926000000385727*^9, 3.9260000618043146`*^9}, 3.9260004726669283`*^9, {
   3.926000764824342*^9, 3.9260007653390408`*^9}, 3.926000968781293*^9, {
   3.9260010312107625`*^9, 3.9260010714294996`*^9}, 3.926001365265334*^9, {
   3.9260018731874065`*^9, 3.9260018742545214`*^9}, 3.926082990598606*^9, 
   3.9260863039821014`*^9, {3.9265239883987703`*^9, 3.926523997643049*^9}},
 CellLabel->
  "In[3399]:=",ExpressionUUID->"3b488055-80e2-4d7d-83d5-2669f39f702f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MaxForScaling", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"contours", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "delN"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"-", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MaxForScaling", "[", 
   RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{".5", 
    RowBox[{
     RowBox[{"contours", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "delN"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
   RowBox[{".5", 
    RowBox[{
     RowBox[{"contours", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "delN"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxForScaling", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MaxAlphaSubSigma", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinForScaling", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MinAlphaSubSigma", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"added", " ", "2024"}], "-", "11", "-", "15"}], " ", "*)"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9144270064573517`*^9, 3.9144270079522266`*^9}, {
   3.9144273495276127`*^9, 3.914427389838423*^9}, {3.9144274295586557`*^9, 
   3.914427437427271*^9}, {3.9144274828654747`*^9, 3.914427506386725*^9}, 
   3.914427715423767*^9, 3.914427793896926*^9, {3.9145551616306763`*^9, 
   3.914555198006445*^9}, {3.917540878790514*^9, 3.9175409182558947`*^9}, 
   3.917540990262286*^9, {3.917541031329056*^9, 3.917541054287865*^9}, {
   3.917541098691606*^9, 3.9175411473247414`*^9}, {3.925998462575386*^9, 
   3.9259984647917747`*^9}, {3.926465710526929*^9, 3.926465711581586*^9}, {
   3.940694981994523*^9, 3.940695025757474*^9}},
 CellLabel->
  "In[3402]:=",ExpressionUUID->"d48f2da6-0ebf-47bf-b1db-adda914a7300"],

Cell["Eventually delete the example?", "Subsubsection",
 CellChangeTimes->{{3.9264657654412527`*^9, 
  3.9264657999311314`*^9}},ExpressionUUID->"64acddda-d069-4cb6-8e35-\
17e887b10198"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TmatMar17", "=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"206.2", 
         RowBox[{"-", "67.4"}], "17.1", 
         RowBox[{"-", "15.9"}], "166.6", 
         RowBox[{"-", "19.5"}]},
        {
         RowBox[{"-", "67.4"}], "352.9", "32.2", "3.3", "61.6", 
         RowBox[{"-", "41.6"}]},
        {"17.1", "32.2", "343.8", "0.4", "73.6", 
         RowBox[{"-", "4.2"}]},
        {
         RowBox[{"-", "15.9"}], "3.3", "0.4", "270.0", "88.8", "13.3"},
        {"166.6", "61.6", "73.6", "88.8", "287.1", "30.7"},
        {
         RowBox[{"-", "19.5"}], 
         RowBox[{"-", "41.6"}], 
         RowBox[{"-", "4.2"}], "13.3", "30.7", "74.0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixNote", "[", "TmatMar17", "]"}], "=", 
  "\"\<T is Mar17\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixShortNote", "[", "TmatMar17", "]"}], "=", 
  "\"\<Mar17\>\""}]}], "Input",
 CellChangeTimes->{{3.906191526830221*^9, 3.9061915349235687`*^9}, {
  3.9061932859195557`*^9, 3.906193286363797*^9}, {3.906200762226416*^9, 
  3.9062007867504396`*^9}, {3.913740677939996*^9, 3.91374076606775*^9}, {
  3.9137408217113113`*^9, 3.913740883162224*^9}, {3.913741091022064*^9, 
  3.913741111995454*^9}, {3.913741784880947*^9, 3.913741786785943*^9}, {
  3.9137424417659903`*^9, 3.9137425521266747`*^9}, {3.9137426230516987`*^9, 
  3.913742623205106*^9}, {3.913853846605277*^9, 3.913853849588495*^9}, {
  3.913853893763404*^9, 3.9138538942025323`*^9}, {3.9398638751947083`*^9, 
  3.9398638762014847`*^9}},
 CellLabel->
  "In[3406]:=",ExpressionUUID->"c33f1479-6307-47af-91f9-c80eea177026"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tmat", "=", "TmatMar17"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "MONO"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixNote", "[", "Tmat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MaxAlphaSubSigma", "[", 
  RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MinAlphaSubSigma", "[", 
  RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "\[IndentingNewLine]", 
 FractionBox[
  RowBox[{"DelAlpha", "[", 
   RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], 
  "10"], "\[IndentingNewLine]", 
 RowBox[{"delNfn", "[", 
  RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"contours", "[", 
  RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9260007290068645`*^9, 3.926000750155314*^9}, {
  3.926000810310279*^9, 3.9260008372880435`*^9}, {3.926002271675506*^9, 
  3.9260022814836187`*^9}, {3.9260028889179173`*^9, 3.926002889833935*^9}, {
  3.926106216439558*^9, 3.9261062235666866`*^9}, {3.9261062828710375`*^9, 
  3.926106292261738*^9}, {3.9265240287302103`*^9, 3.926524032657817*^9}},
 CellLabel->
  "In[3409]:=",ExpressionUUID->"c0054373-eebb-456c-9179-4581e8c5dfdf"],

Cell["\<\
Looking for relation between dT[Tmat, MONO] and dT[Tmat, ISO].  Delete \
eventually .\
\>", "Subsubsection",
 CellChangeTimes->{{3.9271564787164288`*^9, 
  3.927156554730872*^9}},ExpressionUUID->"8acdc843-f73b-488f-99f5-\
e88fbd8ed9f9"],

Cell[BoxData[{
 RowBox[{"MatrixNote", "[", "Tmat", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<dT[Tmat,MONO] = \>\"", ",", 
    RowBox[{"dT", "[", 
     RowBox[{"Tmat", ",", "MONO"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<dT[Tmat,ISO] = \>\"", ",", 
    RowBox[{"dT", "[", 
     RowBox[{"Tmat", ",", "ISO"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dT", "[", 
   RowBox[{"Tmat", ",", "MONO"}], "]"}], "+", 
  RowBox[{"dT", "[", 
   RowBox[{"Tmat", ",", "ISO"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<NormMatrix[Tmat]Sin[MaxAlphaSubSigma[Tmat,MONO] = \>\"", ",", 
    RowBox[{
     RowBox[{"NormMatrix", "[", "Tmat", "]"}], 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"MaxAlphaSubSigma", "[", 
        RowBox[{"Tmat", ",", "MONO"}], "]"}], "Degree"}], "]"}]}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9266871188239837`*^9, 3.9266871586065435`*^9}, {
  3.9266872094126625`*^9, 3.9266872765048933`*^9}, {3.9266874429324627`*^9, 
  3.926687449133484*^9}, {3.92668792339677*^9, 3.9266879454072285`*^9}, {
  3.9266880187978497`*^9, 3.9266880277818584`*^9}, {3.92668806871739*^9, 
  3.926688083648162*^9}, {3.926688125471234*^9, 3.926688207808363*^9}, {
  3.9266882464008775`*^9, 3.926688259658059*^9}, {3.926688332747947*^9, 
  3.9266883435789022`*^9}, {3.9266883868795767`*^9, 3.9266883976475925`*^9}, {
  3.926689276133217*^9, 3.926689277627492*^9}, {3.9271563222155905`*^9, 
  3.92715632325387*^9}},
 CellLabel->
  "In[3417]:=",ExpressionUUID->"3283d0ca-4a02-4e40-952e-3fefbe9fa04c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"colorscheme", "[", "XISO", "]"}], "=", 
   "\"\<M10DefaultDensityGradient\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorscheme", "[", "MONO", "]"}], "=", "\"\<TemperatureMap\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorscheme", "[", "CUBE", "]"}], "=", "\"\<RustTones\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorscheme", "[", "ORTH", "]"}], "=", "\"\<AuroraColors\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorscheme", "[", "TRIG", "]"}], "=", "\"\<LakeColors\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorscheme", "[", "TET", "]"}], "=", 
   "\"\<FruitPunchColors\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.917541172969859*^9, 3.917541224335204*^9}, {
   3.917541303356315*^9, 3.9175413126415615`*^9}, {3.917543083406571*^9, 
   3.917543095078646*^9}, {3.9175437094742656`*^9, 3.9175437133819804`*^9}, {
   3.917544632279686*^9, 3.9175446851903887`*^9}, {3.9175450263201704`*^9, 
   3.917545031455763*^9}, {3.9175451818323193`*^9, 3.9175452311460767`*^9}, 
   3.9175453471615443`*^9, {3.9175504741392965`*^9, 3.917550477803217*^9}, {
   3.91755052855342*^9, 3.917550537825059*^9}},
 CellLabel->
  "In[3422]:=",ExpressionUUID->"2277bdac-b0f0-45e2-87e5-a9f95b54d188"],

Cell[CellGroupData[{

Cell["Section is \[Sigma] = \[Sigma]0.  Endpoints \[Theta]1, \[Theta]2", \
"Subsubsection",
 CellChangeTimes->{{3.9223050357196264`*^9, 3.922305056399501*^9}, {
  3.9223183576727715`*^9, 
  3.922318374366211*^9}},ExpressionUUID->"5feb9646-3db4-43e4-bd8e-\
c1f275f6f3ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cp\[CapitalSigma]prelimFix\[Sigma]", " ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cp\[CapitalSigma]prelimFix\[Sigma]", "[", 
    RowBox[{
    "Tmat_", ",", "\[CapitalSigma]_", ",", "colorscheme_", ",", "\[Sigma]0_", 
     ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "contours_", ",", "legends_", 
     ",", "MaxForScaling_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"cp\[CapitalSigma]prelimFix\[Sigma]", "[", 
     RowBox[{
     "Tmat", ",", "\[CapitalSigma]", ",", "colorscheme", ",", "\[Sigma]0", 
      ",", "\[Theta]1", ",", "\[Theta]2", ",", "contours", ",", "legends", 
      ",", "MaxForScaling", ",", "plotpoints", ",", "contourstyle"}], "]"}], 
    "=", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Alpha", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Sigma]0", ",", "\[Phi]"}], "}"}], ",", 
         "\[CapitalSigma]"}], "]"}], "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Theta]1", ",", "\[Theta]2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ContourStyle", "->", "contourstyle"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", "14", "}"}]}], ",", 
      RowBox[{"PlotPoints", "->", "plotpoints"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "colorscheme", "]"}], "[", 
          FractionBox["#", "MaxForScaling"], "]"}], "&"}], ")"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "legends"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9223049919875946`*^9, 3.922305021655452*^9}, {
  3.922305346438007*^9, 3.9223053557813387`*^9}, {3.9223679149649396`*^9, 
  3.9223679303222084`*^9}},
 CellLabel->
  "In[3428]:=",ExpressionUUID->"8aed9833-a679-4aae-bfea-df0b4b0e4013"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cp\[CapitalSigma]Fix\[Sigma]", "[", 
    RowBox[{
    "Tmat_", ",", "\[CapitalSigma]_", ",", "\[Sigma]0_", ",", "\[Theta]1_", 
     ",", "\[Theta]2_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
   RowBox[{"GraphicsComplex", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[Sigma]0", ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
      RowBox[{
       RowBox[{"cp\[CapitalSigma]prelimFix\[Sigma]", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", 
         RowBox[{"colorscheme", "[", "\[CapitalSigma]", "]"}], ",", 
         "\[Sigma]0", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
         RowBox[{"contours", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "None", ",", 
         RowBox[{"MaxForScaling", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "plotpoints", 
         ",", "contourstyle"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", "  ", 
     "\[IndentingNewLine]", 
     "                                                                        \
          ", 
     RowBox[{
      RowBox[{"cp\[CapitalSigma]prelimFix\[Sigma]", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", 
        RowBox[{"colorscheme", "[", "\[CapitalSigma]", "]"}], ",", 
        "\[Sigma]0", ",", "\[Theta]1", ",", "\[Theta]2", ",", 
        RowBox[{"contours", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "None", ",", 
        RowBox[{"MaxForScaling", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "plotpoints", 
        ",", "contourstyle"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.922305818247279*^9, 3.9223058451092787`*^9}, {
   3.9223058774708443`*^9, 3.922305903954779*^9}, {3.922305972341626*^9, 
   3.9223059742253523`*^9}, {3.922306018697675*^9, 3.922306075162651*^9}, {
   3.922306113974467*^9, 3.922306124922341*^9}, {3.9223064507500525`*^9, 
   3.922306451758875*^9}, {3.92230650344123*^9, 3.922306514359542*^9}, 
   3.9223065812258377`*^9, {3.922306617471446*^9, 3.922306624695479*^9}, {
   3.922306659482463*^9, 3.9223067011369486`*^9}, 3.922306741350649*^9, {
   3.922367968329707*^9, 3.9223679936905656`*^9}, 3.922368026015298*^9, {
   3.923354976506608*^9, 3.9233549776405506`*^9}, {3.927211301492034*^9, 
   3.9272113057194552`*^9}, {3.9272114570635724`*^9, 3.9272114714897976`*^9}},
 CellLabel->
  "In[3430]:=",ExpressionUUID->"99ce35eb-7be0-43ec-8de5-2a7038f9bfa7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Section is \[Theta] = \[Theta]0.  Endpoints \[Sigma]1, \[Sigma]2.", \
"Subsubsection",
 CellChangeTimes->{{3.9223050357196264`*^9, 3.922305056399501*^9}, {
  3.9223181914777665`*^9, 3.9223182094815435`*^9}, {3.9223183326958323`*^9, 
  3.9223183466627007`*^9}, {3.939825165869538*^9, 
  3.9398251712983427`*^9}},ExpressionUUID->"ef7f4560-e43e-484a-9f1c-\
7179de5972c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cp\[CapitalSigma]prelimFix\[Theta]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cp\[CapitalSigma]prelimFix\[Theta]", "[", 
    RowBox[{
    "Tmat_", ",", "\[CapitalSigma]_", ",", "colorscheme_", ",", "\[Theta]0_", 
     ",", "\[Sigma]1_", ",", "\[Sigma]2_", ",", "contours_", ",", "legends_", 
     ",", "MaxForScaling_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"cp\[CapitalSigma]prelimFix\[Theta]", "[", 
     RowBox[{
     "Tmat", ",", "\[CapitalSigma]", ",", "colorscheme", ",", "\[Theta]0", 
      ",", "\[Sigma]1", ",", "\[Sigma]2", ",", "contours", ",", "legends", 
      ",", "MaxForScaling", ",", "plotpoints", ",", "contourstyle"}], "]"}], 
    "=", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Alpha", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]0", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
         "\[CapitalSigma]"}], "]"}], "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "\[Sigma]1", ",", "\[Sigma]2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ContourStyle", "->", "contourstyle"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", "14", "}"}]}], ",", 
      RowBox[{"PlotPoints", "->", "plotpoints"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "colorscheme", "]"}], "[", 
          FractionBox["#", "MaxForScaling"], "]"}], "&"}], ")"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "legends"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9223049919875946`*^9, 3.922305021655452*^9}, {
   3.922305346438007*^9, 3.9223053557813387`*^9}, 3.9223182191030703`*^9, {
   3.9223182521234426`*^9, 3.922318322106037*^9}, {3.922318389127623*^9, 
   3.922318507323979*^9}},
 CellLabel->
  "In[3431]:=",ExpressionUUID->"3b0f179a-1fd5-42de-86ae-cdfbe7e1bf02"],

Cell[BoxData[
 RowBox[{"Clear", "[", "cp\[CapitalSigma]Fix\[Theta]", "]"}]], "Input",
 CellChangeTimes->{{3.9233548889411106`*^9, 3.9233548919452085`*^9}},
 CellLabel->
  "In[3433]:=",ExpressionUUID->"9b6cf47a-01d2-4770-9538-a2662da3a298"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cp\[CapitalSigma]Fix\[Theta]", "[", 
    RowBox[{
    "Tmat_", ",", "\[CapitalSigma]_", ",", "\[Theta]0_", ",", "\[Sigma]1_", 
     ",", "\[Sigma]2_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
   RowBox[{"GraphicsComplex", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]0", ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
      RowBox[{
       RowBox[{"cp\[CapitalSigma]prelimFix\[Theta]", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", 
         RowBox[{"colorscheme", "[", "\[CapitalSigma]", "]"}], ",", 
         "\[Theta]0", ",", "\[Sigma]1", ",", "\[Sigma]2", ",", 
         RowBox[{"contours", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "None", ",", 
         RowBox[{"MaxForScaling", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "plotpoints", 
         ",", "contourstyle"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", "  ", 
     "\[IndentingNewLine]", 
     "                                                                        \
         ", 
     RowBox[{
      RowBox[{"cp\[CapitalSigma]prelimFix\[Theta]", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", 
        RowBox[{"colorscheme", "[", "\[CapitalSigma]", "]"}], ",", 
        "\[Theta]0", ",", "\[Sigma]1", ",", "\[Sigma]2", ",", 
        RowBox[{"contours", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "None", ",", 
        RowBox[{"MaxForScaling", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "plotpoints", 
        ",", "contourstyle"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.922305818247279*^9, 3.9223058451092787`*^9}, {
   3.9223058774708443`*^9, 3.922305903954779*^9}, {3.922305972341626*^9, 
   3.9223059742253523`*^9}, {3.922306018697675*^9, 3.922306075162651*^9}, {
   3.922306113974467*^9, 3.922306124922341*^9}, {3.9223064507500525`*^9, 
   3.922306451758875*^9}, {3.92230650344123*^9, 3.922306514359542*^9}, 
   3.9223065812258377`*^9, {3.922306617471446*^9, 3.922306624695479*^9}, {
   3.922306659482463*^9, 3.9223067011369486`*^9}, 3.922306741350649*^9, 
   3.922318529657093*^9, {3.9223186032265997`*^9, 3.9223186383001328`*^9}, {
   3.9223186850849667`*^9, 3.9223186867942123`*^9}, {3.9223187315657873`*^9, 
   3.922318736333749*^9}, {3.9223191216936135`*^9, 3.9223191396263905`*^9}, {
   3.9233549870183477`*^9, 3.9233549880387554`*^9}, {3.927211562200137*^9, 
   3.927211580782852*^9}},
 CellLabel->
  "In[3434]:=",ExpressionUUID->"a33a1aee-f1ce-442f-b434-1319f0c04c73"]
}, Open  ]],

Cell["Many inputs added January 2024", "Subsubsection",
 CellChangeTimes->{{3.9143599800700955`*^9, 3.9143600032415895`*^9}, 
   3.9143625070268135`*^9},ExpressionUUID->"9d275f85-90e6-458d-8026-\
4761295f98e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LegendsWithDefaultColors", "[", 
   RowBox[{
   "contours_", ",", "heading_", ",", "hw_", ",", "fontsize_", ",", 
    "increment_", ",", "offset_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"WantRound", "==", "\"\<WantRound\>\""}], ",", 
        "\[IndentingNewLine]", 
        StyleBox[
         RowBox[{
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"SequenceForm", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"SuperscriptBox", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"PaddedForm", "[", 
                    RowBox[{
                    RowBox[{"contours", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                    "fontsize"}], "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<\[SmallCircle]\>\"", ",", 
                    RowBox[{"1", "+", "fontsize"}]}], "]"}]}], "]"}], "//", 
                "DisplayForm"}], ",", "\"\< \>\""}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"offset", ",", 
               RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"2", ",", 
            RowBox[{
             RowBox[{"Length", "[", "contours", "]"}], "-", "1"}], ",", 
            "increment"}], "]"}]}],
         FontColor->RGBColor[1, 0, 0]], 
        StyleBox[",",
         FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"SequenceForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"SuperscriptBox", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{"contours", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", 
                   "                          ", "fontsize"}], "]"}], ",", 
                 "  ", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<\[SmallCircle]\>\"", ",", 
                   RowBox[{"1", "+", "fontsize"}]}], "]"}]}], "]"}], "//", 
               "DisplayForm"}], ",", "\"\< \>\""}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"offset", ",", 
              RowBox[{"#", " ", "hw"}]}], "}"}]}], "]"}], "&"}], "/@", 
         "               ", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             StyleBox["contours",
              FontWeight->"Plain"], "]"}], "-", "1"}], ",", "increment"}], 
          "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"heading", ",", 
        RowBox[{"{", 
         RowBox[{".75", ",", 
          RowBox[{"hw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              StyleBox["contours",
               FontWeight->"Plain"], "]"}], "+", ".75"}], ")"}]}]}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".0005", "]"}], ",", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", 
             RowBox[{"1.15", "hw", 
              RowBox[{"(", 
               RowBox[{"Length", "[", 
                StyleBox["contours",
                 FontWeight->"Plain"], "]"}], ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3.5", ",", 
             RowBox[{"1.15", "hw", 
              RowBox[{"(", 
               RowBox[{"Length", "[", 
                StyleBox["contours",
                 FontWeight->"Plain"], "]"}], ")"}]}]}], "}"}]}], "}"}]}]}], 
       "}"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"fake", " ", "points"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Thickness", "[", ".003", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "ColorData", "[", "\"\<M10DefaultDensityGradient\>\"", "]"}], 
             "[", 
             FractionBox[
              RowBox[{
               RowBox[{".5", 
                RowBox[{"contours", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "+", 
               RowBox[{".5", 
                RowBox[{"contours", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "-", 
               RowBox[{"contours", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], 
              RowBox[{
               RowBox[{".5", 
                RowBox[{"contours", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
               RowBox[{".5", 
                RowBox[{"contours", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{".5", 
                  RowBox[{"contours", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                 RowBox[{".5", 
                  RowBox[{"contours", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}]}], "}"}], 
             "]"}]}], "}"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{
         StyleBox["1",
          FontColor->RGBColor[1, 0, 0]], ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8970650805922356`*^9, 3.8970650974931583`*^9}, {
   3.8970653527332544`*^9, 3.897065356942707*^9}, {3.897065496106089*^9, 
   3.897065528438134*^9}, {3.8970655761824694`*^9, 3.8970655844643636`*^9}, 
   3.897065741206607*^9, {3.8970664938602448`*^9, 3.8970665207146363`*^9}, {
   3.8970665887296133`*^9, 3.897066629189027*^9}, {3.8970667287203536`*^9, 
   3.8970667614330463`*^9}, {3.897067199185506*^9, 3.89706723727534*^9}, 
   3.8970672831868167`*^9, {3.8970673883400764`*^9, 3.897067428704113*^9}, 
   3.8970675207947364`*^9, {3.89706770104578*^9, 3.8970677050247726`*^9}, {
   3.8970677605783677`*^9, 3.8970677628095813`*^9}, {3.897067898179243*^9, 
   3.897067901620552*^9}, 3.8970759661329107`*^9, 3.8970760897288685`*^9, {
   3.8970762425640426`*^9, 3.8970762433950977`*^9}, {3.8975083284246607`*^9, 
   3.8975083654295435`*^9}, 3.89750841203564*^9, 3.897508442676783*^9, {
   3.8975084754090676`*^9, 3.8975084891417613`*^9}, {3.897508535332142*^9, 
   3.8975087429565883`*^9}, {3.8975087740699997`*^9, 3.8975087752313137`*^9}, 
   3.8975099707321353`*^9, {3.8975127744558115`*^9, 3.8975127799951615`*^9}, {
   3.897513259564858*^9, 3.8975132665830894`*^9}, {3.899655498023056*^9, 
   3.899655498501145*^9}, {3.8996555855390434`*^9, 3.899655591237478*^9}, {
   3.899655650517541*^9, 3.8996557103089933`*^9}, {3.89965587206988*^9, 
   3.8996558889344997`*^9}, {3.899655933750066*^9, 3.899655943845474*^9}, {
   3.899655976101471*^9, 3.899655978916907*^9}, {3.8996561930133677`*^9, 
   3.899656202806426*^9}, 3.8996565988220673`*^9, {3.899656685028875*^9, 
   3.899656685156464*^9}, 3.899732275802255*^9, 3.899732316619712*^9, {
   3.8997325966973934`*^9, 3.89973265117915*^9}, {3.8997327357877235`*^9, 
   3.8997327385716953`*^9}, {3.899732791243602*^9, 3.8997327925238876`*^9}, {
   3.8997328431165123`*^9, 3.8997328639474506`*^9}, {3.899732904604663*^9, 
   3.8997329243480535`*^9}, {3.899732975836596*^9, 3.8997329809864883`*^9}, {
   3.899733223051328*^9, 3.8997332251147103`*^9}, {3.899733415594942*^9, 
   3.8997334272922406`*^9}, {3.899733937962591*^9, 3.8997339387147245`*^9}, {
   3.899733973178096*^9, 3.8997340608091936`*^9}, {3.9032023956870794`*^9, 
   3.9032023965437136`*^9}, {3.9046729695777407`*^9, 
   3.9046729952845526`*^9}, {3.9046730967923517`*^9, 3.904673105846819*^9}, 
   3.9084038384643908`*^9, {3.908403870474476*^9, 3.908403900002651*^9}, {
   3.9094413085810423`*^9, 3.9094413232530746`*^9}, {3.9094415605007315`*^9, 
   3.90944159735116*^9}, {3.912379888992262*^9, 3.9123799167225*^9}, {
   3.9123803572678413`*^9, 3.912380362081005*^9}, 3.9142667086236706`*^9, 
   3.9142667510334625`*^9, 3.914266923237097*^9, 3.9142669543854275`*^9, 
   3.9142672167946577`*^9, {3.914267302122415*^9, 3.9142673116516557`*^9}, 
   3.914267363080859*^9, {3.9142674121208897`*^9, 3.914267413834412*^9}, 
   3.9142674849753156`*^9, 3.914274563853245*^9, 3.9142746677974353`*^9, 
   3.9142748025517235`*^9, 3.9143487726365013`*^9, {3.9143488231155443`*^9, 
   3.914348824405233*^9}, {3.9143490225561996`*^9, 3.9143490514536247`*^9}, {
   3.9143602029487286`*^9, 3.914360203769593*^9}, {3.91436027435888*^9, 
   3.914360319772889*^9}, 3.9143607389445753`*^9, {3.9143607986350393`*^9, 
   3.9143608130741444`*^9}, {3.9143608762962008`*^9, 3.914360877741667*^9}, {
   3.9143609359801693`*^9, 3.9143609382256985`*^9}, {3.914363188269023*^9, 
   3.9143632678214655`*^9}, {3.9143633009478846`*^9, 3.914363336856144*^9}, {
   3.914426596811731*^9, 3.9144266149765663`*^9}, 3.9146738936166334`*^9, {
   3.9148632294549184`*^9, 3.9148632298470497`*^9}, {3.9148652931583586`*^9, 
   3.9148652936600647`*^9}, {3.914866219862346*^9, 3.9148662201602182`*^9}},
 CellLabel->
  "In[3435]:=",ExpressionUUID->"0709f7ce-364b-40d6-98a2-be79151017f6"],

Cell[BoxData[
 RowBox[{"WantRound", "=", "\"\<NoWantRound\>\""}]], "Input",
 CellChangeTimes->{{3.8997330405914*^9, 3.899733077817568*^9}, 
   3.899733161032676*^9, 3.899733264409441*^9, {3.899733302728598*^9, 
   3.899733303832593*^9}, {3.8997334453066945`*^9, 3.899733446504133*^9}, {
   3.910449550653633*^9, 3.910449571661747*^9}, {3.9143623497823143`*^9, 
   3.914362352797014*^9}},
 CellLabel->
  "In[3436]:=",ExpressionUUID->"873ff0df-19f6-4985-ab90-d17d5944517d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imagesize", "=", "100"}], ";", 
  RowBox[{"hw", "=", "1.5"}], ";", 
  RowBox[{"fontsize", "=", "15"}], ";", 
  RowBox[{"WantRound", "=", "\"\<NoWantRound\>\""}], ";", 
  RowBox[{"increment", "=", "1"}], ";", 
  RowBox[{"offset", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"legends", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "24", ",", "4"}], "]"}], ",", "22", ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "20"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<MONO\>\"", ",", "11"}], "]"}]}], "]"}], "//", 
      "DisplayForm"}], ",", "hw", ",", 
     RowBox[{"fontsize", " ", 
      FractionBox["imagesize", "100"]}], ",", "increment", ",", "offset"}], 
    "]"}], ",", 
   RowBox[{"ImageSize", "->", "imagesize"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.897509443903418*^9, 3.897509452335904*^9}, 
   3.8975096166535206`*^9, 3.8975133074408684`*^9, {3.8975815103839397`*^9, 
   3.8975815395986648`*^9}, {3.8975816444157743`*^9, 
   3.8975816798233814`*^9}, {3.897581862926977*^9, 3.8975819475829816`*^9}, {
   3.898866218309831*^9, 3.8988662778051586`*^9}, {3.898866337817874*^9, 
   3.898866357125506*^9}, {3.8997331118339767`*^9, 3.8997331295293956`*^9}, 
   3.89973350426546*^9, {3.9084684111222806`*^9, 3.908468451873836*^9}, {
   3.9084685028586493`*^9, 3.9084685050395365`*^9}, {3.908468621387975*^9, 
   3.9084686218904266`*^9}, {3.90846865665687*^9, 3.9084686628569818`*^9}, {
   3.908468865488393*^9, 3.9084688991677527`*^9}, {3.9084689971109667`*^9, 
   3.908469015241024*^9}, {3.908469170699434*^9, 3.908469175986441*^9}, {
   3.908469254057007*^9, 3.908469277327214*^9}, {3.9094293649852004`*^9, 
   3.9094293797299232`*^9}, {3.909429864153368*^9, 3.9094298963442745`*^9}, {
   3.9094412254771366`*^9, 3.9094412278290076`*^9}, {3.909441483861921*^9, 
   3.9094415111247306`*^9}, 3.9094416932886243`*^9, {3.9094527262683444`*^9, 
   3.9094527574226885`*^9}, {3.914706690768588*^9, 3.914706715794216*^9}, {
   3.914706901744236*^9, 3.9147069036886864`*^9}, {3.914707165079977*^9, 
   3.9147071922036924`*^9}, {3.9147072660593452`*^9, 
   3.9147072750864515`*^9}, {3.914707320968764*^9, 3.914707368750136*^9}, {
   3.9147074043964605`*^9, 3.91470742257533*^9}, {3.9147074601164527`*^9, 
   3.9147074802301707`*^9}, {3.914709744152482*^9, 3.9147097536285424`*^9}, 
   3.914709951011038*^9, 3.9147104735677967`*^9},
 CellLabel->
  "In[3437]:=",ExpressionUUID->"c5cb2e20-6e07-4f7e-8e71-7a43d85d4785"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hw", "=", "1.5"}], ";", 
  RowBox[{"fontsize", "=", "15"}], ";", 
  RowBox[{"WantRound", "=", "\"\<NoNoWantRound\>\""}], ";", 
  RowBox[{"increment", "=", "1"}], ";", 
  RowBox[{"offset", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"LegendsWithDefaultColors", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"12", ",", "20", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", "20"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<XISO\>\"", ",", "11"}], "]"}]}], "]"}], "//", 
      "DisplayForm"}], ",", "hw", ",", "fontsize", ",", "increment", ",", 
     "offset"}], "]"}], ",", 
   RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.897065378804065*^9, 3.8970653818136663`*^9}, {
   3.8970654624854383`*^9, 3.8970654796377125`*^9}, 3.897066103814332*^9, 
   3.8970661660602*^9, {3.8970667715231476`*^9, 3.897066771946636*^9}, {
   3.897066806750881*^9, 3.897066819303035*^9}, {3.8970679563373704`*^9, 
   3.897067956822983*^9}, {3.8975087545788345`*^9, 3.897508755429982*^9}, {
   3.8975087979733477`*^9, 3.897508799872948*^9}, 3.8975098797375264`*^9, {
   3.897509913728053*^9, 3.897509915688051*^9}, {3.897513322338952*^9, 
   3.897513328678775*^9}, {3.8988661119513626`*^9, 3.898866122514305*^9}, {
   3.899732371626047*^9, 3.8997323979127307`*^9}, {3.8997332353373146`*^9, 
   3.8997332365858965`*^9}, {3.9094292705864544`*^9, 3.909429271732711*^9}, {
   3.909429924183595*^9, 3.9094299313570786`*^9}, {3.914362275099923*^9, 
   3.914362282665583*^9}, 3.9143623402866955`*^9},
 CellLabel->
  "In[3439]:=",ExpressionUUID->"527e2f26-7f95-47d1-a38b-8251ed5b7f16"],

Cell[BoxData["I"], "Input",
 CellChangeTimes->{3.9178244256727934`*^9},
 CellLabel->
  "In[3441]:=",ExpressionUUID->"598e65f2-b7b8-4dca-9597-2db52a7c6e13"],

Cell[CellGroupData[{

Cell["\<\
Crystallographic BarForm text for n-fold rotations. 
Not meant for arbitrary rotations or even n-fold rotations with arbitrary \
rotation axes.\
\>", "Subsubsection",
 CellChangeTimes->{{3.890060951285735*^9, 3.89006096360441*^9}, {
   3.8900646632339835`*^9, 3.890064697109466*^9}, {3.890064747735567*^9, 
   3.8900647588914742`*^9}, {3.8901807528034043`*^9, 3.89018078437807*^9}, 
   3.904312048704237*^9, 3.9143757011000705`*^9, 
   3.914621359123474*^9},ExpressionUUID->"dded4cf9-74a0-4151-a428-\
991aaf612d82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FirstNonZero", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_", ",", "p_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"m", "\[Equal]", "0"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "p", ",", "n"}], "]"}], ",", 
     "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PreAxis", "[", "U_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Eigenvectors", "[", "U", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"U", ".", "#"}], "==", "#"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotAxisForNfoldU", "[", "U_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Vtest", "=", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"PreAxis", "[", "U", "]"}], ",", "RandomDirection"}], "]"}]}],
      ";", "    ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"needs", " ", "modification", " ", "for", " ", "identity"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{"Vtest", ",", 
           RowBox[{"U", ".", "Vtest"}], ",", 
           RowBox[{"PreAxis", "[", "U", "]"}]}], "}"}], "]"}], 
        "\[GreaterEqual]", 
        RowBox[{"-", ".000001"}]}], ",", 
       RowBox[{"PreAxisNew", "=", 
        RowBox[{"PreAxis", "[", "U", "]"}]}], ",", 
       RowBox[{"PreAxisNew", "=", 
        RowBox[{"-", 
         RowBox[{"PreAxis", "[", "U", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RotationAngle", "[", "U", "]"}], "\[Equal]", "\[Pi]"}], "&&", 
        RowBox[{
         RowBox[{"FirstNonZero", "[", "PreAxisNew", "]"}], "<", "0"}]}], ",", 
       RowBox[{"-", "PreAxisNew"}], ",", "PreAxisNew"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarForm", "[", "n_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[GreaterEqual]", "0"}], ",", "n", ",", 
     OverscriptBox[
      RowBox[{"-", "n"}], "_"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarFormText", "[", "U_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"U", "\[Equal]", "id"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<I\>\"", ",", "Italic"}], "]"}], ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"SequenceForm", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BarForm", "[", 
           RowBox[{
            RowBox[{"RotAxisForNfoldU", "[", "U", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BarForm", "[", 
           RowBox[{
            RowBox[{"RotAxisForNfoldU", "[", "U", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BarForm", "[", 
           RowBox[{
            RowBox[{"RotAxisForNfoldU", "[", "U", "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"RotationAngle", "[", "U", "]"}], "]"}]}]}]}], "]"}], "//",
       "DisplayForm"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890060822177127*^9, 3.890060905734544*^9}, {
   3.890061070131735*^9, 3.890061124025692*^9}, {3.890061809476994*^9, 
   3.8900618098972015`*^9}, {3.89006189725653*^9, 3.8900618988869114`*^9}, {
   3.890062377448352*^9, 3.8900623928729734`*^9}, {3.8900645294556913`*^9, 
   3.8900645733812656`*^9}, {3.8900646137318573`*^9, 3.890064647099513*^9}, {
   3.8900647653891306`*^9, 3.8900647946275387`*^9}, {3.8900649132176647`*^9, 
   3.8900649634053707`*^9}, {3.890065016192517*^9, 3.890065021329948*^9}, {
   3.8901809822066135`*^9, 3.8901810141101522`*^9}, {3.8901811020425763`*^9, 
   3.8901811308223205`*^9}, {3.8901817573939457`*^9, 3.890181773912665*^9}, {
   3.8901874220427327`*^9, 3.8901874618596087`*^9}, {3.890502721256652*^9, 
   3.8905027311849575`*^9}, {3.890583970669634*^9, 3.890584143390314*^9}, {
   3.890584209194031*^9, 3.890584230078514*^9}, 3.890584555810692*^9, {
   3.89058509135993*^9, 3.8905851153370686`*^9}, {3.8905852603649883`*^9, 
   3.8905852613370314`*^9}, {3.890593340371934*^9, 3.890593350318657*^9}, {
   3.8990742017608433`*^9, 3.899074218226144*^9}, {3.8990742666023054`*^9, 
   3.8990742672144194`*^9}, {3.917824350357693*^9, 3.9178243946267176`*^9}, {
   3.9178244347889843`*^9, 3.9178244483572235`*^9}},
 CellLabel->
  "In[3442]:=",ExpressionUUID->"df3b93d8-4ee8-4a19-ad72-02127b791f58"]
}, Open  ]],

Cell["Scratchwork for ORTH and CUBE", "Subsubsection",
 CellChangeTimes->{{3.918346990704059*^9, 3.9183469985945067`*^9}, {
  3.9183471931038933`*^9, 3.9183471946974525`*^9}, {3.918347230398549*^9, 
  3.9183472411161013`*^9}, {3.918498077525343*^9, 
  3.918498083258396*^9}},ExpressionUUID->"1689f830-70d3-4959-9c07-\
02e7f3b989de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "jjofjj", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "jj_", "]"}], ":=", "jj"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "24", "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "1", "]"}], ":=", "24"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "9", "]"}], ":=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "5", "]"}], ":=", "9"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "16", "]"}], ":=", "6"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jjofjj", "[", "6", "]"}], ":=", "16"}], ";"}]}], "Input",
 CellChangeTimes->{{3.918402908649937*^9, 3.918402949270752*^9}, {
  3.918403025424448*^9, 3.918403093534236*^9}, {3.918403750820119*^9, 
  3.918403775457688*^9}, {3.9184038087532263`*^9, 3.9184040097279477`*^9}, {
  3.918404072830719*^9, 3.918404155231205*^9}},
 CellLabel->
  "In[3447]:=",ExpressionUUID->"26827675-f61a-47ff-b1ef-081ba35c5cc7"],

Cell[BoxData[{
 RowBox[{"Map", "[", 
  RowBox[{"MatrixForm", ",", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GyroidGp", "[", 
         RowBox[{"[", 
          RowBox[{"jjofjj", "[", "jj", "]"}], "]"}], "]"}], ".", 
        RowBox[{"ZRot", "[", 
         RowBox[{"kk", " ", 
          RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", "1"}], "]"}],
    ",", 
   RowBox[{"{", "1", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", 
  RowBox[{"Union", "[", "%", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"GyroidGp", "[", 
      RowBox[{"[", 
       RowBox[{"jjofjj", "[", "jj", "]"}], "]"}], "]"}], ".", 
     RowBox[{"ZRot", "[", 
      RowBox[{"kk", " ", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"jj", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kk", ",", "0", ",", "3"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"BarFormText", "[", 
     RowBox[{
      RowBox[{"GyroidGp", "[", 
       RowBox[{"[", 
        RowBox[{"jjofjj", "[", "jj", "]"}], "]"}], "]"}], ".", 
      RowBox[{"ZRot", "[", 
       RowBox[{"kk", " ", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"jj", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kk", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9184025714805937`*^9, 3.9184026871410103`*^9}, {
   3.9184027416512146`*^9, 3.918402759274745*^9}, {3.918402953176508*^9, 
   3.918402990438237*^9}, 3.9184031581218925`*^9, {3.9184031920713215`*^9, 
   3.918403204695026*^9}, {3.9184032360354767`*^9, 3.918403306091318*^9}, {
   3.9184034096770134`*^9, 3.9184035399027953`*^9}, {3.9184035942409563`*^9, 
   3.918403606395831*^9}, {3.918403664562026*^9, 3.918403679169838*^9}, {
   3.9184037119952736`*^9, 3.918403733306014*^9}, 3.9184040479270554`*^9, {
   3.918404207464896*^9, 3.9184042084807186`*^9}, {3.918404239696575*^9, 
   3.918404243369106*^9}, {3.9184042773366356`*^9, 3.918404305998801*^9}, {
   3.9184043976929708`*^9, 3.9184044071803885`*^9}},
 CellLabel->
  "In[3455]:=",ExpressionUUID->"c6797a5d-bcdd-4a02-aefc-b0e5d2e6efde"],

Cell["TextAlt", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
   3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
   3.918424345572372*^9}, {3.9184244469103403`*^9, 3.9184244474382544`*^9}, 
   3.91849761588585*^9, {3.919471703959755*^9, 
   3.919471707111707*^9}},ExpressionUUID->"14708f31-a477-4441-98c0-\
c510fa5be1e3"],

Cell[BoxData[
 RowBox[{"RotationAngle", "[", 
  RowBox[{"ZRot", "[", 
   RowBox[{"5", 
    RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9194602629679246`*^9, 3.9194602773991055`*^9}},
 CellLabel->
  "In[3459]:=",ExpressionUUID->"f78efe6b-5aea-4530-a264-2756e8267381"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RotationAngleBig", "[", "V_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"V", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"V", ".", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ">=", "0"}], ",", 
       RowBox[{"RotationAngle", "[", "V", "]"}], ",", 
       RowBox[{
        RowBox[{"2", "\[Pi]"}], "-", 
        RowBox[{"RotationAngle", "[", "V", "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.919460359048769*^9, 3.9194604193983107`*^9}, {
  3.9194604760054684`*^9, 3.9194604940694227`*^9}, {3.9194605302006617`*^9, 
  3.919460556502369*^9}, {3.919460613446093*^9, 3.919460668790144*^9}},
 CellLabel->
  "In[3460]:=",ExpressionUUID->"766e4cce-afa7-484d-9749-0c09a0b919a1"],

Cell[BoxData[
 RowBox[{"RotationAngleBig", "[", 
  RowBox[{"ZRot", "[", 
   RowBox[{"5", 
    RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9194606841188607`*^9, 3.9194607244070654`*^9}},
 CellLabel->
  "In[3461]:=",ExpressionUUID->"89a19d4d-42f9-4dde-a0ed-afd9ebd70738"],

Cell["\<\
XRot[\[Pi]] happens second, on the left. ZRot happens first, on the right\
\>", "Subsubsection",
 CellChangeTimes->{{3.922289117042592*^9, 3.922289139359806*^9}, {
  3.9222908632604494`*^9, 
  3.922290873810796*^9}},ExpressionUUID->"30d506e4-f45f-4d9a-ae2d-\
97b686381d9a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "[", "TextAlt", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TextAlt", "[", "V_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"V", ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"SubscriptBox", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Z\>\"", ",", "Italic"}], "]"}], ",", 
         RowBox[{"SequenceForm", "[", 
          RowBox[{
           RowBox[{"Numerator", "[", 
            RowBox[{"RotationAngleBig", "[", "V", "]"}], "]"}], ",", 
           "\"\</\>\"", ",", 
           RowBox[{"Denominator", "[", 
            RowBox[{"RotationAngleBig", "[", "V", "]"}], "]"}]}], "]"}]}], 
        "]"}], "//", "DisplayForm"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"V", ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", 
        RowBox[{"SequenceForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SubscriptBox", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<X\>\"", ",", "Italic"}], "]"}], ",", "\[Pi]"}], 
            "]"}], "//", "DisplayForm"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\< \>\"", ",", "5"}], "]"}], ",", 
          RowBox[{"TextAlt", "[", 
           RowBox[{
            RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", "V"}], "]"}]}], "]"}]}],
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TextAlt", "[", "id", "]"}], "=", "\"\<\>\""}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.919460896054637*^9, 3.9194609905655727`*^9}, {
   3.919461044919036*^9, 3.919461058310013*^9}, {3.9194611135574045`*^9, 
   3.919461117461712*^9}, {3.9194611500385647`*^9, 3.9194611841032925`*^9}, {
   3.9194612226952095`*^9, 3.9194612704711885`*^9}, {3.9194613179092646`*^9, 
   3.9194614285038033`*^9}, {3.9194615623599443`*^9, 3.91946169859968*^9}, {
   3.9194617489201927`*^9, 3.919461780328373*^9}, {3.919462118157358*^9, 
   3.91946212590007*^9}, {3.9194621635721207`*^9, 3.9194622987473464`*^9}, {
   3.919462617579331*^9, 3.9194626526554923`*^9}, {3.9194627084359784`*^9, 
   3.9194627092552104`*^9}, {3.9194722491881742`*^9, 
   3.9194723342591124`*^9}, {3.9194723916997366`*^9, 3.9194723983723297`*^9}, 
   3.9222912433391776`*^9, {3.922291673652325*^9, 3.9222916854406085`*^9}, {
   3.9222920084913235`*^9, 3.9222920126784124`*^9}},
 CellLabel->
  "In[3462]:=",ExpressionUUID->"20e8f885-a5cd-46ad-9a01-bc8aa61a1c21"],

Cell["\<\
XRot[\[Pi]] happens first, on the right.  ZRot happens second, on the left\
\>", "Subsubsection",
 CellChangeTimes->{{3.922289117042592*^9, 3.9222891638926964`*^9}, {
  3.922290831539044*^9, 
  3.9222908532395706`*^9}},ExpressionUUID->"7d8feada-49ea-4192-acbb-\
104681fd24eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "TextAlt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextAlt", "[", "V_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"V", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Z\>\"", ",", "Italic"}], "]"}], ",", 
        RowBox[{"SequenceForm", "[", 
         RowBox[{
          RowBox[{"Numerator", "[", 
           RowBox[{"RotationAngleBig", "[", "V", "]"}], "]"}], ",", 
          "\"\</\>\"", ",", 
          RowBox[{"Denominator", "[", 
           RowBox[{"RotationAngleBig", "[", "V", "]"}], "]"}]}], "]"}]}], 
       "]"}], "//", "DisplayForm"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "==", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{"SequenceForm", "[", 
        RowBox[{
         RowBox[{"TextAlt", "[", 
          RowBox[{"V", ".", 
           RowBox[{"XRot", "[", "\[Pi]", "]"}]}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\< \>\"", ",", "5"}], "]"}], ",", 
         RowBox[{
          RowBox[{"SubscriptBox", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<X\>\"", ",", "Italic"}], "]"}], ",", "\[Pi]"}], 
           "]"}], "//", "DisplayForm"}]}], " ", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextAlt", "[", "id", "]"}], "=", "\"\<\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.919460896054637*^9, 3.9194609905655727`*^9}, {
   3.919461044919036*^9, 3.919461058310013*^9}, {3.9194611135574045`*^9, 
   3.919461117461712*^9}, {3.9194611500385647`*^9, 3.9194611841032925`*^9}, {
   3.9194612226952095`*^9, 3.9194612704711885`*^9}, {3.9194613179092646`*^9, 
   3.9194614285038033`*^9}, {3.9194615623599443`*^9, 3.91946169859968*^9}, {
   3.9194617489201927`*^9, 3.919461780328373*^9}, {3.919462118157358*^9, 
   3.91946212590007*^9}, {3.9194621635721207`*^9, 3.9194622987473464`*^9}, {
   3.919462617579331*^9, 3.9194626526554923`*^9}, {3.9194627084359784`*^9, 
   3.9194627092552104`*^9}, {3.9194722491881742`*^9, 
   3.9194723342591124`*^9}, {3.9194723916997366`*^9, 
   3.9194723983723297`*^9}, {3.9222892174133835`*^9, 3.9222892418025036`*^9}, 
   3.9222912523464203`*^9, 3.9222915243605967`*^9, {3.922291589736843*^9, 
   3.922291601313882*^9}},
 CellLabel->
  "In[3463]:=",ExpressionUUID->"6b61f797-9261-49c1-8f34-41f2b315cb77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZRot", "[", 
   RowBox[{"\[Pi]", "/", "3"}], "]"}], ".", 
  RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9222913930165606`*^9, 3.9222913969620156`*^9}},
 CellLabel->
  "In[3466]:=",ExpressionUUID->"e3efe453-3daf-4865-b649-cf34a7cf5719"],

Cell[BoxData[{
 RowBox[{"TextAlt", "[", 
  RowBox[{"ZRot", "[", 
   RowBox[{"\[Pi]", "/", "3"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TextAlt", "[", 
  RowBox[{
   RowBox[{"ZRot", "[", 
    RowBox[{"\[Pi]", "/", "3"}], "]"}], ".", 
   RowBox[{"XRot", "[", "\[Pi]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.922291322703614*^9, 3.9222913691297*^9}},
 CellLabel->
  "In[3467]:=",ExpressionUUID->"79d91f48-ff59-48c5-9650-b5189b42207f"],

Cell[BoxData[{
 RowBox[{"BarFormText", "[", "rot111", "]"}], "\[IndentingNewLine]", 
 RowBox[{"BarFormText", "[", 
  RowBox[{"ZRot", "[", 
   RowBox[{"\[Pi]", "/", "4"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9222858864812603`*^9, 3.922285896827503*^9}, {
  3.922286108696782*^9, 3.9222861590338697`*^9}},
 CellLabel->
  "In[3469]:=",ExpressionUUID->"c6063130-864b-47ba-92fd-24d6355d1c7a"],

Cell[BoxData[{
 RowBox[{"TextAlt", "[", 
  RowBox[{"XRot", "[", "\[Pi]", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BarFormText", "[", 
  RowBox[{"XRot", "[", "\[Pi]", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.922285914758083*^9, 3.922285919703107*^9}, {
  3.9222859526685677`*^9, 3.9222859540197773`*^9}, {3.922286089663765*^9, 
  3.922286093358321*^9}},
 CellLabel->
  "In[3471]:=",ExpressionUUID->"bf7ce556-6817-4f9c-82f5-0e56b60a0cee"],

Cell["Used in file SI_SymmetryIntuition.nb", "Subsubsection",
 CellChangeTimes->{{3.9185120528853474`*^9, 
  3.918512087340885*^9}},ExpressionUUID->"950644cd-8a14-4611-a100-\
48101445c816"],

Cell[TextData[{
 "Just one label for each line (\[Theta], \[Phi]) = (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4c0579df-f33c-4434-a3b2-02344bdf455a"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Phi]", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b0338314-64e4-47bf-bcc4-6b360dd6ac8a"],
 ")"
}], "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
  3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
  3.918424345572372*^9}, {3.9184976031527505`*^9, 
  3.9184976055070724`*^9}},ExpressionUUID->"67f66682-3c98-4458-9502-\
faa3a42215a5"],

Cell["CUBE and ORTH. ", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
   3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
   3.918424345572372*^9}, 3.918497609823429*^9, {3.9184977340497913`*^9, 
   3.9184977378192797`*^9}, {3.9184981171484637`*^9, 
   3.9184981233721533`*^9}, {3.9399501841171412`*^9, 
   3.9399501852444806`*^9}},ExpressionUUID->"18efcc85-0fb1-4e67-b57c-\
35f09b6e3a76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RotFormPrint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U_", ",", "\[CapitalSigma]_"}], "]"}], ":=", "False"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.91947152783934*^9, 3.919471537578023*^9}},
 CellLabel->
  "In[3473]:=",ExpressionUUID->"ae43a1f9-122c-43d0-a921-a4010296623a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"id", ",", "CUBE"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", "CUBE"}], "]"}], "=", "True"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"YRot", "[", "\[Pi]", "]"}], ",", "CUBE"}], "]"}], "=", 
   "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"rot111", ",", "CUBE"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"rot111", ".", "rot111"}], ",", "CUBE"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotFormPrint", "[", 
   RowBox[{"U_", ",", "ORTH"}], "]"}], ":=", 
  RowBox[{"RotFormPrint", "[", 
   RowBox[{"U", ",", "CUBE"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.9184051495449286`*^9, {3.918405198454545*^9, 3.9184052745725946`*^9}, {
   3.9184053168831797`*^9, 3.9184055030773134`*^9}, {3.918406666904171*^9, 
   3.918406699369385*^9}, {3.9184067670343933`*^9, 3.91840684163173*^9}, {
   3.918497305516244*^9, 3.9184973070862045`*^9}, {3.918497926369411*^9, 
   3.9184979275179977`*^9}, {3.919543625420868*^9, 3.919543690848098*^9}, {
   3.919544169405711*^9, 3.919544170547879*^9}, {3.9222849900204315`*^9, 
   3.922285002297039*^9}, {3.922285720797868*^9, 3.92228572184995*^9}, {
   3.922286304250859*^9, 3.922286312639444*^9}},
 CellLabel->
  "In[3475]:=",ExpressionUUID->"43c8b359-9c2c-4ad4-bd31-ac98cfc7ad81"],

Cell["Label all for CUBE and ORTH. ", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
   3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
   3.918424345572372*^9}, 3.918497609823429*^9, {3.9184977340497913`*^9, 
   3.9184977378192797`*^9}, {3.9184981171484637`*^9, 
   3.9184981233721533`*^9}, {3.939949979700512*^9, 3.9399499917039957`*^9}, {
   3.9399501923277845`*^9, 
   3.939950195160406*^9}},ExpressionUUID->"43ed7975-2e7e-4dc9-b90b-\
b385735cd4c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RotFormPrint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U_", ",", "CUBE"}], "]"}], ":=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9222885441048717`*^9, 3.9222885449367943`*^9}},
 CellLabel->
  "In[3481]:=",ExpressionUUID->"f04f1717-9f17-407d-8a29-4702536dca3c"],

Cell["Another labelling for CUBE and ORTH. ", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
   3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
   3.918424345572372*^9}, 3.918497609823429*^9, {3.9184977340497913`*^9, 
   3.9184977378192797`*^9}, {3.9184981171484637`*^9, 
   3.9184981233721533`*^9}, {3.939949979700512*^9, 
   3.9399499917039957`*^9}},ExpressionUUID->"4101eddf-554f-47de-ae6e-\
f9404becd7b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RotFormPrint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U_", ",", "CUBE"}], "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"id", ",", "CUBE"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", "CUBE"}], "]"}], "=", "True"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", 
         RowBox[{"-", "1"}]},
        {"1", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}], ",", "CUBE"}], "]"}], "=", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "1", "0"},
        {"0", "0", 
         RowBox[{"-", "1"}]},
        {
         RowBox[{"-", "1"}], "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}], ",", "CUBE"}], "]"}], "=", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotFormPrint", "[", 
   RowBox[{"U_", ",", "ORTH"}], "]"}], ":=", 
  RowBox[{"RotFormPrint", "[", 
   RowBox[{"U", ",", "CUBE"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.92228766833306*^9, {3.9222877321273966`*^9, 3.922287747293382*^9}, {
   3.9222878412042785`*^9, 3.922287857787535*^9}, {3.922288408984412*^9, 
   3.9222884241296687`*^9}, {3.9248770481085653`*^9, 3.9248770492720227`*^9}},
 CellLabel->
  "In[3483]:=",ExpressionUUID->"2dd79339-4654-4dbc-ba00-17722e92526a"],

Cell[BoxData[{
 RowBox[{"BarFormText", "[", 
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{"-", "1"}]},
     {"1", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BarFormText", "[", 
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"-", "1"}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.924877589280616*^9, 3.9248775941288843`*^9}, {
  3.924877627159122*^9, 3.924877636852803*^9}},
 CellLabel->
  "In[3490]:=",ExpressionUUID->"b387c796-68cf-439d-9af9-f17b6115bf5c"],

Cell["TET", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
   3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
   3.918424345572372*^9}, {3.9184244469103403`*^9, 3.9184244474382544`*^9}, 
   3.91849761588585*^9, {3.919540300518159*^9, 
   3.919540301302139*^9}},ExpressionUUID->"ba24de6d-7bc3-4ac9-bfd7-\
50c41a7e2871"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U_", ",", "TET"}], "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"id", ",", "TET"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"ZRot", "[", 
      RowBox[{"\[Pi]", "/", "4"}], "]"}], ",", "TET"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"ROT", "[", 
      RowBox[{"\[Pi]", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", "TET"}], 
    "]"}], "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ZRot", "[", 
       RowBox[{"\[Pi]", "/", "2"}], "]"}], ".", 
      RowBox[{"ROT", "[", 
       RowBox[{"\[Pi]", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", "TET"}], 
    "]"}], "=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9184051495449286`*^9, {3.918405198454545*^9, 3.9184052745725946`*^9}, {
   3.9184053168831797`*^9, 3.9184055030773134`*^9}, {3.918406666904171*^9, 
   3.918406699369385*^9}, {3.9184067670343933`*^9, 3.91840684163173*^9}, {
   3.9184244713128195`*^9, 3.918424491775818*^9}, {3.9184245309431796`*^9, 
   3.9184245842710075`*^9}, {3.918424814195702*^9, 3.918424814876914*^9}, {
   3.9184972846643214`*^9, 3.918497285214132*^9}, {3.9195402480424957`*^9, 
   3.919540290081353*^9}, {3.9235138902291117`*^9, 3.9235138914009085`*^9}, {
   3.9235144408766546`*^9, 3.9235144606561155`*^9}, {3.9235149674923487`*^9, 
   3.923514970320096*^9}, {3.923515217636307*^9, 3.923515226354102*^9}, {
   3.9235153665873046`*^9, 3.9235153675091853`*^9}, {3.923515468294119*^9, 
   3.923515471934344*^9}, {3.923526761353486*^9, 3.9235267626034565`*^9}},
 CellLabel->
  "In[3492]:=",ExpressionUUID->"9f1a7ddb-4ca7-4ea4-9c96-fb434a497f4c"],

Cell["TRIG", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
  3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
  3.918424345572372*^9}, {3.9184244469103403`*^9, 3.9184244474382544`*^9}, {
  3.9184251109263163`*^9, 3.9184251127828956`*^9}, {3.9184976507893906`*^9, 
  3.9184976515573816`*^9}, {3.919540302808648*^9, 
  3.9195403032641296`*^9}},ExpressionUUID->"77d9e195-33a1-48e0-8855-\
b9c643b41779"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U_", ",", "TRIG"}], "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"id", ",", "TRIG"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"ZRot", "[", 
      RowBox[{"\[Pi]", "/", "3"}], "]"}], ",", "TRIG"}], "]"}], "=", "True"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ",", "TRIG"}], "]"}], "=", "True"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ZRot", "[", 
       RowBox[{"\[Pi]", "/", "3"}], "]"}], ".", 
      RowBox[{"XRot", "[", "\[Pi]", "]"}]}], ",", "TRIG"}], "]"}], "=", 
   "True"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9184051495449286`*^9, {3.918405198454545*^9, 3.9184052745725946`*^9}, {
   3.9184053168831797`*^9, 3.9184055030773134`*^9}, {3.918406666904171*^9, 
   3.918406699369385*^9}, {3.9184067670343933`*^9, 3.91840684163173*^9}, {
   3.9184244713128195`*^9, 3.918424491775818*^9}, {3.9184245309431796`*^9, 
   3.9184245842710075`*^9}, {3.918424814195702*^9, 3.918424814876914*^9}, {
   3.918425127871135*^9, 3.91842514065236*^9}, {3.9184972705980425`*^9, 
   3.9184972713201103`*^9}, {3.9194508376951866`*^9, 3.919450838823698*^9}, {
   3.9194508838765907`*^9, 3.9194509443041935`*^9}, 3.9194715576275177`*^9, 
   3.9194731456956377`*^9, {3.922288910182228*^9, 3.922288928586048*^9}, {
   3.9222896911699743`*^9, 3.922289704337351*^9}, {3.922290148992119*^9, 
   3.9222901770269756`*^9}, 3.9222902657452936`*^9, 3.922291748176299*^9, 
   3.9222919070718117`*^9, 3.9222919720610867`*^9, {3.9235153183090715`*^9, 
   3.92351532004331*^9}},
 CellLabel->
  "In[3497]:=",ExpressionUUID->"d74790a2-f856-4a39-85c4-95b20ba6b9d6"],

Cell["MONO and XISO", "Subsubsection",
 CellChangeTimes->{{3.918404754347678*^9, 3.918404849074787*^9}, {
  3.9184049541499653`*^9, 3.9184050338178825`*^9}, {3.9184242906550813`*^9, 
  3.918424345572372*^9}, {3.9184244469103403`*^9, 3.9184244474382544`*^9}, {
  3.9184251109263163`*^9, 3.9184251127828956`*^9}, {3.9184976507893906`*^9, 
  3.9184976515573816`*^9}, {3.918497682019116*^9, 
  3.9184976872034507`*^9}},ExpressionUUID->"b27680e7-25bb-461b-92d9-\
39b8488f416e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"id", ",", "MONO"}], "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{
     RowBox[{"ROT", "[", 
      RowBox[{"\[Pi]", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", "MONO"}], 
    "]"}], "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U_", ",", "XISO"}], "]"}], ":=", 
   RowBox[{"RotFormPrint", "[", 
    RowBox[{"U", ",", "MONO"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9184969953072324`*^9, 3.918497109031189*^9}, {
  3.9184971396288815`*^9, 3.918497183442067*^9}, {3.918497823824822*^9, 
  3.91849782515961*^9}, {3.9184979631131015`*^9, 3.9184979979776344`*^9}},
 CellLabel->
  "In[3502]:=",ExpressionUUID->"d45041b3-4659-4969-9fcb-1cdfaf0f53be"],

Cell[BoxData[
 RowBox[{"BarFormText", "[", "id", "]"}]], "Input",
 CellChangeTimes->{{3.9184951895711412`*^9, 3.918495190857726*^9}},
 CellLabel->
  "In[3505]:=",ExpressionUUID->"8222c761-e3ce-4722-967e-826c32b3dd74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BarFormTextForTriples", "[", 
   RowBox[{"{", 
    RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], "]"}], ":=", 
  RowBox[{"SequenceForm", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BarForm", "[", "n1", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BarForm", "[", "n2", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BarForm", "[", "n3", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8990745286387105`*^9, 3.899074582563293*^9}, {
  3.8990747167713337`*^9, 3.8990747584504023`*^9}},
 CellLabel->
  "In[3506]:=",ExpressionUUID->"f016d6be-c75c-440e-8d79-54acab30c316"],

Cell[BoxData[{
 RowBox[{"BarFormText", "[", 
  RowBox[{"ZRot", "[", "\[Pi]", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BarFormTextForTriples", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", 
    RowBox[{"-", "3"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.899074425933503*^9, 3.8990744419598436`*^9}, {
  3.899074770236881*^9, 3.899074776510295*^9}, {3.8990748215222187`*^9, 
  3.899074833921664*^9}},
 CellLabel->
  "In[3507]:=",ExpressionUUID->"d81736f2-425d-431d-8c95-8e02007d9f1c"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "luc"}], "]"}]], "Input",
 CellChangeTimes->{{3.910450240397311*^9, 3.9104502440616035`*^9}},
 CellLabel->
  "In[3509]:=",ExpressionUUID->"e6e40c86-37bc-4ef3-910f-97039d9af9f3"],

Cell[BoxData[{
 RowBox[{"BarFormText", "[", 
  RowBox[{"ZRot", "[", "\[Pi]", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BarFormTextForTriples", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", 
    RowBox[{"-", "3"}]}], "}"}], "]"}]}], "Input",
 CellLabel->
  "In[3510]:=",ExpressionUUID->"b6523880-28d4-4c11-a1f6-803e26a63875"],

Cell[CellGroupData[{

Cell[TextData[{
 "Sort them. ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 13 seems to give an error message not seen in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10. The final output is still OK."
}], "Subsubsection",
 CellChangeTimes->{{3.890060951285735*^9, 3.89006096360441*^9}, {
  3.8900646632339835`*^9, 3.890064697109466*^9}, {3.890064747735567*^9, 
  3.8900647588914742`*^9}, {3.8901807528034043`*^9, 3.89018078437807*^9}, {
  3.8905036241170216`*^9, 3.8905036269409432`*^9}, {3.898866641861104*^9, 
  3.8988666987630453`*^9}},ExpressionUUID->"21e78778-1bf0-4b1e-96ed-\
a444f6f15cee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumberZeros", "[", "nTuple_", "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{"nTuple", ",", 
      RowBox[{
       RowBox[{"#", "\[Equal]", "0"}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderByRotAngleAndNumberZeros", "[", 
    RowBox[{"U1_", ",", "U2_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RotationAngle", "[", "U1", "]"}], "==", 
       RowBox[{"RotationAngle", "[", "U2", "]"}]}], "&&", 
      RowBox[{
       RowBox[{"NumberZeros", "[", 
        RowBox[{"RotationAxis", "[", "U1", "]"}], "]"}], "==", 
       RowBox[{"NumberZeros", "[", 
        RowBox[{"RotationAxis", "[", "U2", "]"}], "]"}]}]}], ",", 
     RowBox[{"OrderedQ", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RotationAxis", "[", "U2", "]"}], ",", 
        RowBox[{"RotationAxis", "[", "U1", "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RotationAngle", "[", "U1", "]"}], "==", 
        RowBox[{"RotationAngle", "[", "U2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"NumberZeros", "[", 
         RowBox[{"RotationAxis", "[", "U1", "]"}], "]"}], ">", 
        RowBox[{"NumberZeros", "[", 
         RowBox[{"RotationAxis", "[", "U2", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RotationAngle", "[", "U1", "]"}], "<", 
        RowBox[{"RotationAngle", "[", "U2", "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortByRotAngleAndNumberZeros", "[", "xxx_", "]"}], ":=", 
  RowBox[{"Sort", "[", 
   RowBox[{"xxx", ",", "OrderByRotAngleAndNumberZeros"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.8905028226065288`*^9, {3.8905083066495075`*^9, 3.8905083076525497`*^9}, {
   3.890578433434654*^9, 3.890578457108817*^9}, {3.8905785005151176`*^9, 
   3.890578515826677*^9}, {3.8905787216674757`*^9, 3.890578727508812*^9}, {
   3.8905788058763084`*^9, 3.8905788092017508`*^9}, {3.890579122213084*^9, 
   3.8905791399086814`*^9}, {3.890579191520915*^9, 3.890579230640934*^9}, {
   3.8905793463478966`*^9, 3.8905793541777787`*^9}},
 CellLabel->
  "In[3512]:=",ExpressionUUID->"988336bf-e8f6-4043-9e47-3d618da23028"],

Cell[BoxData[
 RowBox[{"BarFormText", "/@", 
  RowBox[{"SortByRotAngleAndNumberZeros", "[", 
   RowBox[{"RefGp", "[", "TET", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.823089382184165*^9, 3.823089438787176*^9}, {
   3.890502695633837*^9, 3.890502709898342*^9}, {3.890502746123519*^9, 
   3.890502761892523*^9}, 3.8905028292749147`*^9, {3.8905083367717595`*^9, 
   3.890508342608862*^9}, {3.9186530326824403`*^9, 3.91865303683893*^9}},
 CellLabel->
  "In[3515]:=",ExpressionUUID->"c2159d63-c0b8-4c64-8181-42b409b1e4ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For the winding path from node to node.  
ClosestToPrior[\[CapitalSigma], Tmat, \[CapitalSigma]n] has symmetry \
\[CapitalSigma].  
Tmat is the original elastic map, not the prior map.\
\>", "Subsection",
 CellChangeTimes->{{3.901740094930415*^9, 3.901740245764635*^9}, {
   3.901743624684272*^9, 3.9017436278526554`*^9}, {3.905121929480939*^9, 
   3.905121988121227*^9}, {3.905181399581711*^9, 3.905181447706805*^9}, {
   3.905243660310083*^9, 3.9052436614346867`*^9}, {3.9052685524356766`*^9, 
   3.9052685575565577`*^9}, {3.905286463634719*^9, 3.905286527632439*^9}, {
   3.905286559564344*^9, 3.9052865665279713`*^9}, {3.905286620259*^9, 
   3.9052866315652533`*^9}, {3.9053463866144066`*^9, 3.9053463985147743`*^9}, 
   3.9053464349670877`*^9, {3.9078859472982316`*^9, 3.907885978291689*^9}, {
   3.907943732500743*^9, 3.907943765320467*^9}, {3.907955877400257*^9, 
   3.9079559137786484`*^9}},ExpressionUUID->"8d5e09dc-38e1-4210-9425-\
b98780b5419c"],

Cell["Changed Nov 1, 2023:  The first input is now \[CapitalSigma], not n.", \
"Subsubsection",
 CellChangeTimes->{{3.907290065206375*^9, 3.907290085598507*^9}, {
  3.9074265128829517`*^9, 3.907426534021368*^9}, {3.907684928741505*^9, 
  3.9076849305465384`*^9}, {3.9078858295712004`*^9, 
  3.9078858658424654`*^9}},ExpressionUUID->"68a76207-051d-44d1-823e-\
2cb6e8597300"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "ClosestToPrior", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prior\[CapitalSigma]", "[", 
    RowBox[{"\[CapitalSigma]_", ",", "\[CapitalSigma]n_"}], "]"}], ":=", 
   RowBox[{"\[CapitalSigma]n", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"domain", "[", "\[CapitalSigma]n", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalSigma]n", "[", "#", "]"}], "\[Equal]", 
          "\[CapitalSigma]"}], " ", "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Next\[CapitalSigma]", "[", 
    RowBox[{"\[CapitalSigma]_", ",", "\[CapitalSigma]n_"}], "]"}], "  ", ":=", 
   RowBox[{"\[CapitalSigma]n", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"domain", "[", "\[CapitalSigma]n", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CapitalSigma]n", "[", "#", "]"}], "\[Equal]", 
          "\[CapitalSigma]"}], " ", "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClosestToPrior", "[", 
    RowBox[{"\[CapitalSigma]_", ",", "Tmat_", ",", "\[CapitalSigma]n_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"ClosestToPrior", "[", 
     RowBox[{"\[CapitalSigma]", ",", "Tmat", ",", "\[CapitalSigma]n"}], "]"}],
     "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "===", 
       RowBox[{"\[CapitalSigma]n", "[", "1", "]"}]}], ",", 
      RowBox[{"Closest", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
      RowBox[{"Closest", "[", 
       RowBox[{
        RowBox[{"ClosestToPrior", "[", 
         RowBox[{
          RowBox[{"Prior\[CapitalSigma]", "[", 
           RowBox[{"\[CapitalSigma]", ",", "\[CapitalSigma]n"}], "]"}], ",", 
          "Tmat", ",", "\[CapitalSigma]n"}], "]"}], ",", "\[CapitalSigma]"}], 
       "]"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9017390834981937`*^9, 3.901739132684661*^9}, {
   3.9017400047457647`*^9, 3.901740036156028*^9}, 3.9017402949964256`*^9, {
   3.90174067115355*^9, 3.9017406913964524`*^9}, {3.9017414831319113`*^9, 
   3.901741485954379*^9}, 3.9050415890152903`*^9, {3.9050839304816585`*^9, 
   3.905083937295287*^9}, {3.905121681435534*^9, 3.9051216832441626`*^9}, {
   3.9051762215504475`*^9, 3.905176250518523*^9}, {3.90517634730437*^9, 
   3.9051763474145327`*^9}, {3.905176783408037*^9, 3.9051767838157043`*^9}, {
   3.90526846096684*^9, 3.9052684769661846`*^9}, {3.907080532783147*^9, 
   3.90708057444131*^9}, {3.9072886586235647`*^9, 3.9072886628316355`*^9}, 
   3.907885822876408*^9, {3.907955931823008*^9, 3.9079559502629642`*^9}, {
   3.907957645966051*^9, 3.907957668409392*^9}, {3.908052891197466*^9, 
   3.908052985244923*^9}, {3.9082037184221296`*^9, 3.9082037343933516`*^9}, {
   3.9082052764852076`*^9, 3.9082052993106117`*^9}, {3.908225055141927*^9, 
   3.908225060904034*^9}},
 CellLabel->
  "In[3516]:=",ExpressionUUID->"b7a9973b-74e6-4f69-b26a-aaeec6fd7075"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ClosestToPriorTuple", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ClosestToPrior", "[", 
      RowBox[{
       RowBox[{"\[CapitalSigma]n", "[", "#", "]"}], ",", "Tmat", ",", 
       "\[CapitalSigma]n"}], "]"}], "&"}], "/@", 
    RowBox[{"domain", "[", "\[CapitalSigma]n", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9076853187444887`*^9, 3.907685383769388*^9}, {
  3.907685467895709*^9, 3.907685507885703*^9}, {3.9076859067063055`*^9, 
  3.9076859159492497`*^9}, {3.9078860791715946`*^9, 3.9078860847389355`*^9}, {
  3.907955954766631*^9, 3.907955955567255*^9}},
 CellLabel->
  "In[3520]:=",ExpressionUUID->"107c8d68-5a6e-408d-8fcd-22cc5e025e38"],

Cell[CellGroupData[{

Cell["\<\
 AmatPrime, TmatPrime
TmatPrime is the disgraced \[OpenCurlyDoubleQuote]hex-approximation\
\[CloseCurlyDoubleQuote] of Browaeys/Chevrot.\
\>", "Subsection",
 CellChangeTimes->{{3.8866146094398575`*^9, 3.8866146380919123`*^9}, {
   3.8940569521219397`*^9, 3.894057047956857*^9}, {3.895338190757129*^9, 
   3.8953381928613205`*^9}, {3.8960508471197867`*^9, 3.8960508476789317`*^9}, 
   3.9219602550776553`*^9},ExpressionUUID->"fefcfc87-6219-4cd1-932b-\
84be89e7ca28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Conj", "[", 
    RowBox[{"Tmat_", ",", "U_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixUbar", "[", "U", "]"}], ".", "Tmat", ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AmatPrime", "[", 
    RowBox[{"Tmat_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"Amat", "[", 
       RowBox[{"Tmat", ",", "U"}], "]"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["id",
      FontColor->RGBColor[1, 0, 0]], ",", "XISO"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmatPrime", "[", 
    RowBox[{"Tmat_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox["Tmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", 
     StyleBox["U",
      FontColor->RGBColor[1, 0, 0]], ",", "XISO"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.886003382199541*^9, 3.8860034341666803`*^9}, {
  3.8860043270164623`*^9, 3.8860043839411793`*^9}, {3.8866124515391707`*^9, 
  3.886612465266702*^9}, {3.895338233578861*^9, 3.8953382477651696`*^9}, {
  3.919989801146138*^9, 3.9199898202370834`*^9}, {3.9219602313823595`*^9, 
  3.921960232484357*^9}},
 CellLabel->
  "In[3521]:=",ExpressionUUID->"dd39b62f-6eff-4bc6-91cd-5ef497223559"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "DummySphereGraphics", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DummySphereGraphics", "[", "hue_", "]"}], ":=", 
   RowBox[{
    RowBox[{"DummySphereGraphics", "[", "hue", "]"}], "=", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"FaceForm", "[", "hue", "]"}], ",", 
      RowBox[{"Polygon", "/@", 
       RowBox[{"SpherePolyList", "[", 
        RowBox[{
        "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5", ",", "5"}],
         "]"}]}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9078011396064477`*^9, 3.90780115856627*^9}, {
   3.907801209143782*^9, 3.907801230599968*^9}, {3.908656655441046*^9, 
   3.9086566819810767`*^9}, {3.9086585921925*^9, 3.9086586412681828`*^9}, {
   3.908658692928528*^9, 3.9086586944965525`*^9}, {3.9087614745719147`*^9, 
   3.9087615320117636`*^9}, {3.9087621711438217`*^9, 3.9087621905259523`*^9}, 
   3.908762982392999*^9, {3.9087631486595564`*^9, 3.908763172221281*^9}, {
   3.908763240948345*^9, 3.90876324529865*^9}, {3.908763281888214*^9, 
   3.908763328702051*^9}, {3.908814926422473*^9, 3.9088149371994443`*^9}, {
   3.9088149856275253`*^9, 3.9088149940590506`*^9}, {3.9088151807486734`*^9, 
   3.908815183386385*^9}, 3.9090672230386972`*^9, 3.9091764726798973`*^9, 
   3.9091776224234753`*^9, {3.9091796724963555`*^9, 3.909179672692133*^9}, {
   3.909179787619034*^9, 3.9091798176993327`*^9}, 3.910276326729154*^9, {
   3.9102765016786065`*^9, 3.910276537303816*^9}, 3.9102812846790533`*^9, {
   3.9202101354909596`*^9, 3.9202101507207193`*^9}},
 CellLabel->
  "In[3524]:=",ExpressionUUID->"7606f411-19b3-4eed-8816-6b0092a37a0d"],

Cell[BoxData[{
 RowBox[{"PrintEye", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempOptions", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ImageSize", "->", "100"}], ",", 
     StyleBox[
      RowBox[{"Lighting", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
      FontColor->RGBColor[1, 0, 0]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempOptions", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
     RowBox[{"Boxed", "->", "False"}], ",", 
     RowBox[{"ImageSize", "->", "100"}], ",", 
     StyleBox[
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}],
      FontColor->RGBColor[1, 0, 0]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DummySphereGraphics", "[", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
         ".03", "]"}], "]"}], "}"}], ",", "TempOptions"}], "]"}], ",", 
    "                                        ", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DummySphereGraphics", "[", 
         RowBox[{"GrayLevel", "[", ".6", "]"}], "]"}], ","}], 
       "                                         ", "}"}], ",", 
      "TempOptions"}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9086586473929787`*^9, 3.9086586723368845`*^9}, {
   3.9086587737465124`*^9, 3.9086587819372587`*^9}, {3.9086588765787635`*^9, 
   3.908658877825324*^9}, {3.9087614943562984`*^9, 3.908761498494223*^9}, {
   3.9091797499723415`*^9, 3.9091797608186445`*^9}, {3.910276291811527*^9, 
   3.9102763121955414`*^9}, {3.9102764295965033`*^9, 3.910276453212641*^9}, {
   3.910276568743273*^9, 3.9102766067281194`*^9}, {3.9102770670994215`*^9, 
   3.9102770680896916`*^9}, {3.9102772426602087`*^9, 
   3.9102772549497304`*^9}, {3.9102772940025315`*^9, 3.91027732352984*^9}, {
   3.9102773591537876`*^9, 3.9102773867022057`*^9}, {3.910277447944852*^9, 
   3.910277540646345*^9}, {3.9102784637127604`*^9, 3.9102784784985685`*^9}, {
   3.9102788963283777`*^9, 3.9102789245089083`*^9}, {3.91028123450917*^9, 
   3.9102812383543973`*^9}, {3.9103084765839005`*^9, 3.910308478859787*^9}, {
   3.9103847780933437`*^9, 3.9103848003536067`*^9}, {3.910384846407696*^9, 
   3.910384874826523*^9}, {3.9142595143565445`*^9, 3.9142595324807577`*^9}, {
   3.914621411877755*^9, 3.914621416992086*^9}, {3.9146214809558277`*^9, 
   3.914621482885339*^9}, 3.91462151763095*^9, {3.917639702043285*^9, 
   3.9176397048372602`*^9}, {3.917639814661464*^9, 3.9176398252961206`*^9}},
 CellLabel->
  "In[3526]:=",ExpressionUUID->"baa8a37b-6108-42ac-9c64-c3c1f1baa6f2"],

Cell[CellGroupData[{

Cell["\<\
For contours and contour shading together, and getting the whole sphere, not \
just the hemisphere seen by the eye.\
\>", "Section",
 CellChangeTimes->{{3.8860023119635935`*^9, 
  3.8860024029850483`*^9}},ExpressionUUID->"74cd6286-c0a1-4620-b977-\
794197466edd"],

Cell["legends = None or Automatic", "Subsubsection",
 CellChangeTimes->{{3.885064375810918*^9, 3.8850644132321053`*^9}, 
   3.8850645303019347`*^9},ExpressionUUID->"886acee9-3dbc-4109-a0c4-\
5a3f0149adff"]
}, Open  ]],

Cell["\"TemperatureMap\"", "Subsubsection",
 CellChangeTimes->{
  3.8855064529650173`*^9},ExpressionUUID->"c427a2c7-9b03-4f62-8d29-\
eb4d22d28e0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ContourStyle", "\[Rule]", 
   RowBox[{"Thickness", "[", ".004", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895204217491829*^9, 3.8952042246160216`*^9}},
 CellLabel->
  "In[3530]:=",ExpressionUUID->"2b28db42-6430-449f-bfbd-076f811ed256"],

Cell[BoxData[
 RowBox[{"ContourStyle", "\[Rule]", 
  RowBox[{"Thickness", "[", 
   StyleBox[".002",
    FontColor->RGBColor[1, 0, 0]], "]"}]}]], "Input",
 CellLabel->
  "In[3531]:=",ExpressionUUID->"d586a33c-7559-4038-86ad-b3a317df5ab6"],

Cell[BoxData[
 StyleBox[
  RowBox[{"PlotPoints", "->", "30"}],
  FontColor->RGBColor[1, 0, 0]]], "Input",
 CellLabel->
  "In[3532]:=",ExpressionUUID->"b8d82f3d-4057-47d6-9b4d-3a5e17a8ccda"],

Cell[BoxData[
 RowBox[{"ContourStyle", "\[Rule]", 
  RowBox[{"Thickness", "[", 
   StyleBox[".0015",
    FontColor->RGBColor[1, 0, 0]], "]"}]}]], "Input",
 CellLabel->
  "In[3533]:=",ExpressionUUID->"e2463291-2011-46b6-96ad-13020e03690f"],

Cell["\<\
plotpoints added as input January 2024. 
Redone February 2024 in connection with the more generalized sections of the \
\[Theta]\[Sigma]\[Phi] coordinate block. Needs checking.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9146000039044957`*^9, 3.9146000504527025`*^9}, {
   3.917551826870293*^9, 3.917551914206333*^9}, 
   3.92046276208899*^9},ExpressionUUID->"96f933a4-1603-4354-bcda-\
0ae9105a0634"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpMONOprelim", " ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cpMONOprelim", "[", 
    RowBox[{
    "Tmat_", ",", "contours_", ",", "legends_", ",", "MaxForScaling_", ",", 
     "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
   RowBox[{"cp\[CapitalSigma]prelimFix\[Sigma]", "[", 
    RowBox[{"Tmat", ",", "MONO", ",", 
     RowBox[{"colorscheme", "[", "MONO", "]"}], ",", "0", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}], ",", "contours", ",", "legends", ",", 
     "MaxForScaling", ",", "plotpoints", ",", "contourstyle"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.885491519278527*^9, {3.885517351689567*^9, 3.88551736224787*^9}, {
   3.885518802074421*^9, 3.8855188105031214`*^9}, 3.8855198319881215`*^9, {
   3.885519988582488*^9, 3.8855199895391755`*^9}, {3.8855200303621006`*^9, 
   3.8855200311542788`*^9}, {3.8856789591458263`*^9, 3.885678961879509*^9}, 
   3.885679437884448*^9, {3.8860840227751923`*^9, 3.8860840237202635`*^9}, 
   3.8860840736680617`*^9, {3.888273270915325*^9, 3.888273276331218*^9}, {
   3.894911640706896*^9, 3.8949116538058243`*^9}, 3.894911797007156*^9, {
   3.894912073230709*^9, 3.8949121116579204`*^9}, {3.8949121494519463`*^9, 
   3.8949121542357144`*^9}, {3.894912274012048*^9, 3.8949122972302265`*^9}, {
   3.894913253469407*^9, 3.894913263581702*^9}, {3.8949137564651413`*^9, 
   3.894913756872761*^9}, {3.8949402181388016`*^9, 3.8949402210540886`*^9}, {
   3.8950376386991415`*^9, 3.8950376468508587`*^9}, 3.895037927887331*^9, {
   3.895089634439132*^9, 3.895089647383175*^9}, {3.895172227696951*^9, 
   3.89517222851226*^9}, 3.904416364370385*^9, 3.9091588823425217`*^9, {
   3.910371511287503*^9, 3.910371528137121*^9}, 3.9103741931902714`*^9, {
   3.91072614152248*^9, 3.910726142319151*^9}, {3.91141862150247*^9, 
   3.9114186278272696`*^9}, {3.9114195898931775`*^9, 3.911419590630349*^9}, {
   3.9142655506118927`*^9, 3.9142655532957754`*^9}, {3.9145829696353045`*^9, 
   3.914582970479535*^9}, {3.9145997303994193`*^9, 3.9145997436406507`*^9}, {
   3.914599870047868*^9, 3.914599870833146*^9}, {3.9145999514797544`*^9, 
   3.9145999855707264`*^9}, {3.9146011159344225`*^9, 3.914601119219201*^9}, {
   3.914677854922261*^9, 3.9146778685833364`*^9}, {3.914677918698044*^9, 
   3.914677932273933*^9}, 3.9146780003837175`*^9, 3.917551465256857*^9, 
   3.917551539270873*^9, 3.9204704738388405`*^9, 3.920541870925107*^9, 
   3.9223683243686075`*^9},
 CellLabel->
  "In[3534]:=",ExpressionUUID->"a5893e64-5a6c-417d-9ef8-f78e4734dece"],

Cell["\<\
Plot on sphere with center and radius. If $VersionNumber < 12, replace [1, 1, \
1] and [1, 1, 2] with [1,  1] and [1,  2] \
\>", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
   3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
   3.894975866627996*^9}, {3.8951052220789804`*^9, 3.8951052273421803`*^9}, {
   3.903208875246393*^9, 3.9032088831960983`*^9}, {3.9093501361927776`*^9, 
   3.909350164332412*^9}, 3.9093507543822412`*^9, {3.917523338209445*^9, 
   3.9175234072509623`*^9}},ExpressionUUID->"656502d4-efda-4045-98bf-\
d350c937bb3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cpMONO", "[", 
    RowBox[{
    "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
     "MaxForScaling_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"GraphicsComplex", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"center", "+", 
         RowBox[{"BBrad", "\[Times]", 
          RowBox[{"xyzTP", "[", "#", "]"}]}]}], "&"}], "/@", 
       RowBox[{
        RowBox[{"cpMONOprelim", "[", 
         RowBox[{
         "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
          "plotpoints", ",", "contourstyle"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      "                                                                       \
                                                 ", 
      RowBox[{
       RowBox[{"cpMONOprelim", "[", 
        RowBox[{
        "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
         "plotpoints", ",", "contourstyle"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9032090031365347`*^9, 3.9032090103964543`*^9}, {
   3.903209096513342*^9, 3.9032091634430532`*^9}, {3.9032091995296583`*^9, 
   3.9032092237594786`*^9}, {3.909350177490202*^9, 3.9093502594197197`*^9}, {
   3.9093506370401707`*^9, 3.909350647150671*^9}, {3.9093510886184034`*^9, 
   3.909351108646296*^9}, 3.910367598851852*^9, {3.9146000808203325`*^9, 
   3.914600102333006*^9}, {3.9146778901695733`*^9, 3.914677904035157*^9}, {
   3.914678019416276*^9, 3.914678024392654*^9}, {3.9146781025947514`*^9, 
   3.914678116980199*^9}, 3.9175234474471207`*^9},
 CellLabel->
  "In[3536]:=",ExpressionUUID->"cc384cfe-33d1-40f7-9674-b5e5dd6f80a5"],

Cell["Plot on sphere.", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}, {3.8951052220789804`*^9, 
  3.8951052273421803`*^9}},ExpressionUUID->"febd46bb-5d4f-4d24-b412-\
319706c4d972"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cpMONO", "[", 
   RowBox[{
   "Tmat_", ",", "contours_", ",", "MaxForScaling_", ",", "plotpoints_", ",", 
    "contourstyle_"}], "]"}], ":=", 
  RowBox[{"cpMONO", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1", ",", "Tmat", ",", 
    "contours", ",", "MaxForScaling", ",", "plotpoints", ",", 
    "contourstyle"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9093506794385915`*^9, 3.9093507098880706`*^9}, {
  3.909350967421652*^9, 3.9093509687978535`*^9}, {3.914600133589284*^9, 
  3.9146001707573724`*^9}, {3.9146780337040997`*^9, 3.9146780453516564`*^9}},
 CellLabel->
  "In[3537]:=",ExpressionUUID->"4735d8a6-6820-4f44-988c-69a1a5d9d33c"],

Cell["\<\
Remember PlotLegends are \[OpenCurlyDoubleQuote]Legended\
\[CloseCurlyDoubleQuote] things, not Graphics objects, so you cannot inset \
them, for example. 
But legends[contours,  MaxForScaling, ... ] is a Graphics object.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.8958431062070265`*^9, {3.8958434312061357`*^9, 3.8958434379592533`*^9}, {
   3.895843469626789*^9, 3.8958435366898975`*^9}, {3.914354959964153*^9, 
   3.914354993466977*^9}},ExpressionUUID->"372c74c7-5ca8-4a55-8e08-\
fab5c5d82a09"],

Cell[TextData[{
 "Normally increment = 1.  The setting increment = ",
 StyleBox["n",
  FontSlant->"Italic"],
 " prints every ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "b3dba6aa-7e30-4ffe-8d7c-17f26e603ed4"],
 " contour label."
}], "Subsubsection",
 CellChangeTimes->{{3.9084687621548567`*^9, 3.9084688298716855`*^9}, 
   3.90847077687479*^9},ExpressionUUID->"aad91d2c-6725-4424-b214-\
a6c27772209b"],

Cell[BoxData[
 RowBox[{"EdgeForm", "[", 
  RowBox[{"(*", 
   RowBox[{"Thickness", "[", ".007", "]"}], "*)"}], "]"}]], "Input",
 CellLabel->
  "In[3538]:=",ExpressionUUID->"91f21e25-600b-4d5c-8e61-f121e3c4f281"],

Cell[BoxData[
 RowBox[{
  RowBox[{"legends", "[", 
   RowBox[{
   "contours_", ",", "MaxForScaling_", ",", "heading_", ",", "hw_", ",", 
    "fontsize_", ",", "increment_", ",", "offset_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"SequenceForm", "[", 
              RowBox[{"SuperscriptBox", "[", 
               RowBox[{
                RowBox[{"contours", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", 
                "\"\<\[SmallCircle]\>\""}], "]"}], "]"}], ",", "fontsize"}], 
            "]"}], "//", "DisplayForm"}], ",", 
          RowBox[{"{", 
           RowBox[{"offset", ",", 
            RowBox[{"#", " ", "hw"}]}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           StyleBox["contours",
            FontWeight->"Plain"], "]"}], "-", "1"}], ",", "increment"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{"heading", ",", 
        RowBox[{"{", 
         RowBox[{".75", ",", 
          RowBox[{"hw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              StyleBox["contours",
               FontWeight->"Plain"], "]"}], "+", ".75"}], ")"}]}]}], "}"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".0005", "]"}], ",", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3.5", ",", 
             RowBox[{"hw", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 StyleBox["contours",
                  FontWeight->"Plain"], "]"}], "+", "1.35"}], ")"}]}]}], 
            "}"}]}], "}"}]}]}], "}"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"fake", " ", "points"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Thickness", "[", ".004", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
            FractionBox[
             RowBox[{
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "+", 
              RowBox[{".5", 
               RowBox[{"contours", "[", 
                RowBox[{"[", 
                 RowBox[{"#", "+", "1"}], "]"}], "]"}]}]}], "MaxForScaling"], 
            "]"}], ",", 
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"#", " ", "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "+", "1"}], ")"}], "hw"}]}], "}"}]}], "}"}], 
            "]"}]}], "}"}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "contours", "]"}], "-", "1"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.92681501046321*^9, 3.926815066876936*^9},
 CellLabel->
  "In[3539]:=",ExpressionUUID->"bf83fa6a-012c-4613-aa12-e162e5674d5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", "=", "TmatMar17"}], ";"}]], "Input",
 CellLabel->
  "In[3540]:=",ExpressionUUID->"683206bc-2f12-4ec3-b4d1-90e24797ecee"],

Cell[BoxData[{
 RowBox[{"MatrixNote", "[", "Tmat", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hw", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontsize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"increment", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"increment", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"legends", "[", 
    RowBox[{
     RowBox[{"contours", "[", 
      RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", 
     RowBox[{"MaxForScaling", "[", 
      RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", "heading", ",", "hw", ",", 
     "fontsize", ",", "increment", ",", "offset"}], "]"}], ",", 
   RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9268153058681555`*^9, 3.926815403020694*^9}, 
   3.926815446219699*^9, {3.9271397711474223`*^9, 3.927139777805441*^9}, {
   3.9271399046787357`*^9, 3.927139912253129*^9}, 3.9271399790434155`*^9, {
   3.9271573892512035`*^9, 3.9271574246245193`*^9}, {3.9271577393748074`*^9, 
   3.927157759223995*^9}},
 CellLabel->
  "In[3541]:=",ExpressionUUID->"ff4c0348-f996-44ed-8b68-0381b1001069"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "MONO"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"50", 
    RowBox[{"xyzTP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"35", "Degree"}], ",", 
       RowBox[{"65", "Degree"}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontsize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"increment", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBrad", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotpoints", "=", "10"}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"for", " ", "speed"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixNote", "[", "Tmat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   StyleBox["False",
    FontColor->RGBColor[1, 0, 0]], ",", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"cpMONO", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "BBrad", ",", 
          "Tmat", ",", 
          RowBox[{"contours", "[", 
           RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", 
          RowBox[{"MaxForScaling", "[", 
           RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", "plotpoints", ",", 
          RowBox[{"Thickness", "[", ".003", "]"}]}], "]"}], ",", 
        StyleBox[
         RowBox[{"Lighting", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
         FontColor->GrayLevel[0]], 
        StyleBox[",",
         FontColor->GrayLevel[0]], 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"legends", "[", 
       RowBox[{
        RowBox[{"contours", "[", 
         RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", 
        RowBox[{"MaxForScaling", "[", 
         RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", "heading", ",", "hw", ",",
         "fontsize", ",", "increment", ",", "offset"}], "]"}]}], "}"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9271401660068884`*^9, 3.9271402147827706`*^9}, {
   3.9271403232508335`*^9, 3.927140336883009*^9}, {3.9271404017756147`*^9, 
   3.9271404061292086`*^9}, {3.9271404676143255`*^9, 3.927140482249346*^9}, {
   3.9271405138771343`*^9, 3.9271405716950283`*^9}, {3.9271407994197435`*^9, 
   3.9271408682927227`*^9}, {3.927140931056378*^9, 3.92714097562484*^9}, 
   3.927141008088824*^9, {3.927141469070752*^9, 3.9271415007206016`*^9}, {
   3.9271418148870516`*^9, 3.927141817931881*^9}, 3.9271418618688507`*^9, {
   3.9271418976915665`*^9, 3.9271419032245207`*^9}, {3.927141948202321*^9, 
   3.927141959463355*^9}, {3.927157467986106*^9, 3.9271574702182426`*^9}, {
   3.9271575917650366`*^9, 3.927157601390137*^9}, {3.928807838118831*^9, 
   3.928807854762862*^9}},
 CellLabel->
  "In[3548]:=",ExpressionUUID->"ee14b0d4-68af-41ff-904a-8e4b7c7ced41"],

Cell["\<\
For XISO, not MONO.  Needs to be redone.  This is not what is done in the SI \
file, which has no legend.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
   3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
   3.894975866627996*^9}, {3.917551625097989*^9, 3.917551639053874*^9}, 
   3.9258470018751793`*^9, {3.9258470530407505`*^9, 3.9258470716407957`*^9}, {
   3.9258471078923683`*^9, 
   3.9258471169217744`*^9}},ExpressionUUID->"a10e5901-022e-4518-a93a-\
7127763cc00b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "cpXISOprelim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cpXISOprelim", "[", 
    RowBox[{
    "Tmat_", ",", "contours_", ",", "legends_", ",", "MaxForScaling_", ",", 
     "MinForScaling_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"cpXISOprelim", "[", 
     RowBox[{
     "Tmat", ",", "contours", ",", "legends", ",", "MaxForScaling", ",", 
      "MinForScaling"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Alpha", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "XISO"}], "]"}], 
       "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      StyleBox[
       RowBox[{"PlotPoints", "->", "30"}],
       FontColor->RGBColor[1, 0, 0]], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Thickness", "[", 
        StyleBox[
         RowBox[{".", 
          StyleBox["0025",
           FontColor->RGBColor[1, 0, 0]]}]], "]"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", "14", "}"}]}], ",", 
      RowBox[{"PlotLegends", "->", "legends"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ColorData", "[", "\"\<M10DefaultDensityGradient\>\"", "]"}], "[", 
          FractionBox[
           RowBox[{"#", "-", "MinForScaling"}], 
           RowBox[{"MaxForScaling", "-", "MinForScaling"}]], "]"}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.885491519278527*^9, {3.885517351689567*^9, 3.88551736224787*^9}, {
   3.885518802074421*^9, 3.8855188105031214`*^9}, 3.8855198319881215`*^9, {
   3.885519988582488*^9, 3.8855199895391755`*^9}, {3.8855200303621006`*^9, 
   3.8855200311542788`*^9}, {3.8856789591458263`*^9, 3.885678961879509*^9}, 
   3.885679437884448*^9, {3.8860840227751923`*^9, 3.8860840237202635`*^9}, 
   3.8860840736680617`*^9, {3.888273270915325*^9, 3.888273276331218*^9}, {
   3.894911640706896*^9, 3.8949116538058243`*^9}, 3.894911797007156*^9, {
   3.894912073230709*^9, 3.8949121116579204`*^9}, {3.8949121494519463`*^9, 
   3.8949121542357144`*^9}, {3.894912274012048*^9, 3.8949122972302265`*^9}, {
   3.894913253469407*^9, 3.894913263581702*^9}, {3.8949137564651413`*^9, 
   3.894913756872761*^9}, {3.8949402181388016`*^9, 3.8949402210540886`*^9}, {
   3.8949756908960943`*^9, 3.894975710495762*^9}, {3.894975802359126*^9, 
   3.894975831930721*^9}, {3.894975964412275*^9, 3.8949759794944077`*^9}, {
   3.8950377407196407`*^9, 3.895037746238251*^9}, {3.895090007454508*^9, 
   3.8950900156056423`*^9}, 3.8951722552009344`*^9, {3.8951724723862267`*^9, 
   3.8951724750999126`*^9}, 3.8951725468114896`*^9, {3.899658942274934*^9, 
   3.899658952545788*^9}, {3.899658992930045*^9, 3.899658995953479*^9}, {
   3.8996590299877863`*^9, 3.899659072129091*^9}, {3.899659179108532*^9, 
   3.8996591858267007`*^9}, {3.8996597245177197`*^9, 3.899659738019331*^9}, {
   3.8996597802588453`*^9, 3.899659790209667*^9}, 3.899682964873596*^9, {
   3.9032022829315395`*^9, 3.9032022889144735`*^9}, {3.903202490033887*^9, 
   3.903202492584711*^9}, 3.9112284195451965`*^9, 3.911228474650441*^9, {
   3.911230048643589*^9, 3.911230055792094*^9}, {3.9142622540282426`*^9, 
   3.9142622744779434`*^9}, 3.9142912551091394`*^9, 3.9142915352170143`*^9, {
   3.914291603853425*^9, 3.914291608735693*^9}, {3.914584384335272*^9, 
   3.9145843856646395`*^9}, {3.9146802459716415`*^9, 
   3.9146802514734383`*^9}, {3.9148663104988594`*^9, 
   3.9148663120223265`*^9}, {3.9272117032492332`*^9, 3.927211746319459*^9}, {
   3.927211779819705*^9, 3.9272117980434184`*^9}, {3.927212441572179*^9, 
   3.927212442762992*^9}, 3.940799468090724*^9, {3.940799645399109*^9, 
   3.940799650420954*^9}, 3.9408888664284844`*^9},
 CellLabel->
  "In[3557]:=",ExpressionUUID->"19945bb5-2a6d-410f-a8e0-a6958d8f1559"],

Cell["\<\
Plot on sphere for XISO with center and radius. If $VersionNumber < 12, \
replace [1, 1, 1] and [1, 1, 2] with [1,  1] and [1,  2] \
\>", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}, {3.8951052220789804`*^9, 3.8951052273421803`*^9}, {
  3.903208875246393*^9, 3.9032088831960983`*^9}, {3.917523497928362*^9, 
  3.917523499703597*^9}, {3.917551610271469*^9, 
  3.917551614877179*^9}},ExpressionUUID->"8b3a993f-cfe6-4b0d-a637-\
1f38ef4b7fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cpXISO", "[", 
    RowBox[{
    "center_", ",", "BBrad_", ",", "Tmat_", ",", "contours_", ",", 
     "MaxForScaling_", ",", "MinForScaling_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"GraphicsComplex", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"center", "+", 
         RowBox[{"BBrad", "\[Times]", 
          RowBox[{"xyzTP", "[", "#", "]"}]}]}], "&"}], "/@", 
       RowBox[{
        RowBox[{"cpXISOprelim", "[", 
         RowBox[{
         "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
          "MinForScaling"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      "                                                                       \
                                                 ", 
      RowBox[{
       RowBox[{"cpXISOprelim", "[", 
        RowBox[{
        "Tmat", ",", "contours", ",", "None", ",", "MaxForScaling", ",", 
         "MinForScaling"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9032090031365347`*^9, 3.9032090103964543`*^9}, {
   3.903209096513342*^9, 3.9032091634430532`*^9}, {3.9032091995296583`*^9, 
   3.9032092237594786`*^9}, {3.9093503495203595`*^9, 3.909350373744338*^9}, 
   3.91752351139167*^9},
 CellLabel->
  "In[3559]:=",ExpressionUUID->"f1ce604e-9344-45a6-acc9-e2637e52a686"],

Cell["Plot on sphere.  XISO.", "Subsubsection",
 CellChangeTimes->{{3.8947166817301846`*^9, 3.894716711586997*^9}, {
  3.8948890047065372`*^9, 3.8948890249291005`*^9}, {3.8949758659078803`*^9, 
  3.894975866627996*^9}, {3.8951052220789804`*^9, 3.8951052273421803`*^9}, {
  3.9175515949385395`*^9, 
  3.917551599351841*^9}},ExpressionUUID->"cca22269-7b95-4f97-9e59-\
69eedcbd9982"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cpXISO", "[", 
    RowBox[{
    "Tmat_", ",", "contours_", ",", "MaxForScaling_", ",", "MinForScaling_"}],
     "]"}], ":=", 
   RowBox[{"cpXISO", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1", ",", "Tmat", ",", 
     "contours", ",", "MaxForScaling", ",", "MinForScaling"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9093504453135967`*^9, 3.9093504721912303`*^9}, 
   3.909350508256156*^9},
 CellLabel->
  "In[3560]:=",ExpressionUUID->"8654f462-7fa3-414f-9d93-6daeedacbce3"],

Cell["\<\
For eye. Hemisphere. Contour curves and shaded regions are separate. 
Now in file AA_ContourPlotsOnHemisphere:
Plot in the plane.  Contour curves only, no shading.
Plot on sphere.  Contour curves only, no shading  With center and BBrad.
Plot in the plane.  No contour curves, just shading.
Plot on sphere.  No contour curves, just shading.  With center and BBrad.
Plot on sphere.  Contour curves only, no shading.  With center and BBrad. \
\>", "Subsubsection",
 CellChangeTimes->{{3.885961143764316*^9, 3.885961154064952*^9}, {
  3.886002435794151*^9, 3.886002462886235*^9}, {3.917523825089803*^9, 
  3.917523888140909*^9}, {3.917523932842225*^9, 
  3.9175239692507944`*^9}},ExpressionUUID->"6e200428-3cef-438a-8de8-\
e1e9051efa9a"],

Cell["GraphicsToShowRotOnT and GraphicsToShowRotOnS", "Subsection",
 CellChangeTimes->{{3.8912674455337143`*^9, 
  3.891267491733796*^9}},ExpressionUUID->"ebc724e5-63ce-4c9c-b080-\
703261ca1e3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"RotAxis", ",", "x", ",", "y", ",", "z"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotAxis", "[", "U_", "]"}], ":=", 
   RowBox[{
    RowBox[{"RotAxis", "[", "U", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"length", "[", 
             RowBox[{
              RowBox[{"U", ".", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "-", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "2"], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], "\[Equal]", "1"}], ",", 
           RowBox[{"z", "\[GreaterEqual]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8883434078093233`*^9, 3.888343445940884*^9}, {
   3.8883434821893415`*^9, 3.88834351211679*^9}, {3.88834356845046*^9, 
   3.8883435723530283`*^9}, 3.8883436721996517`*^9, {3.8883438476657267`*^9, 
   3.888343867160714*^9}, {3.8911806194208736`*^9, 3.8911806208319798`*^9}, {
   3.8911816136458783`*^9, 3.891181619421794*^9}, {3.8911821895521164`*^9, 
   3.891182201712247*^9}, {3.8911822888855085`*^9, 3.891182293643793*^9}, {
   3.891213622194298*^9, 3.8912136280301266`*^9}},
 CellLabel->
  "In[3561]:=",ExpressionUUID->"2882f5a7-bf58-4181-ba69-ec1182b79236"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GraphicsToShowRotOnT", "[", 
    RowBox[{"U_", ",", "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_"}], 
    "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".01", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.3", 
           RowBox[{"RotAxis", "[", "U", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".008", "]"}], ",", 
       RowBox[{"Hue", "[", 
        RowBox[{".4", ",", "1", ",", ".7"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"arc", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RotAxis", "[", "U", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"arc", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RotAxis", "[", "U", "]"}], ",", 
            RowBox[{"U", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".4", ",", "1", ",", ".5"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "]"}], ",", 
         RowBox[{"Polygon", "/@", 
          RowBox[{"DiskOnSphere", "[", 
           RowBox[{
            RowBox[{"U", ".", "#"}], ",", "AngRadDisk", ",", "ShiftToEye", 
            ",", "eye"}], "]"}]}]}], "}"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.888345973727236*^9, 3.8883460137159433`*^9}, {
   3.8883460646406684`*^9, 3.8883460736682377`*^9}, {3.88834621436003*^9, 
   3.8883462156686068`*^9}, 3.888353726756837*^9, 3.8883537646437902`*^9, {
   3.8884167640027523`*^9, 3.888416766961732*^9}, {3.888440898082176*^9, 
   3.888440899447359*^9}, {3.888440961118741*^9, 3.888440967565853*^9}, {
   3.888441346259759*^9, 3.888441346986512*^9}, {3.888445560865185*^9, 
   3.8884456054108295`*^9}, {3.891147987944391*^9, 3.891147994785697*^9}, {
   3.89114837872803*^9, 3.8911483851820107`*^9}, {3.8911494903633356`*^9, 
   3.8911495203301573`*^9}, {3.891178157677657*^9, 3.8911781810113525`*^9}, 
   3.8911782638367043`*^9, {3.8911782999515257`*^9, 3.8911783470726824`*^9}, 
   3.8914527000271964`*^9, {3.891462913593669*^9, 3.8914629918993673`*^9}, {
   3.8914631764499493`*^9, 3.8914631780969634`*^9}, {3.8933320054068236`*^9, 
   3.893332006221297*^9}, {3.9011201661727724`*^9, 3.901120170112869*^9}, 
   3.9011203486572328`*^9, 3.901120386182428*^9, {3.9011205516712356`*^9, 
   3.901120553724384*^9}, {3.9011205876089725`*^9, 3.9011206029502935`*^9}, {
   3.9011206491341777`*^9, 3.901120674069256*^9}, {3.901120704214822*^9, 
   3.901120718857043*^9}, 3.9147847612744904`*^9, 3.9147959482155075`*^9},
 CellLabel->
  "In[3563]:=",ExpressionUUID->"b6db0598-fd2a-4cfb-95b9-b7b725629b27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GraphicsToShowRotOnS", "[", 
    RowBox[{"U_", ",", "AngRadDisk_", ",", "ShiftToEye_", ",", "eye_"}], 
    "]"}], ":=", 
   RowBox[{"{", "         ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".01", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.3", 
           RowBox[{"RotAxis", "[", "U", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     ",", "   ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
       "since", " ", "the", " ", "rotation", " ", "axis", " ", "should", " ", 
        "not", " ", "change"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".008", "]"}], ",", 
       RowBox[{"Hue", "[", 
        RowBox[{".4", ",", "1", ",", ".7"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"arc", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RotAxis", "[", "U", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"arc", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RotAxis", "[", "U", "]"}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "U", "]"}], ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", 
        RowBox[{".4", ",", "1", ",", ".5"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "]"}], ",", 
         RowBox[{"Polygon", "/@", 
          RowBox[{"DiskOnSphere", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "AngRadDisk", ",",
             "ShiftToEye", ",", "eye"}], "]"}]}]}], "}"}]}], "}"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.888345973727236*^9, 3.8883460137159433`*^9}, {
   3.8883460646406684`*^9, 3.8883460736682377`*^9}, {3.88834621436003*^9, 
   3.8883462156686068`*^9}, 3.888353726756837*^9, 3.8883537646437902`*^9, {
   3.8884164613622503`*^9, 3.8884164842341104`*^9}, {3.888416695101691*^9, 
   3.8884167014256177`*^9}, 3.8884409972158012`*^9, {3.8884413396264668`*^9, 
   3.8884413425929766`*^9}, {3.888445622458227*^9, 3.8884456264952717`*^9}, {
   3.8911484158439693`*^9, 3.8911484427372*^9}, {3.89114917600563*^9, 
   3.8911491844054728`*^9}, {3.8911496004038997`*^9, 3.8911496116470366`*^9}, 
   3.891178539086443*^9, {3.8911786089074464`*^9, 3.8911786327858315`*^9}, {
   3.8911787067633104`*^9, 3.891178730594735*^9}, 3.8911788489914246`*^9, {
   3.8911796320911427`*^9, 3.8911796466014843`*^9}, {3.8911824711150093`*^9, 
   3.8911825606608887`*^9}, 3.8914527241360445`*^9, {3.8933319955549808`*^9, 
   3.8933319986449795`*^9}, {3.901120167114499*^9, 3.9011201691873875`*^9}, 
   3.901120350038721*^9, 3.9011203881802015`*^9, {3.901120552407672*^9, 
   3.901120553082096*^9}, 3.90112059117029*^9, 3.9147847688022013`*^9, 
   3.9147959371972528`*^9},
 CellLabel->
  "In[3564]:=",ExpressionUUID->"0d885f59-8dea-4e24-b2c8-f362a54d008c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UUU", "=", 
   RowBox[{
    RowBox[{"XRot", "[", 
     RowBox[{"10", "Degree"}], "]"}], ".", 
    RowBox[{"ZRot", "[", 
     RowBox[{"20", "Degree"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngRadDisk", "=", 
   RowBox[{"1.75", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShiftToEye", "=", ".02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"GraphicsToShowRotOnT", "[", 
    RowBox[{"UUU", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], "]"}], 
   ",", 
   RowBox[{"ImageSize", "\[Rule]", "100"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "Automatic"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"GraphicsToShowRotOnS", "[", 
    RowBox[{"UUU", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], "]"}], 
   ",", 
   RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8911480814814634`*^9, 3.8911481343561*^9}, {
   3.8911481662242565`*^9, 3.891148203750471*^9}, {3.891148272803308*^9, 
   3.8911482946567893`*^9}, {3.8911484666819553`*^9, 
   3.8911484961177635`*^9}, {3.8911495393388243`*^9, 3.891149586063383*^9}, {
   3.8911784075609684`*^9, 3.8911784141892014`*^9}, {3.8911784497785625`*^9, 
   3.89117846112881*^9}, 3.891178683869029*^9, 3.891178822401636*^9, {
   3.891193178428651*^9, 3.8911931869131436`*^9}, {3.8911932288010297`*^9, 
   3.8911932321412024`*^9}, {3.891193271422954*^9, 3.8911933108247833`*^9}, {
   3.891193391334091*^9, 3.8911934040399632`*^9}, {3.891193446215502*^9, 
   3.891193467565963*^9}, {3.8911934978408394`*^9, 3.89119350166394*^9}, {
   3.9107077526613836`*^9, 3.9107077586926785`*^9}},
 CellLabel->
  "In[3565]:=",ExpressionUUID->"64a32fd5-8bd0-453b-9811-5a733ade9e69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\!\(\*OverscriptBox[\(U\), \(_\)]\)\>\"", ",", "Italic"}],
        "]"}], ",", "\"\<*\>\""}], "]"}], ",", 
    RowBox[{"17", 
     FractionBox["imagesize", "800"]}]}], "]"}], "//", 
  "DisplayForm"}]], "Input",
 CellChangeTimes->{{3.9148062371291823`*^9, 3.9148063119409804`*^9}},
 CellLabel->
  "In[3570]:=",ExpressionUUID->"ac35b6c2-76a7-49b7-8fd3-ec6a726674c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sep", "=", ".95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<P(#,\!\(\*SubscriptBox[\(\[ScriptCapitalV]\), \
\(XISO\)]\)(U))\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"Italic", ",", "15"}], "}"}]}], "]"}], ",", 
      RowBox[{"sep", 
       RowBox[{"{", 
        RowBox[{"0", ",", ".2"}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"SequenceForm", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<P\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", "15.5"}], "}"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(#, \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Italic", ",", "15"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"Bold", ",", "15"}], "}"}]}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<XISO\>\"", ",", "11"}], "]"}]}], "]"}], "//", 
         "DisplayForm"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<( I ))\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Italic", ",", "15"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"sep", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.88679267824571*^9, 3.8867927322086763`*^9}, {
   3.8867927656833115`*^9, 3.8867928535556784`*^9}, {3.886792884308823*^9, 
   3.886792945179528*^9}, {3.8867929870919*^9, 3.886793017759269*^9}, {
   3.8867930667972994`*^9, 3.886793183968342*^9}, {3.886793246070878*^9, 
   3.886793273864728*^9}, {3.8867933053772106`*^9, 3.8867933528716574`*^9}, {
   3.886793405873689*^9, 3.8867934892900877`*^9}, {3.886793560680072*^9, 
   3.8867935671169004`*^9}, {3.8867936157738323`*^9, 
   3.8867936418613625`*^9}, {3.8867938429716806`*^9, 3.886793849970772*^9}, {
   3.886794013231373*^9, 3.886794023446576*^9}, {3.8867941140530744`*^9, 
   3.8867943522896786`*^9}, {3.886794396964602*^9, 3.8867944378043184`*^9}, {
   3.886794470238331*^9, 3.8867946300190363`*^9}, {3.8867946625019217`*^9, 
   3.88679476988408*^9}, {3.8867948707113247`*^9, 3.886794880147646*^9}, {
   3.8867949288243074`*^9, 3.8867949546964054`*^9}, {3.8867951494633036`*^9, 
   3.8867951508069053`*^9}, 3.8912676030266337`*^9, {3.8912676730931587`*^9, 
   3.891267694743249*^9}, 3.8912677727243814`*^9, {3.8914643818963184`*^9, 
   3.8914643829016266`*^9}},
 CellLabel->
  "In[3571]:=",ExpressionUUID->"79599c6a-76ff-421b-9f6c-98b6aaa564df"],

Cell["For easier text placement :", "Subsubsection",
 CellChangeTimes->{{3.8915174576586113`*^9, 
  3.8915174804065356`*^9}},ExpressionUUID->"ee4b650c-a527-45e4-a280-\
e162f5a11b01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xeye", ":=", 
   RowBox[{"unit", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yeye", ":=", 
   RowBox[{"unit", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"eye", ",", "Xeye"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Reye", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"r", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", " ", "Degree"}], "]"}], " ", "Xeye"}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", " ", "Degree"}], "]"}], " ", "Yeye"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.891517491119311*^9, 3.891517701982768*^9}, {
  3.891517962312658*^9, 3.8915179766213894`*^9}},
 CellLabel->
  "In[3573]:=",ExpressionUUID->"6b1fbd57-a04c-4ca9-8e03-dc15ea91190b"],

Cell["\<\
The commutative diagram for hexagonal approximation.
Needs to be modified for the revised legends command and for Mathematica 13.\
\>", "Section",
 CellChangeTimes->{{3.8912678088768826`*^9, 3.8912678373615556`*^9}, {
  3.908469998451088*^9, 3.9084700178943152`*^9}, {3.908572372328066*^9, 
  3.9085723812000875`*^9}},ExpressionUUID->"ded59786-ff54-4f06-8f28-\
643da340a571"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VertOffset", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", ".1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9147982307922463`*^9, 3.9147982486809683`*^9}, {
  3.9147983846843452`*^9, 3.9147983948099165`*^9}},
 CellLabel->
  "In[3576]:=",ExpressionUUID->"b6680e3f-e34c-4f00-b2f3-049dadbff7a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CDdiagramHexApprox", "[", 
   RowBox[{"Tmat_", ",", "U_", ",", "TextUk_", ",", "legends_"}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", ".002", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3.12"}], "}"}], "]"}]}], "}"}], ",", "   ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"fake", " ", "point"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"Inset", "[", 
         RowBox[{"legends", ",", 
          RowBox[{"sep", 
           RowBox[{"{", 
            RowBox[{".1", ",", "0"}], "}"}]}], ",", "Center", ",", "1."}], 
         " ", "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cpMONO", "[", 
             RowBox[{"Tmat", ",", 
              RowBox[{"contoursMONO", "[", "Tmat", "]"}], ",", 
              RowBox[{"MaxForScalingMONO", "[", "Tmat", "]"}], ",", 
              "plotpoints", ",", "contourstyle"}], "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             StyleBox["T",
              FontFamily->"Courier New",
              FontSize->20,
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GraphicsToShowRotOnT", "[", 
                RowBox[{
                "U", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
                "]"}], ",", "\[IndentingNewLine]", "TextUk", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Paxes", "[", 
                RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", 
                 "1", ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", 
                 "ArrowColor"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Boxed", "->", "False"}], ",", 
          RowBox[{"ViewPoint", "->", "eye"}], ",", 
          StyleBox[
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
           FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", "Center", ",", 
        "2.8"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cpMONO", "[", 
             RowBox[{
              RowBox[{"TmatPrime", "[", 
               RowBox[{"Tmat", ",", "U"}], "]"}], ",", 
              RowBox[{"contoursMONO", "[", "Tmat", "]"}], ",", 
              RowBox[{"MaxForScalingMONO", "[", "Tmat", "]"}], ",", 
              "plotpoints", ",", "contourstyle"}], "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             StyleBox[
              RowBox[{"T", "'"}],
              FontFamily->"Courier New",
              FontSize->20,
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", ".004", "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MapEyeward", "[", 
                    RowBox[{
                    RowBox[{"U", ".", "#"}], ",", ".02", ",", "eye"}], "]"}], 
                    "&"}], "/@", "EquatorList"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", ".015", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Point", "[", 
                    RowBox[{"MapEyeward", "[", 
                    RowBox[{"#", ",", ".05", ",", "eye"}], "]"}], "]"}], 
                   "&"}], "/@", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"U", ".", "#"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"SeeOnSphere", "[", 
                    RowBox[{"#", ",", "1", ",", "eye"}], "]"}], "&"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"GraphicsToShowRotOnT", "[", 
                RowBox[{
                "U", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Paxes", "[", 
                RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", 
                 "1", ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", 
                 "ArrowColor"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Boxed", "->", "False"}], ",", 
          RowBox[{"ViewPoint", "->", "eye"}], ",", 
          StyleBox[
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
           FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}]}], ",", "Center", ",", "2.8"}], 
       "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cpMONO", "[", 
             RowBox[{
              RowBox[{"Amat", "[", 
               RowBox[{"Tmat", ",", "U"}], "]"}], ",", 
              RowBox[{"contoursMONO", "[", "Tmat", "]"}], ",", 
              RowBox[{"MaxForScalingMONO", "[", "Tmat", "]"}], ",", 
              "plotpoints", ",", "contourstyle"}], "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             StyleBox["A",
              FontFamily->"Courier New",
              FontSize->20,
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GraphicsToShowRotOnS", "[", 
                RowBox[{
                "U", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Paxes", "[", 
                RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", 
                 "1", ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", 
                 "ArrowColor"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Boxed", "->", "False"}], ",", 
          RowBox[{"ViewPoint", "->", "eye"}], ",", 
          StyleBox[
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
           FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", "Center", ",", "2.8"}], "]"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cpMONO", "[", 
             RowBox[{
              RowBox[{"AmatPrime", "[", 
               RowBox[{"Tmat", ",", "U"}], "]"}], ",", 
              RowBox[{"contoursMONO", "[", "Tmat", "]"}], ",", 
              RowBox[{"MaxForScalingMONO", "[", "Tmat", "]"}], ",", 
              "plotpoints", ",", "contourstyle"}], "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             StyleBox[
              RowBox[{"A", "'"}],
              FontFamily->"Courier New",
              FontSize->20,
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", ".004", "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MapEyeward", "[", 
                    RowBox[{"#", ",", ".02", ",", "eye"}], "]"}], "&"}], "/@",
                    "EquatorList"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"GraphicsToShowRotOnS", "[", 
                RowBox[{
                "U", ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Paxes", "[", 
                RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", 
                 "1", ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", 
                 "ArrowColor"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Boxed", "->", "False"}], ",", 
          RowBox[{"ViewPoint", "->", "eye"}], ",", 
          StyleBox[
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
           FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", "Center", ",", "2.8"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Arrowheads", "[", ".04", "]"}], ",", 
      RowBox[{"Thickness", "[", ".003", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Arrow", "[", 
       RowBox[{
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "  ", "2"}], "}"}], ",", " ", 
           RowBox[{"{", "  ", 
            RowBox[{"2", ",", " ", "2"}], "}"}]}], "}"}]}], ",", "1.5"}], 
       "]"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"from", " ", "T", " ", "to", " ", 
         RowBox[{"T", "'"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Arrow", "[", 
       RowBox[{
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", "  ", 
            RowBox[{"2", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", "1.5"}], "]"}], ",",
       "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"from", " ", "A", " ", "to", " ", 
         RowBox[{"A", "'"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Arrow", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"sep", "  ", "#"}], "-", "VertOffset"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "  ", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", "1.5"}], "]"}], ",",
       "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"from", " ", "T", " ", "to", " ", "A"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Arrow", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"sep", "  ", "#"}], "-", "VertOffset"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{"2", ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", "  ", 
            RowBox[{"2", ",", "  ", "2"}], "}"}]}], "}"}]}], ",", "1.5"}], 
       "]"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"from", " ", 
         RowBox[{"A", "'"}], " ", "to", " ", 
         RowBox[{"T", "'"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"SequenceForm", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<P\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Bold", ",", 
              RowBox[{"19", 
               FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<(#, \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Italic", ",", 
              RowBox[{"17", 
               FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"SubscriptBox", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"Bold", ",", 
                 RowBox[{"18", 
                  FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<XISO\>\"", ",", 
               RowBox[{"13", 
                FractionBox["imagesize", "800"]}]}], "]"}]}], "]"}], "//", 
           "DisplayForm"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<(U))\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Italic", ",", 
              RowBox[{"18", 
               FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2.25"}], "}"}]}]}], "]"}], ",", "   ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"from", " ", "T", " ", "to", " ", 
         RowBox[{"T", "'"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"SequenceForm", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<P\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Bold", ",", 
              RowBox[{"19", 
               FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<(#, \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Italic", ",", 
              RowBox[{"17", 
               FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"SubscriptBox", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"Bold", ",", 
                 RowBox[{"18", 
                  FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<XISO\>\"", ",", 
               RowBox[{"13", 
                FractionBox["imagesize", "800"]}]}], "]"}]}], "]"}], "//", 
           "DisplayForm"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<( I ))\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Italic", ",", 
              RowBox[{"18", 
               FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1.75"}]}], "}"}]}]}], "]"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"from", " ", "A", " ", "to", " ", 
         RowBox[{"A", "'"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"SuperscriptBox", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*OverscriptBox[\(U\), \(_\)]\)\>\"", ",", 
                 "Italic"}], "]"}], ",", "\"\<*\>\""}], "]"}], "//", 
             "DisplayForm"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<\[SmallCircle] # \[SmallCircle] \!\(\*OverscriptBox[\(U\), \
\(_\)]\)\>\"", ",", "Italic"}], "]"}]}], "]"}], ",", 
          RowBox[{"18", 
           FractionBox["imagesize", "800"]}]}], "]"}], ",", 
        "                          ", 
        RowBox[{"sep", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2.55"}], ",", ".1"}], "}"}], "-", "VertOffset"}], 
          ")"}]}]}], "]"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"left", " ", "side", " ", "and", " ", "down"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<\!\(\*OverscriptBox[\(U\), \(_\)]\) \[SmallCircle] # \
\[SmallCircle] \>\"", ",", "Italic"}], "]"}], ",", 
            RowBox[{
             RowBox[{"SuperscriptBox", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*OverscriptBox[\(U\), \(_\)]\)\>\"", ",", 
                 "Italic"}], "]"}], ",", "\"\<*\>\""}], "]"}], "//", 
             "DisplayForm"}]}], "]"}], ",", 
          RowBox[{"18", 
           FractionBox["imagesize", "800"]}]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2.55", ",", "0"}], "}"}], "-", "VertOffset"}], ")"}]}]}],
        "]"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"right", " ", "side", " ", "and", " ", "up"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<T\>\"", ",", "  ", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", 
            RowBox[{"21", 
             FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", ".54"}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<T'\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", 
            RowBox[{"21", 
             FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", "  ", 
          RowBox[{"2", ",", ".54"}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<A\>\"", ",", "  ", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", 
            RowBox[{"21", 
             FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "3.49"}]}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<A'\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", 
            RowBox[{"21", 
             FractionBox["imagesize", "800"]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"sep", 
         RowBox[{"{", " ", 
          RowBox[{"2", ",", 
           RowBox[{"-", "3.49"}]}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]",
      "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imagesize"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8860084303912697`*^9, 3.8860084427025676`*^9}, {
   3.8860085140445023`*^9, 3.8860085413697624`*^9}, {3.886008576818971*^9, 
   3.8860086127387514`*^9}, 3.8860086870115013`*^9, {3.8860090762628727`*^9, 
   3.8860090890749655`*^9}, {3.886009124980941*^9, 3.886009134292441*^9}, {
   3.8860198516267333`*^9, 3.886019952511901*^9}, {3.8860247325859323`*^9, 
   3.8860247911489725`*^9}, {3.886039240815724*^9, 3.8860392711832957`*^9}, {
   3.8860844756224966`*^9, 3.886084486056959*^9}, {3.886084522317395*^9, 
   3.8860845616054573`*^9}, 3.886084595666099*^9, {3.886791493271251*^9, 
   3.886791538439901*^9}, {3.8867916206205025`*^9, 3.88679162266064*^9}, {
   3.886791985259157*^9, 3.8867920094604974`*^9}, {3.8867921234822817`*^9, 
   3.886792174671857*^9}, {3.8867922129167347`*^9, 3.886792300657049*^9}, {
   3.886792471581051*^9, 3.8867924967370815`*^9}, 3.8867926549669666`*^9, {
   3.8867936985289125`*^9, 3.886793836222392*^9}, {3.8867938723277073`*^9, 
   3.8867938908883357`*^9}, {3.8867939983138657`*^9, 3.886793999430421*^9}, {
   3.8867940393355193`*^9, 3.8867940413509307`*^9}, {3.886794098971325*^9, 
   3.8867941004872475`*^9}, {3.8867948124301033`*^9, 3.8867948469647145`*^9}, 
   3.886794990270045*^9, {3.8867950625621223`*^9, 3.886795099933506*^9}, {
   3.886795170526194*^9, 3.8867951719791546`*^9}, {3.8867952259742455`*^9, 
   3.8867952420662594`*^9}, {3.886795275156505*^9, 3.8867952794685326`*^9}, 
   3.8867953625535994`*^9, {3.886795397924823*^9, 3.8867954170477114`*^9}, {
   3.886795450669047*^9, 3.886795482977955*^9}, {3.8880647492791915`*^9, 
   3.8880647502596855`*^9}, {3.8880647896333*^9, 3.888064795896364*^9}, {
   3.8880648673571496`*^9, 3.888064896287841*^9}, {3.8880659943794165`*^9, 
   3.8880660054091806`*^9}, {3.8880673840669155`*^9, 
   3.8880673977623825`*^9}, {3.888067437751833*^9, 3.8880674741727777`*^9}, {
   3.8880681132219963`*^9, 3.8880681414929013`*^9}, {3.888068224764538*^9, 
   3.88806822534755*^9}, {3.88806825910752*^9, 3.888068284411931*^9}, {
   3.888068324912758*^9, 3.8880683308112288`*^9}, {3.888068416092358*^9, 
   3.8880684177526197`*^9}, {3.8880684490858736`*^9, 3.888068451449224*^9}, {
   3.8880686136079082`*^9, 3.888068648487116*^9}, {3.8880687105316086`*^9, 
   3.8880687446632185`*^9}, {3.8880688520581656`*^9, 3.888068855377553*^9}, 
   3.8880691419164543`*^9, {3.888069297271016*^9, 3.888069352080978*^9}, {
   3.8880693965898223`*^9, 3.888069482846977*^9}, {3.888069994400925*^9, 
   3.8880700343677797`*^9}, {3.8880702907674007`*^9, 
   3.8880702931538744`*^9}, {3.88807033785874*^9, 3.8880703391498556`*^9}, 
   3.8880704231094065`*^9, {3.888070477535646*^9, 3.888070478228016*^9}, {
   3.8884160221053267`*^9, 3.8884160237183723`*^9}, 3.888416204891939*^9, {
   3.8884165695608935`*^9, 3.8884165747540708`*^9}, {3.888426856981927*^9, 
   3.8884269136500483`*^9}, 3.8885399596991644`*^9, {3.8911500771099467`*^9, 
   3.891150112510368*^9}, {3.8911942997343454`*^9, 3.8911943225911183`*^9}, {
   3.891207173363381*^9, 3.8912072311579833`*^9}, {3.891207595445288*^9, 
   3.8912075966222935`*^9}, {3.891214102684978*^9, 3.8912141221594057`*^9}, {
   3.8912147726382666`*^9, 3.891214785423089*^9}, {3.8912155124128704`*^9, 
   3.8912155412165747`*^9}, {3.8912160964507303`*^9, 
   3.8912160973666925`*^9}, {3.891464515964396*^9, 3.8914645785324726`*^9}, {
   3.8918909814049096`*^9, 3.891890984686664*^9}, {3.893332221694147*^9, 
   3.8933322248930273`*^9}, {3.8953382444413023`*^9, 
   3.8953382456642694`*^9}, {3.8986116407518983`*^9, 3.898611747950738*^9}, {
   3.8986967309254074`*^9, 3.8986967671049557`*^9}, 3.89869697778137*^9, {
   3.8986987315101876`*^9, 3.8986987405576*^9}, {3.898699812486175*^9, 
   3.898699833042619*^9}, {3.898699867412636*^9, 3.8986998870882874`*^9}, {
   3.898700981775823*^9, 3.898700991291701*^9}, {3.9011218057854595`*^9, 
   3.9011218075129566`*^9}, {3.901121937093886*^9, 3.901121949349045*^9}, {
   3.9011219873072467`*^9, 3.901122049724318*^9}, 3.914786085002543*^9, 
   3.9147861202515726`*^9, {3.914786166684879*^9, 3.9147861930732217`*^9}, 
   3.9147863658066397`*^9, {3.914786775199733*^9, 3.914786785811226*^9}, {
   3.914787477262809*^9, 3.9147874846369996`*^9}, {3.9147877391858797`*^9, 
   3.9147877410003724`*^9}, {3.9147878512820296`*^9, 3.9147878793900633`*^9}, 
   3.9147879582880564`*^9, {3.914788089363035*^9, 3.914788142548831*^9}, 
   3.9147884158340373`*^9, {3.9147885213310013`*^9, 3.9147885369868765`*^9}, {
   3.9147886413077154`*^9, 3.9147886658676*^9}, {3.914788718819476*^9, 
   3.9147887266635256`*^9}, {3.9147887721353817`*^9, 3.914788789544139*^9}, {
   3.914788938095848*^9, 3.914788947532345*^9}, 3.9147890174787498`*^9, {
   3.914789504334713*^9, 3.914789514287324*^9}, {3.914789550191374*^9, 
   3.914789557864439*^9}, {3.9147896458282447`*^9, 3.9147896962315445`*^9}, 
   3.9147949242264433`*^9, 3.9147949716141567`*^9, {3.914795011595441*^9, 
   3.9147950140483036`*^9}, {3.914795056796834*^9, 3.9147950631715937`*^9}, 
   3.9147954572626667`*^9, 3.9147956314370213`*^9, {3.9147958506896033`*^9, 
   3.9147958542363796`*^9}, {3.9147961766802673`*^9, 
   3.9147962103004565`*^9}, {3.914796295761347*^9, 3.9147963165693474`*^9}, {
   3.9147966162725897`*^9, 3.914796616819499*^9}, {3.914796653083403*^9, 
   3.914796655426981*^9}, {3.9147966910640655`*^9, 3.914796766694408*^9}, {
   3.9147969132303276`*^9, 3.91479691477704*^9}, {3.914797505112345*^9, 
   3.914797505612286*^9}, {3.914797646544504*^9, 3.914797665671302*^9}, 
   3.9147978956714244`*^9, 3.9147979482936497`*^9, {3.9147980087626395`*^9, 
   3.9147980172066975`*^9}, {3.9147983012699623`*^9, 
   3.9147983398284125`*^9}, {3.914798463105461*^9, 3.9147984738077602`*^9}, {
   3.9147985397336082`*^9, 3.914798542250945*^9}, {3.9147985927462697`*^9, 
   3.914798674877734*^9}, 3.9147987342504063`*^9, {3.9147988155742126`*^9, 
   3.9147988854764013`*^9}, {3.914798922380905*^9, 3.9147989858105907`*^9}, {
   3.9147990437114735`*^9, 3.914799053534793*^9}, {3.9147992053889046`*^9, 
   3.9147992078573723`*^9}, 3.9147992805397253`*^9, {3.9148049538627057`*^9, 
   3.914805055653285*^9}, {3.914806382229192*^9, 3.914806492368983*^9}, {
   3.9148065396642694`*^9, 3.9148065435900073`*^9}, {3.914806609235134*^9, 
   3.914806622425275*^9}, 3.914806672484234*^9, 3.9148067099755497`*^9, {
   3.914806741941536*^9, 3.914806772923188*^9}, {3.914806811388771*^9, 
   3.9148068464794693`*^9}, {3.9148069179417534`*^9, 3.914806919863744*^9}, {
   3.9148074235666094`*^9, 3.9148075031088295`*^9}, {3.9148075588263817`*^9, 
   3.914807631075367*^9}, {3.9148083761909175`*^9, 3.914808380198212*^9}},
 CellLabel->
  "In[3577]:=",ExpressionUUID->"90535a1f-a565-41c7-9d23-da6ba91205cc"],

Cell[TextData[{
 "Hex approximations  X[T, ",
 StyleBox["U",
  FontSlant->"Italic"],
 "] for selected ",
 StyleBox["U",
  FontSlant->"Italic"],
 ".  See file BC_July16_MONOetc for an example. It was tested 2024-05-18 for \
the Wolfram notebook.\nMaxForScaling is no longer inputs.  Now tkns, \
plotpoints, and contourstyle ARE inputs. \nNow it is for whole spheres, not \
hemispheres.\nAn error with the ball at 001 m",
 StyleBox["e",
  FontWeight->"Normal"],
 "ans that UswapVandK has somehow been overwritten. Clear UswapVandK and \
reenter it."
}], "Subsection",
 CellChangeTimes->{{3.898625648666299*^9, 3.898625710250999*^9}, {
   3.8986271713574333`*^9, 3.8986271786276565`*^9}, {3.898697143685955*^9, 
   3.898697154796201*^9}, {3.898701101035601*^9, 3.898701121234682*^9}, 
   3.8987011555357885`*^9, {3.9009630532188463`*^9, 3.9009630654919147`*^9}, 
   3.904312162221569*^9, {3.909353258455168*^9, 3.909353273016906*^9}, {
   3.909353322644635*^9, 3.909353350059346*^9}, {3.910380715524726*^9, 
   3.910380755201988*^9}, {3.914678932763532*^9, 3.9146789604862456`*^9}, {
   3.9250738416298013`*^9, 
   3.9250738866864014`*^9}},ExpressionUUID->"8c21c4a9-6b7f-4f00-a0dd-\
ba46b8267e9b"],

Cell[BoxData[
 RowBox[{"Modify", " ", 
  FractionBox["imagesize", "600"], " ", "as", " ", 
  "needed"}]], "Subsubsection",
 CellChangeTimes->{{3.9146882513970585`*^9, 3.9146882726887608`*^9}},
 FontFamily->"Source Sans Pro",
 FontWeight->"Normal",ExpressionUUID->"1ef1f2f5-5e42-46ca-a53c-430683b9d110"],

Cell[BoxData[
 RowBox[{"Clear", "[", "HexApproxDiagram", "]"}]], "Input",
 CellChangeTimes->{{3.9093551842623167`*^9, 3.909355193416321*^9}},
 CellLabel->
  "In[3578]:=",ExpressionUUID->"0fb0e76d-27e5-47a4-b04f-0e6b5f959a4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HexApproxDiagram", "[", 
   RowBox[{
   "Tmat_", ",", "Ulist_", ",", "eye_", ",", "axis_", ",", "BBrad_", ",", 
    "LegendsHeading_", ",", "LegendsCenter_", ",", "LegendsSize_", ",", 
    "tkns_", ",", "plotpoints_", ",", "contourstyle_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cpMONO", "[", "                ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "           ", "1", 
       ",", "                       ", "Tmat", "         ", ",", 
       RowBox[{"contours", "[", 
        RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", 
       RowBox[{"MaxForScaling", "[", 
        RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", "plotpoints", ",", 
       "contourstyle"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"cpMONO", "[", 
        RowBox[{
         RowBox[{"axis", " ", 
          RowBox[{"#", ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", " ", "BBrad", 
         ",", 
         RowBox[{"TmatPrime", "[", 
          RowBox[{"Tmat", ",", "#"}], "]"}], ",", 
         RowBox[{"contours", "[", 
          RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", 
         RowBox[{"MaxForScaling", "[", 
          RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", "plotpoints", ",", 
         "contourstyle"}], "]"}], "&"}], "/@", "Ulist"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          StyleBox["True",
           FontColor->RGBColor[1, 0, 0]], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            StyleBox[
             RowBox[{"legends", "[", 
              RowBox[{
               RowBox[{"contours", "[", 
                RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", 
               RowBox[{"MaxForScaling", "[", 
                RowBox[{"Tmat", ",", "MONO"}], "]"}], ",", "LegendsHeading", 
               ",", "hw", ",", "LegendsFontSize", ",", "increment", ",", 
               "offset"}], "]"}],
             FontColor->GrayLevel[0]], ",", "LegendsCenter", ",", "Center", 
            ",", "LegendsSize"}], "]"}]}], "]"}], ",", 
        RowBox[{"(*", " ", 
         StyleBox["Legends",
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Paxes", "[", 
           RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", "1", 
            ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", "ArrowColor"}],
            "]"}]}], "]"}], ",", "  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"axes", " ", "on", " ", "the", " ", "big", " ", "ball"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", ".003", "]"}], ",", 
              RowBox[{"Line", "[", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", ".", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
                 RowBox[{"#", ".", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"axis", "-", "BBrad"}]}], "}"}]}]}], "}"}], 
               "]"}]}], "}"}], ",", "  ", 
            RowBox[{"(*", " ", 
             StyleBox["spokes",
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"TwoFoldGraphics", "[", 
             RowBox[{"XISO", ",", "#", ",", 
              RowBox[{"axis", " ", 
               RowBox[{"#", ".", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", "BBrad", 
              ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye", ",", "tkns", 
              ",", "Black"}], "]"}], ",", " ", 
            RowBox[{"(*", " ", 
             StyleBox[
              RowBox[{"Change", " ", "color", " ", "if", " ", "desired"}],
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"BetaText", "[", 
               RowBox[{"Tmat", ",", "#"}], "]"}], ",", 
              RowBox[{
               RowBox[{"TextCenter", "[", "#", "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", ".14"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"(*", " ", 
             StyleBox["\[Beta]",
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"label", "[", "#", "]"}], "//", "DisplayForm"}], ",", 
              RowBox[{
               RowBox[{"TextCenter", "[", "#", "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", ".14"}], "}"}]}]}], "]"}]}], "  ", 
           RowBox[{"(*", " ", 
            StyleBox[
             RowBox[{"H", ",", " ", "K", ",", " ", "etc"}],
             FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
           "\[IndentingNewLine]", "}"}], "&"}], "/@", "Ulist"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<T\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"Bold", ",", 
              RowBox[{"24", 
               FractionBox["imagesize", "600"]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"1.25", 
           RowBox[{
            RowBox[{"ROT", "[", 
             RowBox[{"ThetaT", ",", 
              RowBox[{"unit", "[", "eye", "]"}]}], "]"}], ".", 
            RowBox[{"unit", "[", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}],
              "]"}]}]}]}], "]"}], ","}], " ", 
       RowBox[{"(*", " ", 
        StyleBox["Tmat",
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       "}"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8986257422943797`*^9, 3.8986257692283893`*^9}, {
   3.8986258099321976`*^9, 3.898625847679948*^9}, {3.8986259242272525`*^9, 
   3.8986259432957087`*^9}, {3.8986260727176228`*^9, 3.8986260847467103`*^9}, 
   3.898626125104846*^9, {3.898626168841819*^9, 3.898626182160399*^9}, {
   3.898626265824712*^9, 3.898626330140317*^9}, {3.8986263782484655`*^9, 
   3.8986264227309704`*^9}, 3.898626562848011*^9, {3.8986267599854107`*^9, 
   3.8986267655974965`*^9}, {3.8986268010525074`*^9, 3.898626804526269*^9}, 
   3.89862706644553*^9, {3.898627114919982*^9, 3.898627137073616*^9}, 
   3.898642115359361*^9, 3.898650473883116*^9, {3.8986968325427847`*^9, 
   3.898696837314599*^9}, {3.898697131579568*^9, 3.89869713496634*^9}, {
   3.8986971665490046`*^9, 3.8986971975765285`*^9}, {3.898700060987229*^9, 
   3.898700088959359*^9}, 3.899298861774933*^9, 3.89929890502343*^9, {
   3.899319850040295*^9, 3.899319851461997*^9}, {3.9005140500781665`*^9, 
   3.9005140517399693`*^9}, {3.9005142821430264`*^9, 
   3.9005142848926806`*^9}, {3.900514792992798*^9, 3.9005147934200163`*^9}, {
   3.9005148286379795`*^9, 3.90051483065372*^9}, 3.9005274174269733`*^9, 
   3.9005276275114484`*^9, {3.900962988891468*^9, 3.9009629922202697`*^9}, {
   3.900963042921424*^9, 3.9009630496379433`*^9}, 3.9032226515727386`*^9, {
   3.903222700740672*^9, 3.903222702019617*^9}, {3.9092801921119947`*^9, 
   3.9092802017594566`*^9}, {3.9092803791179733`*^9, 3.909280394971155*^9}, {
   3.9092804845765395`*^9, 3.909280486413316*^9}, 3.909280614043908*^9, {
   3.9093515307654204`*^9, 3.90935155966362*^9}, {3.9093515919905295`*^9, 
   3.9093516748002453`*^9}, {3.909351765670968*^9, 3.909351767181122*^9}, {
   3.9093527024162045`*^9, 3.909352724899507*^9}, {3.909352865923012*^9, 
   3.9093528666773186`*^9}, {3.909353562826964*^9, 3.90935356760507*^9}, {
   3.909353641615769*^9, 3.9093536447532964`*^9}, {3.909353792902627*^9, 
   3.90935380830062*^9}, {3.909353852347828*^9, 3.9093538575221615`*^9}, {
   3.9093539284301014`*^9, 3.909353929780295*^9}, 3.909355100102474*^9, {
   3.909355199475211*^9, 3.9093552174799623`*^9}, 3.9093553467572265`*^9, {
   3.909443047956025*^9, 3.9094430840787735`*^9}, {3.909502985135621*^9, 
   3.9095030222707663`*^9}, {3.9095031679443364`*^9, 
   3.9095031844546623`*^9}, {3.9103681328326597`*^9, 
   3.9103681559523706`*^9}, {3.9103682912558093`*^9, 3.9103682923717966`*^9}, 
   3.9103683682364244`*^9, {3.9103685609181366`*^9, 3.9103685675784945`*^9}, {
   3.910369442778201*^9, 3.910369451641184*^9}, {3.9142084208416643`*^9, 
   3.9142084226169567`*^9}, {3.9144286784195056`*^9, 
   3.9144287211273375`*^9}, {3.914624295244089*^9, 3.914624312610656*^9}, {
   3.9146787906822977`*^9, 3.914678802636196*^9}, {3.914678833190709*^9, 
   3.914678834962104*^9}, {3.914678874438223*^9, 3.9146788816751547`*^9}, 
   3.9146835449155045`*^9, {3.914688183422727*^9, 3.9146881987547274`*^9}, 
   3.9147048258158283`*^9, {3.9147051529808865`*^9, 3.9147051546813807`*^9}, {
   3.9147248827911935`*^9, 3.9147248856486073`*^9}, {3.914726343584895*^9, 
   3.914726358410917*^9}, 3.9147793699683027`*^9, {3.9147795147245564`*^9, 
   3.9147795153971467`*^9}, {3.914779586345811*^9, 3.914779608861602*^9}, {
   3.914779690633219*^9, 3.91477970988524*^9}, {3.9147827243959255`*^9, 
   3.914782725615282*^9}, {3.9147827849820943`*^9, 3.9147827869668503`*^9}, {
   3.9147829168286943`*^9, 3.914782917703494*^9}, {3.9148513071862745`*^9, 
   3.9148513236637683`*^9}, {3.9148513577901864`*^9, 3.914851392626322*^9}, {
   3.9148610869372563`*^9, 3.9148610896251245`*^9}, {3.914862467437045*^9, 
   3.9148624697944736`*^9}, 3.9148925916011767`*^9, {3.9250724612925835`*^9, 
   3.9250724987752323`*^9}, {3.9250726068216033`*^9, 
   3.9250726138101482`*^9}, {3.925072662147579*^9, 3.9250726629961557`*^9}, 
   3.925073320866294*^9, {3.9250734181757097`*^9, 3.925073418433414*^9}, {
   3.925073454389125*^9, 3.9250734545463333`*^9}, {3.925073508229611*^9, 
   3.9250735099888377`*^9}, 3.925073667817892*^9, {3.9250737227947063`*^9, 
   3.9250737246718283`*^9}, {3.926793188773675*^9, 3.9267932075537663`*^9}},
 CellLabel->
  "In[3579]:=",ExpressionUUID->"b973c48d-b3fc-484e-a038-a64e1527c774"],

Cell[BoxData[
 RowBox[{
  RowBox[{"axis", "=", ".5"}], ";", 
  RowBox[{"BBrad", "=", "1"}], ";", 
  RowBox[{"tkns", "=", ".004"}], ";"}]], "Input",
 CellChangeTimes->{{3.910449265665946*^9, 3.9104493007502103`*^9}},
 CellLabel->
  "In[3580]:=",ExpressionUUID->"3a9b7ef4-b91f-4cf9-8b1d-99da48bdf098"],

Cell[BoxData[{
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TwoFoldGraphics", "[", 
      RowBox[{"XISO", ",", "#", ",", 
       RowBox[{"axis", " ", 
        RowBox[{"#", ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", "BBrad", ",", 
       RowBox[{
        StyleBox["3",
         FontColor->RGBColor[1, 0, 0]], "AngRadDisk"}], ",", "ShiftToEye", 
       ",", "eye", ",", "tkns", ",", "Green"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"XRot", "[", 
      RowBox[{".01", "Degree"}], "]"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "100"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TwoFoldGraphics", "[", 
      RowBox[{"XISO", ",", "#", ",", 
       RowBox[{"axis", " ", 
        RowBox[{"#", ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", "BBrad", ",", 
       RowBox[{
        StyleBox["3",
         FontColor->RGBColor[1, 0, 0]], "AngRadDisk"}], ",", "ShiftToEye", 
       ",", "eye", ",", "tkns", ",", "Green"}], "]"}], "&"}], "/@", 
    RowBox[{"{", "id", "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.910368668213442*^9, 3.9103687154983783`*^9}, {
  3.910368745637168*^9, 3.9103687942496986`*^9}, {3.9103690337191834`*^9, 
  3.9103690954564843`*^9}, {3.91037013563017*^9, 3.9103701413576355`*^9}, {
  3.9104496849099283`*^9, 3.9104497858216043`*^9}},
 CellLabel->
  "In[3581]:=",ExpressionUUID->"067cfb9a-d257-40aa-a16e-1a0d683725a0"],

Cell[CellGroupData[{

Cell["An ORTH reference matrix with prescribed eigenvalues", "Section",
 CellChangeTimes->{{3.8948905299633026`*^9, 3.8948905709649553`*^9}, {
  3.8955993027263145`*^9, 3.895599304295655*^9}, {3.8956002027962437`*^9, 
  3.8956002042006207`*^9}, {3.9102929383958864`*^9, 3.9102929481177526`*^9}, {
  3.9102931219159126`*^9, 
  3.9102931380577908`*^9}},ExpressionUUID->"4cb167f3-2161-485c-a869-\
bf7300c87ead"],

Cell[CellGroupData[{

Cell["Used to be ORTHmatrix", "Subsubsection",
 CellChangeTimes->{{3.910292878263237*^9, 
  3.910292953389583*^9}},ExpressionUUID->"2faeb7c0-331f-42e7-a18a-\
508bcf6a1483"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "a", ",", "b", ",", "c", ",", "\[Lambda]4", ",", "\[Lambda]5", ",", 
   "\[Lambda]6", ",", "U3"}], "]"}]], "Input",
 CellChangeTimes->{{3.894891052736163*^9, 3.894891076924195*^9}, {
  3.8956003159383693`*^9, 3.8956003259488606`*^9}},
 CellLabel->
  "In[3583]:=",ExpressionUUID->"5e5ea396-6286-479e-bccc-2bb28aed482f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RefMatrixORTH", "[", 
    RowBox[{
    "a_", ",", "b_", ",", "c_", ",", "\[Lambda]4_", ",", "\[Lambda]5_", ",", 
     "\[Lambda]6_", ",", "U3_"}], "]"}], ":=", 
   RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
      "                                                                       \
                                    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"U3", ".", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]4", ",", "\[Lambda]5", ",", "\[Lambda]6"}], 
            "}"}], "]"}], ".", 
          RowBox[{"Transpose", "[", "U3", "]"}]}], "]"}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894814685198121*^9, 3.8948146932999144`*^9}, {
   3.894814767881629*^9, 3.894814850599532*^9}, {3.8948149031123295`*^9, 
   3.8948149079688683`*^9}, {3.894814988647134*^9, 3.8948149934621496`*^9}, {
   3.89481517818291*^9, 3.8948153004101706`*^9}, {3.8948153455833445`*^9, 
   3.8948153675052996`*^9}, {3.894818101463306*^9, 3.8948182827968984`*^9}, {
   3.8948905900138927`*^9, 3.894890607821305*^9}, {3.8948906498403077`*^9, 
   3.894890791750849*^9}, {3.8948908290986333`*^9, 3.8948908883541193`*^9}, {
   3.894890931202524*^9, 3.8948909589375467`*^9}, {3.8948909950534043`*^9, 
   3.894891022241273*^9}, {3.8948911124528556`*^9, 3.894891133335621*^9}, {
   3.895273412871693*^9, 3.8952734376147356`*^9}, {3.8956002268026223`*^9, 
   3.8956003051114674`*^9}, 3.8956010891936398`*^9, {3.895601158920106*^9, 
   3.8956011624226575`*^9}, 3.910292862970332*^9},
 CellLabel->
  "In[3584]:=",ExpressionUUID->"6357b6dd-4d1c-48d6-84fd-e36095d1cc65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rot6", "[", "U3_", "]"}], ":=", 
  RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "         ", 
      RowBox[{"id", ",", "                                          ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
       "              ", "U3"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8952738021092525`*^9, 3.895273872213425*^9}, {
  3.8956004937337637`*^9, 3.895600532200957*^9}, {3.895600567155748*^9, 
  3.895600567736677*^9}, {3.895600917918793*^9, 3.8956009364455633`*^9}, {
  3.9103657399459333`*^9, 3.910365757458002*^9}},
 CellLabel->
  "In[3585]:=",ExpressionUUID->"2c49f53f-1d72-498c-9ba6-45b79e340b37"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "    ", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "   ", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "   ", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U3", "=", "RandomRotation"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8949004994252977`*^9, 3.894900502909546*^9}, 
   3.8949006252044*^9, {3.8952398194733424`*^9, 3.8952398390146914`*^9}, {
   3.895240047564974*^9, 3.895240049444376*^9}, {3.8952412831057773`*^9, 
   3.8952413009933586`*^9}, {3.895241345255352*^9, 3.8952413530231447`*^9}, {
   3.8952413862925324`*^9, 3.8952414117783546`*^9}, 3.895246415772981*^9, 
   3.8952806167708387`*^9, {3.895600818054293*^9, 3.8956008289451146`*^9}, {
   3.9102929879176245`*^9, 3.9102930098347483`*^9}},
 CellLabel->
  "In[3586]:=",ExpressionUUID->"5529a5dc-696b-41be-875e-295896d0cb0b"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "U3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Rot6", "[", "U3", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"RefMatrixORTH", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "\[Lambda]4", ",", "\[Lambda]5", ",", 
    "\[Lambda]6", ",", "U3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8956005812009926`*^9, 3.8956005987000046`*^9}, {
  3.895600689781334*^9, 3.8956006913405676`*^9}, {3.895600843748311*^9, 
  3.895600855910119*^9}, {3.9103657892777667`*^9, 3.91036579639202*^9}, {
  3.9103659428044453`*^9, 3.9103659871176796`*^9}, {3.9103660349501333`*^9, 
  3.910366035781756*^9}},
 CellLabel->
  "In[3593]:=",ExpressionUUID->"707c96da-43ad-4774-a246-4689e6b2468c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenvalueSixTuple", ":=", 
   RowBox[{"{", 
    RowBox[{
    "a", ",", "b", ",", "c", ",", "\[Lambda]4", ",", "\[Lambda]5", ",", 
     "\[Lambda]6"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.910294174959955*^9, 3.9102942223320684`*^9}},
 CellLabel->
  "In[3596]:=",ExpressionUUID->"e0cb3fd9-51d7-47da-b43c-c448e0d2265e"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "a", ",", "b", ",", "c", ",", "\[Lambda]4", ",", "\[Lambda]5", ",", 
   "\[Lambda]6"}], "]"}]], "Input",
 CellChangeTimes->{{3.910294691622125*^9, 3.910294703752909*^9}},
 CellLabel->
  "In[3597]:=",ExpressionUUID->"1108baa9-0fc2-4abc-80dc-100a8f0dcd53"],

Cell[TextData[{
 "Rot6[U3] is an eigenbasis for RefMatrixORTH[a, b, c, \[Lambda]4, \
\[Lambda]5, \[Lambda]6, U3]. That is, the ",
 StyleBox["columns",
  FontSlant->"Italic"],
 " are the eigenvectors."
}], "Subsubsection",
 CellChangeTimes->{{3.910293535322505*^9, 3.910293577499466*^9}, 
   3.910293612961381*^9, {3.91029405872919*^9, 3.9102940778940926`*^9}, {
   3.9102946658655505`*^9, 
   3.910294669048439*^9}},ExpressionUUID->"b24f3289-d98c-4f86-8890-\
a7369aae3717"],

Cell[BoxData[{"EigenvalueSixTuple", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U3", "=", 
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<U3 = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "U3", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Rot6[U3] = \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Rot6", "[", "U3", "]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RefMatrixORTH", "[", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "\[Lambda]4", ",", "\[Lambda]5", ",", 
        "\[Lambda]6", ",", "U3"}], "]"}], ".", 
      RowBox[{"Rot6", "[", "U3", "]"}], ".", 
      RowBox[{"ee", "[", "#", "]"}]}], "==", 
     RowBox[{
      RowBox[{"EigenvalueSixTuple", "[", 
       RowBox[{"[", "#", "]"}], "]"}], " ", 
      RowBox[{
       RowBox[{"Rot6", "[", "U3", "]"}], ".", 
       RowBox[{"ee", "[", "#", "]"}]}]}]}], "]"}], "&"}], "/@", 
  RowBox[{"Range", "[", "6", "]"}]}]}], "Input",
 CellChangeTimes->{{3.910294805777169*^9, 3.910294836701087*^9}, {
  3.9102949033978868`*^9, 3.9102949162836537`*^9}, {3.9103653090040627`*^9, 
  3.91036531693944*^9}, {3.9103653566055374`*^9, 3.9103653578014936`*^9}, {
  3.910365410782988*^9, 3.910365411457677*^9}, {3.910365483238042*^9, 
  3.910365594382811*^9}},
 CellLabel->
  "In[3598]:=",ExpressionUUID->"7c235139-606b-493c-9645-cc85f708e716"],

Cell[CellGroupData[{

Cell["For starting Tmat with MONO symmetry", "Section",
 CellChangeTimes->{{3.8948905299633026`*^9, 
  3.8948905709649553`*^9}},ExpressionUUID->"486ab6b3-51ee-40dd-878b-\
fa615982284c"],

Cell[BoxData[
 RowBox[{"Random4tuple", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{3.8948952812836833`*^9},
 CellLabel->
  "In[3603]:=",ExpressionUUID->"43a90122-53bc-4213-abd8-65d713adfc3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Random4rot", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BasisR4", "=", 
      RowBox[{"{", 
       RowBox[{
       "Random4tuple", ",", "Random4tuple", ",", "Random4tuple", ",", 
        "Random4tuple"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Pre4Rot", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sign", "[", 
         RowBox[{"Det", "[", "BasisR4", "]"}], "]"}]}], 
       RowBox[{"Orthogonalize", "[", "BasisR4", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sign", "[", 
        RowBox[{"Det", "[", "Pre4Rot", "]"}], "]"}]}], 
      RowBox[{"unit", "/@", "Pre4Rot"}]}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8948913381191764`*^9, 3.894891626047409*^9}, {
   3.8948916813256893`*^9, 3.8948917128614635`*^9}, 3.894891764292596*^9, {
   3.894894821613262*^9, 3.8948948302656827`*^9}, {3.894894872328265*^9, 
   3.8948949421334286`*^9}, {3.894895012484337*^9, 3.894895043831674*^9}, {
   3.894895270681119*^9, 3.894895274630392*^9}, 3.894895458553914*^9, {
   3.894895624565653*^9, 3.8948956453655233`*^9}, {3.894895716560388*^9, 
   3.89489572742005*^9}, {3.8948958311547*^9, 3.894895835996955*^9}},
 CellLabel->
  "In[3604]:=",ExpressionUUID->"c9e62d95-d002-4859-8485-f1ddaca58515"],

Cell[BoxData[{
 RowBox[{"test4rot", "=", "Random4rot"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{"test4rot", ".", 
    RowBox[{"Transpose", "[", "test4rot", "]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Det", "[", "test4rot", "]"}]}], "Input",
 CellChangeTimes->{{3.8948916384446836`*^9, 3.894891650732171*^9}, {
   3.8948917003708305`*^9, 3.894891703447027*^9}, {3.894891790688678*^9, 
   3.8948917965121155`*^9}, {3.894895482253473*^9, 3.894895548438681*^9}, {
   3.8948957506363955`*^9, 3.8948957623389096`*^9}, 3.894895801168211*^9, 
   3.8948958471645136`*^9},
 CellLabel->
  "In[3605]:=",ExpressionUUID->"4e4dee53-4ad7-4f5b-aacd-04715fa040c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MONOmatrix", "[", 
    RowBox[{
    "a_", ",", "b_", ",", "\[Lambda]3_", ",", "\[Lambda]4_", ",", 
     "\[Lambda]5_", ",", "\[Lambda]6_", ",", "U2_", ",", "U4_"}], "]"}], ":=", 
   RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"U2", ".", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "]"}], ".", 
         RowBox[{"Transpose", "[", "U2", "]"}]}], ",", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", "0", "0"},
           {"0", "0", "0", "0"}
          }], "\[NoBreak]", ")"}]}], "}"}], ",", 
      "                                                                       \
                                    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0"},
           {"0", "0"},
           {"0", "0"},
           {"0", "0"}
          }], "\[NoBreak]", ")"}], ",", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"U4", ".", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
            "\[Lambda]3", ",", "\[Lambda]4", ",", "\[Lambda]5", ",", 
             "\[Lambda]6"}], "}"}], "]"}], ".", 
          RowBox[{"Transpose", "[", "U4", "]"}]}], "]"}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894814685198121*^9, 3.8948146932999144`*^9}, {
   3.894814767881629*^9, 3.894814850599532*^9}, {3.8948149031123295`*^9, 
   3.8948149079688683`*^9}, {3.894814988647134*^9, 3.8948149934621496`*^9}, {
   3.89481517818291*^9, 3.8948153004101706`*^9}, {3.8948153455833445`*^9, 
   3.8948153675052996`*^9}, {3.894818101463306*^9, 3.8948182827968984`*^9}, {
   3.8948905900138927`*^9, 3.894890607821305*^9}, {3.8948906498403077`*^9, 
   3.894890791750849*^9}, {3.8948908290986333`*^9, 3.8948908883541193`*^9}, {
   3.894890931202524*^9, 3.8948909589375467`*^9}, {3.8948909950534043`*^9, 
   3.894891022241273*^9}, {3.8948911124528556`*^9, 3.894891133335621*^9}, {
   3.920920130573055*^9, 3.920920146114236*^9}, 3.9209202150087004`*^9, 
   3.9209202502845807`*^9, {3.9209203120509667`*^9, 3.9209203178980446`*^9}},
 CellLabel->
  "In[3608]:=",ExpressionUUID->"322ac93e-5375-4600-a967-6f83d2c1c522"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U2", ",", "U4"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U2", "=", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"U4", "=", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"MONOmatrix", "[", 
      RowBox[{
      "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<\[Lambda]3\>\"", ",", 
       "\"\<\[Lambda]4\>\"", ",", "\"\<\[Lambda]5\>\"", ",", 
       "\"\<\[Lambda]6\>\"", ",", "U2", ",", "U4"}], "]"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.920920149414364*^9, 3.920920150419704*^9}, {
  3.9209202994350758`*^9, 3.920920305817973*^9}, {3.9285029252187004`*^9, 
  3.9285029518446345`*^9}, {3.9285030176923027`*^9, 3.928503052707264*^9}, {
  3.9285037614508343`*^9, 3.928503800290393*^9}, {3.9285038304753733`*^9, 
  3.9285039103478575`*^9}},
 CellLabel->
  "In[3609]:=",ExpressionUUID->"03fc057b-9014-4044-8774-4996866d5655"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "a", ",", "b", ",", "\[Lambda]3", ",", " ", "\[Lambda]4", ",", 
     "\[Lambda]5", ",", "\[Lambda]6", ",", "U2", ",", "U4", ",", "Tmat"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"b", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]3", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]4", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]5", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]6", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"U2", "=", 
     RowBox[{"Rot2D", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"U4", "=", "Random4rot"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tmat", "=", 
     RowBox[{"MONOmatrix", "[", 
      RowBox[{
      "a", ",", "b", ",", "\[Lambda]3", ",", "\[Lambda]4", ",", "\[Lambda]5", 
       ",", "\[Lambda]6", ",", "U2", ",", "U4"}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", "Tmat", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Eigenvalues", "[", "Tmat", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949004994252977`*^9, 3.894900502909546*^9}, 
   3.8949006252044*^9, {3.9285026916840415`*^9, 3.9285028279217567`*^9}, 
   3.928503946089779*^9},
 CellLabel->
  "In[3610]:=",ExpressionUUID->"67ef385d-d2e2-46a3-9a62-530b98a7161a"],

Cell["\<\
MDFgraphics. Now has eye as an input, may have to change elsewhere. And \
contours is now an input.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.8860948209432187`*^9, {3.8986117678823757`*^9, 3.8986117871377277`*^9}, {
   3.8986968593547497`*^9, 3.8986968820779495`*^9}, {3.898699725567361*^9, 
   3.898699729113715*^9}},ExpressionUUID->"dd652703-73c7-47a7-8841-\
a69bb9812934"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OLDMDFgraphics", "[", 
   RowBox[{
   "center_", ",", "BBrad_", ",", "Tmat_", ",", "eye_", ",", "contours_", ",",
     "MaxForScaling_", ",", "plotpoints_", ",", "ExtraGraphics_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["   ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{"cpMONOcontoursOnly", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Paxes", "[", 
        RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", "1", 
         ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
        "]"}], ",", "\[IndentingNewLine]", "ExtraGraphics"}], "}"}], "]"}], 
    ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    StyleBox[
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
     FontColor->RGBColor[1, 0, 0]], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8851130046436377`*^9, 3.885113029467578*^9}, 
   3.885113071091058*^9, {3.8851427806277375`*^9, 3.885142859592553*^9}, {
   3.8851696758949347`*^9, 3.885169713106724*^9}, {3.885169824632389*^9, 
   3.885169846741619*^9}, 3.8854201253006244`*^9, {3.885420196984582*^9, 
   3.8854202029236393`*^9}, {3.8854323702369146`*^9, 
   3.8854323710867767`*^9}, {3.8854334715048485`*^9, 
   3.8854334757449474`*^9}, {3.8854335238750005`*^9, 3.885433526120186*^9}, {
   3.885435357095127*^9, 3.885435362553445*^9}, {3.885485539549903*^9, 
   3.885485545409445*^9}, {3.8854866209302807`*^9, 3.8854866320250435`*^9}, {
   3.885487092590778*^9, 3.8854871060984097`*^9}, 3.88548978959958*^9, 
   3.885963705931657*^9, {3.8859641677072287`*^9, 3.885964215615703*^9}, {
   3.8860278739617176`*^9, 3.8860278884586177`*^9}, 3.886027931203431*^9, {
   3.8860281069937754`*^9, 3.886028108241293*^9}, {3.8860374453201227`*^9, 
   3.8860374627705936`*^9}, 3.88603910858936*^9, {3.8866277901139927`*^9, 
   3.886627843137542*^9}, {3.8866410850966964`*^9, 3.886641090780578*^9}, {
   3.890871258935702*^9, 3.890871263702645*^9}, {3.8949280868131747`*^9, 
   3.894928103341728*^9}, 3.8949282290544357`*^9, {3.8949402884834194`*^9, 
   3.8949402897688866`*^9}, 3.8949416484621196`*^9, {3.895037883178206*^9, 
   3.895037886975437*^9}, {3.8968772274846735`*^9, 3.8968772369325905`*^9}, {
   3.8986963990343323`*^9, 3.8986964025868983`*^9}, {3.89869659937827*^9, 
   3.8986966334252195`*^9}, {3.89869970917429*^9, 3.8986997548811836`*^9}, {
   3.9091566792792425`*^9, 3.9091566804108696`*^9}, 3.909159178114092*^9, {
   3.9093498683209457`*^9, 3.909349869216093*^9}},
 CellLabel->
  "In[3611]:=",ExpressionUUID->"538cc135-7386-4be8-98c0-23d67fbe2232"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OLDMDFgraphicsNoPaxes", "[", 
   RowBox[{
   "center_", ",", "BBrad_", ",", "Tmat_", ",", "eye_", ",", "contours_", ",",
     "MaxForScaling_", ",", "plotpoints_", ",", "ExtraGraphics_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["    ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{"cpMONOcontoursOnly", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "ExtraGraphics", "}"}], "]"}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    StyleBox[
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
     FontColor->RGBColor[1, 0, 0]], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8866280429900775`*^9, 3.886628077464938*^9}, 
   3.886641105360939*^9, 3.8949278678856893`*^9, {3.89492825897311*^9, 
   3.8949282658376236`*^9}, {3.894940291745882*^9, 3.894940292436223*^9}, 
   3.8949416499861116`*^9, {3.895037897675191*^9, 3.8950379032433944`*^9}, {
   3.8968772555989647`*^9, 3.8968772609645295`*^9}, {3.898696413113826*^9, 
   3.8986964184044905`*^9}, {3.898696673598717*^9, 3.8986967038999023`*^9}, {
   3.8986996295716*^9, 3.8986996807888985`*^9}, {3.909156686693738*^9, 
   3.9091566876202264`*^9}, 3.909159182083518*^9, {3.909349873518567*^9, 
   3.909349874481221*^9}},
 CellLabel->
  "In[3612]:=",ExpressionUUID->"7829af70-2f55-4f95-b999-159d3ecb38b2"],

Cell[CellGroupData[{

Cell["\<\
These commands modify what are in common_funs.  (From the Igel file)\
\>", "Subsubsection",
 CellChangeTimes->{{3.8996021849975395`*^9, 3.8996022928104744`*^9}, {
  3.899602329261489*^9, 3.8996023445887065`*^9}, {3.899602386972867*^9, 
  3.899602391804528*^9}, {3.9093065177577868`*^9, 3.909306528936284*^9}, {
  3.9093499505281363`*^9, 
  3.909349969664137*^9}},ExpressionUUID->"17e92cd7-e3fc-49c4-aed7-\
ed8deeb5a3d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FROMIGELMDFgraphics", "[", 
   RowBox[{
   "center_", ",", "BBrad_", ",", "Tmat_", ",", "eye_", ",", "contours_", ",",
     "MaxForScaling_", ",", "plotpoints_", ",", "ExtraGraphics_"}], "]"}], ":=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", "        ", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["   ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{"cpMONOcontoursOnly", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Paxes", "[", 
        RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", "1", 
         ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
        "]"}], ",", "\[IndentingNewLine]", "ExtraGraphics"}], "}"}], "]"}], 
    ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    StyleBox[
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
     FontColor->RGBColor[1, 0, 0]], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.909280252570706*^9, 3.9092802685109673`*^9}, {
  3.9093500219077044`*^9, 3.9093500272795525`*^9}},
 CellLabel->
  "In[3613]:=",ExpressionUUID->"bf3ea5df-373b-4c6f-ac52-495abe962320"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MDFgraphics", "[", 
   RowBox[{
   "center_", ",", "BBrad_", ",", "Tmat_", ",", "eye_", ",", "contours_", ",",
     "MaxForScaling_", ",", "ExtraGraphics_"}], "]"}], ":=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", "        ", 
   RowBox[{
    RowBox[{"cpMONOnoContours", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox["   ",
     FontColor->RGBColor[1, 0, 0]], 
    RowBox[{"cpMONOcontoursOnly", "[", 
     RowBox[{
     "center", ",", "BBrad", ",", "Tmat", ",", "contours", ",", 
      "MaxForScaling", ",", "plotpoints", ",", "eye"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Paxes", "[", 
        RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", "1", 
         ",", ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
        "]"}], ",", "\[IndentingNewLine]", "ExtraGraphics"}], "}"}], "]"}], 
    ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    StyleBox[
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
     FontColor->RGBColor[1, 0, 0]], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9093500444325557`*^9, 3.909350053232545*^9}},
 CellLabel->
  "In[3614]:=",ExpressionUUID->"93b21678-9825-49a7-8836-8aaf100aff67"],

Cell["Minimization commands", "Section",
 CellChangeTimes->{{3.8996021849975395`*^9, 3.8996022928104744`*^9}, {
  3.899602329261489*^9, 3.8996023445887065`*^9}, {3.899602386972867*^9, 
  3.899602391804528*^9}, {3.9093065177577868`*^9, 3.909306528936284*^9}, {
  3.9093499505281363`*^9, 3.909349969664137*^9}, {3.921940805690008*^9, 
  3.921940826133083*^9}, {3.921942053734274*^9, 
  3.921942067665615*^9}},ExpressionUUID->"2440f2f4-9287-446b-9d1a-\
55c300fb17e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScriptV", "[", 
    RowBox[{"\[CapitalSigma]_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", "13", ",", "Bold"}], "]"}],
         ",", 
        StyleBox["\[CapitalSigma]",
         FontColor->GrayLevel[0]]}], "]"}], "//", "DisplayForm"}], ",", 
     "\"\<(\>\"", ",", "U", ",", "\"\<)\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScriptT", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SubscriptBox", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\[ScriptCapitalT]\>\"", ",", "Bold"}], "]"}], ",", 
      "\[CapitalSigma]"}], "]"}], "//", "DisplayForm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"text\[Beta]T", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SubsuperscriptBox", "[", 
     RowBox[{"\"\<\[Beta] \>\"", ",", "\[CapitalSigma]", ",", "\"\<T\>\""}], 
     "]"}], "//", "DisplayForm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"textDT", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SubsuperscriptBox", "[", 
     RowBox[{
     "\"\<\!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\) \>\"", ",", 
      "\[CapitalSigma]", ",", "\"\<T\>\""}], "]"}], "//", "DisplayForm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DegreeText", "[", "\[Xi]_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"\[Xi]", ">=", "0"}], ",", 
     SuperscriptBox[
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"\[Xi]", "/", "Degree"}], ",", ".1"}], "]"}], 
      "\"\<\!\(\*StyleBox[\"\[SmallCircle]\",FontWeight->\"Plain\"]\)\>\""], 
     ",", 
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[Xi]", "/", "Degree"}], "]"}], ",", ".1"}], "]"}], 
       "\"\<\[SmallCircle]\>\""]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyRound", "[", 
    RowBox[{"0.", ",", "k_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyRound", "[", 
    RowBox[{"0", ",", "k_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyRound", "[", 
    RowBox[{"x_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "nn", "}"}], ",", 
     RowBox[{
      RowBox[{"nn", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"x", "-", 
            RowBox[{"Floor", "[", "x", "]"}]}], ",", 
           SuperscriptBox["10.", 
            RowBox[{"-", "nn"}]]}], "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"False", ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<k = \>\"", ",", "k", ",", "\"\<, nn = \>\"", ",", "nn", ",", 
             "\"\<, round = \>\"", ",", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"x", "-", 
                RowBox[{"Floor", "[", "x", "]"}]}], ",", 
               SuperscriptBox["10.", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"nn", "+", "k"}], ")"}]}]]}], "]"}]}], "]"}]}], 
          "]"}], ";", 
         RowBox[{"nn", "=", 
          RowBox[{"nn", "+", "1"}]}], ";"}]}], "]"}], ";", 
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{"x", ",", 
          SuperscriptBox["10.", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"nn", "-", "1", "+", "k"}], ")"}]}]]}], "]"}], ",", 
        "9"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9217590611775293`*^9, 3.921759078448926*^9}, 
   3.9217594969199467`*^9, {3.925921246414626*^9, 3.9259212534150276`*^9}},
 CellLabel->
  "In[3615]:=",ExpressionUUID->"be5f639e-e294-4c15-8eb3-8f811f9415b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "nminimize", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nminimize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_", ",", "nSeed_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"nminimize", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nSeed"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "===", "ISO"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
         RowBox[{"Tmat", ",", "id", ",", "ISO"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", "->", "0"}], ",", 
          RowBox[{"\[Sigma]", "->", "0"}], ",", 
          RowBox[{"\[Phi]", "->", "0"}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
           RowBox[{"Tmat", ",", 
            RowBox[{"UsHat", "[", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
             "]"}], ",", "\[CapitalSigma]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
            RowBox[{"2", "\[Pi]"}]}], "&&", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", 
            "\[LessEqual]", "\[Pi]"}], "&&", 
           RowBox[{
           "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<RandomSearch\>\"", ",", 
           RowBox[{"\"\<RandomSeed\>\"", "->", "nSeed"}]}], "}"}]}]}], 
       "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BestSeed", "[", 
     RowBox[{"Tmat_", ",", "\[CapitalSigma]_", ",", "nRuns_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{"nRuns", "-", "1"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"nminimize", "[", 
           RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "#1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<=", 
         RowBox[{
          RowBox[{"nminimize", "[", 
           RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"revised", " ", "2024"}], "-", "08", "-", "26"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nminimize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"nminimize", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", 
     RowBox[{"BestSeed", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nRuns"}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.919870265206219*^9, 3.919870350534449*^9}, {
   3.9198705311220417`*^9, 3.919870538428556*^9}, {3.919871140653344*^9, 
   3.91987120762306*^9}, {3.919950899639089*^9, 3.919950914916088*^9}, {
   3.9199774242954683`*^9, 3.919977426756916*^9}, {3.919991196398712*^9, 
   3.9199911969095025`*^9}, {3.920064147564764*^9, 3.920064151436767*^9}, {
   3.9200644684970226`*^9, 3.920064503391965*^9}, {3.9210758081913023`*^9, 
   3.9210758153678017`*^9}, {3.925600288526909*^9, 3.9256002903208003`*^9}, {
   3.9256003209255095`*^9, 3.925600323326578*^9}, {3.9256004478179536`*^9, 
   3.9256004604585657`*^9}, {3.9256005005501237`*^9, 
   3.9256005171089487`*^9}, {3.925600597302661*^9, 3.9256006647164173`*^9}, 
   3.925601101779214*^9, {3.9256452576204467`*^9, 3.925645262920849*^9}, {
   3.9256463910923176`*^9, 3.9256463925817256`*^9}, {3.92564644435223*^9, 
   3.92564644556067*^9}, 3.9256465367478013`*^9, 3.925646664487537*^9, 
   3.9256595756754923`*^9, {3.9336922148464966`*^9, 3.9336922586024046`*^9}},
 CellLabel->
  "In[3623]:=",ExpressionUUID->"2f195364-f849-47a2-a10a-f820f01afba2"],

Cell["\<\
nminimize[Tmat, \[CapitalSigma]] (above) in principle depends on nRuns, but \
nRuns is not an argument. So nRuns needs to be specified.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9258326533815413`*^9, 3.92583292999899*^9}, {
  3.9258336234118443`*^9, 3.9258337104232206`*^9}, {3.9258337719843445`*^9, 
  3.925833772628107*^9}},ExpressionUUID->"162df65c-bdd9-406b-b65b-\
4d09e084168d"],

Cell["\<\
Likewise, dT[Tmat, \[CapitalSigma]], UT[Tmat, \[CapitalSigma]], Closest[Tmat, \
\[CapitalSigma]], etc, (below) depend on nRuns. 
(In practice there will usually be virtually no dependence, or, in the case \
of UT[Tmat, \[CapitalSigma]], it will be inessential.)\
\>", "Subsubsection",
 CellChangeTimes->{{3.9258326533815413`*^9, 3.92583292999899*^9}, {
  3.9258336234118443`*^9, 3.9258337104232206`*^9}, {3.925833777046679*^9, 
  3.925833815214486*^9}},ExpressionUUID->"696bc5d5-1a9b-4d58-b71b-\
75c836027326"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChopT", "=", 
    RowBox[{"0.01", "Degree"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"ChopT", " ", "can", " ", "be", " ", "changed"}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dT", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"nminimize", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UT", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"UsHat", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"nminimize", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Closest", "[", 
     RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{"Tmat", ",", 
      RowBox[{"UT", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
      "\[CapitalSigma]"}], "]"}]}], " ", ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]Tinitial", "[", 
     RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
    RowBox[{"ArcSin", "[", 
     FractionBox[
      RowBox[{"dT", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]T", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"\[Beta]Tinitial", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "ChopT"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9217590822726493`*^9, 3.921759125188692*^9}, {
  3.921759234591434*^9, 3.9217592622836604`*^9}, {3.9217594574580374`*^9, 
  3.921759461811508*^9}, {3.9219411871019926`*^9, 3.921941254492282*^9}, {
  3.921941292767275*^9, 3.9219413155445805`*^9}, {3.9258299265764427`*^9, 
  3.9258299316154146`*^9}, {3.9258300369746017`*^9, 3.925830037789821*^9}},
 CellLabel->
  "In[3627]:=",ExpressionUUID->"b144efd7-b2d1-46e6-ac85-a0ed95e2efa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Sigma]\[Phi]", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
      RowBox[{
       RowBox[{"nminimize", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ";"}]], "Input",
 CellLabel->
  "In[3633]:=",ExpressionUUID->"ee308d0e-134d-4312-ab19-9c094f61a4e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Deg", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "\[Theta]", "]"}], ";", 
     RowBox[{"DegreeText", "[", 
      RowBox[{"(", 
       RowBox[{"\[Theta]", "/.", 
        RowBox[{
         RowBox[{"nminimize", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[3634]:=",ExpressionUUID->"1ccdb220-fb4e-40a1-b358-e842c581273c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]Deg", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "\[Sigma]", "]"}], ";", 
     RowBox[{"DegreeText", "[", 
      RowBox[{"(", 
       RowBox[{"\[Sigma]", "/.", 
        RowBox[{
         RowBox[{"nminimize", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[3635]:=",ExpressionUUID->"ad541482-34c2-4063-94ea-669c16bca9bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]Deg", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "\[Phi]", "]"}], ";", 
     RowBox[{"DegreeText", "[", 
      RowBox[{"(", 
       RowBox[{"\[Phi]", "/.", 
        RowBox[{
         RowBox[{"nminimize", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ")"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[3636]:=",ExpressionUUID->"de90d7fd-9b84-463f-86ca-c47e913348e9"],

Cell["\<\
Same but for nmaximize. Note that Farthest[Tmat, \[CapitalSigma]] is not what \
it sounds like.\
\>", "Subsubsection",
 CellChangeTimes->{
  3.8860948209432187`*^9, {3.8986117678823757`*^9, 3.8986117871377277`*^9}, {
   3.8986968593547497`*^9, 3.8986968820779495`*^9}, {3.898699725567361*^9, 
   3.898699729113715*^9}, {3.9219421251352634`*^9, 3.921942141477101*^9}, {
   3.930005388560678*^9, 3.9300054007905316`*^9}, {3.9300057614214993`*^9, 
   3.930005778608038*^9}},ExpressionUUID->"3e090d23-622e-4360-8eeb-\
70f7342b072e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "nmaximize", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_", ",", "nSeed_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"nmaximize", "[", 
     RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nSeed"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "===", "ISO"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
         RowBox[{"Tmat", ",", "id", ",", "ISO"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", "->", "0"}], ",", 
          RowBox[{"\[Sigma]", "->", "0"}], ",", 
          RowBox[{"\[Phi]", "->", "0"}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"NMaximize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
           RowBox[{"Tmat", ",", 
            RowBox[{"UsHat", "[", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
             "]"}], ",", "\[CapitalSigma]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
            RowBox[{"2", "\[Pi]"}]}], "&&", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", 
            "\[LessEqual]", "\[Pi]"}], "&&", 
           RowBox[{
           "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<RandomSearch\>\"", ",", 
           RowBox[{"\"\<RandomSeed\>\"", "->", "nSeed"}]}], "}"}]}]}], 
       "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BestSeedForNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_", ",", "nRuns_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"nRuns", "-", "1"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"nmaximize", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "#1"}], "]"}], ">=", 
        RowBox[{"nmaximize", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "#2"}], "]"}]}], 
       "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"nmaximize", "[", 
    RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", 
     RowBox[{"BestSeedForNmaximize", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nRuns"}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.919870265206219*^9, 3.919870350534449*^9}, {
   3.9198705311220417`*^9, 3.919870538428556*^9}, {3.919871140653344*^9, 
   3.91987120762306*^9}, {3.919950899639089*^9, 3.919950914916088*^9}, {
   3.9199774242954683`*^9, 3.919977426756916*^9}, {3.919991196398712*^9, 
   3.9199911969095025`*^9}, {3.920064147564764*^9, 3.920064151436767*^9}, {
   3.9200644684970226`*^9, 3.920064503391965*^9}, {3.9210758081913023`*^9, 
   3.9210758153678017`*^9}, {3.925600288526909*^9, 3.9256002903208003`*^9}, {
   3.9256003209255095`*^9, 3.925600323326578*^9}, {3.9256004478179536`*^9, 
   3.9256004604585657`*^9}, {3.9256005005501237`*^9, 
   3.9256005171089487`*^9}, {3.925600597302661*^9, 3.9256006647164173`*^9}, 
   3.925601101779214*^9, {3.9256452576204467`*^9, 3.925645262920849*^9}, {
   3.9256463910923176`*^9, 3.9256463925817256`*^9}, {3.92564644435223*^9, 
   3.92564644556067*^9}, 3.9256465367478013`*^9, 3.925646664487537*^9, 
   3.9256595756754923`*^9, {3.930005478854698*^9, 3.930005593811824*^9}},
 CellLabel->
  "In[3637]:=",ExpressionUUID->"62981257-ed32-417b-b42c-a92765490da0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dTforNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"nmaximize", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UTforNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"UsHat", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"nmaximize", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Farthest", "[", 
     RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{"Tmat", ",", 
      RowBox[{"UTforNmaximize", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
      "\[CapitalSigma]"}], "]"}]}], " ", ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]TforNmaximize", "[", 
     RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
    RowBox[{"ArcSin", "[", 
     FractionBox[
      RowBox[{"dTforNmaximize", "[", 
       RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], 
      RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.9217590822726493`*^9, 3.921759125188692*^9}, {
  3.921759234591434*^9, 3.9217592622836604`*^9}, {3.9217594574580374`*^9, 
  3.921759461811508*^9}, {3.9219411871019926`*^9, 3.921941254492282*^9}, {
  3.921941292767275*^9, 3.9219413155445805`*^9}, {3.9258299265764427`*^9, 
  3.9258299316154146`*^9}, {3.9258300369746017`*^9, 3.925830037789821*^9}, {
  3.930005442935446*^9, 3.930005469637088*^9}, {3.9300056554446154`*^9, 
  3.930005691847581*^9}, {3.9300057273594894`*^9, 3.9300057364842343`*^9}, {
  3.9300058117457466`*^9, 3.9300058551628804`*^9}, {3.930005899282447*^9, 
  3.9300059089538183`*^9}},
 CellLabel->
  "In[3641]:=",ExpressionUUID->"58dbe49e-dd0a-44db-ae63-a3824166b8ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Sigma]\[Phi]ForNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
      RowBox[{
       RowBox[{"nmaximize", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9300059215459642`*^9, 3.9300059378720493`*^9}, 
   3.930005973836192*^9},
 CellLabel->
  "In[3645]:=",ExpressionUUID->"d02656f0-1484-4e88-8b32-c14624da9868"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]DegForNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "\[Theta]", "]"}], ";", 
     RowBox[{"DegreeText", "[", 
      RowBox[{"(", 
       RowBox[{"\[Theta]", "/.", 
        RowBox[{
         RowBox[{"nmaximize", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.930005961494009*^9, 3.93000599441202*^9}},
 CellLabel->
  "In[3646]:=",ExpressionUUID->"42fee069-93a7-4da4-99b1-6ba6b917eed1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]DegForNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "\[Sigma]", "]"}], ";", 
     RowBox[{"DegreeText", "[", 
      RowBox[{"(", 
       RowBox[{"\[Sigma]", "/.", 
        RowBox[{
         RowBox[{"nmaximize", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9300059860377426`*^9, 3.9300059954276524`*^9}},
 CellLabel->
  "In[3647]:=",ExpressionUUID->"17d49d1a-27f2-4631-a724-1bc23e60df49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]DegForNmaximize", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "[", "\[Phi]", "]"}], ";", 
     RowBox[{"DegreeText", "[", 
      RowBox[{"(", 
       RowBox[{"\[Phi]", "/.", 
        RowBox[{
         RowBox[{"nmaximize", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ")"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.930005987616066*^9, 3.9300059968180256`*^9}},
 CellLabel->
  "In[3648]:=",ExpressionUUID->"4b547a90-8d00-4bda-a9d1-67b3c7e21c2e"],

Cell["MinimizationFacts.  Replaces the old OutputFor.", "Subsubsection",
 CellChangeTimes->{
  3.8860948209432187`*^9, {3.8986117678823757`*^9, 3.8986117871377277`*^9}, {
   3.8986968593547497`*^9, 3.8986968820779495`*^9}, {3.898699725567361*^9, 
   3.898699729113715*^9}, {3.9219421251352634`*^9, 
   3.921942141477101*^9}},ExpressionUUID->"fc07de58-9244-4877-b6c5-\
59a89c686fca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrderG", "[", "TET", "]"}], "=", "16"}], ";"}], 
  "       "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderG", "[", "TRIG", "]"}], "=", "12"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderG", "[", "ORTH", "]"}], "=", 
   RowBox[{
    RowBox[{"OrderG", "[", "CUBE", "]"}], "=", "24"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderG", "[", "MONO", "]"}], "=", 
   RowBox[{
    RowBox[{"OrderG", "[", "XISO", "]"}], "=", 
    RowBox[{
     RowBox[{"OrderG", "[", "ISO", "]"}], "=", 
     RowBox[{
      RowBox[{"OrderG", "[", "TRIV", "]"}], "=", "\[Infinity]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.920997393336131*^9, 3.9209973962109184`*^9}, 
   3.9210180697472672`*^9, {3.921115797906088*^9, 3.921115811986253*^9}},
 CellLabel->
  "In[3649]:=",ExpressionUUID->"81a894a1-ad82-4eb8-8f62-1143ec3d9e9e"],

Cell[BoxData[
 RowBox[{"PrintMatrixNote", "[", "Tmat", "]"}]], "Input",
 CellLabel->
  "In[3653]:=",ExpressionUUID->"65c2b7ed-bdf1-4a06-af13-0fa9c1662217"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NMinimizeMulti", "[", 
   RowBox[{"Tmat_", ",", "\[CapitalSigma]_", ",", "nRuns_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"PrintMatrixNote", "[", "Tmat", "]"}], ",", "\"\<,  \>\"", ",", 
      "\[CapitalSigma]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Minimizing the function (\[Theta], \[Sigma], \[Phi]) \
\!\(\*StyleBox[\"\[LongRightArrow]\",FontSize->14,FontWeight->\"Bold\"]\) \
\!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"(\",FontSize->\
14]\)\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\), \>\"", ",", 
      RowBox[{"ScriptV", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\[CapitalSigma]", ",", "Red", ",", "Bold"}], "]"}], ",", 
        "\"\<\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\>\""}], "]"}], 
      ",", "\"\<\!\(\*StyleBox[\")\",FontSize->14]\), \
\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)= \
\!\(\*SubscriptBox[OverscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \
\"^\"], RowBox[{\"(\", RowBox[{\"\[Theta]\", \",\", \"\[Sigma]\", \",\", \"\
\[Phi]\"}], \")\"}]]\):\>\""}], " ", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<seed\>\"", ",", 
           RowBox[{"textDT", "[", "\[CapitalSigma]", "]"}], ",", 
           RowBox[{"text\[Beta]T", "[", "\[CapitalSigma]", "]"}], ",", 
           "\"\<  \!\(\*SubscriptBox[\(\[Theta]\), \(0\)]\)\>\"", ",", 
           "\"\<  \!\(\*SubscriptBox[\(\[Sigma]\), \(0\)]\)\>\"", ",", 
           "\"\<   \!\(\*SubscriptBox[\(\[Phi]\), \(0\)]\)\>\""}], "}"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
            SuperscriptBox[
             RowBox[{"MyRound", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ArcSin", "[", 
                 FractionBox[
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], 
                  RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}], "/", 
                "Degree"}], ",", "2"}], "]"}], "\"\<\[SmallCircle]\>\""], ",",
             "\[IndentingNewLine]", 
            RowBox[{"PaddedForm", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "/.", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"8", ",", "6"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PaddedForm", "[", 
             RowBox[{
              RowBox[{"\[Sigma]", "/.", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"8", ",", "6"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PaddedForm", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "/.", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2", ",", "3"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"8", ",", "6"}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nSeed", ",", 
             RowBox[{"nminimize", "[", 
              RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nSeed"}], "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSeed", ",", "0", ",", 
             RowBox[{"nRuns", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], "]"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0.00001"}], "]"}], "&"}], 
          "/@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"nminimize", "[", 
             RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nSeed"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"nSeed", ",", "0", ",", 
              RowBox[{"nRuns", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], "]"}], 
       ">", "1"}], ",", 
      RowBox[{
       StyleBox["Print",
        FontColor->GrayLevel[0]], 
       StyleBox["[",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox["Style",
         FontColor->GrayLevel[0]], 
        StyleBox["[",
         FontColor->GrayLevel[0]], 
        RowBox[{
         RowBox[{
          StyleBox["SequenceForm",
           FontColor->GrayLevel[0]], 
          StyleBox["[",
           FontColor->GrayLevel[0]], 
          RowBox[{
           StyleBox["\"\<Minimum values for \>\"",
            FontColor->GrayLevel[0]], 
           StyleBox[",",
            FontColor->GrayLevel[0]], "\[CapitalSigma]", ",", 
           "\"\< are not the same\>\""}], "]"}], ",", "14", ",", "Bold", ",", 
         "Red"}], "]"}], 
       StyleBox["]",
        FontColor->GrayLevel[0]]}]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", "\"\<-------------------------------------------\>\"", 
     "]"}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.925750025935508*^9, 3.925750029621801*^9}, {
  3.925750294214712*^9, 3.925750304245262*^9}, {3.939827368627508*^9, 
  3.9398273969512033`*^9}, {3.9398276871811714`*^9, 3.9398277382404985`*^9}},
 CellLabel->
  "In[3654]:=",ExpressionUUID->"694a287c-b38f-470e-aa69-f907439a8a50"],

Cell[BoxData[
 RowBox[{"Clear", "[", "MinimizationFacts", "]"}]], "Input",
 CellChangeTimes->{{3.9258330945170918`*^9, 3.9258331011699467`*^9}},
 CellLabel->
  "In[3655]:=",ExpressionUUID->"16a3d54d-213b-4541-9d55-1d8c33b927e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MinimizationFacts", "[", 
    RowBox[{"Tmat_", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<nRuns = \>\"", ",", "nRuns", ",", " ", 
       "\"\<  (must have been entered)\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Here seed = \>\"", ",", 
       RowBox[{"BestSeed", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]", ",", "nRuns"}], "]"}], ",", 
       "\"\<. Then (\!\(\*SubscriptBox[\(\[Theta]\), \(0\)]\), \
\!\(\*SubscriptBox[\(\[Sigma]\), \(0\)]\), \!\(\*SubscriptBox[\(\[Phi]\), \(0\
\)]\)) = \>\"", ",", 
       RowBox[{"\[Theta]\[Sigma]\[Phi]", "[", 
        RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "\"\< = \>\"", 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]Deg", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
         RowBox[{"\[Sigma]Deg", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
         RowBox[{"\[Phi]Deg", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}]}], "}"}]}], " ", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \"0\"]\) \
= \!\(\*SubscriptBox[OverscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \"^\
\"], RowBox[{\"(\", RowBox[{SubscriptBox[\"\[Theta]\", \"0\"], \",\", \
SubscriptBox[\"\[Sigma]\", \"0\"], \",\", SubscriptBox[\"\[Phi]\", \"0\"]}], \
\")\"}]]\) = \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"UT", "[", 
           RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], "]"}], "]"}], ",", 
       "\"\<  \!\(\*StyleBox[\"(\",FontSize->16]\)One of at least \>\"", ",", 
       RowBox[{"OrderG", "[", "\[CapitalSigma]", "]"}], ",", "\"\< \>\"", ",",
        "\[CapitalSigma]", ",", 
       "\"\<-minimizers for \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\). It \
minimizes the function  \!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\) \>\"", 
       ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[LongRightArrow]\>\"", " ", ",", "Bold", ",", "14"}], 
        "]"}], ",", 
       "\"\< \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"(\"\
,FontSize->14]\)\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\), \>\"", ",", 
       RowBox[{"ScriptV", "[", 
        RowBox[{
        "\[CapitalSigma]", ",", 
         "\"\<\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\>\""}], "]"}], 
       ",", "\"\<\!\(\*StyleBox[\")\",FontSize->14]\)\!\(\*StyleBox[\")\",\
FontSize->16]\)\>\""}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      StyleBox["minimizer",
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"textDT", "[", "\[CapitalSigma]", "]"}], ",", 
       "\"\< = \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"(\
\",FontSize->14]\)\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\), \
P\!\(\*StyleBox[\"(\",FontSize->12]\)\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"\
]\),\>\"", ",", 
       RowBox[{"ScriptV", "[", 
        RowBox[{
        "\[CapitalSigma]", ",", 
         "\"\<\!\(\*SubscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \
\"0\"]\)\>\""}], "]"}], ",", 
       "\"\<\!\(\*StyleBox[\")\",FontSize->12]\)\!\(\*StyleBox[\")\",FontSize-\
>14]\) = \>\"", ",", 
       RowBox[{"MyRound", "[", 
        RowBox[{
         RowBox[{"dT", "[", 
          RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "3"}], "]"}], 
       ",", "\"\< (Distance between \
\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) and \>\"", ",", 
       RowBox[{"ScriptT", "[", "\[CapitalSigma]", "]"}], ",", "\"\<)\>\""}], 
      "]"}], ";", "  ", 
     RowBox[{"(*", " ", 
      StyleBox["dT",
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"text\[Beta]T", "[", "\[CapitalSigma]", "]"}], ",", 
         "\"\< = \!\(\*SuperscriptBox[\(sin\), \
\(-1\)]\)\!\(\*StyleBox[\"(\",FontSize->16]\)\>\"", ",", 
         RowBox[{"textDT", "[", "\[CapitalSigma]", "]"}], ",", 
         "\"\<\!\(\*StyleBox[\"/\",FontSize->16]\)\>\"", ",", 
         RowBox[{
         "\[LeftBracketingBar]", "\"\<T\>\"", "\[RightBracketingBar]"}], ",", 
         "\"\<\!\(\*StyleBox[\")\",FontSize->16]\)\>\"", ",", "\"\< = \>\"", 
         ",", 
         RowBox[{"MyRound", "[", 
          RowBox[{
           RowBox[{"\[Beta]Tinitial", "[", 
            RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "3"}], 
          "]"}], ",", "\"\< = \>\"", ",", 
         SuperscriptBox[
          RowBox[{"MyRound", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]Tinitial", "[", 
              RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "/", 
             "Degree"}], ",", "2"}], "]"}], "o"], ",", 
         "\"\< (Angle between \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) \
and \>\"", ",", 
         RowBox[{"ScriptT", "[", "\[CapitalSigma]", "]"}], ",", "\"\<)\>\""}],
         "]"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"BETA", ",", " ", 
        RowBox[{"initial", " ", "but", " ", "rounded"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "\[Equal]", "0"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"text\[Beta]T", "[", "\[CapitalSigma]", "]"}], ",", 
          "\"\< = \!\(\*SuperscriptBox[\(sin\), \
\(-1\)]\)\!\(\*StyleBox[\"(\",FontSize->16]\)\>\"", ",", 
          RowBox[{"textDT", "[", "\[CapitalSigma]", "]"}], ",", 
          "\"\<\!\(\*StyleBox[\"/\",FontSize->16]\)\>\"", ",", 
          RowBox[{
          "\[LeftBracketingBar]", "\"\<T\>\"", "\[RightBracketingBar]"}], 
          ",", "\"\<\!\(\*StyleBox[\")\",FontSize->16]\)\>\"", ",", 
          "\"\< = \>\"", ",", 
          RowBox[{"\[Beta]T", "[", 
           RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
          "\"\< (Angle between \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) \
and \>\"", ",", 
          RowBox[{
           RowBox[{"ScriptT", "[", "\[CapitalSigma]", "]"}], ".", " ", 
           "\"\< The initial \>\""}], ",", 
          RowBox[{"text\[Beta]T", "[", "\[CapitalSigma]", "]"}], " ", ",", 
          "\"\< = \>\"", ",", " ", 
          RowBox[{"MyRound", "[", 
           RowBox[{
            RowBox[{"\[Beta]Tinitial", "[", 
             RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", "3"}], 
           "]"}], ",", 
          "\"\< is here chopped to zero, since the chop threshold is set at \
\>\"", ",", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"ChopT", "/", "Degree"}], ")"}], "o"], ",", "\"\<)\>\""}],
          "]"}], ";", "  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"BETA", ",", " ", "chopped"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"SequenceForm", "[", 
          RowBox[{"\"\<Since \>\"", " ", ",", 
           RowBox[{"text\[Beta]T", "[", "\[CapitalSigma]", "]"}], ",", 
           "\"\< = 0, \!\(\*StyleBox[\"T\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"is\",FontColor->RGBColor[1, 0, 0]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"assigned\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"symmetry\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"at\",FontColor->RGBColor[1, 0, 0]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"least\",FontColor->RGBColor[1, 0, 0]]\) \>\"", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\[CapitalSigma]", ",", "Red"}], "]"}], ",", 
           "\"\<.\>\""}], "]"}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "\[Equal]", "0"}], 
       ",", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"ScriptV", "[", 
          RowBox[{
          "\[CapitalSigma]", ",", 
           "\"\<\!\(\*SubscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \"0\
\"]\)\>\""}], "]"}], ",", 
         "\"\< contains \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\)\>\""}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"ScriptV", "[", 
          RowBox[{
          "\[CapitalSigma]", ",", 
           "\"\<\!\(\*SubscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \"0\
\"]\)\>\""}], "]"}], ",", 
         "\"\< contains a closest map to \
\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) in \>\"", ",", 
         RowBox[{"ScriptT", "[", "\[CapitalSigma]", "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ">", "0"}], ",", 
       "   ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"closest", " ", "elastic", " ", "map"}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\!\(\*StyleBox[\"P\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\"(\"\
,FontSize->16]\)\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\), \>\"", ",", 
          RowBox[{"ScriptV", "[", 
           RowBox[{
           "\[CapitalSigma]", ",", 
            "\"\<\!\(\*SubscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \
\"0\"]\)\>\""}], "]"}], ",", "\"\<\!\(\*StyleBox[\")\",FontSize->16]\)= \>\"",
           ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{"Closest", "[", 
              RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "6"}]]}], "]"}], "]"}], ",", 
          "\"\<  \!\(\*StyleBox[\"(\",FontSize->14]\)a closest elastic map to \
\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) having symmetry at least \>\"", 
          ",", "\[CapitalSigma]", ",", 
          "\"\<\!\(\*StyleBox[\")\",FontSize->14]\)\>\""}], "]"}], ";"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "\[CapitalSigma]"}], "]"}], "\[Equal]", "0"}], 
       ",", "   ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"\[CapitalSigma]", "-", 
          RowBox[{"reference", " ", "matrix", " ", "for", " ", "T"}]}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SubscriptBox", "[", 
            RowBox[{"\"\<T\>\"", ",", "\[CapitalSigma]"}], "]"}], "//", 
           "DisplayForm"}], ",", 
          "\"\< = [\!\(\*OverscriptBox[SubscriptBox[StyleBox[\"U\",FontSlant->\
\"Italic\"], \"0\"], \"_\"]\)\!\(\*SuperscriptBox[\(]\), \
\(T\)]\)[\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\)][\!\(\*OverscriptBox[\
SubscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"], \"0\"], \"_\"]\)] = \>\"",
           ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"MatrixUbar", "[", 
                RowBox[{"UT", "[", 
                 RowBox[{"Tmat", ",", 
                  StyleBox["\[CapitalSigma]",
                   FontWeight->"Plain",
                   FontColor->GrayLevel[0]]}], "]"}], "]"}], "]"}], ".", 
              "Tmat", ".", 
              RowBox[{"MatrixUbar", "[", 
               RowBox[{"UT", "[", 
                RowBox[{"Tmat", ",", 
                 StyleBox["\[CapitalSigma]",
                  FontWeight->"Plain",
                  FontColor->GrayLevel[0]]}], "]"}], "]"}]}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "6"}]]}], "]"}], "]"}], ",", 
          "\"\<  (Should be a \>\"", ",", "\[CapitalSigma]", ",", 
          "\"\< ref matrix for \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\). \
If not, consider decreasing ChopT.)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Thus \!\(\*SuperscriptBox[SubscriptBox[\(U\), \(0\)], \(T\)]\) \
will reorient the material so that its symmetry group contains \>\"", ",", 
          RowBox[{
           RowBox[{"SubscriptBox", "[", 
            RowBox[{
            "\"\<\[DoubleStruckCapitalU]\>\"", ",", "\[CapitalSigma]"}], 
            "]"}], "//", "DisplayForm"}]}], " ", "]"}], ";"}]}], "]"}], ";"}],
     ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.838816725963194*^9, 3.838816881281695*^9}, 
   3.8388169161073084`*^9, 3.8388172423383355`*^9, {3.8388174538902965`*^9, 
   3.8388174643868694`*^9}, {3.838817649748008*^9, 3.8388177312967*^9}, 
   3.838817828115161*^9, {3.838818247780265*^9, 3.8388182595232644`*^9}, 
   3.838818461586613*^9, {3.838823975283159*^9, 3.838824013539116*^9}, {
   3.8389054551296883`*^9, 3.838905465509371*^9}, {3.8389054972170954`*^9, 
   3.838905525024954*^9}, {3.838905617068334*^9, 3.83890567171142*^9}, {
   3.838907007015088*^9, 3.838907009281518*^9}, {3.8389253321337857`*^9, 
   3.8389253503897104`*^9}, {3.839074017622334*^9, 3.839074051880118*^9}, {
   3.839074085048066*^9, 3.839074111364107*^9}, {3.8390753702962866`*^9, 
   3.839075416183073*^9}, 3.839075596838152*^9, {3.839075741912668*^9, 
   3.8390757981268835`*^9}, {3.8390758413843603`*^9, 
   3.8390758433669596`*^9}, {3.839075874391024*^9, 3.8390759257843695`*^9}, {
   3.839076253476379*^9, 3.8390763153342743`*^9}, {3.839076585061388*^9, 
   3.8390766000539975`*^9}, {3.839078828521459*^9, 3.8390788323607388`*^9}, 
   3.8398797372343597`*^9, {3.8416740069313283`*^9, 3.8416740149943824`*^9}, {
   3.843143012042697*^9, 3.8431430657834077`*^9}, {3.8431431590783415`*^9, 
   3.8431431825317516`*^9}, {3.843143214021452*^9, 3.843143237196582*^9}, {
   3.843143323484751*^9, 3.8431433344377365`*^9}, 3.8431558687993107`*^9, 
   3.843157297565833*^9, 3.8431575030199633`*^9, {3.8431579272050896`*^9, 
   3.8431580081740217`*^9}, {3.843158320007517*^9, 3.843158321757513*^9}, {
   3.843158394517685*^9, 3.843158396064559*^9}, {3.8432632904925423`*^9, 
   3.8432632951459084`*^9}, {3.843264343034833*^9, 3.843264356987213*^9}, {
   3.8432643871946836`*^9, 3.843264406124892*^9}, {3.843264773516732*^9, 
   3.843264822027796*^9}, 3.8435225800924253`*^9, 3.843525315338416*^9, {
   3.843532629466859*^9, 3.843532633701269*^9}, 3.843533441802493*^9, {
   3.843574850324317*^9, 3.8435748866583214`*^9}, 3.843575524738406*^9, 
   3.843590008010985*^9, {3.8439147973368692`*^9, 3.843914809968131*^9}, {
   3.8439149524091415`*^9, 3.8439149672951336`*^9}, {3.843915064452213*^9, 
   3.8439150925162015`*^9}, 3.8439155299042215`*^9, {3.843915695200239*^9, 
   3.843915780860218*^9}, {3.8439160489082527`*^9, 3.843916101152295*^9}, {
   3.8439161363642635`*^9, 3.8439161380602636`*^9}, {3.8439163108468432`*^9, 
   3.843916329340288*^9}, {3.8439166969893136`*^9, 3.8439166987359877`*^9}, 
   3.843917864082238*^9, 3.8439179200325255`*^9, {3.8439183443245783`*^9, 
   3.8439183893597803`*^9}, 3.84391865081855*^9, 3.843918942240654*^9, 
   3.843919663401228*^9, {3.843920075476799*^9, 3.843920103168639*^9}, {
   3.843920935827218*^9, 3.84392093918467*^9}, {3.843921614004985*^9, 
   3.843921620000994*^9}, 3.8439221105158453`*^9, 3.8439221712650614`*^9, {
   3.8439331613283978`*^9, 3.8439332234272623`*^9}, 3.8439334090784917`*^9, {
   3.8446170235111876`*^9, 3.8446170437287197`*^9}, {3.8446170949303017`*^9, 
   3.8446171181325893`*^9}, {3.844617193587243*^9, 3.8446172302913456`*^9}, {
   3.84461733941376*^9, 3.8446173478769293`*^9}, {3.8446176469697733`*^9, 
   3.8446176512666492`*^9}, 3.8446225759678802`*^9, {3.8446392803451796`*^9, 
   3.8446392978728976`*^9}, 3.8447858493306055`*^9, 3.846945731317214*^9, {
   3.8469458223637075`*^9, 3.846945831865611*^9}, {3.8469461600591164`*^9, 
   3.8469461701564035`*^9}, {3.846946309834462*^9, 3.8469463327757387`*^9}, {
   3.846946387564884*^9, 3.846946392160483*^9}, 3.8469464596766963`*^9, {
   3.846946718902442*^9, 3.84694672457587*^9}, 3.8469469559106183`*^9, {
   3.8469473146764116`*^9, 3.8469473688856516`*^9}, {3.846948603154036*^9, 
   3.8469486298003016`*^9}, {3.846948677652589*^9, 3.846948718223466*^9}, 
   3.846950266371421*^9, {3.8469503219472466`*^9, 3.8469503243065643`*^9}, {
   3.846950468368929*^9, 3.846950469556486*^9}, {3.8469505796090794`*^9, 
   3.8469506207016563`*^9}, {3.846950668691991*^9, 3.84695067524047*^9}, {
   3.8469507369831295`*^9, 3.846950739139336*^9}, {3.846950794518769*^9, 
   3.846950796208602*^9}, {3.8469508602361994`*^9, 3.8469508642525253`*^9}, {
   3.8469513975900817`*^9, 3.8469514123575706`*^9}, 3.846962767060589*^9, 
   3.8469654327244024`*^9, 3.8470061370824575`*^9, 3.847022425267502*^9, 
   3.847027742885198*^9, 3.8470437868119135`*^9, {3.8473815216827283`*^9, 
   3.847381544666728*^9}, 3.847381921577861*^9, {3.847382391449973*^9, 
   3.84738239453885*^9}, {3.847382537260126*^9, 3.8473825398171253`*^9}, {
   3.853519913096917*^9, 3.853519939739993*^9}, {3.853520246066271*^9, 
   3.8535202725525312`*^9}, {3.8535203080075827`*^9, 3.85352031808785*^9}, 
   3.853520462435667*^9, {3.853520509453504*^9, 3.853520513619234*^9}, {
   3.8535205869985514`*^9, 3.853520680550354*^9}, {3.8535207199762774`*^9, 
   3.8535207557506714`*^9}, 3.853520817425362*^9, {3.8535208964464397`*^9, 
   3.8535209385501633`*^9}, {3.8535209990324965`*^9, 
   3.8535210232644377`*^9}, {3.853773404561138*^9, 3.8537734151904616`*^9}, {
   3.853773457129304*^9, 3.8537735029243803`*^9}, {3.853773537948598*^9, 
   3.853773543415995*^9}, {3.8537736502150707`*^9, 3.8537737092202053`*^9}, {
   3.853773749628911*^9, 3.8537737786776886`*^9}, {3.85377382307673*^9, 
   3.853773828219431*^9}, {3.853773905678814*^9, 3.8537739355638285`*^9}, 
   3.853773967211937*^9, {3.853774009151683*^9, 3.853774058597478*^9}, {
   3.8537741639728985`*^9, 3.85377417170465*^9}, {3.853774205258111*^9, 
   3.853774206748891*^9}, {3.8537742803854446`*^9, 3.8537743014703417`*^9}, 
   3.85377437852361*^9, {3.853774503625136*^9, 3.853774531339212*^9}, {
   3.853774748343277*^9, 3.8537747632438617`*^9}, {3.8537748634356823`*^9, 
   3.853774918629639*^9}, 3.8537754638382683`*^9, {3.8537755230157204`*^9, 
   3.8537755253240376`*^9}, {3.8537755637238364`*^9, 3.853775574370835*^9}, 
   3.8537756607880216`*^9, 3.853775716452773*^9, {3.853775818750383*^9, 
   3.8537758311594887`*^9}, {3.8537758898358536`*^9, 3.85377598196447*^9}, {
   3.8537761006846523`*^9, 3.8537761101187754`*^9}, {3.8537761637687387`*^9, 
   3.8537761787611856`*^9}, {3.8537765874854655`*^9, 3.853776630634557*^9}, {
   3.853776834406987*^9, 3.8537768581983604`*^9}, {3.8537769465442653`*^9, 
   3.853776950375338*^9}, {3.8537775258295355`*^9, 3.8537775541936665`*^9}, {
   3.853777593503098*^9, 3.8537776293540344`*^9}, {3.8537777409440193`*^9, 
   3.8537777442162743`*^9}, {3.8631960869404926`*^9, 
   3.8631961016593184`*^9}, {3.863196684215438*^9, 3.863196721259267*^9}, {
   3.8631967617927976`*^9, 3.8631967718357687`*^9}, {3.863197991893715*^9, 
   3.863197997062252*^9}, 3.863198045120901*^9, {3.8632720167851677`*^9, 
   3.8632720254537635`*^9}, {3.8661621415593605`*^9, 3.866162142391141*^9}, {
   3.866162832039361*^9, 3.866162892461954*^9}, {3.8661630804539127`*^9, 
   3.866163089813918*^9}, {3.8661631785259724`*^9, 3.8661632237021384`*^9}, {
   3.8661632687253885`*^9, 3.8661633045644197`*^9}, {3.866163403609968*^9, 
   3.866163483699318*^9}, {3.866163767247197*^9, 3.866163829177126*^9}, 
   3.8661639889374313`*^9, {3.866164091508552*^9, 3.866164193153799*^9}, {
   3.866164533111749*^9, 3.866164553726178*^9}, {3.866164964193658*^9, 
   3.866165057276991*^9}, {3.866212612629837*^9, 3.8662126322391586`*^9}, {
   3.86621266380864*^9, 3.86621269864241*^9}, {3.8662131224808755`*^9, 
   3.866213189853673*^9}, {3.866243046904386*^9, 3.8662430588608546`*^9}, 
   3.866243106619791*^9, {3.8662431649984946`*^9, 3.8662431837863398`*^9}, {
   3.8662432294985237`*^9, 3.8662432676418514`*^9}, {3.866243349431781*^9, 
   3.8662434377417912`*^9}, {3.866243469825283*^9, 3.8662435203952055`*^9}, {
   3.8662435588586273`*^9, 3.8662435602988377`*^9}, {3.8662437804591494`*^9, 
   3.86624378268237*^9}, 3.866243983004033*^9, 3.8662440325884285`*^9, {
   3.866244134248619*^9, 3.8662442053890133`*^9}, {3.8662442416491117`*^9, 
   3.8662442620114274`*^9}, 3.8662524727687054`*^9, 3.8662525366505966`*^9, {
   3.866252634475233*^9, 3.866252635646659*^9}, {3.866292006776153*^9, 
   3.86629201208772*^9}, {3.8662946883325863`*^9, 3.866294693195808*^9}, {
   3.8662947401052833`*^9, 3.8662947419943967`*^9}, {3.866294806364527*^9, 
   3.866294861931617*^9}, {3.8662949715425873`*^9, 3.8662949811623607`*^9}, 
   3.8662950177866964`*^9, {3.866295428751165*^9, 3.8662954557995806`*^9}, {
   3.8662955163280554`*^9, 3.866295526296811*^9}, {3.86629565041005*^9, 
   3.866295661337488*^9}, {3.8662957718374057`*^9, 3.866295774170613*^9}, 
   3.8662958674977493`*^9, 3.866296046073335*^9, {3.8662961671655254`*^9, 
   3.8662961733584137`*^9}, {3.866309679444229*^9, 3.866309683503435*^9}, 
   3.8663779820103188`*^9, {3.8693237560268307`*^9, 3.8693237594762487`*^9}, {
   3.8693243246875873`*^9, 3.869324337937271*^9}, {3.8693243944403706`*^9, 
   3.869324396674507*^9}, {3.8693244799873853`*^9, 3.8693244822432137`*^9}, 
   3.869324600224702*^9, 3.869357385326062*^9, {3.8693586683152637`*^9, 
   3.869358678213606*^9}, 3.869405124805023*^9, {3.8694431734414043`*^9, 
   3.8694432068321047`*^9}, {3.8696647418156047`*^9, 
   3.8696647485932198`*^9}, {3.869690967273942*^9, 3.869690991750859*^9}, {
   3.8696911337110987`*^9, 3.8696911740766315`*^9}, 3.8698364894082346`*^9, {
   3.869836757030467*^9, 3.869836759494525*^9}, {3.8698370705928774`*^9, 
   3.869837230650918*^9}, {3.869838429067793*^9, 3.86983845060013*^9}, 
   3.8698385516117783`*^9, {3.8698390466819906`*^9, 3.8698390894065895`*^9}, {
   3.869839127948627*^9, 3.8698391605066786`*^9}, {3.8698394246040688`*^9, 
   3.8698394589231477`*^9}, {3.8698395760417023`*^9, 
   3.8698395767144184`*^9}, {3.869839720879715*^9, 3.8698397652777305`*^9}, {
   3.869839955022662*^9, 3.86984004398219*^9}, {3.8698402438262815`*^9, 
   3.869840246822686*^9}, {3.8698404679144382`*^9, 3.8698405234155893`*^9}, {
   3.8698406274352493`*^9, 3.8698406532746906`*^9}, {3.8698406975798006`*^9, 
   3.8698406985431194`*^9}, {3.8698407471683264`*^9, 
   3.8698407687268543`*^9}, {3.869840866213728*^9, 3.869840868491741*^9}, {
   3.8698414959051733`*^9, 3.8698415008821487`*^9}, {3.8698553264160666`*^9, 
   3.869855354766505*^9}, {3.8698554059815264`*^9, 3.8698554652317038`*^9}, {
   3.869855704410987*^9, 3.869855728158568*^9}, {3.8698557625949583`*^9, 
   3.8698557699751973`*^9}, {3.869873949862152*^9, 3.869873951108526*^9}, {
   3.8699215248710766`*^9, 3.8699215667468853`*^9}, 3.869921605790045*^9, {
   3.869921784042886*^9, 3.869921803840526*^9}, {3.8699218441725936`*^9, 
   3.8699218873557706`*^9}, {3.8699232595897055`*^9, 3.869923368735633*^9}, {
   3.86992341902102*^9, 3.8699234396915703`*^9}, {3.8699237028481703`*^9, 
   3.8699237404701223`*^9}, {3.869923785521261*^9, 3.8699238048981037`*^9}, 
   3.8699238692342567`*^9, {3.8699239776320715`*^9, 3.8699240553094773`*^9}, {
   3.869924133185952*^9, 3.8699241343535614`*^9}, {3.8699241680495872`*^9, 
   3.869924184196416*^9}, 3.8699242325933423`*^9, {3.8699246266074*^9, 
   3.8699246761936707`*^9}, {3.8699247300250998`*^9, 
   3.8699247609142447`*^9}, {3.8699248277305765`*^9, 
   3.8699248396009665`*^9}, {3.8699250246756554`*^9, 3.869925026898682*^9}, {
   3.869925429745373*^9, 3.869925433975116*^9}, {3.8699255533636136`*^9, 
   3.8699255852084217`*^9}, 3.869925713898408*^9, {3.869925782217394*^9, 
   3.869925786300213*^9}, {3.869925844616621*^9, 3.869925866857355*^9}, {
   3.8699259180365067`*^9, 3.869925936506031*^9}, {3.8700288428862276`*^9, 
   3.8700288597985163`*^9}, 3.8700290602002053`*^9, {3.870029103847274*^9, 
   3.8700291054626293`*^9}, {3.870029299429001*^9, 3.87002930305324*^9}, {
   3.8700295148939013`*^9, 3.8700295426234107`*^9}, {3.8700297969736867`*^9, 
   3.8700298492470818`*^9}, 3.8700299049229703`*^9, {3.8700299390195837`*^9, 
   3.8700299712822948`*^9}, {3.87003001118299*^9, 3.870030016415576*^9}, {
   3.8700301577691517`*^9, 3.870030165021721*^9}, {3.8700302399346027`*^9, 
   3.8700302542700233`*^9}, {3.870030499036725*^9, 3.8700305279508114`*^9}, 
   3.8700305931192875`*^9, {3.8700306543377666`*^9, 3.8700306559206324`*^9}, {
   3.8700307091851835`*^9, 3.8700307136627493`*^9}, {3.8700308158557997`*^9, 
   3.8700308590706577`*^9}, {3.870031076455504*^9, 3.8700311111535797`*^9}, {
   3.870031185475553*^9, 3.870031208754573*^9}, {3.8700312936260505`*^9, 
   3.870031305788394*^9}, {3.8700314408582563`*^9, 3.870031480186172*^9}, {
   3.87003160072513*^9, 3.870031609049426*^9}, {3.8700317226641207`*^9, 
   3.870031752972559*^9}, {3.870031969105568*^9, 3.870031970128969*^9}, {
   3.8700320027197256`*^9, 3.870032079090859*^9}, {3.8700321363336353`*^9, 
   3.870032145703391*^9}, {3.8700322490730963`*^9, 3.8700322672607946`*^9}, {
   3.8700323380976887`*^9, 3.870032339053876*^9}, {3.8700323813404546`*^9, 
   3.87003244643377*^9}, {3.8700324799059277`*^9, 3.8700324867852383`*^9}, {
   3.8700325176823444`*^9, 3.870032519441718*^9}, {3.870032557265401*^9, 
   3.8700325682294436`*^9}, {3.870032612529805*^9, 3.870032641568965*^9}, {
   3.87003267418406*^9, 3.87003270100922*^9}, 3.8700328274721737`*^9, 
   3.8700328763552628`*^9, {3.8700329527551174`*^9, 3.870032966354368*^9}, {
   3.87003904265014*^9, 3.870039066790864*^9}, {3.870039515956051*^9, 
   3.8700395440088916`*^9}, {3.870039579256117*^9, 3.870039624482711*^9}, {
   3.8700396567591095`*^9, 3.8700397828893757`*^9}, {3.8700458596654*^9, 
   3.8700458637557726`*^9}, {3.870190743575161*^9, 3.870190751502466*^9}, {
   3.870190844603297*^9, 3.8701908668934317`*^9}, {3.8701908995106754`*^9, 
   3.870190903559557*^9}, {3.870190936626405*^9, 3.870190984357909*^9}, 
   3.8701910357121887`*^9, 3.870191130609575*^9, {3.8701912074958286`*^9, 
   3.870191219764129*^9}, {3.870191270504241*^9, 3.8701913401571865`*^9}, {
   3.8701913760965257`*^9, 3.870191392566674*^9}, {3.8701914279033628`*^9, 
   3.8701914287185345`*^9}, 3.8701915474420147`*^9, 3.8701915971835227`*^9, 
   3.8701916306997223`*^9, {3.870191706447872*^9, 3.8701917343994894`*^9}, {
   3.8701918473868103`*^9, 3.870191851579156*^9}, {3.870191897551628*^9, 
   3.870191920751834*^9}, {3.8701924137156005`*^9, 3.8701924162971025`*^9}, 
   3.8701924820201206`*^9, {3.870193054513666*^9, 3.870193090288916*^9}, {
   3.8701931687725167`*^9, 3.8701931711532707`*^9}, {3.8701933830394154`*^9, 
   3.8701933846497493`*^9}, 3.8701934168046875`*^9, {3.8701935152007074`*^9, 
   3.8701935209466705`*^9}, {3.8701935986786275`*^9, 3.870193601250058*^9}, 
   3.8701937150759706`*^9, {3.8701938293644495`*^9, 3.870193874514969*^9}, {
   3.8701939118286343`*^9, 3.8701939638089333`*^9}, {3.870194059186431*^9, 
   3.8701940599757786`*^9}, 3.87019409955398*^9, {3.8701941384060154`*^9, 
   3.8701941676506014`*^9}, {3.87020228443091*^9, 3.870202288314335*^9}, {
   3.8702024089961405`*^9, 3.8702024524058247`*^9}, {3.8702025429380474`*^9, 
   3.8702025448549232`*^9}, {3.8702025980271473`*^9, 
   3.8702026351087403`*^9}, {3.870202756863126*^9, 3.870202771051364*^9}, {
   3.8702028108238173`*^9, 3.870202846584079*^9}, 3.8702028964663243`*^9, {
   3.870203146122286*^9, 3.8702031666036863`*^9}, 3.870203197432027*^9, {
   3.8702033165038233`*^9, 3.8702033258647156`*^9}, {3.870203367723144*^9, 
   3.870203387101159*^9}, {3.8702156686577625`*^9, 3.870215695935353*^9}, {
   3.870215773844801*^9, 3.870215806171393*^9}, {3.870216109341428*^9, 
   3.870216111599885*^9}, 3.8702162423698874`*^9, {3.870218895470168*^9, 
   3.870218905955303*^9}, {3.870221856691197*^9, 3.870221863165356*^9}, {
   3.870221924043498*^9, 3.870221938807746*^9}, {3.8702222800585423`*^9, 
   3.8702222822827263`*^9}, {3.87022247825329*^9, 3.870222481353137*^9}, {
   3.8702228692752247`*^9, 3.870222879883388*^9}, {3.870223227450932*^9, 
   3.87022323143506*^9}, 3.870223402137602*^9, {3.870223523374319*^9, 
   3.870223537162284*^9}, {3.870223732028333*^9, 3.87022376170875*^9}, {
   3.8702359082646246`*^9, 3.8702359173283463`*^9}, {3.870236063904454*^9, 
   3.8702360754227853`*^9}, 3.8702361160631504`*^9, {3.870236250770194*^9, 
   3.8702362569846835`*^9}, {3.8702363838640604`*^9, 
   3.8702364657287407`*^9}, {3.870236828319151*^9, 3.870236846803935*^9}, 
   3.8702655604378414`*^9, {3.870265684274582*^9, 3.8702656904840426`*^9}, 
   3.870269013291187*^9, 3.870272128627182*^9, 3.870304322501058*^9, {
   3.870304544583524*^9, 3.870304585939337*^9}, {3.870352848591296*^9, 
   3.870352856561077*^9}, 3.8823253598328114`*^9, {3.882325491176525*^9, 
   3.8823254926639643`*^9}, 3.8823268101849017`*^9, {3.88232723688542*^9, 
   3.882327237933923*^9}, 3.8823273446185055`*^9, {3.8826502693413277`*^9, 
   3.882650283792097*^9}, {3.8826565579952106`*^9, 3.8826565697583704`*^9}, 
   3.8826569373811784`*^9, 3.882657059809675*^9, 3.8887629875980577`*^9, 
   3.890831721686878*^9, {3.894658380919961*^9, 3.8946584085104747`*^9}, {
   3.8946584495110235`*^9, 3.894658451236745*^9}, {3.8946585542318335`*^9, 
   3.8946585917332883`*^9}, {3.8946586285315065`*^9, 3.894658670487064*^9}, {
   3.894658702152189*^9, 3.894658728005437*^9}, {3.894658871684699*^9, 
   3.8946589323624916`*^9}, {3.894658993081773*^9, 3.894658997656893*^9}, {
   3.8946591297472563`*^9, 3.8946591336874304`*^9}, {3.894659200669917*^9, 
   3.894659223047514*^9}, {3.894659402905545*^9, 3.8946594122538805`*^9}, {
   3.8946595037497163`*^9, 3.894659512138602*^9}, {3.8946597213656473`*^9, 
   3.894659792641867*^9}, {3.8946598406891656`*^9, 3.8946598482690897`*^9}, 
   3.8946598958836007`*^9, {3.8946599535799484`*^9, 3.894659988628364*^9}, 
   3.894660053155545*^9, 3.8946600895113325`*^9, {3.8946602264145737`*^9, 
   3.894660330013259*^9}, 3.894660440776046*^9, {3.8947212709564934`*^9, 
   3.894721272655925*^9}, {3.894725441705068*^9, 3.8947254793944187`*^9}, {
   3.8947269403418493`*^9, 3.894726962978783*^9}, 3.894727087370947*^9, 
   3.8947272952339907`*^9, {3.899647609403386*^9, 3.899647610571838*^9}, {
   3.9017207508380213`*^9, 3.901720811612297*^9}, {3.9017208438356647`*^9, 
   3.901720871941019*^9}, {3.9017217353615932`*^9, 3.901721801890558*^9}, {
   3.9018458723802795`*^9, 3.9018459537100296`*^9}, {3.90185320761386*^9, 
   3.901853208619175*^9}, {3.9034832908976803`*^9, 3.903483320908223*^9}, 
   3.9034833736991744`*^9, {3.912448708031815*^9, 3.9124487121589637`*^9}, {
   3.916065435091158*^9, 3.9160654520364037`*^9}, 3.9160654954857807`*^9, {
   3.919872730822861*^9, 3.9198727624483705`*^9}, 3.919872857101797*^9, {
   3.9198742474418874`*^9, 3.9198742958087664`*^9}, 3.9198743367166057`*^9, {
   3.9198748169102306`*^9, 3.919874844711748*^9}, {3.9198749174247656`*^9, 
   3.9198749201695232`*^9}, {3.9198749558667955`*^9, 3.919874977803359*^9}, {
   3.919875021723427*^9, 3.9198750671402802`*^9}, 3.9198763547263403`*^9, {
   3.9198764595222435`*^9, 3.919876470644286*^9}, 3.919876553239705*^9, {
   3.919876824332255*^9, 3.9198768339779663`*^9}, 3.919877192492176*^9, {
   3.9198775231609316`*^9, 3.919877564690759*^9}, {3.919877640171792*^9, 
   3.9198776657418175`*^9}, {3.9198778466067705`*^9, 
   3.9198778632917953`*^9}, {3.9198779189315324`*^9, 3.919877944806435*^9}, {
   3.9198845256064825`*^9, 3.9198845333442545`*^9}, 3.9198845647263784`*^9, {
   3.919884748832617*^9, 3.919884853979357*^9}, 3.919884912891751*^9, {
   3.9198853016937356`*^9, 3.919885306857588*^9}, {3.9198996688815856`*^9, 
   3.9198996912469354`*^9}, {3.919899789872177*^9, 3.9198997980620112`*^9}, 
   3.9199017414110165`*^9, {3.9199589048891287`*^9, 3.9199589069269905`*^9}, {
   3.919958943118724*^9, 3.919958953986609*^9}, {3.920032233590599*^9, 
   3.920032292416273*^9}, 3.9200323397254477`*^9, {3.9200330109312935`*^9, 
   3.9200330183167543`*^9}, 3.920033356867464*^9, 3.920033969205513*^9, 
   3.920036278347126*^9, {3.9200363373035593`*^9, 3.920036368268052*^9}, 
   3.9200377897733803`*^9, {3.92003786962282*^9, 3.9200378790585165`*^9}, {
   3.920038470469822*^9, 3.9200384838970904`*^9}, 3.920038527778472*^9, {
   3.9200414526078644`*^9, 3.9200414804997*^9}, {3.92004164756417*^9, 
   3.9200416483357167`*^9}, {3.920041714940695*^9, 3.9200417376221495`*^9}, {
   3.920041818617612*^9, 3.920041860161476*^9}, {3.920043213176655*^9, 
   3.920043253064906*^9}, 3.9200432970042973`*^9, {3.9200445288241386`*^9, 
   3.920044530081623*^9}, 3.920044561749366*^9, {3.920044636207283*^9, 
   3.9200446378244133`*^9}, {3.9200447269200525`*^9, 3.920044729257948*^9}, {
   3.9200447670798607`*^9, 3.9200447676604695`*^9}, {3.920044855936552*^9, 
   3.9200448597218904`*^9}, {3.9200449597180867`*^9, 3.92004499055359*^9}, 
   3.9200450856180334`*^9, 3.9200451487452707`*^9, {3.920045335009825*^9, 
   3.9200453379671683`*^9}, {3.9200453840645957`*^9, 3.920045393880622*^9}, {
   3.920045499175926*^9, 3.920045567020243*^9}, 3.9200457224775743`*^9, {
   3.920046016430433*^9, 3.9200460657422667`*^9}, 3.9200462476120415`*^9, {
   3.9200570247640676`*^9, 3.920057037240054*^9}, {3.9200571605290394`*^9, 
   3.9200571706884165`*^9}, 3.9200636967345524`*^9, {3.9200651093130474`*^9, 
   3.920065120159813*^9}, {3.920156382517893*^9, 3.9201563994226923`*^9}, 
   3.9201564447751884`*^9, {3.9201585786062746`*^9, 3.920158613534367*^9}, {
   3.9201592476469145`*^9, 3.920159248253484*^9}, {3.9202114585850635`*^9, 
   3.9202114723334484`*^9}, {3.920211581850998*^9, 3.9202115830435047`*^9}, 
   3.9204623485435944`*^9, {3.9204685715317955`*^9, 3.920468572049656*^9}, 
   3.9209947829274497`*^9, 3.920996975236356*^9, {3.920997520666474*^9, 
   3.920997534305768*^9}, {3.9209975680835533`*^9, 3.920997570489476*^9}, 
   3.9209989275111294`*^9, {3.9210022500070157`*^9, 3.921002272565487*^9}, 
   3.921002376932376*^9, {3.9210024614814434`*^9, 3.921002462232097*^9}, {
   3.921019200067915*^9, 3.9210192207155275`*^9}, 3.921068337238341*^9, 
   3.9211136899212937`*^9, 3.9212493509309425`*^9, 3.921250821410216*^9, 
   3.9212509769225054`*^9, {3.921251056868235*^9, 3.9212510768349023`*^9}, {
   3.921251107985222*^9, 3.921251110215375*^9}, {3.921251149083079*^9, 
   3.9212511548882923`*^9}, {3.92125118720864*^9, 3.9212514053324585`*^9}, {
   3.921251882658035*^9, 3.921251894382094*^9}, 3.9213423412031393`*^9, {
   3.9216804189979725`*^9, 3.921680419891608*^9}, 3.9216832816469326`*^9, {
   3.9216847878381805`*^9, 3.9216848827867174`*^9}, {3.9216849135939703`*^9, 
   3.921684941889264*^9}, 3.9216851837556505`*^9, 3.921772087788617*^9, {
   3.9258330441736383`*^9, 3.925833089387698*^9}, {3.925833146583379*^9, 
   3.925833181780527*^9}, {3.925833212032984*^9, 3.9258332122059174`*^9}, {
   3.9258342971400366`*^9, 3.925834298348444*^9}, 3.92583433177141*^9},
 CellLabel->
  "In[3656]:=",ExpressionUUID->"2740f544-96b1-4298-8c47-21608887cfb9"],

Cell["\<\
MinimizationFacts is now defined.  Here are custom versions for \
\[CapitalSigma] = ISO and \[CapitalSigma] =TRIV. 
Remember that these commands are also in ES_FindSymGpsSUPP.nb, which is \
mentioned in the Wolfram notebook.\
\>", "Subsubsection",
 CellChangeTimes->{{3.866252320114276*^9, 3.8662523408671365`*^9}, 
   3.8662524004119167`*^9, 3.869404743723121*^9, {3.8696860194952936`*^9, 
   3.8696860364701614`*^9}, {3.8696893498197913`*^9, 
   3.8696893504888296`*^9}, {3.8702382492049556`*^9, 3.870238252732716*^9}, {
   3.9200636609596014`*^9, 3.9200636620136085`*^9}, {3.9200687519030724`*^9, 
   3.9200687986221075`*^9}, {3.92016262860322*^9, 3.920162629215266*^9}, 
   3.920994825969551*^9, 3.9209970193444276`*^9, 3.9209989709229994`*^9, 
   3.9210192573753767`*^9, 3.9210684308272176`*^9, 3.9211137435815706`*^9, {
   3.9216925963820977`*^9, 3.921692635000409*^9}, {3.9217696379157887`*^9, 
   3.921769638778225*^9}, 3.92193906879162*^9, {3.925260771954402*^9, 
   3.9252607729311333`*^9}, {3.925260807764214*^9, 
   3.925260901841652*^9}},ExpressionUUID->"b4af7e6e-140e-402b-bf53-\
fd655ffa3c0e"],

Cell[CellGroupData[{

Cell["For \[CapitalSigma] = ISO", "Subsubsection",
 CellChangeTimes->{{3.866252561922802*^9, 3.8662526001536655`*^9}, {
   3.869404706669767*^9, 3.869404714656294*^9}, 3.9200636422206964`*^9, {
   3.920158638023493*^9, 3.920158640102857*^9}, {3.9202439774315014`*^9, 
   3.9202439785021377`*^9}, 3.920994827704111*^9, 3.9209970213784747`*^9, 
   3.920998973329099*^9, 3.9210192633987007`*^9, 3.9210684351274934`*^9, 
   3.9211137458697796`*^9, {3.9217696282496305`*^9, 
   3.9217696323915834`*^9}},ExpressionUUID->"42f97059-9759-4d78-8585-\
158f88c2773f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]ofTmatISO", "[", "TmatISO_", "]"}], ":=", 
    RowBox[{"Simplify", "[", 
     FractionBox[
      RowBox[{"TmatISO", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "6"}], "]"}], "]"}], "3"], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"bulk", " ", "modulus"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]ofTmatISO", "[", "TmatISO_", "]"}], ":=", 
    RowBox[{"Simplify", "[", 
     FractionBox[
      RowBox[{"TmatISO", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"shear", " ", "modulus"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]ofTmatISO", "[", "TmatISO_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"TmatISO", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "6"}], "]"}], "]"}], "-", 
      RowBox[{"TmatISO", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "3"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Poisson", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Mu]_"}], "]"}], ":=", 
   FractionBox["\[Lambda]", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]", "+", "\[Mu]"}], ")"}]}]]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PoissonOfTmatISO", "[", "TmatISO_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Poisson", "[", 
     RowBox[{
      RowBox[{"\[Lambda]ofTmatISO", "[", "TmatISO", "]"}], ",", 
      RowBox[{"\[Mu]ofTmatISO", "[", "TmatISO", "]"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8661635536753025`*^9, 3.866163587600415*^9}, {
  3.8661636190094137`*^9, 3.8661637500046263`*^9}, {3.8661638499432306`*^9, 
  3.8661638626934786`*^9}, {3.8662129650671797`*^9, 3.866213047535986*^9}, {
  3.8668179718210998`*^9, 3.8668180018378735`*^9}, {3.869405251908348*^9, 
  3.8694052562471933`*^9}, {3.9180024206304736`*^9, 3.9180024217796326`*^9}, {
  3.9285951368392005`*^9, 3.928595186996812*^9}, {3.9357761938433924`*^9, 
  3.9357762666083994`*^9}},
 CellLabel->
  "In[3657]:=",ExpressionUUID->"585321d7-d1aa-42e6-8a13-02958632d01f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinimizationFacts", "[", 
   RowBox[{"Tmat_", ",", "ISO"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<nRuns = \>\"", ",", "nRuns", ",", " ", 
      "\"\<  (must have been entered)\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[StyleBox[\"\[ScriptCapitalV]\",FontWeight->\"\
Bold\"], \"ISO\"]\)(\!\(\*StyleBox[\"U\",FontWeight->\"Normal\",FontSlant->\"\
Italic\"]\)) = \!\(\*SubscriptBox[\(\[ScriptCapitalV]\), \
\(ISO\)]\)(\!\(\*StyleBox[\"I\",FontWeight->\"Normal\",FontSlant->\"Italic\"]\
\)), independent of \
\!\(\*StyleBox[\"U\",FontWeight->\"Normal\",FontSlant->\"Italic\"]\), so the \
function \!\(\*StyleBox[\"U\",FontWeight->\"Normal\",FontSlant->\"Italic\"]\) \
\>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\[LongRightArrow]\>\"", " ", ",", "Bold", ",", "14"}], 
       "]"}], ",", 
      "\"\< \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)(\!\(\*StyleBox[\"T\"\
,FontWeight->\"Bold\"]\), \!\(\*SubscriptBox[\(\[ScriptCapitalV]\), \
\(ISO\)]\)(\!\(\*StyleBox[\"U\",FontWeight->\"Normal\",FontSlant->\"Italic\"]\
\))) = \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)(\!\(\*StyleBox[\"T\",\
FontWeight->\"Bold\"]\), \
\!\(\*SubscriptBox[StyleBox[\"\[ScriptCapitalT]\",StripOnInput->False,\
FontWeight->Bold], \"ISO\"]\)) is constant.\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"textDT", "[", "ISO", "]"}], ",", 
      "\"\< = \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)(\!\(\*StyleBox[\"\
T\",FontWeight->\"Bold\"]\), \
\!\(\*SubscriptBox[StyleBox[\"\[ScriptCapitalT]\",StripOnInput->False,\
FontWeight->Bold], \"ISO\"]\)) = \>\"", ",", 
      RowBox[{"dT", "[", 
       RowBox[{"Tmat", ",", "ISO"}], "]"}], ",", 
      "\"\<   (Distance from \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) to \
\!\(\*SubscriptBox[StyleBox[\"\[ScriptCapitalT]\",StripOnInput->False,\
FontWeight->Bold], \"ISO\"]\))\>\""}], "]"}], ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox["dT",
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]T", "[", 
        RowBox[{"Tmat", ",", "ISO"}], "]"}], ">", "0"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\!\(\*SubsuperscriptBox[\"\[Beta]\", \"ISO\", \
StyleBox[\"T\",FontSize->9,FontWeight->\"Bold\"]]\) = \>\"", ",", 
        RowBox[{"MyRound", "[", 
         RowBox[{
          RowBox[{"\[Beta]Tinitial", "[", 
           RowBox[{"Tmat", ",", "ISO"}], "]"}], ",", "3"}], "]"}], ",", 
        "\"\< = \>\"", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"MyRound", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]Tinitial", "[", 
              RowBox[{"Tmat", ",", "ISO"}], "]"}], "/", "Degree"}], ",", 
            "2"}], "]"}], ")"}], "o"], ",", 
        "\"\< (Angle between \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) and \
\!\(\*SubscriptBox[StyleBox[\"\[ScriptCapitalT]\",StripOnInput->False,\
FontWeight->Bold], \"ISO\"]\))\>\""}], "]"}]}], "]"}], ";", " ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{"BETA", ",", " ", "initial"}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]T", "[", 
        RowBox[{"Tmat", ",", "ISO"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]Tinitial", "[", 
           RowBox[{"Tmat", ",", "ISO"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<\!\(\*SubsuperscriptBox[\"\[Beta]\", \"ISO\", RowBox[{\"\
\[Placeholder]\", StyleBox[\"T\",FontWeight->\"Bold\"]}]]\) = 0, (Angle \
between \!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) and \
\!\(\*TagBox[SubscriptBox[StyleBox[\"\[ScriptCapitalT]\",StripOnInput->False,\
FontWeight->Bold], \"ISO\"],DisplayForm]\))\>\"", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]Tinitial", "[", 
           RowBox[{"Tmat", ",", "ISO"}], "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<\!\(\*SubsuperscriptBox[\"\[Beta]\", \"ISO\", RowBox[{\"\
\[Placeholder]\", StyleBox[\"T\",FontWeight->\"Bold\"]}]]\) = \>\"", ",", 
           RowBox[{"\[Beta]T", "[", 
            RowBox[{"Tmat", ",", "ISO"}], "]"}], ",", 
           "\"\< (Angle between T and \!\(\*SubscriptBox[StyleBox[\"\
\[ScriptCapitalT]\",StripOnInput->False,FontWeight->Bold], \"ISO\"]\). The \
initial \!\(\*SubsuperscriptBox[\(\[Beta]\), \(ISO\), \(T\)]\) = \>\"", ",", 
           " ", 
           RowBox[{"MyRound", "[", 
            RowBox[{
             RowBox[{"\[Beta]Tinitial", "[", 
              RowBox[{"Tmat", ",", "ISO"}], "]"}], ",", "3"}], "]"}], ",", 
           "\"\< is here chopped to zero, since the chop threshold is set at \
\>\"", ",", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ChopT", "/", "Degree"}], ")"}], "o"], ",", 
           "\"\<)\>\""}], "]"}]}], "]"}], ";", "  ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"BETA", ",", " ", "chopped"}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Since \!\(\*SubsuperscriptBox[\"\[Beta]\", \"ISO\", RowBox[{\"\
\[Placeholder]\", StyleBox[\"T\",FontWeight->\"Bold\"]}]]\) = 0, then \
\!\(\*StyleBox[\"T\",FontColor->RGBColor[1, 0, 0]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"is\",FontColor->RGBColor[1, 0, 0]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"assigned\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\"symmetry\",FontColor->RGBColor[1, 0, \
0]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, 0]]\)\!\(\*StyleBox[\"ISO\
\",FontColor->RGBColor[1, 0, 0]]\)\!\(\*StyleBox[\".\",FontColor->RGBColor[1, \
0, 0]]\)\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]T", "[", 
        RowBox[{"Tmat", ",", "ISO"}], "]"}], ">", "0"}], ",", "   ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"closest", " ", "ISO", " ", "elastic", " ", "map"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\!\(\*StyleBox[\"P\",FontWeight->\"Bold\"]\)(\!\(\*StyleBox[\"T\",\
FontWeight->\"Bold\"]\),\!\(\*SubscriptBox[\(\[ScriptCapitalV]\), \(ISO\)]\)(\
\!\(\*StyleBox[\"I\",FontWeight->\"Normal\",FontSlant->\"Italic\"]\))) = \
\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"1.", 
          RowBox[{"ProjToVSigOfU", "[", 
           RowBox[{"Tmat", ",", "id", ",", 
            StyleBox["ISO",
             FontColor->GrayLevel[0]]}], "]"}]}], "]"}], ",", 
        "\"\<  (The closest elastic map to T having symmetry ISO)\>\""}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]T", "[", 
        RowBox[{"Tmat", ",", "ISO"}], "]"}], ">", "0"}], " ", ",", "        ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"Lame", " ", "parameters", " ", "and", " ", "Poisson"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Lam\[EAcute] parameters for \
\!\(\*StyleBox[\"P\",FontWeight->\"Bold\"]\)(\!\(\*StyleBox[\"T\",FontWeight->\
\"Bold\"]\),\!\(\*SubscriptBox[\(\[ScriptCapitalV]\), \
\(ISO\)]\)(\!\(\*StyleBox[\"I\",FontWeight->\"Normal\",FontSlant->\"Italic\"]\
\)))\>\"", ",", "\[IndentingNewLine]", "\"\< are \[Lambda] = \>\"", ",", 
        "                       ", 
        RowBox[{"\[Lambda]ofTmatISO", "[", 
         RowBox[{"ProjToVSigOfU", "[", 
          RowBox[{"Tmat", ",", "id", ",", 
           StyleBox["ISO",
            FontColor->GrayLevel[0]]}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\< and \[Mu] = \>\"", ",", 
        "                       ", 
        RowBox[{"\[Mu]ofTmatISO", "[", 
         RowBox[{"ProjToVSigOfU", "[", 
          RowBox[{"Tmat", ",", "id", ",", 
           StyleBox["ISO",
            FontColor->GrayLevel[0]]}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<, bulk modulus \[Kappa] = \>\"", ",", 
        RowBox[{"\[Kappa]ofTmatISO", "[", 
         RowBox[{"ProjToVSigOfU", "[", 
          RowBox[{"Tmat", ",", "id", ",", 
           StyleBox["ISO",
            FontColor->GrayLevel[0]]}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<, Poisson ratio = \>\"", ",", 
        RowBox[{"PoissonOfTmatISO", "[", 
         RowBox[{"ProjToVSigOfU", "[", 
          RowBox[{"Tmat", ",", "id", ",", 
           StyleBox["ISO",
            FontColor->GrayLevel[0]]}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]T", "[", 
        RowBox[{"Tmat", ",", "ISO"}], "]"}], "\[Equal]", "0"}], " ", ",", " ",
       "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Lam\[EAcute] parameters for \
\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\) are \[Lambda] = \>\"", ",", 
        RowBox[{"\[Lambda]ofTmatISO", "[", "Tmat", "]"}], ",", 
        "\[IndentingNewLine]", 
        "                                                           ", 
        "\"\< and \[Mu] = \>\"", ",", 
        RowBox[{"\[Mu]ofTmatISO", "[", "Tmat", "]"}], ",", 
        "\[IndentingNewLine]", "                                    ", 
        "\"\<, bulk modulus \[Kappa] = \>\"", ",", 
        RowBox[{"\[Kappa]ofTmatISO", "[", "Tmat", "]"}], ",", 
        "\[IndentingNewLine]", "                                    ", 
        "\"\<, Poisson ratio = \>\"", ",", " ", 
        RowBox[{"PoissonOfTmatISO", "[", "Tmat", "]"}]}], "]"}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8662524510093946`*^9, 3.8662524929122133`*^9}, {
   3.866252547535158*^9, 3.866252556275206*^9}, {3.8662526523940496`*^9, 
   3.8662526675690236`*^9}, {3.8662527041729336`*^9, 3.866252715533536*^9}, {
   3.866252872372701*^9, 3.8662529236782203`*^9}, {3.86625297824477*^9, 
   3.86625300957015*^9}, {3.866253073496605*^9, 3.866253084599798*^9}, {
   3.8662531991618185`*^9, 3.8662532484393044`*^9}, {3.8662534079275956`*^9, 
   3.866253437959863*^9}, {3.866253483588958*^9, 3.866253490355127*^9}, {
   3.8662535430468216`*^9, 3.866253547359133*^9}, {3.866253664330923*^9, 
   3.8662536852610683`*^9}, {3.8662537661673536`*^9, 
   3.8662537733852873`*^9}, {3.8662539224865685`*^9, 3.8662539233444405`*^9}, 
   3.866253957689968*^9, {3.866254010381728*^9, 3.8662540429053593`*^9}, {
   3.8662541298000526`*^9, 3.866254143127823*^9}, {3.8662542035131025`*^9, 
   3.8662542238587294`*^9}, {3.8662542589875107`*^9, 
   3.8662542665771513`*^9}, {3.866254298838705*^9, 3.866254303173485*^9}, 
   3.866254354939714*^9, {3.8662544038976245`*^9, 3.8662544058002853`*^9}, {
   3.8662545468883133`*^9, 3.86625455135297*^9}, {3.866254606005103*^9, 
   3.8662546098801794`*^9}, 3.866254700317774*^9, {3.866254796284337*^9, 
   3.866254797608042*^9}, {3.8662548665453415`*^9, 3.8662548947275577`*^9}, {
   3.866254940279172*^9, 3.866254990212181*^9}, {3.866255037679236*^9, 
   3.866255039340262*^9}, {3.8662551480242443`*^9, 3.8662551650198736`*^9}, {
   3.866255364823188*^9, 3.8662553888451743`*^9}, 3.8662554751991873`*^9, {
   3.8662555293629065`*^9, 3.8662555477407427`*^9}, {3.866255589868573*^9, 
   3.866255614905233*^9}, {3.866255661305645*^9, 3.866255726695964*^9}, {
   3.866255777989356*^9, 3.8662557833364444`*^9}, {3.86625582685419*^9, 
   3.866255827761587*^9}, 3.866292623602892*^9, {3.8662926649924726`*^9, 
   3.866292666114414*^9}, {3.866292703959*^9, 3.866292750066086*^9}, {
   3.866292819173113*^9, 3.866292820675804*^9}, {3.866292872629506*^9, 
   3.8662928803197694`*^9}, {3.866293042213887*^9, 3.866293097447117*^9}, {
   3.8662931388518295`*^9, 3.8662931394829907`*^9}, {3.8662931843715506`*^9, 
   3.866293196599408*^9}, 3.866293591940158*^9, 3.86629389466006*^9, 
   3.8662939885808754`*^9, 3.866294044178362*^9, {3.8662941592515593`*^9, 
   3.866294178004371*^9}, 3.866294250401868*^9, {3.8662942947409716`*^9, 
   3.866294297872816*^9}, 3.866294479934393*^9, {3.8662952625143127`*^9, 
   3.8662952887094193`*^9}, {3.8662953202951035`*^9, 3.866295328612215*^9}, {
   3.866299755166454*^9, 3.866299767844014*^9}, {3.866308827566371*^9, 
   3.866308872435512*^9}, {3.866308913101841*^9, 3.866308917776628*^9}, 
   3.8663089645214767`*^9, {3.8663090161020966`*^9, 3.866309042121807*^9}, {
   3.866309081024869*^9, 3.8663091065537233`*^9}, {3.866309137528593*^9, 
   3.866309226995674*^9}, {3.866378096164158*^9, 3.866378181708243*^9}, {
   3.866378228749163*^9, 3.8663782596849704`*^9}, {3.869323944365809*^9, 
   3.8693239478434944`*^9}, {3.8700291278701563`*^9, 3.870029139037085*^9}, {
   3.8700392531868057`*^9, 3.870039272399903*^9}, {3.87004662359408*^9, 
   3.8700466239069705`*^9}, 3.8700492008666754`*^9, {3.8700492408992667`*^9, 
   3.870049382501234*^9}, {3.870049418116223*^9, 3.870049422305442*^9}, {
   3.8700495032495604`*^9, 3.870049504401086*^9}, {3.8700496760211115`*^9, 
   3.870049681968848*^9}, {3.8700497249416943`*^9, 3.8700498650129566`*^9}, 
   3.870049922359107*^9, {3.870050381971948*^9, 3.87005040227428*^9}, {
   3.8700504521781025`*^9, 3.8700504838422017`*^9}, {3.870050656696664*^9, 
   3.8700506608182673`*^9}, {3.870050719361972*^9, 3.870050720896699*^9}, {
   3.8700507799120984`*^9, 3.8700507854505672`*^9}, 3.870050908180621*^9, {
   3.8700681161250176`*^9, 3.8700681412454596`*^9}, 3.8700682001302567`*^9, {
   3.8700682466724443`*^9, 3.8700682473418884`*^9}, {3.870068426074884*^9, 
   3.870068426266673*^9}, {3.8700689583507395`*^9, 3.870068959214575*^9}, {
   3.870069105696045*^9, 3.870069116356945*^9}, {3.8700691843833094`*^9, 
   3.8700692562675943`*^9}, {3.8700692884568644`*^9, 
   3.8700693246280727`*^9}, {3.870069357672531*^9, 3.870069392593294*^9}, {
   3.8700695891110315`*^9, 3.8700695975990086`*^9}, {3.87006977011246*^9, 
   3.870069775521269*^9}, {3.87007003064005*^9, 3.870070050584505*^9}, {
   3.8700701056590605`*^9, 3.870070110385402*^9}, 3.8700702116740713`*^9, {
   3.8700702683494415`*^9, 3.8700703178899345`*^9}, {3.870070396986796*^9, 
   3.8700705000041065`*^9}, {3.87007072330097*^9, 3.8700707244355235`*^9}, {
   3.8700709632529993`*^9, 3.870070975589855*^9}, {3.8701004495667305`*^9, 
   3.8701005044796324`*^9}, {3.8701006000511265`*^9, 3.87010062389174*^9}, {
   3.870100657645134*^9, 3.8701006798744555`*^9}, {3.870100746240161*^9, 
   3.8701007471236887`*^9}, {3.870100809439488*^9, 3.8701008710074883`*^9}, {
   3.870100953831607*^9, 3.8701009675021048`*^9}, {3.8701011106396956`*^9, 
   3.870101124803195*^9}, {3.870101217472292*^9, 3.87010123035546*^9}, {
   3.87010128671509*^9, 3.870101287469548*^9}, {3.8701014117757115`*^9, 
   3.8701014127165847`*^9}, {3.870101529546399*^9, 3.870101554477433*^9}, 
   3.8701015925250864`*^9, {3.8701017248609343`*^9, 3.870101770490075*^9}, {
   3.870101854874448*^9, 3.8701018705864267`*^9}, 3.870101909894975*^9, {
   3.870101967517412*^9, 3.8701019912140656`*^9}, {3.870102037609448*^9, 
   3.870102066484297*^9}, 3.87010212344886*^9, 3.8701022212820044`*^9, {
   3.8701025494281826`*^9, 3.870102550032714*^9}, {3.8701025844696302`*^9, 
   3.8701026082587814`*^9}, {3.870102833700012*^9, 3.8701028447235584`*^9}, {
   3.870102924266693*^9, 3.870102925042137*^9}, {3.8701030040159607`*^9, 
   3.8701030041830406`*^9}, {3.870103047710457*^9, 3.870103076878746*^9}, {
   3.8701031419105744`*^9, 3.8701031426499205`*^9}, {3.8701804554899263`*^9, 
   3.870180473516418*^9}, {3.870180509639707*^9, 3.87018056828158*^9}, {
   3.870180691939417*^9, 3.8701807316142387`*^9}, 3.8701807695046654`*^9, 
   3.87018090156736*^9, {3.870181225538636*^9, 3.87018123142681*^9}, {
   3.8701812825779867`*^9, 3.8701813924205647`*^9}, 3.8701814511050787`*^9, 
   3.870181561731351*^9, {3.8701816553314247`*^9, 3.870181734411048*^9}, {
   3.870181766530122*^9, 3.870181768673214*^9}, 3.87018180003036*^9, 
   3.870190542490941*^9, 3.8701918529646683`*^9, {3.870202983049225*^9, 
   3.870203023580027*^9}, {3.870203582838542*^9, 3.8702036106843596`*^9}, 
   3.870203719656823*^9, {3.8702037758627267`*^9, 3.870203805412453*^9}, {
   3.8702218183424997`*^9, 3.8702218316713715`*^9}, {3.870222263721141*^9, 
   3.8702222664564857`*^9}, {3.870222493333172*^9, 3.870222512155269*^9}, {
   3.870222678360545*^9, 3.870222679555647*^9}, 3.870222842425955*^9, 
   3.8702229219981976`*^9, 3.870222971947793*^9, 3.8702381584183545`*^9, {
   3.870238587954905*^9, 3.870238594975269*^9}, {3.870265718452425*^9, 
   3.8702657260183096`*^9}, {3.870352917798475*^9, 3.8703529222520895`*^9}, {
   3.9017235124665594`*^9, 3.901723524768465*^9}, {3.9124487164946575`*^9, 
   3.9124487190457416`*^9}, 3.9124488356869154`*^9, {3.9180017669030495`*^9, 
   3.9180018111109247`*^9}, {3.9180018681182446`*^9, 3.918001951905759*^9}, {
   3.9180020003180647`*^9, 3.9180020734258127`*^9}, {3.9180021703361053`*^9, 
   3.9180021979465647`*^9}, {3.91800223852617*^9, 3.9180022585736847`*^9}, {
   3.918002293477646*^9, 3.9180023372719164`*^9}, {3.918002386278942*^9, 
   3.9180023867647552`*^9}, {3.921682253293169*^9, 3.921682280874451*^9}, 
   3.9216823705225415`*^9, {3.9216824447119584`*^9, 3.9216824462062016`*^9}, {
   3.9216828110288773`*^9, 3.9216828197453785`*^9}, {3.9216828545927567`*^9, 
   3.9216828578113813`*^9}, {3.9216830169726067`*^9, 3.921683018793285*^9}, {
   3.9216831681885595`*^9, 3.9216831844569035`*^9}, {3.921683456634103*^9, 
   3.921683464989375*^9}, 3.9216836140194693`*^9, {3.921683653400559*^9, 
   3.9216836658827353`*^9}, {3.9216837222408185`*^9, 3.9216837523546476`*^9}, 
   3.921683836472472*^9, 3.9216840305301437`*^9, {3.9216840821164937`*^9, 
   3.92168409518077*^9}, {3.921684179051427*^9, 3.9216841844593368`*^9}, {
   3.9216842370205708`*^9, 3.9216842485656853`*^9}, {3.9216843085692635`*^9, 
   3.921684316690652*^9}, {3.921772139906907*^9, 3.921772153518075*^9}, {
   3.921772189609647*^9, 3.9217721978655257`*^9}, {3.925834368923093*^9, 
   3.9258343860200777`*^9}},
 CellLabel->
  "In[3662]:=",ExpressionUUID->"2770d3ec-75f3-4f5e-92aa-485d1262268a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["For TRIV", "Subsubsection",
 CellChangeTimes->{{3.866252561922802*^9, 3.8662526001536655`*^9}, {
   3.869404706669767*^9, 3.869404714656294*^9}, {3.869665326211708*^9, 
   3.869665327758236*^9}, 3.920063647448645*^9, {3.9201586791264825`*^9, 
   3.9201586859280863`*^9}, 3.9201594352404575`*^9, 3.9209948027030582`*^9, 
   3.9209970227544146`*^9, 3.920998974969515*^9, 3.9210192659862127`*^9, 
   3.9210683829329453`*^9, 3.9211137483344517`*^9, {3.921769701903863*^9, 
   3.9217697072920585`*^9}},ExpressionUUID->"4d9a4370-1dfd-4d49-ac8d-\
835458ff1c21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinimizationFacts", "[", 
   RowBox[{"Tmat_", ",", "TRIV"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<The reference group \>\"", ",", 
       RowBox[{"Style", "[", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalU]", "TRIV"], ",", "14"}], "]"}], 
       ",", "\"\< is {I}, so \>\"", ",", 
       RowBox[{"ScriptV", "[", 
        RowBox[{
        "TRIV", ",", 
         "\"\<\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\>\""}], "]"}], 
       ",", "\"\< = {T : \!\(\*SubscriptBox[\(\[ScriptCapitalS]\), \(T\)]\) \
\[Superset] U \!\(\*SubscriptBox[\(\[DoubleStruckCapitalU]\), \(TRIV\)]\) \
\!\(\*SuperscriptBox[\(U\), \(T\)]\)} = {T : \!\(\*SubscriptBox[\(\
\[ScriptCapitalS]\), \(T\)]\) \[Superset] {I}} = \>\"", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[ScriptCapitalT]\>\"", ",", "Bold"}], "]"}], ",", 
       "\"\< for all U \[Element] \>\"", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\[DoubleStruckCapitalU]", ",", "13"}], "]"}]}], "]"}], ";"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "                    ", 
     RowBox[{
      RowBox[{"ScriptT", "[", "TRIV", "]"}], ",", 
      "\"\< = \!\(\*StyleBox[\"\[ScriptCapitalT]\",FontWeight->\"Bold\"]\)\>\"\
"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<\!\(\*SubsuperscriptBox[StyleBox[\"d\",FontSlant->\"Italic\"], \
\"TRIV\", StyleBox[RowBox[{\" \", \"T\"}],FontWeight->\"Bold\"]]\) = \
\!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\)(\!\(\*StyleBox[\"T\",FontWeight-\
>\"Bold\"]\), \!\(\*StyleBox[\"\[ScriptCapitalT]\",FontWeight->\"Bold\"]\)) = \
0 for all elastic maps T\>\"", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<\!\(\*SubsuperscriptBox[\"\[Beta]\", \"TRIV\", RowBox[{\" \", \
StyleBox[\"T\",FontWeight->\"Bold\"]}]]\) = \>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\[Angle]", ",", "18"}], "]"}], ",", 
      "\"\<(\!\(\*StyleBox[\"T\",FontWeight->\"Bold\"]\), \!\(\*StyleBox[\"\
\[ScriptCapitalT]\",FontWeight->\"Bold\"]\)) = 0           '' \>\""}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8662524510093946`*^9, 3.8662524929122133`*^9}, {
   3.866252547535158*^9, 3.866252556275206*^9}, {3.8662526523940496`*^9, 
   3.8662526675690236`*^9}, {3.8662527041729336`*^9, 3.866252715533536*^9}, {
   3.866252872372701*^9, 3.8662529236782203`*^9}, {3.86625297824477*^9, 
   3.86625300957015*^9}, {3.866253073496605*^9, 3.866253084599798*^9}, {
   3.8662531991618185`*^9, 3.8662532484393044`*^9}, {3.8662534079275956`*^9, 
   3.866253437959863*^9}, {3.866253483588958*^9, 3.866253490355127*^9}, {
   3.8662535430468216`*^9, 3.866253547359133*^9}, {3.866253664330923*^9, 
   3.8662536852610683`*^9}, {3.8662537661673536`*^9, 
   3.8662537733852873`*^9}, {3.8662539224865685`*^9, 3.8662539233444405`*^9}, 
   3.866253957689968*^9, {3.866254010381728*^9, 3.8662540429053593`*^9}, {
   3.8662541298000526`*^9, 3.866254143127823*^9}, {3.8662542035131025`*^9, 
   3.8662542238587294`*^9}, {3.8662542589875107`*^9, 
   3.8662542665771513`*^9}, {3.866254298838705*^9, 3.866254303173485*^9}, 
   3.866254354939714*^9, {3.8662544038976245`*^9, 3.8662544058002853`*^9}, {
   3.8662545468883133`*^9, 3.86625455135297*^9}, {3.866254606005103*^9, 
   3.8662546098801794`*^9}, 3.866254700317774*^9, {3.866254796284337*^9, 
   3.866254797608042*^9}, {3.8662548665453415`*^9, 3.8662548947275577`*^9}, {
   3.866254940279172*^9, 3.866254990212181*^9}, {3.866255037679236*^9, 
   3.866255039340262*^9}, {3.8662551480242443`*^9, 3.8662551650198736`*^9}, {
   3.866255364823188*^9, 3.8662553888451743`*^9}, 3.8662554751991873`*^9, {
   3.8662555293629065`*^9, 3.8662555477407427`*^9}, {3.866255589868573*^9, 
   3.866255614905233*^9}, {3.866255661305645*^9, 3.866255726695964*^9}, {
   3.866255777989356*^9, 3.8662557833364444`*^9}, {3.86625582685419*^9, 
   3.866255827761587*^9}, 3.866292623602892*^9, {3.8662926649924726`*^9, 
   3.866292666114414*^9}, {3.866292703959*^9, 3.866292750066086*^9}, {
   3.866292819173113*^9, 3.866292820675804*^9}, {3.866292872629506*^9, 
   3.8662928803197694`*^9}, {3.866293042213887*^9, 3.866293097447117*^9}, {
   3.8662931388518295`*^9, 3.8662931394829907`*^9}, {3.8662931843715506`*^9, 
   3.866293196599408*^9}, 3.866293591940158*^9, 3.86629389466006*^9, 
   3.8662939885808754`*^9, 3.866294044178362*^9, {3.8662941592515593`*^9, 
   3.866294178004371*^9}, 3.866294250401868*^9, {3.8662942947409716`*^9, 
   3.866294297872816*^9}, 3.866294479934393*^9, {3.8662952625143127`*^9, 
   3.8662952887094193`*^9}, {3.8662953202951035`*^9, 3.866295328612215*^9}, {
   3.866299755166454*^9, 3.866299767844014*^9}, {3.866308827566371*^9, 
   3.866308872435512*^9}, {3.866308913101841*^9, 3.866308917776628*^9}, 
   3.8663089645214767`*^9, {3.8663090161020966`*^9, 3.866309042121807*^9}, {
   3.866309081024869*^9, 3.8663091065537233`*^9}, {3.866309137528593*^9, 
   3.866309226995674*^9}, {3.866378096164158*^9, 3.866378181708243*^9}, {
   3.866378228749163*^9, 3.8663782596849704`*^9}, {3.869323944365809*^9, 
   3.8693239478434944`*^9}, {3.869665287828939*^9, 3.8696653024877605`*^9}, {
   3.8696653652510977`*^9, 3.869665407428137*^9}, {3.8696654961780057`*^9, 
   3.8696655034319496`*^9}, {3.8696655454446735`*^9, 
   3.8696655484919834`*^9}, {3.869665695759836*^9, 3.86966572454673*^9}, 
   3.869665798405157*^9, {3.8696853639638414`*^9, 3.86968538300791*^9}, {
   3.869685437342413*^9, 3.869685479024766*^9}, {3.869685518854539*^9, 
   3.8696855390926714`*^9}, 3.8696888556724515`*^9, 3.8702359248819313`*^9, 
   3.870236117454253*^9, {3.870236261557418*^9, 3.8702362642630377`*^9}, {
   3.901723258119145*^9, 3.9017232761498804`*^9}, 3.9200636521568823`*^9, {
   3.9201586897676396`*^9, 3.9201586952584815`*^9}, {3.9204686032224045`*^9, 
   3.920468604337084*^9}, 3.920994807064143*^9, 3.9209970234747467`*^9, 
   3.920998976719277*^9, 3.9210192687060614`*^9, 3.921068384582226*^9, 
   3.921113751962471*^9, 3.9216926606562605`*^9, 3.921771594326648*^9, {
   3.9217721131455765`*^9, 3.921772126058727*^9}, {3.921772675703627*^9, 
   3.9217726972443533`*^9}, {3.9217728015177917`*^9, 3.921772803210399*^9}, {
   3.921772900627025*^9, 3.921772923640053*^9}, 3.921773046176812*^9, {
   3.921773174706534*^9, 3.9217731834537935`*^9}, {3.921773229487331*^9, 
   3.9217732406991873`*^9}, 3.9217735186721907`*^9, 3.9217735939022045`*^9, {
   3.9258346792286386`*^9, 3.9258346797458725`*^9}},
 CellLabel->
  "In[3663]:=",ExpressionUUID->"4b4b364e-9464-4b46-8250-b5562e75d075"]
}, Open  ]],

Cell["Finding the symmetry group.", "Subsubsection",
 CellChangeTimes->{{3.9208219325974708`*^9, 3.9208219438899813`*^9}, {
  3.9208220768931117`*^9, 3.920822161967209*^9}, {3.9212572907159324`*^9, 
  3.9212573110772953`*^9}, {3.9219423412660675`*^9, 
  3.921942347118578*^9}},ExpressionUUID->"107933f0-c09f-41f6-b140-\
baeb58d0fd7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"TRIV", ",", "\[CapitalSigma]_"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"MONO", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "MONO", ",", "ORTH", ",", "TET", ",", "CUBE", ",", "ISO", ",", "TRIG", 
       ",", "XISO"}], "}"}], ",", "\[CapitalSigma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"ORTH", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", "             ", 
      RowBox[{"ORTH", ",", "TET", ",", "CUBE", ",", "ISO", ",", "XISO"}], 
      "}"}], ",", "\[CapitalSigma]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"TET", ",", "  ", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", "                          ", 
      RowBox[{"TET", ",", "CUBE", ",", "ISO", ",", "XISO"}], "}"}], ",", 
     "\[CapitalSigma]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"CUBE", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", "                                    ", 
      RowBox[{"CUBE", ",", "ISO"}], "}"}], ",", "\[CapitalSigma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"TRIG", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TRIG", ",", "XISO", ",", "ISO", ",", "CUBE"}], "}"}], ",", 
     "\[CapitalSigma]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", 
    RowBox[{"XISO", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", "             ", 
      RowBox[{"XISO", ",", "ISO"}], "}"}], ",", "\[CapitalSigma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precedes", "[", "  ", 
    RowBox[{"ISO", ",", "\[CapitalSigma]_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", "                          ", "ISO", "}"}], ",", 
     "\[CapitalSigma]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8696145287068453`*^9, 3.869614553593849*^9}, {
   3.869614681425894*^9, 3.869614836250671*^9}, {3.869614894769023*^9, 
   3.869614925902031*^9}, {3.8696149649489264`*^9, 3.8696149975262365`*^9}, {
   3.869615076926673*^9, 3.8696151042459354`*^9}, {3.8696151412089825`*^9, 
   3.8696151580488286`*^9}, {3.8696152214939833`*^9, 3.869615302587714*^9}, {
   3.869615366176697*^9, 3.8696155427410235`*^9}, 3.8696158326450577`*^9, {
   3.86961603851777*^9, 3.8696161553695254`*^9}, {3.8696172105514927`*^9, 
   3.8696172136780963`*^9}, {3.8696185794025664`*^9, 
   3.8696186165143137`*^9}, {3.8696188674417973`*^9, 
   3.8696188743304424`*^9}, {3.8696189061022997`*^9, 3.869618933172969*^9}, {
   3.8696189639043517`*^9, 3.869619001406026*^9}, {3.869619034882307*^9, 
   3.869619061878623*^9}, {3.905024636115966*^9, 3.905024638579113*^9}, {
   3.9211561646027813`*^9, 3.9211561827383585`*^9}, {3.921156262238447*^9, 
   3.9211562900327396`*^9}},
 CellLabel->
  "In[3664]:=",ExpressionUUID->"9e32e3f1-5201-4b96-a0dc-2659c4b52e1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]list", "=", 
   RowBox[{"{", 
    RowBox[{
    "TRIV", ",", "MONO", ",", "ORTH", ",", "TET", ",", "CUBE", ",", "ISO", 
     ",", "TRIG", ",", "XISO"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]sBelow", "[", "\[CapitalSigma]_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"\[CapitalSigma]list", ",", 
     RowBox[{
      RowBox[{"precedes", "[", 
       RowBox[{"#", ",", "\[CapitalSigma]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]sWithZero\[Beta]", "[", "Tmat_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"\[CapitalSigma]list", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]T", "[", 
        RowBox[{"Tmat", ",", "#"}], "]"}], "==", "0"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]ofT", "[", "Tmat_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]sWithZero\[Beta]", "[", "Tmat", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"\[CapitalSigma]sBelow", "[", "#", "]"}], "]"}], "\[Equal]", 
        RowBox[{"Length", "[", 
         RowBox[{"\[CapitalSigma]sWithZero\[Beta]", "[", "Tmat", "]"}], 
         "]"}]}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymGroupText", "[", "Tmat_", "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
    "\"\<\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSize->4,FontSlant->\"Italic\"]\)\>\"", ",", 
     RowBox[{
      RowBox[{"SubscriptBox", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          StyleBox["\[DoubleStruckCapitalU]",
           FontSize->18], ",", "15"}], "]"}], ",", 
        RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], "//", 
      "DisplayForm"}], ",", 
     "\"\<\!\(\*StyleBox[SuperscriptBox[StyleBox[\"U\",FontSlant->\"Italic\"],\
 StyleBox[\"T\",FontSlant->\"Plain\"]],FontSlant->\"Italic\"]\)\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.869615836460982*^9, 3.869615850266922*^9}, {
   3.8696159246779885`*^9, 3.8696159785954895`*^9}, {3.8696160105713005`*^9, 
   3.869616016585687*^9}, {3.8696161979834833`*^9, 3.869616243653635*^9}, {
   3.869616291684947*^9, 3.8696163145664525`*^9}, 3.869616354074516*^9, {
   3.869616401250442*^9, 3.8696164022312336`*^9}, {3.86962143402676*^9, 
   3.8696214548709593`*^9}, {3.920072046680822*^9, 3.9200720766519313`*^9}, 
   3.920072225945049*^9, 3.920072361784114*^9, 3.9211562887305593`*^9, 
   3.9211564344021273`*^9, 3.921156749599573*^9, 3.921156876667571*^9, {
   3.9211569931273746`*^9, 3.9211570107023644`*^9}, 3.921157148075433*^9, {
   3.9211572198553395`*^9, 3.9211572340264196`*^9}, 3.921157306562419*^9, {
   3.9211578981156263`*^9, 3.9211579119656744`*^9}, {3.921158092950058*^9, 
   3.921158097388451*^9}, {3.921161437108162*^9, 3.921161439054104*^9}},
 CellLabel->
  "In[3672]:=",ExpressionUUID->"1a2170d1-b32f-4b6c-8e33-34a28551dd4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeriveSymGp", "[", "Tmat_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "TRIV", ",", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "MONO", ",", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "ORTH", ",", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "TET", ",", "  ", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "XISO", ",", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "ISO", ",", "  ", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "TRIG", ",", "nRuns"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"NMinimizeMulti", "[", 
      RowBox[{"Tmat", ",", "CUBE", ",", "nRuns"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"SequenceForm", "[", 
         RowBox[{
         "\"\<The symmetry classes \[CapitalSigma] with \
\!\(\*SubsuperscriptBox[\(\[Beta]\), \(\[CapitalSigma]\), \(T\)]\) = 0  are \
\>\"", ",", 
          RowBox[{"\[CapitalSigma]sWithZero\[Beta]", "[", "Tmat", "]"}], ",", 
          "\"\<  (See the lattice)\>\""}], "]"}], ",", "14", ",", "Bold"}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"SequenceForm", "[", 
         RowBox[{"\"\<The symmetry class for T is therefore \>\"", ",", 
          RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], ",", 
        "14", ",", "Bold"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TRIV", ",", "ISO"}], "}"}], ",", 
          RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{"\"\<The symmetry group for T is \>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\>\"", ",", 
              "14"}], "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\< \>\"", ",", "5"}], "]"}], ",", 
            RowBox[{
             RowBox[{"SubscriptBox", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\[DoubleStruckCapitalU]", ",", "15"}], "]"}], ",", 
               RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], "//",
              "DisplayForm"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\< \>\"", ",", "4"}], "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<\!\(\*StyleBox[SuperscriptBox[StyleBox[\"U\",FontSlant->\"\
Italic\"], \"T\"],FontSlant->\"Italic\"]\)\>\"", ",", "14"}], "]"}], ",", 
            " ", "\"\<, where \!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\) = \
UT[Tmat,\>\"", ",", 
            RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}], ",", 
            "\"\<] = \>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"Chop", "[", 
              RowBox[{
               RowBox[{"UT", "[", 
                RowBox[{"Tmat", ",", 
                 RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], 
               ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "8"}]]}], "]"}], "]"}]}], "]"}], ",", "14", ",", 
          "Bold"}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "TRIV", "}"}], ",", 
         RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{
           "\"\<The symmetry group for T is \
\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\< \>\"", ",", "5"}], "]"}], ",", 
            RowBox[{
             RowBox[{"SubscriptBox", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\[DoubleStruckCapitalU]", ",", "15"}], "]"}], ",", 
               RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], "//",
              "DisplayForm"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\< \>\"", ",", "4"}], "]"}], ",", 
            "\"\<\!\(\*StyleBox[SuperscriptBox[StyleBox[\"U\",FontSlant->\"\
Italic\"], StyleBox[\"T\",FontSlant->\"Plain\"]],FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \",FontSlant->\"Italic\"]\)= \
{\!\(\*StyleBox[\"I\",FontSlant->\"Italic\"]\)}\>\""}], "]"}], ",", "14", ",",
           "Bold"}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "ISO", "}"}], ",", 
         RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{
           "\"\<The symmetry group for T is \
\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)\>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\< \>\"", ",", "5"}], "]"}], ",", 
            RowBox[{
             RowBox[{"SubscriptBox", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\[DoubleStruckCapitalU]", ",", "15"}], "]"}], ",", 
               RowBox[{"\[CapitalSigma]ofT", "[", "Tmat", "]"}]}], "]"}], "//",
              "DisplayForm"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\< \>\"", ",", "4"}], "]"}], ",", 
            "\"\<\!\(\*StyleBox[SuperscriptBox[StyleBox[\"U\",FontSlant->\"\
Italic\"], StyleBox[\"T\",FontSlant->\"Plain\"]],FontSlant->\"Italic\"]\)= \>\
\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\[DoubleStruckCapitalU]\>\"", ",", "15"}], "]"}]}], 
           "]"}], ",", "14", ",", "Bold"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LatticeOfBetas", "[", "Tmat", "]"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.8696163633394413`*^9, {3.869621463324604*^9, 3.869621465708634*^9}, {
   3.8696219716352153`*^9, 3.8696220187355194`*^9}, {3.86962213436029*^9, 
   3.8696222741491823`*^9}, {3.869622338681963*^9, 3.8696223523961477`*^9}, {
   3.8696223968804417`*^9, 3.8696226018123665`*^9}, {3.869622635968937*^9, 
   3.8696227088844204`*^9}, {3.8696227663396373`*^9, 
   3.8696228306058927`*^9}, {3.8696230406444893`*^9, 
   3.8696230490214252`*^9}, {3.8696231146784306`*^9, 3.8696231603564253`*^9}, 
   3.869623200285184*^9, {3.869623310838189*^9, 3.869623351001647*^9}, {
   3.8696234664346514`*^9, 3.869623467919593*^9}, 3.8696235028154793`*^9, {
   3.8696235367326717`*^9, 3.8696236600947804`*^9}, {3.869623745494275*^9, 
   3.869623759444523*^9}, {3.8696250574584904`*^9, 3.869625141798394*^9}, {
   3.869663366358886*^9, 3.869663380918374*^9}, {3.8696634155755663`*^9, 
   3.8696634166485076`*^9}, {3.869663447667142*^9, 3.8696634984366026`*^9}, 
   3.869663543237678*^9, {3.869663672406267*^9, 3.8696636944677134`*^9}, {
   3.869689685201104*^9, 3.8696897005581446`*^9}, 3.8696897706391296`*^9, 
   3.869689976336934*^9, 3.869690218640473*^9, {3.869690253489468*^9, 
   3.869690261062951*^9}, {3.869690330679112*^9, 3.8696903586656446`*^9}, {
   3.869690402550681*^9, 3.8696904525069833`*^9}, {3.869690495658244*^9, 
   3.869690569767743*^9}, {3.869690608508107*^9, 3.8696906150987663`*^9}, {
   3.8696906696274834`*^9, 3.8696906705069504`*^9}, {3.870216463864705*^9, 
   3.870216473840618*^9}, {3.870269996915787*^9, 3.8702700145479183`*^9}, {
   3.8703025713567495`*^9, 3.870302654167238*^9}, {3.870302865514406*^9, 
   3.8703028747739086`*^9}, 3.870302966469447*^9, {3.9198815303082895`*^9, 
   3.9198815711936283`*^9}, {3.919882510507918*^9, 3.9198825153154984`*^9}, {
   3.9199521171611996`*^9, 3.919952125953451*^9}, {3.9199522718228693`*^9, 
   3.9199523084732866`*^9}, {3.9199523981201553`*^9, 3.919952400757922*^9}, 
   3.919952432460664*^9, 3.9199524846321163`*^9, {3.9199525243115854`*^9, 
   3.9199525501439543`*^9}, {3.9199526035494027`*^9, 3.919952604601906*^9}, {
   3.919952664205056*^9, 3.919952689270096*^9}, {3.919952765963746*^9, 
   3.9199528004696074`*^9}, {3.919952840817738*^9, 3.919952859089729*^9}, 
   3.9199529486267233`*^9, {3.9199529793112545`*^9, 3.919953037657175*^9}, {
   3.9199533976542587`*^9, 3.9199535115202513`*^9}, 3.919955156896805*^9, 
   3.919955584667241*^9, {3.9199561786289577`*^9, 3.9199561804798512`*^9}, {
   3.9199562192055645`*^9, 3.919956237207426*^9}, {3.919956291006096*^9, 
   3.9199562957391615`*^9}, {3.919956441502449*^9, 3.919956442944569*^9}, 
   3.9200688762690907`*^9, {3.920069011463808*^9, 3.9200690460687723`*^9}, {
   3.9200691672481527`*^9, 3.920069204715786*^9}, 3.920069544019757*^9, {
   3.9200724626130323`*^9, 3.9200724668070517`*^9}, {3.920159601481275*^9, 
   3.920159603563692*^9}, {3.9201596456925554`*^9, 3.9201597067639494`*^9}, 
   3.9203056000805645`*^9, {3.921002937433527*^9, 3.9210029378400297`*^9}, {
   3.9210030541115704`*^9, 3.921003059939252*^9}, 3.921004486674963*^9, {
   3.9210058468985243`*^9, 3.921005861962221*^9}, {3.921156888567565*^9, 
   3.9211568937342386`*^9}, 3.9211570095846696`*^9, 3.9211579102553434`*^9, {
   3.9212493528137074`*^9, 3.921249361032858*^9}, {3.9213423426831617`*^9, 
   3.921342347389715*^9}, {3.921509611492449*^9, 3.9215096798971796`*^9}, {
   3.921509710269301*^9, 3.9215097215682898`*^9}, 3.921509788359868*^9, 
   3.9215148409968987`*^9, {3.9216114109205165`*^9, 3.921611449430065*^9}, 
   3.921620686440216*^9, {3.9216688053531303`*^9, 3.9216689202477245`*^9}, {
   3.9216694551627927`*^9, 3.9216694559943485`*^9}, {3.921672381919427*^9, 
   3.9216724361888514`*^9}, {3.921672556589018*^9, 3.921672558404849*^9}, 
   3.921771014219124*^9, 3.9217710586476307`*^9},
 CellLabel->
  "In[3677]:=",ExpressionUUID->"bd617737-e35a-46c9-9bc0-26f13bb68999"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"seq", "[", 
    RowBox[{"\[CapitalSigma]_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{"Subsuperscript", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[Beta]\>\"", ",", "18"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\[CapitalSigma]", ",", "11"}], "]"}], ",", 
       RowBox[{"Overscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\< \>\"", ",", "4"}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<T\>\"", ",", "Bold", ",", "12"}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\< = \>\"", ",", "16"}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Round", "[", 
         RowBox[{"\[Beta]", ",", "0.1"}], "]"}], "\"\<o\>\""], ",", "16"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[3678]:=",ExpressionUUID->"ae59d5e8-67f3-4251-a0ca-f63462d2d43d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LatticeOfBetas", "[", "Tmat_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ww", "=", "1.7"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<ChopT = \>\"", ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"ChopT", "/", "Degree"}], ")"}], "o"]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", ".08", "]"}], ",", 
        RowBox[{"Thickness", "[", ".006", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "MONO"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", ".13"}]}], "}"}], ",", "      ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "          ", 
            ".25"}], "]"}]}], "}"}], ",", "  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TRIV", " ", "to", " ", "MONO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ORTH"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "             ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "2"}], "}"}]}], "}"}], ",", "    ", 
            ".50"}], "]"}]}], "}"}], ",", "  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "MONO", " ", "to", " ", "ORTH"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "  ", "TET"}], "]"}], "==", "0"}], ",", 
            "Red"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "1.9"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "3"}], "}"}]}], "}"}], ",", "    ", 
            ".20"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "ORTH"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "CUBE"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "2.9"}], "}"}], ",", 
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "4"}], "}"}]}], "}"}], ",", ".20"}],
            "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TET", " ", "to", " ", "CUBE"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "XISO"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "2.9"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}]}], "}"}], ",", 
            ".20"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TRIG", " ", "to", " ", "XISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "CUBE"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "3"}], "}"}], ",", "    ", 
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "4"}], "}"}]}], "}"}], ",", ".80"}],
            "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TRIG", " ", "to", " ", "CUBE"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "XISO"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "3"}], "}"}], ",", "    ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}]}], "}"}], ",", 
            ".70"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TET", " ", "to", " ", "XISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TRIG"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "            ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "3"}], "}"}]}], "}"}], ",", 
            ".30"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "MONO", " ", "to", " ", "TRIG"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "  ", "ISO"}], "]"}], "==", "0"}], ",", 
            "Red"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "4"}], "}"}], ",", "   ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}]}], "}"}], ",", "         ", 
            ".50"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "CUBE", " ", "to", " ", "ISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "  ", "ISO"}], "]"}], "==", "0"}], ",", 
            "Red"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}], ",", "   ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}]}], "}"}], ",", "         ", 
            ".55"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "XISO", " ", "to", " ", "ISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"TRIV", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TRIV"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"MONO", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "MONO"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"ORTH", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ORTH"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "ww"}], ",", "2"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"TET", ",", "  ", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TET"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", "  ", 
          RowBox[{"{", "   ", 
           RowBox[{
            RowBox[{"1", "ww"}], ",", "3"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"CUBE", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "CUBE"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", "   ", 
           RowBox[{
            RowBox[{"1", "ww"}], ",", "4"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"XISO", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "XISO"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"TRIG", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TRIG"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "ww"}], ",", "3"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"ISO", ",", "  ", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ISO"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "5"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"ImageSize", "->", "350"}]}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8370181463265653`*^9, 3.837018331394561*^9}, {
   3.8370184159015703`*^9, 3.837018617774561*^9}, {3.837018665119568*^9, 
   3.837018679678566*^9}, {3.837019003423561*^9, 3.837019191150567*^9}, {
   3.837019229358568*^9, 3.8370193182545714`*^9}, {3.8370195348035603`*^9, 
   3.8370195713915606`*^9}, {3.837019614399562*^9, 3.837019635567562*^9}, {
   3.837019874078582*^9, 3.837019883583565*^9}, {3.8370199490715604`*^9, 
   3.8370200623995695`*^9}, {3.83702009385457*^9, 3.8370200984305696`*^9}, {
   3.8370201335995684`*^9, 3.8370201968635693`*^9}, {3.8370202310395575`*^9, 
   3.8370204166235547`*^9}, {3.8370204553125553`*^9, 
   3.8370205099845676`*^9}, {3.837020541711568*^9, 3.837020579599554*^9}, {
   3.83702064283257*^9, 3.8370207176005697`*^9}, {3.8370252092485604`*^9, 
   3.837025384385552*^9}, {3.83702545188857*^9, 3.83702559219357*^9}, {
   3.837025632656565*^9, 3.8370258564815607`*^9}, {3.837025925506571*^9, 
   3.8370259577785735`*^9}, {3.8370260176025643`*^9, 3.837026084258566*^9}, {
   3.837026116529569*^9, 3.837026205602556*^9}, {3.837026368964576*^9, 
   3.837026572307558*^9}, {3.8370266411385746`*^9, 3.8370267484185658`*^9}, {
   3.8370268700335693`*^9, 3.8370268782895565`*^9}, {3.8370274312655663`*^9, 
   3.83702744773057*^9}, {3.8370275022905664`*^9, 3.83702753401758*^9}, {
   3.837027611138569*^9, 3.837027619522569*^9}, {3.837027809986557*^9, 
   3.837027858194584*^9}, {3.83703765894757*^9, 3.8370376595555606`*^9}, {
   3.837037695600587*^9, 3.8370377237305737`*^9}, {3.8370378154915733`*^9, 
   3.837037868418567*^9}, 3.837037944084566*^9, {3.8370382355413976`*^9, 
   3.83703829105939*^9}, {3.83703853300338*^9, 3.837038540169388*^9}, {
   3.8370386192833853`*^9, 3.83703862507438*^9}, {3.8370435973493958`*^9, 
   3.8370438373793945`*^9}, 3.8370452177333927`*^9, 3.8370854393101854`*^9, {
   3.83708548519386*^9, 3.8370855554802303`*^9}, {3.8370856595141125`*^9, 
   3.8370857006151133`*^9}, {3.8370857446087093`*^9, 
   3.8370857581014385`*^9}, {3.837085809449133*^9, 3.8370859290341606`*^9}, {
   3.8370859653677683`*^9, 3.8370859974028807`*^9}, {3.8370862677045383`*^9, 
   3.8370862770474625`*^9}, {3.837086623223106*^9, 3.837086837546943*^9}, {
   3.837086897641491*^9, 3.8370869569216814`*^9}, {3.837087019034116*^9, 
   3.8370872025533123`*^9}, {3.837087325226897*^9, 3.8370873320395966`*^9}, {
   3.8370874177851872`*^9, 3.8370878498003345`*^9}, {3.8370878881526523`*^9, 
   3.8370879475292873`*^9}, {3.8370880106831684`*^9, 3.837088071402605*^9}, 
   3.8370881162336016`*^9, {3.837092876636677*^9, 3.8370929389705143`*^9}, 
   3.8370929698480234`*^9, {3.837094458261659*^9, 3.837094478452037*^9}, 
   3.8370945127760625`*^9, {3.8370945941238813`*^9, 3.837094695801298*^9}, {
   3.83709472898483*^9, 3.837094801271778*^9}, 3.8370948408707285`*^9, 
   3.8372629428776703`*^9, {3.83850767953935*^9, 3.83850768066162*^9}, {
   3.8385078036056275`*^9, 3.838507824246597*^9}, 3.8385079155474553`*^9, {
   3.838508135734826*^9, 3.8385081363442755`*^9}, {3.8385083491767097`*^9, 
   3.8385083541087723`*^9}, {3.838508581407811*^9, 3.8385086336273775`*^9}, {
   3.8385086674783897`*^9, 3.83850866769039*^9}, {3.83850872775138*^9, 
   3.838508790328144*^9}, {3.8385089779269457`*^9, 3.8385089855065985`*^9}, {
   3.8385090957347593`*^9, 3.838509115589082*^9}, {3.838509261080325*^9, 
   3.8385092662323713`*^9}, {3.838509440359363*^9, 3.838509440919798*^9}, {
   3.838513025829235*^9, 3.8385130379766145`*^9}, {3.8385580495807962`*^9, 
   3.8385580746369934`*^9}, 3.8385617383805847`*^9, {3.8388205838742495`*^9, 
   3.838820610978253*^9}, {3.838820647667348*^9, 3.838820655523256*^9}, {
   3.8388208879103208`*^9, 3.838820911030321*^9}, {3.8388215309713645`*^9, 
   3.838821591895434*^9}, {3.838821707899458*^9, 3.8388217287359962`*^9}, {
   3.8388218487569017`*^9, 3.83882192752324*^9}, {3.838824224565867*^9, 
   3.8388242615251737`*^9}, {3.8388249564068375`*^9, 3.838824961570805*^9}, {
   3.8388249997022595`*^9, 3.8388250206003895`*^9}, {3.83882507497882*^9, 
   3.83882507832282*^9}, {3.8388251401348505`*^9, 3.8388251424517107`*^9}, {
   3.8388263590619807`*^9, 3.8388263740829844`*^9}, 3.838828445176153*^9, {
   3.8388285804232984`*^9, 3.838828585991289*^9}, {3.8388286271113033`*^9, 
   3.8388286302773767`*^9}, {3.838828807847303*^9, 3.838828846919343*^9}, 
   3.838828931925268*^9, {3.8388289927793493`*^9, 3.83882900037537*^9}, {
   3.838830635223561*^9, 3.8388306355755615`*^9}, {3.838842570393077*^9, 
   3.8388425713212423`*^9}, {3.838905176465457*^9, 3.838905215472639*^9}, {
   3.838905738913064*^9, 3.838905767294829*^9}, {3.8389058918250694`*^9, 
   3.838905936177064*^9}, {3.838906333993126*^9, 3.8389063463113184`*^9}, 
   3.8389064337221856`*^9, {3.8389070786252155`*^9, 3.8389070792332134`*^9}, {
   3.838907122129212*^9, 3.838907122847023*^9}, {3.8389074524889526`*^9, 
   3.838907499869239*^9}, {3.838922355763171*^9, 3.8389223596555543`*^9}, {
   3.870029154471189*^9, 3.870029190042804*^9}, {3.8703059611067*^9, 
   3.8703059670176086`*^9}, {3.919904263237747*^9, 3.91990448516887*^9}, {
   3.9199047567338705`*^9, 3.9199047650222983`*^9}, {3.921005085320139*^9, 
   3.921005091324439*^9}, 3.9210051329396644`*^9, {3.9210056004705424`*^9, 
   3.9210056008299456`*^9}},
 CellLabel->
  "In[3679]:=",ExpressionUUID->"64d2c355-43df-470b-842a-70daf982369a"],

Cell[CellGroupData[{

Cell["ChristoffelMatrix \[CapitalGamma]mat, copied from Slawinski.", "Section",
 CellChangeTimes->{{3.8054660040574265`*^9, 3.80546600434883*^9}, 
   3.8096529139002433`*^9, {3.822872931232916*^9, 3.822872939143306*^9}, {
   3.8247967322416897`*^9, 3.8247968301590824`*^9}, {3.8247968757122564`*^9, 
   3.824796954895218*^9}, {3.8265537630362673`*^9, 3.8265537721817913`*^9}, {
   3.826556349092514*^9, 3.826556382555866*^9}, {3.82655644097025*^9, 
   3.8265564652490587`*^9}, {3.8265565408224783`*^9, 
   3.8265565464579854`*^9}, {3.869494968090262*^9, 
   3.869494970258461*^9}},ExpressionUUID->"7a0c09b4-45f4-4c79-87ca-\
322dfb4e141f"],

Cell[CellGroupData[{

Cell["\<\
Remember the elastic map T should be positive definite in order to get real \
velocities.
C is the Voigt matrix for T.
See the file SSM_ChristoffelAndStrainForPlaneWave for examples.\
\>", "Subsection",
 CellChangeTimes->{{3.8054660040574265`*^9, 3.80546600434883*^9}, 
   3.8096529139002433`*^9, {3.822872931232916*^9, 3.822872939143306*^9}, {
   3.8247967322416897`*^9, 3.8247968301590824`*^9}, {3.8247968757122564`*^9, 
   3.824796954895218*^9}, {3.8265537630362673`*^9, 3.8265537721817913`*^9}, {
   3.826556349092514*^9, 3.826556382555866*^9}, {3.82655644097025*^9, 
   3.8265564652490587`*^9}, {3.8265565408224783`*^9, 
   3.8265565464579854`*^9}, {3.8694949744651785`*^9, 
   3.869494976228541*^9}},ExpressionUUID->"ada742a5-f73f-46d3-82fc-\
b3fc44bc2f04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]11", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"C11_", "C12_", "C13_", "C14_", "C15_", "C16_"},
         {"D12_", "C22_", "C23_", "C24_", "C25_", "C26_"},
         {"D13_", "D23_", "C33_", "C34_", "C35_", "C36_"},
         {"D14_", "D24_", "D34_", "C44_", "C45_", "C46_"},
         {"D15_", "D25_", "D35_", "D45_", "C55_", "C56_"},
         {"D16_", "D26_", "D36_", "D46_", "D56_", "C66_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C11", " ", 
     SuperscriptBox["n1", "2"]}], "+", 
    RowBox[{"C66", " ", 
     SuperscriptBox["n2", "2"]}], "+", 
    RowBox[{"C55", " ", 
     SuperscriptBox["n3", "2"]}], "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"C16", " ", "n1", " ", "n2"}], "+", 
       RowBox[{"C56", " ", "n2", " ", "n3"}], "+", 
       RowBox[{"C15", " ", "n1", " ", "n3"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]22", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"C11_", "C12_", "C13_", "C14_", "C15_", "C16_"},
         {"D12_", "C22_", "C23_", "C24_", "C25_", "C26_"},
         {"D13_", "D23_", "C33_", "C34_", "C35_", "C36_"},
         {"D14_", "D24_", "D34_", "C44_", "C45_", "C46_"},
         {"D15_", "D25_", "D35_", "D45_", "C55_", "C56_"},
         {"D16_", "D26_", "D36_", "D46_", "D56_", "C66_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C66", " ", 
     SuperscriptBox["n1", "2"]}], "+", 
    RowBox[{"C22", " ", 
     SuperscriptBox["n2", "2"]}], "+", 
    RowBox[{"C44", " ", 
     SuperscriptBox["n3", "2"]}], "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"C26", " ", "n1", " ", "n2"}], "+", 
       RowBox[{"C24", " ", "n2", " ", "n3"}], "+", 
       RowBox[{"C46", " ", "n1", " ", "n3"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]33", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"C11_", "C12_", "C13_", "C14_", "C15_", "C16_"},
         {"D12_", "C22_", "C23_", "C24_", "C25_", "C26_"},
         {"D13_", "D23_", "C33_", "C34_", "C35_", "C36_"},
         {"D14_", "D24_", "D34_", "C44_", "C45_", "C46_"},
         {"D15_", "D25_", "D35_", "D45_", "C55_", "C56_"},
         {"D16_", "D26_", "D36_", "D46_", "D56_", "C66_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C55", " ", 
     SuperscriptBox["n1", "2"]}], "+", 
    RowBox[{"C44", " ", 
     SuperscriptBox["n2", "2"]}], "+", 
    RowBox[{"C33", " ", 
     SuperscriptBox["n3", "2"]}], "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"C45", " ", "n1", " ", "n2"}], "+", 
       RowBox[{"C34", " ", "n2", " ", "n3"}], "+", 
       RowBox[{"C35", " ", "n1", " ", "n3"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]12", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"C11_", "C12_", "C13_", "C14_", "C15_", "C16_"},
         {"D12_", "C22_", "C23_", "C24_", "C25_", "C26_"},
         {"D13_", "D23_", "C33_", "C34_", "C35_", "C36_"},
         {"D14_", "D24_", "D34_", "C44_", "C45_", "C46_"},
         {"D15_", "D25_", "D35_", "D45_", "C55_", "C56_"},
         {"D16_", "D26_", "D36_", "D46_", "D56_", "C66_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C16", " ", 
     SuperscriptBox["n1", "2"]}], "+", 
    RowBox[{"C26", " ", 
     SuperscriptBox["n2", "2"]}], "+", 
    RowBox[{"C45", " ", 
     SuperscriptBox["n3", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C12", "+", "C66"}], ")"}], "n1", " ", "n2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C25", "+", "C46"}], ")"}], "n2", " ", "n3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C14", "+", "C56"}], ")"}], " ", "n1", " ", "n3"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]13", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"C11_", "C12_", "C13_", "C14_", "C15_", "C16_"},
         {"D12_", "C22_", "C23_", "C24_", "C25_", "C26_"},
         {"D13_", "D23_", "C33_", "C34_", "C35_", "C36_"},
         {"D14_", "D24_", "D34_", "C44_", "C45_", "C46_"},
         {"D15_", "D25_", "D35_", "D45_", "C55_", "C56_"},
         {"D16_", "D26_", "D36_", "D46_", "D56_", "C66_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C15", " ", 
     SuperscriptBox["n1", "2"]}], "+", 
    RowBox[{"C46", " ", 
     SuperscriptBox["n2", "2"]}], "+", 
    RowBox[{"C35", " ", 
     SuperscriptBox["n3", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C14", "+", "C56"}], ")"}], "n1", " ", "n2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C36", "+", "C45"}], ")"}], "n2", " ", "n3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C13", "+", "C55"}], ")"}], " ", "n1", " ", "n3"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]23", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_", ",", "n3_"}], "}"}], ",", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"C11_", "C12_", "C13_", "C14_", "C15_", "C16_"},
         {"D12_", "C22_", "C23_", "C24_", "C25_", "C26_"},
         {"D13_", "D23_", "C33_", "C34_", "C35_", "C36_"},
         {"D14_", "D24_", "D34_", "C44_", "C45_", "C46_"},
         {"D15_", "D25_", "D35_", "D45_", "C55_", "C56_"},
         {"D16_", "D26_", "D36_", "D46_", "D56_", "C66_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"C56", " ", 
     SuperscriptBox["n1", "2"]}], "+", 
    RowBox[{"C24", " ", 
     SuperscriptBox["n2", "2"]}], "+", 
    RowBox[{"C34", " ", 
     SuperscriptBox["n3", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C25", "+", "C46"}], ")"}], "n1", " ", "n2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C23", "+", "C44"}], ")"}], "n2", " ", "n3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"C36", "+", "C45"}], ")"}], " ", "n1", " ", "n3"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.824658005596802*^9, 3.824658006885848*^9}, {
  3.8246580894785447`*^9, 3.8246583829322786`*^9}, {3.824658440927226*^9, 
  3.82465856373821*^9}, {3.8246586014576035`*^9, 3.824658791878068*^9}, {
  3.8246588355512314`*^9, 3.8246588371190863`*^9}, {3.824690203772827*^9, 
  3.824690231868371*^9}, {3.824690262515172*^9, 3.8246903040755424`*^9}, {
  3.8246903345672817`*^9, 3.824690379186737*^9}, {3.824690411887303*^9, 
  3.824690428591755*^9}},
 CellLabel->
  "In[3680]:=",ExpressionUUID->"0b733127-44bb-4f04-b643-dd9627458ccb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChristoffelMatrix", "[", 
     RowBox[{"n_", ",", "C_"}], "]"}], ":=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"\[CapitalGamma]11", "[", 
          RowBox[{"n", ",", "C"}], "]"}], 
         RowBox[{"\[CapitalGamma]12", "[", 
          RowBox[{"n", ",", "C"}], "]"}], 
         RowBox[{"\[CapitalGamma]13", "[", 
          RowBox[{"n", ",", "C"}], "]"}]},
        {
         RowBox[{"\[CapitalGamma]12", "[", 
          RowBox[{"n", ",", "C"}], "]"}], 
         RowBox[{"\[CapitalGamma]22", "[", 
          RowBox[{"n", ",", "C"}], "]"}], 
         RowBox[{"\[CapitalGamma]23", "[", 
          RowBox[{"n", ",", "C"}], "]"}]},
        {
         RowBox[{"\[CapitalGamma]13", "[", 
          RowBox[{"n", ",", "C"}], "]"}], 
         RowBox[{"\[CapitalGamma]23", "[", 
          RowBox[{"n", ",", "C"}], "]"}], 
         RowBox[{"\[CapitalGamma]33", "[", 
          RowBox[{"n", ",", "C"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox["ChristoffelMatrix",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8246601477761784`*^9, 3.824660162059349*^9}, {
   3.824660202932304*^9, 3.8246602785327325`*^9}, {3.8246631175884666`*^9, 
   3.8246632173905725`*^9}, {3.824678067426567*^9, 3.824678076310668*^9}, {
   3.8246904498500223`*^9, 3.8246904830803175`*^9}, 3.824690653074613*^9, {
   3.82475196235947*^9, 3.8247519636640944`*^9}, {3.824752009377881*^9, 
   3.82475202737295*^9}, {3.8260334818928375`*^9, 3.8260334870418625`*^9}, {
   3.8265537906321044`*^9, 3.826553816757599*^9}, {3.8265564774673386`*^9, 
   3.826556481130601*^9}, {3.826556524540721*^9, 3.826556528476617*^9}, {
   3.8269003563611517`*^9, 3.826900361885031*^9}},
 CellLabel->
  "In[3686]:=",ExpressionUUID->"333ba1b1-a080-4c1a-bffe-90b9b6484314"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "U", ",", "\[Theta]", ",", "\[Sigma]", ",", "\[Phi]", ",", "x", ",", "y", 
     ",", "z", ",", "nVec"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nVec", "=", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";", "   ", 
    "\[IndentingNewLine]", 
    RowBox[{"U", "=", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ChristoffelMatrix", "[", 
         RowBox[{
          RowBox[{"U", ".", "nVec"}], ",", 
          RowBox[{"CmatOfTmat", "[", 
           RowBox[{
            RowBox[{"MatrixUbar", "[", "U", "]"}], ".", "BlankSlate", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}], "]"}]}], "]"}], 
        "-", 
        RowBox[{"U", ".", 
         RowBox[{"ChristoffelMatrix", "[", 
          RowBox[{"nVec", ",", 
           RowBox[{"CmatOfTmat", "[", "BlankSlate", "]"}]}], "]"}], ".", 
         RowBox[{"Transpose", "[", "U", "]"}]}]}], "]"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"U", "=", 
     RowBox[{"YRot", "[", "\[Phi]", "]"}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{"follows", " ", "for", " ", "U"}], " ", "=", " ", 
       RowBox[{"UsHat", "[", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}]}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ChristoffelMatrix", "[", 
         RowBox[{
          RowBox[{"U", ".", "nVec"}], ",", 
          RowBox[{"CmatOfTmat", "[", 
           RowBox[{
            RowBox[{"MatrixUbar", "[", "U", "]"}], ".", "BlankSlate", ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}], "]"}]}], "]"}], 
        "-", 
        RowBox[{"U", ".", 
         RowBox[{"ChristoffelMatrix", "[", 
          RowBox[{"nVec", ",", 
           RowBox[{"CmatOfTmat", "[", "BlankSlate", "]"}]}], "]"}], ".", 
         RowBox[{"Transpose", "[", "U", "]"}]}]}], "]"}], "]"}], "]"}], 
    ";"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8288811158932085`*^9, 3.8288813351887093`*^9}, {
   3.8288813677167425`*^9, 3.8288814106456738`*^9}, {3.8288815119893227`*^9, 
   3.828881518228345*^9}, {3.8288815935105553`*^9, 3.828881599716917*^9}, {
   3.8288816557811904`*^9, 3.8288816590924144`*^9}, {3.8288816967247057`*^9, 
   3.828881758841277*^9}, {3.828881803477272*^9, 3.8288818245969973`*^9}, {
   3.8288818558457627`*^9, 3.8288818637973013`*^9}, {3.828882170580883*^9, 
   3.828882195973957*^9}, {3.8288824382232594`*^9, 3.8288824681167955`*^9}, {
   3.828882735077707*^9, 3.828882853333084*^9}, {3.8754859911340485`*^9, 
   3.8754860170552006`*^9}, {3.879383895046167*^9, 3.8793838958092594`*^9}, {
   3.879520995411945*^9, 3.8795209961284833`*^9}, {3.928348816722966*^9, 
   3.9283488452980103`*^9}, 3.928348910999669*^9, {3.9283490707705283`*^9, 
   3.9283490760601034`*^9}, {3.928349109503683*^9, 3.9283493665825357`*^9}, {
   3.9283494552494526`*^9, 3.928349455924641*^9}, {3.928349496778389*^9, 
   3.92834958006269*^9}},
 CellLabel->
  "In[3687]:=",ExpressionUUID->"0253d884-f64d-4605-8a77-35dfaec0d477"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"ChristoffelMatrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"C11", "C12", "C13", "0", "0", "C16"},
       {"C12", "C22", "C23", "0", "0", "C26"},
       {"C13", "C23", "C33", "0", "0", "C36"},
       {"0", "0", "0", "C44", "C45", "0"},
       {"0", "0", "0", "C45", "C55", "0"},
       {"C16", "C26", "C36", "0", "0", "C66"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8246906436950884`*^9, 3.8246906476084127`*^9}, {
   3.8246907025179214`*^9, 3.8246907214835343`*^9}, 3.826553834919388*^9, 
   3.826900374849918*^9},
 CellLabel->
  "In[3688]:=",ExpressionUUID->"20f63861-779f-47d6-9a92-9823c9005040"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"ChristoffelMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"C11", "C12", "C13", "0", "0", "0"},
        {"C12", "C22", "C23", "0", "0", "0"},
        {"C13", "C23", "C33", "0", "0", "0"},
        {"0", "0", "0", "C44", "0", "0"},
        {"0", "0", "0", "0", "C55", "0"},
        {"0", "0", "0", "0", "0", "C66"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "]"}], 
   "]"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox["orthorhombic",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"ChristoffelMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"C11", "C12", "C13", "0", "0", "0"},
        {"C12", "C22", "C23", "0", "0", "0"},
        {"C13", "C23", "C33", "0", "0", "0"},
        {"0", "0", "0", "C44", "0", "0"},
        {"0", "0", "0", "0", "C55", "0"},
        {"0", "0", "0", "0", "0", "C66"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "]"}], 
   "]"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox["orthorhombic",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8288382773491893`*^9, 3.828838291077103*^9}, {
  3.828838473606498*^9, 3.828838484948908*^9}, {3.8288385185499372`*^9, 
  3.8288385280387444`*^9}},
 CellLabel->
  "In[3689]:=",ExpressionUUID->"8ec0d6a9-ef5f-419c-95c9-8ff519b766da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fedorov' s \[CapitalLambda] tensor :", "Subsection",
 CellChangeTimes->{{3.8255460743307104`*^9, 3.825546149037276*^9}, {
   3.8255462833905034`*^9, 3.8255462834095063`*^9}, 
   3.825602477734544*^9},ExpressionUUID->"e68d389f-eb63-4c71-bffb-\
ab21e1e28c2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"alphaBona", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"i", " ", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"9", "-", "i", "-", "j"}], ")"}]}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "immediately", " ", "follows", " ", "Eq", " ", "4", " ", "of", " ", 
     "Bona2007"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8200235665353217`*^9, 3.8200236655945573`*^9}, {
   3.825545647871185*^9, 3.825545664720043*^9}, 3.82554572427079*^9, {
   3.8255457571669292`*^9, 3.825545758511306*^9}},
 CellLabel->
  "In[3691]:=",ExpressionUUID->"bd7af651-6ba6-49b9-b5fd-9482f798274d"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"alphaBona", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8200236690535336`*^9, 3.820023704692467*^9}, 
   3.8255457697025814`*^9, {3.825547075855483*^9, 3.8255470828948517`*^9}},
 CellLabel->
  "In[3692]:=",ExpressionUUID->"b4185851-a7fe-4eb7-aeb1-c880993697c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cToC", "[", 
    RowBox[{"c", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k_", ",", "l_"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"alphaBona", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "\[LessEqual]", 
      RowBox[{"alphaBona", "[", 
       RowBox[{"k", ",", "l"}], "]"}]}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
       "entries", " ", "of", " ", "Voigt", " ", "matrix", " ", "C", " ", "in",
         " ", "terms", " ", "of", " ", "the", " ", "cijkl"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"C", "[", 
      RowBox[{
       RowBox[{"alphaBona", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"alphaBona", "[", 
        RowBox[{"k", ",", "l"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"C", "[", 
      RowBox[{
       RowBox[{"alphaBona", "[", 
        RowBox[{"k", ",", "l"}], "]"}], ",", 
       RowBox[{"alphaBona", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cToC", "[", 
  RowBox[{"c", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cToC", "[", 
  RowBox[{"c", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825458503364145*^9, 3.825458679474367*^9}, {
  3.8254587173139834`*^9, 3.825458734786127*^9}, {3.8254587732137012`*^9, 
  3.8254587810740433`*^9}, {3.825467694114634*^9, 3.8254677908350983`*^9}, {
  3.8254682373470774`*^9, 3.825468239810602*^9}, {3.825545818815027*^9, 
  3.8255458407736783`*^9}, {3.8259491011707363`*^9, 3.825949151159848*^9}, {
  3.8288376877664113`*^9, 3.8288376883895917`*^9}, {3.8288379530136085`*^9, 
  3.828837959397826*^9}},
 CellLabel->
  "In[3693]:=",ExpressionUUID->"3d9adfaa-ddd5-44b3-8bbe-2d9b4c627baa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]fedorovPRE", "[", 
    RowBox[{"i_", ",", "m_", ",", "nVec_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "\[Rho]"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "m"}], "}"}]}], "]"}], 
       RowBox[{"nVec", "[", 
        RowBox[{"[", "j", "]"}], "]"}], 
       RowBox[{"nVec", "[", 
        RowBox[{"[", "l", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "3"}], "}"}]}], "]"}]}]}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "is", " ", "Eq", " ", 
     RowBox[{"(", "15.20", ")"}], " ", "of", " ", "Fedorov"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]fedorov", "[", 
   RowBox[{"i_", ",", "m_", ",", "nVec_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "\[Rho]"], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cToC", "[", 
       RowBox[{"c", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "m"}], "}"}]}], "]"}], "]"}], 
      RowBox[{"nVec", "[", 
       RowBox[{"[", "j", "]"}], "]"}], 
      RowBox[{"nVec", "[", 
       RowBox[{"[", "l", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "3"}], "}"}]}], "]"}], "  ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"The", " ", "entry", " ", 
       StyleBox[
        SubscriptBox["\[CapitalLambda]", "im"],
        FontSize->24], " ", "of", " ", 
       RowBox[{"Fedorov", "'"}], "s", " ", 
       StyleBox["\[CapitalLambda]",
        FontSize->16]}], "-", "tensor"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.8254625941378927`*^9, 3.825462684178856*^9}, {
   3.825462771681367*^9, 3.8254628245784926`*^9}, {3.8254628917304277`*^9, 
   3.8254628944192142`*^9}, {3.825462952514119*^9, 3.8254629553946533`*^9}, {
   3.825463025362756*^9, 3.8254630607701473`*^9}, {3.825464456963486*^9, 
   3.825464468114289*^9}, 3.8254645594267073`*^9, 3.8254664313006425`*^9, 
   3.8254664852841773`*^9, {3.8254666553002*^9, 3.8254667046273966`*^9}, {
   3.825467822963441*^9, 3.825467844019342*^9}, {3.825468552850994*^9, 
   3.8254686035481496`*^9}, {3.8254686401325445`*^9, 3.825468641427227*^9}, {
   3.825545319039357*^9, 3.8255453338725777`*^9}, {3.8255458890722485`*^9, 
   3.825545926784335*^9}, {3.825545957599862*^9, 3.8255460254884057`*^9}, {
   3.8255463321757593`*^9, 3.825546333089082*^9}, {3.8259492480088115`*^9, 
   3.82594927943122*^9}},
 CellLabel->
  "In[3696]:=",ExpressionUUID->"994c713d-f914-4a68-83c7-fa113ad35d8c"],

Cell[BoxData[{
 RowBox[{"\[CapitalLambda]fedorovPRE", "[", 
  RowBox[{"1", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalLambda]fedorov", "[", 
  RowBox[{"1", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8254644826921544`*^9, 3.8254645166747036`*^9}, {
  3.8254666622261825`*^9, 3.825466663474425*^9}, {3.8254667138425865`*^9, 
  3.8254667178586097`*^9}, {3.8255463357341747`*^9, 3.8255463365748315`*^9}},
 CellLabel->
  "In[3698]:=",ExpressionUUID->"1d09e3ff-78ed-48bb-baf8-45d1ad0a1aad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Verifying that Slawinski' s Christoffel matrix \[CapitalGamma]mat is \[Rho] \
\[Times] Fedorov' s \[CapitalLambda] tensor :\
\>", "Subsection",
 CellChangeTimes->{{3.8255460743307104`*^9, 3.825546149037276*^9}, {
  3.8255462833905034`*^9, 3.8255462834095063`*^9}, {3.825547170721168*^9, 
  3.825547173680365*^9}, {3.8256025279646006`*^9, 3.8256025303034215`*^9}, {
  3.826553858428391*^9, 
  3.826553865974448*^9}},ExpressionUUID->"1f825147-c556-43d8-a113-\
f85392a1c156"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cmat", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "1"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "2"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "3"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "4"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "5"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"1", ",", "6"}], "]"}]},
      {"D12", 
       RowBox[{"C", "[", 
        RowBox[{"2", ",", "2"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"2", ",", "3"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"2", ",", "4"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"2", ",", "5"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"2", ",", "6"}], "]"}]},
      {"D13", "D23", 
       RowBox[{"C", "[", 
        RowBox[{"3", ",", "3"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"3", ",", "4"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"3", ",", "5"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"3", ",", "6"}], "]"}]},
      {"D14", "D24", "D34", 
       RowBox[{"C", "[", 
        RowBox[{"4", ",", "4"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"4", ",", "5"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"4", ",", "6"}], "]"}]},
      {"D15", "D25", "D35", "D45", 
       RowBox[{"C", "[", 
        RowBox[{"5", ",", "5"}], "]"}], 
       RowBox[{"C", "[", 
        RowBox[{"5", ",", "6"}], "]"}]},
      {"D16", "D26", "D36", "D46", "D56", 
       RowBox[{"C", "[", 
        RowBox[{"6", ",", "6"}], "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.825513059275028*^9, 3.8255130708885355`*^9}},
 CellLabel->
  "In[3700]:=",ExpressionUUID->"08156764-afbe-4cd9-980d-4eb63435cc2e"],

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]11", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], ",", 
     TagBox["Cmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], "\[Equal]", 
   RowBox[{"\[Rho]", " ", 
    RowBox[{"\[CapitalLambda]fedorov", "[", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]22", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], ",", 
     TagBox["Cmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], "\[Equal]", 
   RowBox[{"\[Rho]", " ", 
    RowBox[{"\[CapitalLambda]fedorov", "[", 
     RowBox[{"2", ",", "2", ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]33", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], ",", 
     TagBox["Cmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], "\[Equal]", 
   RowBox[{"\[Rho]", " ", 
    RowBox[{"\[CapitalLambda]fedorov", "[", 
     RowBox[{"3", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]23", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], ",", 
     TagBox["Cmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], "\[Equal]", 
   RowBox[{"\[Rho]", " ", 
    RowBox[{"\[CapitalLambda]fedorov", "[", 
     RowBox[{"2", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]13", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], ",", 
     TagBox["Cmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], "\[Equal]", 
   RowBox[{"\[Rho]", " ", 
    RowBox[{"\[CapitalLambda]fedorov", "[", 
     RowBox[{"1", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]12", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], ",", 
     TagBox["Cmat",
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], "]"}], "\[Equal]", 
   RowBox[{"\[Rho]", " ", 
    RowBox[{"\[CapitalLambda]fedorov", "[", 
     RowBox[{"1", ",", "2", ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8254684969319053`*^9, 3.825468499920698*^9}, {
  3.825468756340414*^9, 3.825468769098239*^9}, {3.825468800443495*^9, 
  3.8254688532015605`*^9}, {3.8254688920138197`*^9, 3.8254689419474115`*^9}, {
  3.825468974570924*^9, 3.8254690777654343`*^9}, {3.8254691245624533`*^9, 
  3.8254691834790792`*^9}, {3.82551307655317*^9, 3.8255131628408136`*^9}, {
  3.8255463255389185`*^9, 3.825546338335188*^9}},
 CellLabel->
  "In[3701]:=",ExpressionUUID->"40e46188-5b97-4b3c-aaff-f854aac10839"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"RulerBar",
CellGrouping->Manual,
WindowSize->{960, 827},
WindowMargins->{{Automatic, 209}, {Automatic, 96}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}, {
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
PageHeaderLines->{False, Inherited},
PrintingOptions->{"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{21.5625, 21.5625}, {7.1875, 36}}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowCellLabel->True,
ShowCellTags->False,
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {"ColorPalette" -> {RGBColor, -1}},
RenderingOptions -> {"ObjectDithering" -> True},
RenderingOptions -> {"RasterDithering" -> False},
ExpressionUUID->"2a60a543-7daa-43be-87c8-3c806e7b2001"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1176, 33, 58, "Input",ExpressionUUID->"f76e0fb2-f476-4524-9be9-d0e7e52752f2"],
Cell[1724, 55, 1144, 24, 94, "Input",ExpressionUUID->"89217b1e-4bad-45e2-9f98-9d1920f3bbf7"],
Cell[2871, 81, 506, 15, 46, "Input",ExpressionUUID->"934bf0af-77f0-4dde-9b85-e462b5d9b5ec"],
Cell[3380, 98, 1351, 35, 235, "Input",ExpressionUUID->"8518a208-0cec-47c6-93c2-8ef654931752"],
Cell[4734, 135, 1297, 27, 235, "Input",ExpressionUUID->"08d3ad1d-7e22-49bd-8212-7d5ce58a4600"],
Cell[CellGroupData[{
Cell[6056, 166, 354, 7, 105, "Section",ExpressionUUID->"4eb1feb6-c2ba-4fb6-b2f3-05a6cd1e0841"],
Cell[6413, 175, 1438, 35, 149, "Input",ExpressionUUID->"03fae7e2-eb3f-4f13-b56a-901d0bed9640"]
}, Open  ]],
Cell[7866, 213, 4449, 138, 178, "Input",ExpressionUUID->"739ae960-aa99-47b6-b1b4-b3a336796465"],
Cell[12318, 353, 261, 5, 30, "Input",ExpressionUUID->"6427e99d-1db7-4c12-aab9-0e39e8ae0499"],
Cell[12582, 360, 1208, 28, 119, "Input",ExpressionUUID->"e6029285-85bd-45c1-a019-631d1bbb8205"],
Cell[13793, 390, 1130, 26, 119, "Input",ExpressionUUID->"2b306b53-3987-4faf-8976-104fc9f825b9"],
Cell[CellGroupData[{
Cell[14948, 420, 216, 4, 34, "Subsubsection",ExpressionUUID->"d2edaa40-1936-4824-8f6f-b557a526c003"],
Cell[15167, 426, 6700, 178, 624, "Input",ExpressionUUID->"9531b01c-6e2a-4fec-9a81-e9bec287c966"]
}, Open  ]],
Cell[21882, 607, 365, 7, 78, "Section",ExpressionUUID->"e59a8be4-7a2f-4e3f-9659-bc93f2b40b48"],
Cell[22250, 616, 965, 31, 19, "Input",ExpressionUUID->"024a22b1-c9a1-4ad2-9c35-2827883006f0"],
Cell[23218, 649, 204, 3, 34, "Subsubsection",ExpressionUUID->"7c2371cc-e09e-474d-9d87-105b1c2999f0"],
Cell[23425, 654, 1907, 52, 48, "Input",ExpressionUUID->"05a473ea-c385-4e96-a25a-b4128d6d6ee1"],
Cell[25335, 708, 716, 13, 73, "Input",ExpressionUUID->"711c86cd-b31c-41ae-9405-7e9506389c36"],
Cell[26054, 723, 160, 3, 50, "Section",ExpressionUUID->"ffc94ad8-d63b-4add-9487-b4b2cedbb7c0"],
Cell[26217, 728, 1509, 41, 34, "Input",ExpressionUUID->"d9a6dd12-7ded-415b-8365-ca49654fd017"],
Cell[27729, 771, 11530, 364, 353, "Input",ExpressionUUID->"ad932059-3f2b-4b94-9763-5975876eaea3"],
Cell[39262, 1137, 398, 12, 21, "Input",ExpressionUUID->"881feb94-5608-47d7-a509-a0316aa0ae36"],
Cell[39663, 1151, 63169, 1830, 2385, "Input",ExpressionUUID->"538930f2-8506-4ab9-ae43-2498b92e58d2",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic],
Cell[CellGroupData[{
Cell[102857, 2985, 497, 9, 53, "Subsubsection",ExpressionUUID->"5ce811ad-87c3-4cea-b109-56d6d4ab1aee"],
Cell[103357, 2996, 3329, 95, 107, "Input",ExpressionUUID->"e728c251-a63a-4b60-a28e-a4f15cb7f990"]
}, Open  ]],
Cell[106701, 3094, 500, 15, 36, "Input",ExpressionUUID->"849d22bd-f7f8-4f55-8c67-24ff9d9ffafa"],
Cell[107204, 3111, 5642, 168, 194, "Input",ExpressionUUID->"4d3814d6-2969-448c-b776-ab2a14c58c9d"],
Cell[112849, 3281, 392, 8, 53, "Subsubsection",ExpressionUUID->"b5017052-3191-4c1d-929a-b43461bdcc4a"],
Cell[113244, 3291, 2727, 75, 79, "Input",ExpressionUUID->"bb9fbcc9-a815-47c2-bfb7-9a3c54eb26a0"],
Cell[115974, 3368, 2490, 58, 115, "Input",ExpressionUUID->"52edcace-73c4-4374-8306-5af61c564dc5"],
Cell[CellGroupData[{
Cell[118489, 3430, 582, 10, 34, "Subsubsection",ExpressionUUID->"e41b2a82-1489-4e66-b60f-a0f7c2fcd58e"],
Cell[119074, 3442, 8003, 223, 366, "Input",ExpressionUUID->"c532158f-afaf-43c0-bf12-75187c6319d5"]
}, Open  ]],
Cell[127092, 3668, 2914, 84, 136, "Input",ExpressionUUID->"c8341bf1-2c2a-48ef-8eb7-97ba3f25ee5d"],
Cell[130009, 3754, 451, 9, 53, "Subsubsection",ExpressionUUID->"fe045f71-5956-4aa0-87d2-dd225fa0ab6d"],
Cell[130463, 3765, 1245, 31, 69, "Input",ExpressionUUID->"d986cb68-4137-4b11-abac-7b7d06cf618a"],
Cell[131711, 3798, 267, 6, 30, "Input",ExpressionUUID->"5209845c-9e1e-4848-a770-948d7e9d1525"],
Cell[131981, 3806, 318, 6, 21, "Input",ExpressionUUID->"09c38d9e-0e6b-415c-95f9-753f8965fd18"],
Cell[132302, 3814, 1570, 44, 75, "Input",ExpressionUUID->"2c9181b5-2552-4a7e-a4c2-532a2fd5a708"],
Cell[133875, 3860, 549, 14, 21, "Input",ExpressionUUID->"281bb2d6-c2b4-4e1e-9821-edf0a61ba095"],
Cell[134427, 3876, 1441, 37, 52, "Input",ExpressionUUID->"4bf6264d-5a05-40d0-942e-eb9b5de12006"],
Cell[135871, 3915, 3908, 102, 50, "Input",ExpressionUUID->"c58dbe88-ac63-45e0-8c9b-3f7a4208d37a"],
Cell[139782, 4019, 203, 4, 23, "SmallText",ExpressionUUID->"2ce80975-ea93-4301-8bfc-9db6f1cf25dd",
 Evaluatable->False],
Cell[139988, 4025, 2304, 71, 50, "Input",ExpressionUUID->"536f4312-dc68-4de8-83b0-57aa762c4cae",
 PageBreakBelow->Automatic],
Cell[142295, 4098, 645, 12, 30, "Input",ExpressionUUID->"46c29b38-1f6d-4c0a-9802-19504d81f070"],
Cell[142943, 4112, 4053, 107, 154, "Input",ExpressionUUID->"d97731d8-9ab1-4150-b011-10494c2caf7e"],
Cell[146999, 4221, 3946, 110, 157, "Input",ExpressionUUID->"3cedf5ba-9b76-435d-b072-b60a8bc222b2"],
Cell[150948, 4333, 4642, 115, 93, "Input",ExpressionUUID->"71de11ff-a814-40df-a33b-69348878cdca"],
Cell[155593, 4450, 14316, 372, 357, "Input",ExpressionUUID->"0ebdfcfb-3ab9-423d-ba27-9745c116136e"],
Cell[169912, 4824, 1490, 40, 94, "Input",ExpressionUUID->"e15bfbaa-ebbd-45e2-8f08-07cdedef0c9c"],
Cell[171405, 4866, 420, 15, 39, "SmallText",ExpressionUUID->"a4d85da3-8861-4428-8eef-f7fd2c085d69",
 Evaluatable->False],
Cell[171828, 4883, 6468, 174, 227, "Input",ExpressionUUID->"87249965-ad31-40e6-83e4-d40d706478af"],
Cell[178299, 5059, 186, 3, 23, "SmallText",ExpressionUUID->"200e26b2-9755-499f-b596-12c4e75c917d"],
Cell[178488, 5064, 999, 25, 73, "Input",ExpressionUUID->"b5674215-07ed-4093-9c64-487d7b493931"],
Cell[179490, 5091, 557, 20, 39, "SmallText",ExpressionUUID->"b9ca4c45-f861-4171-8a96-0f3e3e561bc2"],
Cell[180050, 5113, 4956, 145, 326, "Input",ExpressionUUID->"fe33df65-b7e4-4057-8351-809631418ec1"],
Cell[185009, 5260, 1766, 56, 80, "Input",ExpressionUUID->"a3ca8ad5-9b3e-410d-9b22-7f64a2f05fcf"],
Cell[186778, 5318, 338, 9, 23, "Text",ExpressionUUID->"e0923b2d-eff1-4b97-9221-4fe41419cd09",
 Evaluatable->False],
Cell[187119, 5329, 927, 27, 36, "Input",ExpressionUUID->"50e56594-6e13-40ef-b393-cd664693a71d"],
Cell[188049, 5358, 199, 5, 23, "SmallText",ExpressionUUID->"fb61a168-9ebf-4428-a048-832ada1e60de"],
Cell[188251, 5365, 2397, 73, 166, "Input",ExpressionUUID->"51b56216-d987-4780-8a2c-08e0bd3f2a19"],
Cell[CellGroupData[{
Cell[190673, 5442, 278, 4, 41, "Subsection",ExpressionUUID->"47c6aa61-2033-4c21-96c7-925e0ec5c5e9"],
Cell[190954, 5448, 369, 7, 45, "Text",ExpressionUUID->"66f73bc8-236c-42bb-8efb-c04d12e63a14"],
Cell[191326, 5457, 437, 12, 30, "Input",ExpressionUUID->"ae3b2764-c38a-4840-b6ef-299aa552ba96"],
Cell[191766, 5471, 7544, 178, 250, "Input",ExpressionUUID->"7fe9d587-9bb5-43c7-b9c6-e09424755f9e"],
Cell[199313, 5651, 1501, 32, 136, "Input",ExpressionUUID->"d553a012-8a17-4a70-aa86-6d15822269ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200851, 5688, 286, 4, 41, "Subsection",ExpressionUUID->"c792bbd9-bc8e-49b7-b2ca-c886b1c9e83a"],
Cell[201140, 5694, 3832, 90, 64, "Input",ExpressionUUID->"b615f9b9-8447-4173-a1d7-b02210414749"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205009, 5789, 406, 6, 34, "Subsubsection",ExpressionUUID->"2d37cac6-a1ee-4e47-8a49-03656d55fcc5"],
Cell[205418, 5797, 479, 13, 38, "Input",ExpressionUUID->"0ea9075e-1466-42a2-9942-3d9f13185586"]
}, Open  ]],
Cell[205912, 5813, 205, 3, 50, "Section",ExpressionUUID->"3e34eae6-03e3-4270-8447-664bc273aa88"],
Cell[206120, 5818, 24300, 672, 574, "Input",ExpressionUUID->"76ed97da-d514-46c4-a217-392631c2fd37"],
Cell[230423, 6492, 713, 20, 64, "Input",ExpressionUUID->"ce2b15fc-7c25-48dc-8991-25702ee9d5e9"],
Cell[231139, 6514, 1925, 51, 79, "Input",ExpressionUUID->"432012bb-a525-43dc-99bd-deb7a3699092"],
Cell[233067, 6567, 1961, 50, 64, "Input",ExpressionUUID->"ce5a8221-4d15-4f0c-aeb8-4ad3c6eb7b9a"],
Cell[235031, 6619, 3014, 82, 98, "Input",ExpressionUUID->"0d99ee7c-54f3-49fc-ac59-9248e7366b6d"],
Cell[238048, 6703, 2577, 52, 173, "Input",ExpressionUUID->"a601fbab-de3d-4f8a-ac7f-04ef9a3f69d0"],
Cell[240628, 6757, 5193, 110, 240, "Input",ExpressionUUID->"e488ea37-5571-44ff-9c40-b665b0ee8428"],
Cell[245824, 6869, 597, 9, 34, "Subsubsection",ExpressionUUID->"dd48014b-7549-43f4-b6f6-8927d7dbc520"],
Cell[246424, 6880, 1088, 19, 90, "Input",ExpressionUUID->"2148e89d-1fbd-4476-bbdd-1c97e2280827"],
Cell[247515, 6901, 726, 10, 34, "Subsubsection",ExpressionUUID->"d53e857d-a0bb-498d-9417-5ae0858b6cc4"],
Cell[248244, 6913, 666, 10, 26, "Input",ExpressionUUID->"51e43bc0-576e-4016-a5a2-28da4c938d33"],
Cell[248913, 6925, 700, 10, 34, "Subsubsection",ExpressionUUID->"a76a64c5-9e99-43d4-9e8f-14c80d8336e2"],
Cell[249616, 6937, 674, 10, 26, "Input",ExpressionUUID->"3295499c-3608-4464-9092-1fc180cc0c82"],
Cell[CellGroupData[{
Cell[250315, 6951, 611, 9, 50, "Section",ExpressionUUID->"fbc91086-0fe9-41da-a16a-35f42ac68b2d"],
Cell[250929, 6962, 1952, 28, 30, "Input",ExpressionUUID->"46a2ebc9-0228-4d4c-8c56-8399d41cb10c"]
}, Open  ]],
Cell[252896, 6993, 1511, 38, 50, "Input",ExpressionUUID->"abe0271b-0f60-4be6-93fc-0ccf29911f6a"],
Cell[254410, 7033, 1657, 41, 50, "Input",ExpressionUUID->"bc6b4512-e875-4057-8803-105bd3f48744"],
Cell[256070, 7076, 7406, 199, 151, "Input",ExpressionUUID->"c1d934b2-12d0-4a28-906f-a460f548d299"],
Cell[263479, 7277, 435, 9, 21, "Input",ExpressionUUID->"0ad09230-a17c-4a21-a8b8-266807a928c1"],
Cell[CellGroupData[{
Cell[263939, 7290, 756, 16, 51, "Section",ExpressionUUID->"cec9ed71-2ae3-4c98-af0d-3c82e9eeabfc"],
Cell[264698, 7308, 1716, 39, 36, "Input",ExpressionUUID->"d9acef4f-2ad8-4133-9a1b-971805d1e7d8"],
Cell[266417, 7349, 394, 9, 52, "Input",ExpressionUUID->"9e8807b2-199e-4b35-bc77-b0af214703c9"],
Cell[CellGroupData[{
Cell[266836, 7362, 190, 3, 34, "Subsubsection",ExpressionUUID->"0cb2f32c-dc03-4541-ac48-87a82522382a"],
Cell[267029, 7367, 3003, 71, 230, "Input",ExpressionUUID->"0c0ac51a-a676-48c9-842a-596c46257f10"],
Cell[270035, 7440, 338, 9, 38, "Input",ExpressionUUID->"8ec4bac9-9939-44d6-b95a-31fe8e55b5b1"],
Cell[270376, 7451, 901, 25, 52, "Input",ExpressionUUID->"32c25af3-dab8-44d8-a5ef-fa0cc4ed1c44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[271314, 7481, 243, 4, 34, "Subsubsection",ExpressionUUID->"d42709bc-4616-456e-a660-aace75bb1ec7"],
Cell[271560, 7487, 553, 16, 30, "Input",ExpressionUUID->"16912d60-c00d-41f9-9e0d-260efe533b0c"],
Cell[272116, 7505, 2932, 61, 157, "Input",ExpressionUUID->"9ba8539d-96cd-4718-8cb6-2aa282c2570c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275085, 7571, 287, 4, 34, "Subsubsection",ExpressionUUID->"e75384d0-529a-4ede-9f98-37ce2e3a81fc"],
Cell[275375, 7577, 3011, 63, 157, "Input",ExpressionUUID->"ad5e7803-5779-4a27-b407-8b09657db841"]
}, Open  ]]
}, Open  ]],
Cell[278413, 7644, 2593, 52, 94, "Input",ExpressionUUID->"077b904a-2520-48d4-8831-1e4b0c2254fa"],
Cell[281009, 7698, 2736, 56, 94, "Input",ExpressionUUID->"298bfd05-7152-4a55-a624-c3cda0b80b04"],
Cell[283748, 7756, 980, 19, 73, "Input",ExpressionUUID->"e07777d1-6c6b-4192-8d27-d6341a2cacd3"],
Cell[CellGroupData[{
Cell[284753, 7779, 375, 10, 50, "Section",ExpressionUUID->"b345cf33-615b-41d4-85fa-227e4a4e5a1c"],
Cell[285131, 7791, 323, 6, 30, "Input",ExpressionUUID->"b21aaec9-5953-4f11-9959-a2a8628d8c64"],
Cell[285457, 7799, 598, 11, 30, "Input",ExpressionUUID->"e5a0d4a5-ad63-43fc-949d-e6099e5a7c0a"]
}, Open  ]],
Cell[286070, 7813, 5769, 155, 93, "Input",ExpressionUUID->"f9a45f13-729d-4179-9bf3-1c89496710d8"],
Cell[291842, 7970, 718, 15, 52, "Input",ExpressionUUID->"9f53e9f9-ba8d-41bf-979e-5c5a273dc2e0"],
Cell[292563, 7987, 5618, 171, 254, "Input",ExpressionUUID->"f69038f3-41c0-40bb-8395-65c41e8a7e60"],
Cell[298184, 8160, 392, 8, 30, "Input",ExpressionUUID->"aaeab46a-8d05-488a-b424-ffb67e8a4fa5"],
Cell[298579, 8170, 1443, 29, 73, "Input",ExpressionUUID->"70f72333-c30f-429c-8ff6-f2b71d5017a1"],
Cell[300025, 8201, 315, 6, 30, "Input",ExpressionUUID->"61c5dc0e-ae5f-48e1-9889-f592f148ed50"],
Cell[CellGroupData[{
Cell[300365, 8211, 225, 5, 34, "Subsubsection",ExpressionUUID->"fa8a0f60-4997-4fa8-8bfa-ea52aba81010"],
Cell[300593, 8218, 852, 18, 52, "Input",ExpressionUUID->"103736c1-95c8-4eb5-bcca-95c4161c7546"],
Cell[301448, 8238, 1498, 30, 94, "Input",ExpressionUUID->"aece23e7-71ae-4a25-bc57-46205291257e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302983, 8273, 369, 7, 34, "Subsubsection",ExpressionUUID->"5797dcf3-8039-430e-b18c-49d941a57d4a"],
Cell[303355, 8282, 1971, 60, 136, "Input",ExpressionUUID->"92be8de0-4e68-4c62-8dcf-15be033705cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305363, 8347, 393, 7, 34, "Subsubsection",ExpressionUUID->"40d94ada-c93f-483c-a4d9-54c7757fcefe"],
Cell[305759, 8356, 2916, 89, 175, "Input",ExpressionUUID->"9b2e4320-6250-4aa3-8554-20d7af7bf997"]
}, Open  ]],
Cell[CellGroupData[{
Cell[308712, 8450, 203, 3, 34, "Subsubsection",ExpressionUUID->"3bfc0de3-f2b8-4b85-a4f1-3b1acb545c32"],
Cell[308918, 8455, 623, 15, 52, "Input",ExpressionUUID->"0c797c23-f03e-4505-b509-b8c11dcbcc1b"],
Cell[309544, 8472, 832, 27, 86, "Input",ExpressionUUID->"0740e436-ae9c-446d-88b5-d000301a243d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310413, 8504, 598, 10, 53, "Subsubsection",ExpressionUUID->"851e819e-da03-4188-b1a2-429438ad4c34"],
Cell[311014, 8516, 1898, 34, 36, "Input",ExpressionUUID->"0f9519fe-9f2f-435b-bb72-3e32d06c1411"],
Cell[312915, 8552, 2677, 53, 36, "Input",ExpressionUUID->"b277b81b-1eb1-4fee-9f7d-3874d5d72893"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315629, 8610, 1303, 23, 34, "Subsubsection",ExpressionUUID->"945ce26c-6d9d-4c9b-9ac1-becddb36b96a"],
Cell[316935, 8635, 717, 19, 21, "Input",ExpressionUUID->"729b81f5-632d-4b57-baee-178eda01d242"],
Cell[317655, 8656, 1542, 43, 50, "Input",ExpressionUUID->"0d84ac36-cf05-49bc-bdda-568220551ed9"],
Cell[319200, 8701, 1214, 32, 73, "Input",ExpressionUUID->"c5ca278b-4a41-425d-8a4f-f2b7c443521d"],
Cell[320417, 8735, 247, 5, 30, "Input",ExpressionUUID->"ab240050-f9ac-44ea-9a6d-1da939874dd6"],
Cell[320667, 8742, 1667, 40, 94, "Input",ExpressionUUID->"5569ce1d-aa2a-4633-a374-77a033528a8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322371, 8787, 1183, 24, 34, "Subsubsection",ExpressionUUID->"155e7ff7-c59e-4166-bd4b-a32a83e6cd4f"],
Cell[323557, 8813, 947, 26, 52, "Input",ExpressionUUID->"11fe316f-103b-4e34-a65b-deb74a1dd419"],
Cell[324507, 8841, 1589, 37, 73, "Input",ExpressionUUID->"e1c1b702-7195-4009-8e4f-e28927eeb16e"],
Cell[326099, 8880, 1351, 34, 73, "Input",ExpressionUUID->"c3580ea5-0d51-4d60-a2c0-61cf0385f3f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327487, 8919, 1234, 25, 34, "Subsubsection",ExpressionUUID->"6fd174e2-56bc-425a-8ccf-1a8a9a8944b1"],
Cell[328724, 8946, 7382, 192, 346, "Input",ExpressionUUID->"0d359d9a-93ab-42f0-8198-41d1c75b762c"],
Cell[336109, 9140, 1360, 41, 106, "Input",ExpressionUUID->"04f56cc1-d98e-4d22-90fc-ea6ad6011b38"],
Cell[337472, 9183, 586, 16, 30, "Input",ExpressionUUID->"31272d1f-bc12-4598-8f76-0b8a006bd20f"],
Cell[338061, 9201, 310, 7, 30, "Input",ExpressionUUID->"1271df57-0464-454e-9813-978c99c22c4c"],
Cell[338374, 9210, 1459, 35, 73, "Input",ExpressionUUID->"c24f321a-59c9-4886-9eca-b889cbab742e"],
Cell[339836, 9247, 1263, 33, 73, "Input",ExpressionUUID->"795ba8c9-579e-4e7a-b568-6d7610ab444b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341136, 9285, 1389, 27, 34, "Subsubsection",ExpressionUUID->"ee8d4926-3b29-4b1f-b923-0ce402d83cfe"],
Cell[342528, 9314, 245, 5, 30, "Input",ExpressionUUID->"25e41851-7a52-487a-a747-e469fc33f374"],
Cell[342776, 9321, 2502, 62, 120, "Input",ExpressionUUID->"99c880ad-d319-497f-86a7-88a1cb6c37c8"],
Cell[345281, 9385, 2853, 69, 233, "Input",ExpressionUUID->"f7dbdcef-d72a-4082-81b3-2b55021bab31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348171, 9459, 171, 3, 41, "Subsection",ExpressionUUID->"6d01061b-90c8-4227-a068-d78f7e7bc29c"],
Cell[348345, 9464, 1958, 54, 50, "Input",ExpressionUUID->"33b96e9a-efb5-4a50-93b2-90b78dd514fc"],
Cell[CellGroupData[{
Cell[350328, 9522, 548, 11, 53, "Subsubsection",ExpressionUUID->"3ada8765-2d0a-4d0b-b7c1-033d836ff049"],
Cell[350879, 9535, 187, 3, 34, "Subsubsection",ExpressionUUID->"ac118f02-e63c-45cb-a057-c67b70f4850f"],
Cell[351069, 9540, 3496, 86, 279, "Input",ExpressionUUID->"9c755011-740f-4c83-af24-31d1d54da6ca"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[354614, 9632, 736, 11, 50, "Section",ExpressionUUID->"63cdc5c6-bfdf-49ea-83ab-543749b7a87a"],
Cell[355353, 9645, 2252, 54, 64, "Input",ExpressionUUID->"d73a6891-40b1-4ecf-85cd-19445f4acadb"],
Cell[CellGroupData[{
Cell[357630, 9703, 328, 7, 34, "Subsubsection",ExpressionUUID->"ca3cb7c9-38c0-455e-9158-a7b6d6df130e"],
Cell[357961, 9712, 229, 4, 34, "Subsubsection",ExpressionUUID->"2ba2f25d-c258-4e9f-aca9-51a8df9fe9c3"],
Cell[358193, 9718, 224, 4, 26, "Input",ExpressionUUID->"d5502b3c-58ac-4283-aaae-b0c1d3c01c6a"]
}, Open  ]]
}, Open  ]],
Cell[358444, 9726, 155, 3, 30, "Input",ExpressionUUID->"68c5b8cf-1b40-4d82-be53-d64100eee7fc"],
Cell[358602, 9731, 2250, 49, 136, "Input",ExpressionUUID->"468d7371-2337-4a3d-945c-a599b4a775a1"],
Cell[360855, 9782, 363, 7, 34, "Subsubsection",ExpressionUUID->"a0e68b50-595b-46a7-8f63-1568f8f4e04e"],
Cell[361221, 9791, 383, 8, 26, "Input",ExpressionUUID->"321eacc1-d0d2-4b37-8744-9f0ccc70e984"],
Cell[361607, 9801, 803, 19, 73, "Input",ExpressionUUID->"6871f14d-8a31-477a-8ea7-7cdfaed0bdeb"],
Cell[362413, 9822, 312, 8, 30, "Input",ExpressionUUID->"20747988-13a8-457b-94ee-ba93c0a7d530"],
Cell[362728, 9832, 3463, 98, 193, "Input",ExpressionUUID->"84f87e6b-c025-4003-84d5-e4727a2ae788"],
Cell[366194, 9932, 302, 7, 30, "Input",ExpressionUUID->"f3cce53e-1e9b-4770-88f0-ed2a5c0adea4"],
Cell[366499, 9941, 6405, 155, 344, "Input",ExpressionUUID->"5c9aa968-89c9-440c-9ae0-24d88c81c918"],
Cell[372907, 10098, 1054, 21, 73, "Input",ExpressionUUID->"9c03d7fe-1fb4-4b66-a298-cecec1a4dee1"],
Cell[373964, 10121, 3266, 78, 189, "Input",ExpressionUUID->"2e66e4c2-367c-462c-a785-9390444f4e22"],
Cell[377233, 10201, 151, 3, 50, "Section",ExpressionUUID->"714d7cce-0d99-471b-a256-3bcfb0bee6d5"],
Cell[CellGroupData[{
Cell[377409, 10208, 268, 4, 30, "Subsection",ExpressionUUID->"2ee3df54-cd5f-4575-9b30-e1780b5de184"],
Cell[377680, 10214, 502, 14, 23, "SmallText",ExpressionUUID->"91559a53-1dca-4f5a-95fb-52dacbe04791",
 Evaluatable->False],
Cell[378185, 10230, 2719, 72, 79, "Input",ExpressionUUID->"5205819f-fdaa-4552-8951-c0c94d0b34cb"],
Cell[380907, 10304, 1749, 43, 62, "Input",ExpressionUUID->"3d39e96c-f379-4feb-bf29-c14777d72c7b"],
Cell[382659, 10349, 2692, 65, 93, "Input",ExpressionUUID->"8e904876-de83-461e-8d66-fb75d8b5ff84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[385388, 10419, 218, 4, 41, "Subsection",ExpressionUUID->"db466874-671a-4e36-af8c-9570c4b8be36"],
Cell[385609, 10425, 4829, 143, 125, "Input",ExpressionUUID->"ed697781-4024-4f38-ba65-20e5915896fb"],
Cell[390441, 10570, 448, 10, 30, "Input",ExpressionUUID->"a604a19e-aed4-4c05-a311-fa8b232385df"],
Cell[390892, 10582, 1475, 38, 36, "Input",ExpressionUUID->"22036b23-f167-48db-bc31-40e14284cb65"],
Cell[392370, 10622, 469, 8, 30, "Input",ExpressionUUID->"c87bd770-1a33-44b3-8e0f-a77830ef7eed"],
Cell[392842, 10632, 984, 23, 52, "Input",ExpressionUUID->"41dd80a5-abd7-4761-a251-de6f2ba78e08"]
}, Open  ]],
Cell[393841, 10658, 403, 8, 53, "Subsubsection",ExpressionUUID->"e56136c8-6da3-4a07-bd09-12f88ded5f88"],
Cell[394247, 10668, 175, 3, 30, "Subsection",ExpressionUUID->"5aa02f85-cd5b-4206-8d6e-d9c5336a82e6"],
Cell[394425, 10673, 10346, 253, 270, "Input",ExpressionUUID->"d2c8d33c-0e1a-421a-b987-1c05df1578dc"],
Cell[404774, 10928, 441, 10, 41, "Text",ExpressionUUID->"5c141cbe-3f41-420b-a13c-76d4bb8bc9fd"],
Cell[405218, 10940, 14379, 337, 270, "Input",ExpressionUUID->"cdc2df6c-9ec9-48ab-8610-db53d39dc134"],
Cell[419600, 11279, 5298, 143, 138, "Input",ExpressionUUID->"f37a34d1-4b59-4b04-82e1-06f1b970ad6f"],
Cell[424901, 11424, 164, 3, 50, "Section",ExpressionUUID->"dfeb9470-90fa-4772-b627-3c73965cea3b"],
Cell[425068, 11429, 276, 6, 40, "Section",ExpressionUUID->"226e4501-8e51-4195-8c9e-e1ecaa821059"],
Cell[CellGroupData[{
Cell[425369, 11439, 294, 7, 29, "Subsubsection",ExpressionUUID->"f586061a-134a-40ce-b71c-80ac478175db"],
Cell[425666, 11448, 12794, 297, 821, "Input",ExpressionUUID->"a2727605-7936-47b1-b4c6-d2a7d502f2ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[438497, 11750, 852, 13, 34, "Subsubsection",ExpressionUUID->"2eea26a1-dcea-469c-b699-80a6628a781c"],
Cell[439352, 11765, 4786, 108, 193, "Input",ExpressionUUID->"13bd5a17-d2e1-4942-9c8d-0cab9fa6d59c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444175, 11878, 415, 7, 34, "Subsubsection",ExpressionUUID->"c24d55ee-3cb1-4405-b870-72131b8838d0"],
Cell[444593, 11887, 2626, 68, 79, "Input",ExpressionUUID->"8caae1c9-f736-447b-a16c-0086feb83659"],
Cell[447222, 11957, 482, 9, 30, "Input",ExpressionUUID->"5f6caf70-7ef5-4743-8df2-bfe752ce2685"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447741, 11971, 1314, 27, 50, "Section",ExpressionUUID->"13cf7320-b5ed-4ac9-8103-8f514e041cff"],
Cell[449058, 12000, 260, 6, 34, "Subsubsection",ExpressionUUID->"41c2ec94-2670-49fc-b090-77ac9da59a78"],
Cell[CellGroupData[{
Cell[449343, 12010, 1746, 39, 50, "Subsubsection",ExpressionUUID->"f7aba39f-2c1b-4a72-83e6-b7e1742a87f2"],
Cell[451092, 12051, 3520, 86, 64, "Input",ExpressionUUID->"9cd76e62-22fb-4468-9015-6bba38704344"],
Cell[454615, 12139, 717, 20, 45, "Input",ExpressionUUID->"13b6e91d-9aae-4767-977a-c2aa1d1e2135"]
}, Open  ]],
Cell[CellGroupData[{
Cell[455369, 12164, 1803, 38, 73, "Subsubsection",ExpressionUUID->"7e017654-1c81-4826-acde-eec61e4dbe5c"],
Cell[457175, 12204, 377, 9, 30, "Input",ExpressionUUID->"437ab04c-2a82-4c35-940d-f6dc016a507a"],
Cell[457555, 12215, 423, 11, 21, "Input",ExpressionUUID->"25d7e6cf-9c95-4a71-81f7-9056c4a61091"]
}, Open  ]],
Cell[CellGroupData[{
Cell[458015, 12231, 1194, 23, 34, "Subsubsection",ExpressionUUID->"e37544bb-f331-4e96-8636-05c77d2265d9"],
Cell[459212, 12256, 963, 18, 30, "Input",ExpressionUUID->"9a48d026-2e3b-4862-b0a9-66f7da439d86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[460212, 12279, 1552, 34, 34, "Subsubsection",ExpressionUUID->"7b1d197c-0f00-4ccd-acec-0902cf5a8916"],
Cell[461767, 12315, 1042, 28, 37, "Input",ExpressionUUID->"ec0b5774-808b-4f6d-a937-67732454574c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[462846, 12348, 1337, 28, 35, "Subsubsection",ExpressionUUID->"5b15b7e6-70ab-48e7-8532-ab16f6898eda"],
Cell[464186, 12378, 1293, 25, 52, "Input",ExpressionUUID->"a6b0e431-5fcb-4a0a-8af7-733c6694f93b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[465516, 12408, 688, 17, 34, "Subsubsection",ExpressionUUID->"e32a18a0-089c-433b-963f-e5ecf12db08b"],
Cell[466207, 12427, 7087, 150, 273, "Input",ExpressionUUID->"e1fa8d95-3727-4686-8cef-870d3eacd115"]
}, Open  ]],
Cell[CellGroupData[{
Cell[473331, 12582, 339, 11, 34, "Subsubsection",ExpressionUUID->"1266a1bd-6019-4bc9-bc43-a9c0d226e965"],
Cell[473673, 12595, 370, 10, 21, "Input",ExpressionUUID->"6f9ad221-e2aa-45cd-aaa9-4432d0c88931"],
Cell[474046, 12607, 288, 6, 30, "Input",ExpressionUUID->"5012bcee-ce94-4683-97a5-e457060c6be8"]
}, Open  ]]
}, Open  ]],
Cell[474361, 12617, 567, 12, 30, "Input",ExpressionUUID->"0396f90c-4bff-4a60-bfad-2ad9a220540f"],
Cell[CellGroupData[{
Cell[474953, 12633, 1584, 29, 73, "Subsubsection",ExpressionUUID->"868d699b-3511-42a2-be67-59f7b092f8ea"],
Cell[476540, 12664, 2047, 48, 50, "Input",ExpressionUUID->"44beb491-f80c-41fc-8c5e-708f7f2640a7"],
Cell[478590, 12714, 1911, 35, 94, "Input",ExpressionUUID->"bec5492e-d574-4098-bb1b-322c4cae1c7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[480538, 12754, 751, 13, 73, "Subsubsection",ExpressionUUID->"6c650f1b-931d-4b61-94cf-226a86e04597"],
Cell[481292, 12769, 1939, 45, 128, "Input",ExpressionUUID->"a6fdbf5f-6245-471b-b67a-e103d19a6861"],
Cell[483234, 12816, 622, 12, 30, "Input",ExpressionUUID->"318aa2c4-b024-42d2-8905-3c696be4ff3b"]
}, Open  ]],
Cell[483871, 12831, 10863, 297, 111, "Input",ExpressionUUID->"0d655f09-3313-4730-a341-d1d87043acbb"],
Cell[CellGroupData[{
Cell[494759, 13132, 680, 11, 34, "Subsubsection",ExpressionUUID->"9c9aa8ad-ef4f-4f06-b196-52753ffcbe4d"],
Cell[495442, 13145, 652, 12, 52, "Input",ExpressionUUID->"213cac8a-3063-4bc7-b6c3-0975e3298317"]
}, Open  ]],
Cell[496109, 13160, 277, 6, 34, "Subsubsection",ExpressionUUID->"0dee9b80-fe5d-418a-8cf8-b6e369f200bf"],
Cell[496389, 13168, 339, 5, 40, "Section",ExpressionUUID->"208529dc-759f-48ef-9c28-cd38475af3e9"],
Cell[496731, 13175, 213, 4, 29, "Subsubsection",ExpressionUUID->"975a51dc-c4ac-4fd2-b041-e165dd601877"],
Cell[496947, 13181, 1145, 33, 48, "Input",ExpressionUUID->"5585fec0-08a4-4fa1-b6e1-853bb03869b1"],
Cell[498095, 13216, 244, 8, 35, "Input",ExpressionUUID->"379551da-0d24-4997-825e-22abff2b3f53"],
Cell[498342, 13226, 6063, 140, 376, "Input",ExpressionUUID->"1c3c3d4c-0a03-4174-b3d8-5e9fedaa21f6"],
Cell[CellGroupData[{
Cell[504430, 13370, 183, 3, 34, "Subsubsection",ExpressionUUID->"db7e9f79-1ff1-4af4-bb9f-989bf86415ed"],
Cell[504616, 13375, 6268, 162, 584, "Input",ExpressionUUID->"a3d9e0d0-d9d3-473c-b17c-34902243049d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[510921, 13542, 163, 3, 50, "Section",ExpressionUUID->"5014b577-eade-44d5-9877-0b6fb524d0f2"],
Cell[511087, 13547, 1622, 43, 94, "Input",ExpressionUUID->"4dafd9f5-cf41-48ce-ba43-77f35832351a"],
Cell[512712, 13592, 631, 18, 52, "Input",ExpressionUUID->"058665eb-b880-4b38-8e3e-537583ce449c"],
Cell[513346, 13612, 3798, 99, 93, "Input",ExpressionUUID->"1833f63b-5540-4e88-877f-bfe1e4c82895"]
}, Open  ]],
Cell[517159, 13714, 400, 10, 30, "Input",ExpressionUUID->"e15ef17f-5dd4-4a87-b01f-2dbe440afb24"],
Cell[517562, 13726, 474, 11, 50, "Section",ExpressionUUID->"9f89590c-a30a-412c-9426-e3964188c53f"],
Cell[518039, 13739, 717, 21, 77, "Input",ExpressionUUID->"f0d35e3d-6776-4ed1-a006-2bfe05a2cda5"],
Cell[518759, 13762, 192, 3, 34, "Subsubsection",ExpressionUUID->"7b19875e-d322-4df6-b1e8-5dad627068b2"],
Cell[518954, 13767, 2857, 82, 91, "Input",ExpressionUUID->"ad5d1134-4a6a-437a-9902-ecf0c3f30e2a"],
Cell[521814, 13851, 1081, 32, 36, "Input",ExpressionUUID->"8815a845-0e32-4da4-84f7-9f376ed00181"],
Cell[CellGroupData[{
Cell[522920, 13887, 1360, 34, 115, "Input",ExpressionUUID->"50ca0582-d26d-4c98-b635-7621b85dd4b4"],
Cell[524283, 13923, 197, 4, 30, "Input",ExpressionUUID->"86a03460-9212-4bfe-8b9c-fd982938602e"]
}, Open  ]],
Cell[524495, 13930, 1014, 25, 50, "Input",ExpressionUUID->"8204e680-917c-4efe-90bd-4afec6c06118"],
Cell[525512, 13957, 1055, 26, 64, "Input",ExpressionUUID->"758e8289-feda-48e9-9320-7988a580484e"],
Cell[526570, 13985, 844, 17, 21, "Input",ExpressionUUID->"e50cb6d8-f75b-4d64-af83-484cfbe97cd4"],
Cell[527417, 14004, 1010, 23, 64, "Input",ExpressionUUID->"08ce8bb4-29d1-49df-90b2-7e3acc538284"],
Cell[528430, 14029, 327, 6, 34, "Subsubsection",ExpressionUUID->"7ba55eb9-e89c-44a1-9a54-a65a9f3320a8"],
Cell[528760, 14037, 5948, 128, 77, "Input",ExpressionUUID->"cfe7223a-97eb-4261-a174-00ae341b30ba"],
Cell[CellGroupData[{
Cell[534733, 14169, 537, 9, 34, "Subsubsection",ExpressionUUID->"82845610-7b09-48b4-8890-11b993725e08"],
Cell[535273, 14180, 4658, 110, 107, "Input",ExpressionUUID->"0e6496d9-2038-4ce8-b8c7-2f4affda3d75"]
}, Open  ]],
Cell[539946, 14293, 627, 9, 34, "Subsubsection",ExpressionUUID->"6b58937f-4cf9-4911-a96b-83e8c6c69808"],
Cell[540576, 14304, 1193, 31, 34, "Input",ExpressionUUID->"1241e5e9-fe9a-46b0-b769-a6276efd9b0d"],
Cell[541772, 14337, 799, 13, 34, "Subsubsection",ExpressionUUID->"e9b6dc6c-115f-4ca5-b3b9-ad6cccac662e"],
Cell[542574, 14352, 1239, 31, 34, "Input",ExpressionUUID->"42a39a91-16e1-4a1f-83de-1bb9408d044e"],
Cell[543816, 14385, 526, 10, 34, "Subsubsection",ExpressionUUID->"b946f69c-9b36-4a27-9684-7c47d7794f24"],
Cell[544345, 14397, 1564, 41, 48, "Input",ExpressionUUID->"c683eb0f-556e-4201-aa62-0783eb180af2"],
Cell[545912, 14440, 1845, 45, 79, "Input",ExpressionUUID->"025b6aae-f003-4ba8-91aa-536fd25872ba"],
Cell[547760, 14487, 990, 24, 34, "Subsubsection",ExpressionUUID->"75409e28-bd2d-490f-8905-4e92068cd9b7"],
Cell[548753, 14513, 2068, 58, 62, "Input",ExpressionUUID->"3969960d-a7ba-45a5-a6e8-450adaef1977"],
Cell[550824, 14573, 558, 8, 34, "Subsubsection",ExpressionUUID->"797ae50f-cd0a-4cf4-9495-d9fd6a02ab2e"],
Cell[551385, 14583, 543, 11, 48, "Input",ExpressionUUID->"f2e852cc-4101-4891-831c-e2c608fe211c"],
Cell[551931, 14596, 1500, 36, 50, "Input",ExpressionUUID->"b449c363-b347-4745-abdb-d7eca3deb486"],
Cell[CellGroupData[{
Cell[553456, 14636, 693, 15, 50, "Section",ExpressionUUID->"9ef33130-6f64-43af-b2b8-5487952d722d"],
Cell[554152, 14653, 1160, 28, 36, "Input",ExpressionUUID->"31d2f149-6858-4f2f-80ab-fce0187427f0"],
Cell[555315, 14683, 310, 6, 30, "Input",ExpressionUUID->"e3961900-d415-4752-9abd-9dadab0b6dcf"],
Cell[555628, 14691, 930, 21, 21, "Input",ExpressionUUID->"05feb303-451b-4030-bbca-765dff325d97"],
Cell[556561, 14714, 16509, 424, 813, "Input",ExpressionUUID->"2fb2e220-2d61-4789-a767-d90b23b892a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[573107, 15143, 303, 4, 34, "Subsubsection",ExpressionUUID->"ad26e51f-b01c-419e-820d-c95f067ae1c3"],
Cell[573413, 15149, 1433, 42, 48, "Input",ExpressionUUID->"7d7cef3f-dcd8-496e-ad51-b9ea784f5db8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[574883, 15196, 1110, 25, 41, "Subsection",ExpressionUUID->"3734f772-ecbf-4140-b5da-47be01d3670c"],
Cell[575996, 15223, 11098, 280, 1126, "Input",ExpressionUUID->"7be5dfaf-bb36-46aa-98f9-c5e770c53485"],
Cell[587097, 15505, 500, 16, 34, "Subsubsection",ExpressionUUID->"6d5ad732-8bf7-402b-8d3a-01c810f344f6"]
}, Open  ]],
Cell[587612, 15524, 2698, 56, 36, "Input",ExpressionUUID->"7a02722a-8930-47a3-a853-8195a584f120"],
Cell[590313, 15582, 443, 11, 30, "Input",ExpressionUUID->"8060ecd3-c0e7-4bee-9188-310f4b8bce2b"],
Cell[590759, 15595, 309, 7, 34, "Subsubsection",ExpressionUUID->"41fb8a5e-b571-4bfc-ae10-4882de4ba9c5"],
Cell[591071, 15604, 2288, 54, 66, "Input",ExpressionUUID->"5b0e8ceb-9a9a-4f5a-b88e-9453c59feddb"],
Cell[CellGroupData[{
Cell[593384, 15662, 479, 9, 34, "Subsubsection",ExpressionUUID->"58b73080-3e63-4e52-a43a-8c4e067dbd66"],
Cell[593866, 15673, 328, 6, 34, "Subsubsection",ExpressionUUID->"f968018b-67dc-43aa-953a-3192ab076f0e"]
}, Open  ]],
Cell[594209, 15682, 350, 7, 34, "Subsubsection",ExpressionUUID->"0a76e4fe-510b-4adf-9b7d-a86e5b66ff4d"],
Cell[594562, 15691, 2279, 53, 62, "Input",ExpressionUUID->"6751929c-09d5-4b36-8754-df9a18c2f497"],
Cell[596844, 15746, 1366, 29, 53, "Subsubsection",ExpressionUUID->"b2e3b68f-fa71-4a40-87ef-d8244a29e4cd"],
Cell[598213, 15777, 2193, 55, 95, "Input",ExpressionUUID->"3b488055-80e2-4d7d-83d5-2669f39f702f"],
Cell[600409, 15834, 2192, 53, 64, "Input",ExpressionUUID->"d48f2da6-0ebf-47bf-b1db-adda914a7300"],
Cell[602604, 15889, 185, 3, 34, "Subsubsection",ExpressionUUID->"64acddda-d069-4cb6-8e35-17e887b10198"],
Cell[602792, 15894, 2192, 51, 161, "Input",ExpressionUUID->"c33f1479-6307-47af-91f9-c80eea177026"],
Cell[604987, 15947, 1234, 24, 197, "Input",ExpressionUUID->"c0054373-eebb-456c-9179-4581e8c5dfdf"],
Cell[606224, 15973, 246, 6, 34, "Subsubsection",ExpressionUUID->"8acdc843-f73b-488f-99f5-e88fbd8ed9f9"],
Cell[606473, 15981, 1683, 39, 132, "Input",ExpressionUUID->"3283d0ca-4a02-4e40-952e-3fefbe9fa04c"],
Cell[608159, 16022, 1389, 33, 93, "Input",ExpressionUUID->"2277bdac-b0f0-45e2-87e5-a9f95b54d188"],
Cell[CellGroupData[{
Cell[609573, 16059, 270, 5, 34, "Subsubsection",ExpressionUUID->"5feb9646-3db4-43e4-bd8e-c1f275f6f3ff"],
Cell[609846, 16066, 2293, 51, 123, "Input",ExpressionUUID->"8aed9833-a679-4aae-bfea-df0b4b0e4013"],
Cell[612142, 16119, 2771, 56, 79, "Input",ExpressionUUID->"99ce35eb-7be0-43ec-8de5-2a7038f9bfa7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[614950, 16180, 374, 6, 34, "Subsubsection",ExpressionUUID->"ef7f4560-e43e-484a-9f1c-7179de5972c9"],
Cell[615327, 16188, 2362, 52, 123, "Input",ExpressionUUID->"3b0f179a-1fd5-42de-86ae-cdfbe7e1bf02"],
Cell[617692, 16242, 239, 4, 21, "Input",ExpressionUUID->"9b6cf47a-01d2-4770-9538-a2662da3a298"],
Cell[617934, 16248, 2878, 58, 79, "Input",ExpressionUUID->"a33a1aee-f1ce-442f-b434-1319f0c04c73"]
}, Open  ]],
Cell[620827, 16309, 210, 3, 34, "Subsubsection",ExpressionUUID->"9d275f85-90e6-458d-8026-4761295f98e2"],
Cell[621040, 16314, 10822, 238, 178, "Input",ExpressionUUID->"0709f7ce-364b-40d6-98a2-be79151017f6"],
Cell[631865, 16554, 471, 8, 30, "Input",ExpressionUUID->"873ff0df-19f6-4985-ab90-d17d5944517d"],
Cell[632339, 16564, 2693, 50, 98, "Input",ExpressionUUID->"c5cb2e20-6e07-4f7e-8e71-7a43d85d4785"],
Cell[635035, 16616, 1822, 36, 94, "Input",ExpressionUUID->"527e2f26-7f95-47d1-a38b-8251ed5b7f16"],
Cell[636860, 16654, 155, 3, 30, "Input",ExpressionUUID->"598e65f2-b7b8-4dca-9597-2db52a7c6e13"],
Cell[CellGroupData[{
Cell[637040, 16661, 525, 10, 53, "Subsubsection",ExpressionUUID->"dded4cf9-74a0-4151-a428-991aaf612d82"],
Cell[637568, 16673, 4918, 119, 150, "Input",ExpressionUUID->"df3b93d8-4ee8-4a19-ad72-02127b791f58"]
}, Open  ]],
Cell[642501, 16795, 332, 5, 34, "Subsubsection",ExpressionUUID->"1689f830-70d3-4959-9c07-02e7f3b989de"],
Cell[642836, 16802, 1176, 35, 120, "Input",ExpressionUUID->"26827675-f61a-47ff-b1ef-081ba35c5cc7"],
Cell[644015, 16839, 2518, 63, 94, "Input",ExpressionUUID->"c6797a5d-bcdd-4a02-aefc-b0e5d2e6efde"],
Cell[646536, 16904, 386, 6, 34, "Subsubsection",ExpressionUUID->"14708f31-a477-4441-98c0-c510fa5be1e3"],
Cell[646925, 16912, 299, 7, 26, "Input",ExpressionUUID->"f78efe6b-5aea-4530-a264-2756e8267381"],
Cell[647227, 16921, 1104, 30, 21, "Input",ExpressionUUID->"766e4cce-afa7-484d-9749-0c09a0b919a1"],
Cell[648334, 16953, 302, 7, 30, "Input",ExpressionUUID->"89a19d4d-42f9-4dde-a0ed-afd9ebd70738"],
Cell[648639, 16962, 283, 6, 34, "Subsubsection",ExpressionUUID->"30d506e4-f45f-4d9a-ae2d-97b686381d9a"],
Cell[648925, 16970, 2862, 66, 77, "Input",ExpressionUUID->"20e8f885-a5cd-46ad-9a01-bc8aa61a1c21"],
Cell[651790, 17038, 286, 6, 34, "Subsubsection",ExpressionUUID->"7d8feada-49ea-4192-acbb-104681fd24eb"],
Cell[652079, 17046, 2838, 67, 77, "Input",ExpressionUUID->"6b61f797-9261-49c1-8f34-41f2b315cb77"],
Cell[654920, 17115, 364, 9, 30, "Input",ExpressionUUID->"e3efe453-3daf-4865-b649-cf34a7cf5719"],
Cell[655287, 17126, 450, 11, 52, "Input",ExpressionUUID->"79d91f48-ff59-48c5-9650-b5189b42207f"],
Cell[655740, 17139, 398, 8, 52, "Input",ExpressionUUID->"c6063130-864b-47ba-92fd-24d6355d1c7a"],
Cell[656141, 17149, 449, 9, 52, "Input",ExpressionUUID->"bf7ce556-6817-4f9c-82f5-0e56b60a0cee"],
Cell[656593, 17160, 189, 3, 34, "Subsubsection",ExpressionUUID->"950644cd-8a14-4611-a100-48101445c816"],
Cell[656785, 17165, 720, 19, 29, "Subsubsection",ExpressionUUID->"67f66682-3c98-4458-9502-faa3a42215a5"],
Cell[657508, 17186, 453, 7, 29, "Subsubsection",ExpressionUUID->"18efcc85-0fb1-4e67-b57c-35f09b6e3a76"],
Cell[657964, 17195, 395, 10, 34, "Input",ExpressionUUID->"ae43a1f9-122c-43d0-a921-a4010296623a"],
Cell[658362, 17207, 1692, 44, 93, "Input",ExpressionUUID->"43c8b359-9c2c-4ad4-bd31-ac98cfc7ad81"],
Cell[660057, 17253, 517, 8, 34, "Subsubsection",ExpressionUUID->"43ed7975-2e7e-4dc9-b90b-b385735cd4c8"],
Cell[660577, 17263, 384, 9, 34, "Input",ExpressionUUID->"f04f1717-9f17-407d-8a29-4702536dca3c"],
Cell[660964, 17274, 473, 7, 34, "Subsubsection",ExpressionUUID->"4101eddf-554f-47de-ae6e-f9404becd7b5"],
Cell[661440, 17283, 2383, 69, 162, "Input",ExpressionUUID->"2dd79339-4654-4dbc-ba00-17722e92526a"],
Cell[663826, 17354, 1268, 36, 119, "Input",ExpressionUUID->"b387c796-68cf-439d-9af9-f17b6115bf5c"],
Cell[665097, 17392, 382, 6, 34, "Subsubsection",ExpressionUUID->"ba24de6d-7bc3-4ac9-bfd7-50c41a7e2871"],
Cell[665482, 17400, 2078, 52, 87, "Input",ExpressionUUID->"9f1a7ddb-4ca7-4ea4-9c96-fb434a497f4c"],
Cell[667563, 17454, 463, 7, 34, "Subsubsection",ExpressionUUID->"77d9e195-33a1-48e0-8855-b9c643b41779"],
Cell[668029, 17463, 1989, 48, 87, "Input",ExpressionUUID->"d74790a2-f856-4a39-85c4-95b20ba6b9d6"],
Cell[670021, 17513, 472, 7, 34, "Subsubsection",ExpressionUUID->"b27680e7-25bb-461b-92d9-39b8488f416e"],
Cell[670496, 17522, 926, 25, 48, "Input",ExpressionUUID->"d45041b3-4659-4969-9fcb-1cdfaf0f53be"],
Cell[671425, 17549, 217, 4, 30, "Input",ExpressionUUID->"8222c761-e3ce-4722-967e-826c32b3dd74"],
Cell[671645, 17555, 621, 13, 64, "Input",ExpressionUUID->"f016d6be-c75c-440e-8d79-54acab30c316"],
Cell[672269, 17570, 505, 11, 52, "Input",ExpressionUUID->"d81736f2-425d-431d-8c95-8e02007d9f1c"],
Cell[672777, 17583, 240, 5, 21, "Input",ExpressionUUID->"e6e40c86-37bc-4ef3-910f-97039d9af9f3"],
Cell[673020, 17590, 337, 8, 52, "Input",ExpressionUUID->"b6523880-28d4-4c11-a1f6-803e26a63875"],
Cell[CellGroupData[{
Cell[673382, 17602, 615, 14, 34, "Subsubsection",ExpressionUUID->"21e78778-1bf0-4b1e-96ed-a444f6f15cee"],
Cell[674000, 17618, 2320, 57, 79, "Input",ExpressionUUID->"988336bf-e8f6-4043-9e47-3d618da23028"],
Cell[676323, 17677, 523, 9, 30, "Input",ExpressionUUID->"c2159d63-c0b8-4c64-8181-42b409b1e4ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[676883, 17691, 966, 16, 82, "Subsection",ExpressionUUID->"8d5e09dc-38e1-4210-9425-b98780b5419c"],
Cell[677852, 17709, 373, 6, 34, "Subsubsection",ExpressionUUID->"68a76207-051d-44d1-823e-2cb6e8597300"],
Cell[678228, 17717, 3195, 73, 62, "Input",ExpressionUUID->"b7a9973b-74e6-4f69-b26a-aaeec6fd7075"]
}, Open  ]],
Cell[681438, 17793, 763, 17, 21, "Input",ExpressionUUID->"107c8d68-5a6e-408d-8fcd-22cc5e025e38"],
Cell[CellGroupData[{
Cell[682226, 17814, 475, 9, 61, "Subsection",ExpressionUUID->"fefcfc87-6219-4cd1-932b-84be89e7ca28"],
Cell[682704, 17825, 1450, 41, 50, "Input",ExpressionUUID->"dd39b62f-6eff-4bc6-91cd-5ef497223559"]
}, Open  ]],
Cell[684169, 17869, 1747, 34, 50, "Input",ExpressionUUID->"7606f411-19b3-4eed-8816-6b0092a37a0d"],
Cell[685919, 17905, 2976, 62, 136, "Input",ExpressionUUID->"baa8a37b-6108-42ac-9c64-c3c1f1baa6f2"],
Cell[CellGroupData[{
Cell[688920, 17971, 272, 6, 78, "Section",ExpressionUUID->"74cd6286-c0a1-4620-b977-794197466edd"],
Cell[689195, 17979, 205, 3, 34, "Subsubsection",ExpressionUUID->"886acee9-3dbc-4109-a0c4-5a3f0149adff"]
}, Open  ]],
Cell[689415, 17985, 147, 3, 34, "Subsubsection",ExpressionUUID->"c427a2c7-9b03-4f62-8d29-eb4d22d28e0f"],
Cell[689565, 17990, 276, 6, 19, "Input",ExpressionUUID->"2b28db42-6430-449f-bfbd-076f811ed256"],
Cell[689844, 17998, 237, 6, 30, "Input",ExpressionUUID->"d586a33c-7559-4038-86ad-b3a317df5ab6"],
Cell[690084, 18006, 189, 5, 30, "Input",ExpressionUUID->"b8d82f3d-4057-47d6-9b4d-3a5e17a8ccda"],
Cell[690276, 18013, 238, 6, 30, "Input",ExpressionUUID->"e2463291-2011-46b6-96ad-13020e03690f"],
Cell[690517, 18021, 411, 8, 53, "Subsubsection",ExpressionUUID->"96f933a4-1603-4354-bcda-0ae9105a0634"],
Cell[690931, 18031, 2575, 43, 48, "Input",ExpressionUUID->"a5893e64-5a6c-417d-9ef8-f78e4734dece"],
Cell[693509, 18076, 616, 10, 34, "Subsubsection",ExpressionUUID->"656502d4-efda-4045-98bf-d350c937bb3e"],
Cell[694128, 18088, 1937, 43, 48, "Input",ExpressionUUID->"cc384cfe-33d1-40f7-9674-b5e5dd6f80a5"],
Cell[696068, 18133, 322, 5, 34, "Subsubsection",ExpressionUUID->"febd46bb-5d4f-4d24-b412-319706c4d972"],
Cell[696393, 18140, 719, 16, 19, "Input",ExpressionUUID->"4735d8a6-6820-4f44-988c-69a1a5d9d33c"],
Cell[697115, 18158, 509, 10, 53, "Subsubsection",ExpressionUUID->"372c74c7-5ca8-4a55-8e08-fab5c5d82a09"],
Cell[697627, 18170, 453, 13, 29, "Subsubsection",ExpressionUUID->"aad91d2c-6725-4424-b214-a6c27772209b"],
Cell[698083, 18185, 210, 5, 26, "Input",ExpressionUUID->"91f21e25-600b-4d5c-8e61-f121e3c4f281"],
Cell[698296, 18192, 4384, 121, 124, "Input",ExpressionUUID->"bf83fa6a-012c-4613-aa12-e162e5674d5b"],
Cell[702683, 18315, 162, 4, 21, "Input",ExpressionUUID->"683206bc-2f12-4ec3-b4d1-90e24797ecee"],
Cell[702848, 18321, 1256, 28, 178, "Input",ExpressionUUID->"ff4c0348-f996-44ed-8b68-0381b1001069"],
Cell[704107, 18351, 3208, 78, 283, "Input",ExpressionUUID->"ee14b0d4-68af-41ff-904a-8e4b7c7ced41"],
Cell[707318, 18431, 551, 10, 34, "Subsubsection",ExpressionUUID->"a10e5901-022e-4518-a93a-7127763cc00b"],
Cell[707872, 18443, 4370, 87, 108, "Input",ExpressionUUID->"19945bb5-2a6d-410f-a8e0-a6958d8f1559"],
Cell[712245, 18532, 592, 10, 34, "Subsubsection",ExpressionUUID->"8b3a993f-cfe6-4b0d-a637-1f38ef4b7fd7"],
Cell[712840, 18544, 1555, 39, 48, "Input",ExpressionUUID->"f1ce604e-9344-45a6-acc9-e2637e52a686"],
Cell[714398, 18585, 380, 6, 34, "Subsubsection",ExpressionUUID->"cca22269-7b95-4f97-9e59-69eedcbd9982"],
Cell[714781, 18593, 580, 16, 19, "Input",ExpressionUUID->"8654f462-7fa3-414f-9d93-6daeedacbce3"],
Cell[715364, 18611, 743, 13, 152, "Subsubsection",ExpressionUUID->"6e200428-3cef-438a-8de8-e1e9051efa9a"],
Cell[716110, 18626, 195, 3, 30, "Subsection",ExpressionUUID->"ebc724e5-63ce-4c9c-b080-703261ca1e3d"],
Cell[716308, 18631, 1809, 44, 36, "Input",ExpressionUUID->"2882f5a7-bf58-4181-ba69-ec1182b79236"],
Cell[718120, 18677, 3781, 87, 93, "Input",ExpressionUUID->"b6db0598-fd2a-4cfb-95b9-b7b725629b27"],
Cell[721904, 18766, 3769, 88, 93, "Input",ExpressionUUID->"0d885f59-8dea-4e24-b2c8-f362a54d008c"],
Cell[725676, 18856, 1859, 40, 136, "Input",ExpressionUUID->"64a32fd5-8bd0-453b-9811-5a733ade9e69"],
Cell[727538, 18898, 524, 14, 47, "Input",ExpressionUUID->"ac35b6c2-76a7-49b7-8fd3-ec6a726674c4"],
Cell[728065, 18914, 2861, 64, 115, "Input",ExpressionUUID->"79599c6a-76ff-421b-9f6c-98b6aaa564df"],
Cell[730929, 18980, 182, 3, 34, "Subsubsection",ExpressionUUID->"ee4b650c-a527-45e4-a280-e162f5a11b01"],
Cell[731114, 18985, 990, 30, 48, "Input",ExpressionUUID->"6b1fbd57-a04c-4ca9-8e03-dc15ea91190b"],
Cell[732107, 19017, 385, 7, 78, "Section",ExpressionUUID->"ded59786-ff54-4f06-8f28-643da340a571"],
Cell[732495, 19026, 333, 8, 19, "Input",ExpressionUUID->"b6680e3f-e34c-4f00-b2f3-049dadbff7a7"],
Cell[732831, 19036, 28083, 639, 943, "Input",ExpressionUUID->"90535a1f-a565-41c7-9d23-da6ba91205cc"],
Cell[760917, 19677, 1194, 25, 103, "Subsection",ExpressionUUID->"8c21c4a9-6b7f-4f00-a0dd-ba46b8267e9b"],
Cell[762114, 19704, 302, 6, 43, "Subsubsection",ExpressionUUID->"1ef1f2f5-5e42-46ca-a53c-430683b9d110"],
Cell[762419, 19712, 225, 4, 19, "Input",ExpressionUUID->"0fb0e76d-27e5-47a4-b04f-0e6b5f959a4c"],
Cell[762647, 19718, 10668, 213, 242, "Input",ExpressionUUID->"b973c48d-b3fc-484e-a038-a64e1527c774"],
Cell[773318, 19933, 299, 7, 21, "Input",ExpressionUUID->"3a9b7ef4-b91f-4cf9-8b1d-99da48bdf098"],
Cell[773620, 19942, 1597, 40, 94, "Input",ExpressionUUID->"067cfb9a-d257-40aa-a16e-1a0d683725a0"],
Cell[CellGroupData[{
Cell[775242, 19986, 408, 6, 50, "Section",ExpressionUUID->"4cb167f3-2161-485c-a869-bf7300c87ead"],
Cell[CellGroupData[{
Cell[775675, 19996, 172, 3, 34, "Subsubsection",ExpressionUUID->"2faeb7c0-331f-42e7-a18a-508bcf6a1483"],
Cell[775850, 20001, 369, 8, 21, "Input",ExpressionUUID->"5e5ea396-6286-479e-bccc-2bb28aed482f"],
Cell[776222, 20011, 2195, 46, 50, "Input",ExpressionUUID->"6357b6dd-4d1c-48d6-84fd-e36095d1cc65"],
Cell[778420, 20059, 997, 23, 50, "Input",ExpressionUUID->"2c49f53f-1d72-498c-9ba6-45b79e340b37"]
}, Open  ]]
}, Open  ]],
Cell[779444, 20086, 1658, 41, 107, "Input",ExpressionUUID->"5529a5dc-696b-41be-875e-295896d0cb0b"],
Cell[781105, 20129, 782, 15, 73, "Input",ExpressionUUID->"707c96da-43ad-4774-a246-4689e6b2468c"],
Cell[781890, 20146, 364, 9, 21, "Input",ExpressionUUID->"e0cb3fd9-51d7-47da-b43c-c448e0d2265e"],
Cell[782257, 20157, 305, 7, 21, "Input",ExpressionUUID->"1108baa9-0fc2-4abc-80dc-100a8f0dcd53"],
Cell[782565, 20166, 473, 11, 34, "Subsubsection",ExpressionUUID->"b24f3289-d98c-4f86-8890-a7369aae3717"],
Cell[783041, 20179, 1659, 43, 132, "Input",ExpressionUUID->"7c235139-606b-493c-9645-cc85f708e716"],
Cell[CellGroupData[{
Cell[784725, 20226, 185, 3, 50, "Section",ExpressionUUID->"486ab6b3-51ee-40dd-878b-fa615982284c"],
Cell[784913, 20231, 716, 22, 21, "Input",ExpressionUUID->"43a90122-53bc-4213-abd8-65d713adfc3e"],
Cell[785632, 20255, 1317, 30, 50, "Input",ExpressionUUID->"c9e62d95-d002-4859-8485-f1ddaca58515"],
Cell[786952, 20287, 711, 14, 73, "Input",ExpressionUUID->"4e4dee53-4ad7-4f5b-aacd-04715fa040c6"],
Cell[787666, 20303, 2343, 52, 109, "Input",ExpressionUUID->"322ac93e-5375-4600-a967-6f83d2c1c522"]
}, Open  ]],
Cell[790024, 20358, 1060, 23, 94, "Input",ExpressionUUID->"03fc057b-9014-4044-8774-4996866d5655"],
Cell[791087, 20383, 2209, 55, 262, "Input",ExpressionUUID->"67ef385d-d2e2-46a3-9a62-530b98a7161a"],
Cell[793299, 20440, 390, 8, 34, "Subsubsection",ExpressionUUID->"dd652703-73c7-47a7-8841-a69bb9812934"],
Cell[793692, 20450, 3284, 63, 77, "Input",ExpressionUUID->"538cc135-7386-4be8-98c0-23d67fbe2232"],
Cell[796979, 20515, 1935, 41, 79, "Input",ExpressionUUID->"7829af70-2f55-4f95-b999-159d3ecb38b2"],
Cell[CellGroupData[{
Cell[798939, 20560, 430, 8, 34, "Subsubsection",ExpressionUUID->"17e92cd7-e3fc-49c4-aed7-ed8deeb5a3d8"],
Cell[799372, 20570, 1785, 42, 79, "Input",ExpressionUUID->"bf3ea5df-373b-4c6f-ac52-495abe962320"]
}, Open  ]],
Cell[801172, 20615, 1704, 41, 79, "Input",ExpressionUUID->"93b21678-9825-49a7-8836-8aaf100aff67"],
Cell[802879, 20658, 464, 7, 50, "Section",ExpressionUUID->"2440f2f4-9287-446b-9d1a-55c300fb17e3"],
Cell[803346, 20667, 4194, 120, 173, "Input",ExpressionUUID->"be5f639e-e294-4c15-8eb3-8f811f9415b0"],
Cell[807543, 20789, 4250, 99, 79, "Input",ExpressionUUID->"2f195364-f849-47a2-a10a-f820f01afba2"],
Cell[811796, 20890, 396, 7, 34, "Subsubsection",ExpressionUUID->"162df65c-bdd9-406b-b65b-4d09e084168d"],
Cell[812195, 20899, 520, 9, 48, "Subsubsection",ExpressionUUID->"696bc5d5-1a9b-4d58-b71b-75c836027326"],
Cell[812718, 20910, 2786, 75, 109, "Input",ExpressionUUID->"b144efd7-b2d1-46e6-ac85-a0ed95e2efa1"],
Cell[815507, 20987, 644, 17, 21, "Input",ExpressionUUID->"ee308d0e-134d-4312-ab19-9c094f61a4e2"],
Cell[816154, 21006, 618, 18, 21, "Input",ExpressionUUID->"1ccdb220-fb4e-40a1-b358-e842c581273c"],
Cell[816775, 21026, 618, 18, 21, "Input",ExpressionUUID->"ad541482-34c2-4063-94ea-669c16bca9bd"],
Cell[817396, 21046, 612, 18, 21, "Input",ExpressionUUID->"de90d7fd-9b84-463f-86ca-c47e913348e9"],
Cell[818011, 21066, 538, 10, 34, "Subsubsection",ExpressionUUID->"3e090d23-622e-4360-8eeb-70f7342b072e"],
Cell[818552, 21078, 3993, 91, 77, "Input",ExpressionUUID->"62981257-ed32-417b-b42c-a92765490da0"],
Cell[822548, 21171, 2522, 62, 81, "Input",ExpressionUUID->"58dbe49e-dd0a-44db-ae63-a3824166b8ea"],
Cell[825073, 21235, 752, 19, 21, "Input",ExpressionUUID->"d02656f0-1484-4e88-8b32-c14624da9868"],
Cell[825828, 21256, 695, 19, 21, "Input",ExpressionUUID->"42fee069-93a7-4da4-99b1-6ba6b917eed1"],
Cell[826526, 21277, 700, 19, 21, "Input",ExpressionUUID->"17d49d1a-27f2-4631-a724-1bc23e60df49"],
Cell[827229, 21298, 692, 19, 21, "Input",ExpressionUUID->"4b547a90-8d00-4bda-a9d1-67b3c7e21c2e"],
Cell[827924, 21319, 382, 6, 34, "Subsubsection",ExpressionUUID->"fc07de58-9244-4877-b6c5-59a89c686fca"],
Cell[828309, 21327, 950, 29, 62, "Input",ExpressionUUID->"81a894a1-ad82-4eb8-8f62-1143ec3d9e9e"],
Cell[829262, 21358, 155, 3, 30, "Input",ExpressionUUID->"65c2b7ed-bdf1-4a06-af13-0fa9c1662217"],
Cell[829420, 21363, 6173, 153, 216, "Input",ExpressionUUID->"694a287c-b38f-470e-aa69-f907439a8a50"],
Cell[835596, 21518, 228, 4, 21, "Input",ExpressionUUID->"16a3d54d-213b-4541-9d55-1d8c33b927e4"],
Cell[835827, 21524, 36389, 615, 425, "Input",ExpressionUUID->"2740f544-96b1-4298-8c47-21608887cfb9"],
Cell[872219, 22141, 1118, 18, 53, "Subsubsection",ExpressionUUID->"b4af7e6e-140e-402b-bf53-fd655ffa3c0e"],
Cell[CellGroupData[{
Cell[873362, 22163, 555, 8, 29, "Subsubsection",ExpressionUUID->"42f97059-9759-4d78-8585-158f88c2773f"],
Cell[873920, 22173, 2397, 66, 143, "Input",ExpressionUUID->"585321d7-d1aa-42e6-8a13-02958632d01f"],
Cell[876320, 22241, 18924, 345, 484, "Input",ExpressionUUID->"2770d3ec-75f3-4f5e-92aa-485d1262268a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[895281, 22591, 560, 8, 34, "Subsubsection",ExpressionUUID->"4d9a4370-1dfd-4d49-ac8d-835458ff1c21"],
Cell[895844, 22601, 6733, 110, 102, "Input",ExpressionUUID->"4b4b364e-9464-4b46-8250-b5562e75d075"]
}, Open  ]],
Cell[902592, 22714, 334, 5, 34, "Subsubsection",ExpressionUUID->"107933f0-c09f-41f6-b140-baeb58d0fd7d"],
Cell[902929, 22721, 3478, 85, 120, "Input",ExpressionUUID->"9e32e3f1-5201-4b96-a0dc-2659c4b52e1c"],
Cell[906410, 22808, 3180, 73, 81, "Input",ExpressionUUID->"1a2170d1-b32f-4b6c-8e33-34a28551dd4c"],
Cell[909593, 22883, 10623, 208, 282, "Input",ExpressionUUID->"bd617737-e35a-46c9-9bc0-26f13bb68999"],
Cell[920219, 23093, 1052, 29, 24, "Input",ExpressionUUID->"ae59d5e8-67f3-4251-a0ca-f63462d2d43d"],
Cell[921274, 23124, 17837, 417, 313, "Input",ExpressionUUID->"64d2c355-43df-470b-842a-70daf982369a"],
Cell[CellGroupData[{
Cell[939136, 23545, 638, 9, 50, "Section",ExpressionUUID->"7a0c09b4-45f4-4c79-87ca-322dfb4e141f"],
Cell[CellGroupData[{
Cell[939799, 23558, 773, 14, 82, "Subsection",ExpressionUUID->"ada742a5-f73f-46d3-82fc-b3fc44bc2f04"],
Cell[940575, 23574, 10195, 264, 542, "Input",ExpressionUUID->"0b733127-44bb-4f04-b643-dd9627458ccb"],
Cell[950773, 23840, 2380, 55, 45, "Input",ExpressionUUID->"333ba1b1-a080-4c1a-bffe-90b9b6484314"],
Cell[953156, 23897, 3492, 77, 262, "Input",ExpressionUUID->"0253d884-f64d-4605-8a77-35dfaec0d477"],
Cell[956651, 23976, 1210, 29, 113, "Input",ExpressionUUID->"20f63861-779f-47d6-9a92-9823c9005040"],
Cell[957864, 24007, 2417, 61, 266, "Input",ExpressionUUID->"8ec0d6a9-ef5f-419c-95c9-8ff519b766da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[960318, 24073, 263, 4, 41, "Subsection",ExpressionUUID->"e68d389f-eb63-4c71-bffb-ab21e1e28c2d"],
Cell[960584, 24079, 963, 27, 21, "Input",ExpressionUUID->"bd7af651-6ba6-49b9-b5fd-9482f798274d"],
Cell[961550, 24108, 523, 13, 30, "Input",ExpressionUUID->"b4185851-a7fe-4eb7-aeb1-c880993697c1"],
Cell[962076, 24123, 2196, 58, 136, "Input",ExpressionUUID->"3d9adfaa-ddd5-44b3-8bbe-2d9b4c627baa"],
Cell[964275, 24183, 2966, 76, 68, "Input",ExpressionUUID->"994c713d-f914-4a68-83c7-fa113ad35d8c"],
Cell[967244, 24261, 659, 14, 52, "Input",ExpressionUUID->"1d09e3ff-78ed-48bb-baf8-45d1ad0a1aad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[967940, 24280, 482, 9, 41, "Subsection",ExpressionUUID->"1f825147-c556-43d8-a113-f85392a1c156"],
Cell[968425, 24291, 2258, 66, 83, "Input",ExpressionUUID->"08156764-afbe-4cd9-980d-4eb63435cc2e"],
Cell[970686, 24359, 3463, 98, 136, "Input",ExpressionUUID->"40e46188-5b97-4b3c-aaff-f854aac10839"]
}, Open  ]]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51871,       1180]
NotebookOptionsPosition[     47076,       1095]
NotebookOutlinePosition[     47540,       1114]
CellTagsIndexPosition[     47497,       1111]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
BC_NodeMaps.nb - plot a column of balls for a chosen node sequence and node \
mode (see also TrivPathToIso.nb)
INSTRUCTIONS: Run common_funs.nb,  ES_FindSymGroups.nb, BC_ChooseTmat.nb, \
BC_CumulativeBeta.nb.
Potentially we could load pre-saved maps instead of running \
BC_CumulativeBeta.nb.\
\>", "Subsubsection",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQve16zG7tv28cpTyD94NoF4OlP64xvnW8WeryC0Qn
NTaxXAfSLvKH2EB0Cp8DD4h+b2/AD6Ij9j586MX01tHppugjEO3K6C52BkgL
1WRKgWjHY7kfNrO9dbRay/AZRPeapn/bzPPW8eBVp98gmvuQ9GItYaA5PFZL
QHTIzah9FkCa43/TYRCtIPtOSlD0rSOL5QFpEB35ujUcRIskdEWBaNnrP2fs
AtJe/admguhVBVNsdWTfOt7x3uAAog+W8XiD6BZ/CR8QXcd1NTpU/q3jC7Ff
YPq+mt08YbW3jpnHPMH0oaxF+0G0/lTewyBaw/jPPRB9SYz9EYgGADZEh+M=

  "],ExpressionUUID->"5c25582a-be7c-463e-aa6a-2a2707b8b3d4"],

Cell[CellGroupData[{

Cell["\<\
Use the Tmat stored in BC_CumulativeBeta.nb
See discretization details in BC_Cumulative.nb
See plotting details in BC_LatticeOfClosestNodes.nb\
\>", "Subsubsection",
 CellChangeTimes->{{3.890830810901332*^9, 3.8908308426026735`*^9}, {
  3.893278661162142*^9, 3.8932786741393857`*^9}, {3.893278756078294*^9, 
  3.8932787740663166`*^9}, {3.8932788180017567`*^9, 3.8932788415078044`*^9}, {
  3.8935160470543633`*^9, 3.8935160486827707`*^9}, {3.893785278464962*^9, 
  3.893785290269849*^9}, {3.902226640642627*^9, 3.902226667740944*^9}, {
  3.907608020555297*^9, 3.907608021942088*^9}, {3.907608496338255*^9, 
  3.907608508813724*^9}, {3.910560771688459*^9, 3.910560772085026*^9}, {
  3.912277205870221*^9, 
  3.912277236697845*^9}},ExpressionUUID->"75c4befc-3d39-40a7-b0e4-\
66960f463185"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrintFigures", "=", "False"}], ";"}]], "Input",
 CellChangeTimes->{{3.912263335675058*^9, 3.912263340799098*^9}, {
  3.9122788296080627`*^9, 3.9122788301852417`*^9}},
 CellLabel->
  "In[1160]:=",ExpressionUUID->"3c011821-90ce-4277-b0d4-c7ea74d135f1"],

Cell[BoxData[{"mdir", "\[IndentingNewLine]", 
 RowBox[{"odir", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"mdir", ",", "\"\<pdf_print\>\""}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tlab", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{"MatrixNote", "[", "Tmat", "]"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"otag", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"odir", ",", 
     RowBox[{"\"\<BC_NodeMaps_\>\"", "<>", "Tlab"}]}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.912264353341282*^9, {3.912264848135672*^9, 3.9122648496198587`*^9}, {
   3.9122705029677*^9, 3.9122705136499434`*^9}, 3.912272808371624*^9, {
   3.912273481774172*^9, 3.912273483357978*^9}, {3.912274850944275*^9, 
   3.9122748522999563`*^9}, {3.912277929288759*^9, 3.9122779713090477`*^9}, {
   3.912278023765049*^9, 3.91227803160421*^9}, {3.912278091019071*^9, 
   3.9122780994063053`*^9}, {3.9123401249623947`*^9, 3.912340133568633*^9}},
 CellLabel->
  "In[1161]:=",ExpressionUUID->"4f75e409-1f4d-4800-9c5e-20ec2e37e17f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tmat", "Subsubsection",
 CellChangeTimes->{{3.890830810901332*^9, 3.8908308426026735`*^9}, {
  3.893278661162142*^9, 3.8932786741393857`*^9}, {3.893278756078294*^9, 
  3.8932787740663166`*^9}, {3.8932788180017567`*^9, 3.8932788415078044`*^9}, {
  3.8935160470543633`*^9, 3.8935160486827707`*^9}, {3.893785278464962*^9, 
  3.893785290269849*^9}, {3.902226640642627*^9, 3.902226667740944*^9}, {
  3.907608020555297*^9, 3.907608021942088*^9}, {3.907608496338255*^9, 
  3.907608508813724*^9}, {3.910560771688459*^9, 3.910560772085026*^9}, {
  3.912277205870221*^9, 3.912277236697845*^9}, {3.912277890219572*^9, 
  3.912277895216157*^9}},ExpressionUUID->"e271ad8f-1944-4318-b396-\
8df2b7aae628"],

Cell[BoxData[{
 RowBox[{"Tmat", "\[Equal]", 
  RowBox[{"Transpose", "[", "Tmat", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"(", 
     RowBox[{"Tmat", "\[Equal]", 
      RowBox[{"Transpose", "[", "Tmat", "]"}]}], ")"}]}], ",", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Tmat", "-", 
     RowBox[{"Transpose", "[", "Tmat", "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixNote", "[", "Tmat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"PrintVoigt", "[", "Tmat", "]"}]}], "Input",
 CellChangeTimes->{{3.902226705198032*^9, 3.902226774495007*^9}, {
  3.90223277946227*^9, 3.902232780218251*^9}, {3.9033595903024406`*^9, 
  3.9033595937116737`*^9}, {3.9033623362475853`*^9, 3.903362353508469*^9}, {
  3.903368517798397*^9, 3.903368519991128*^9}, {3.90960359369455*^9, 
  3.909603593873468*^9}},
 CellLabel->
  "In[1165]:=",ExpressionUUID->"4457c713-ec46-41c2-a8d2-65b3ea8dce4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Choose \[CapitalSigma]n (all four were run in Cumulative) or use the one from \
Cumulative.\
\>", "Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.910607244324827*^9, 3.910607251723556*^9}, {
   3.910607331510791*^9, 3.910607338073598*^9}, {3.910607384870595*^9, 
   3.9106074218040543`*^9}, {3.91060909152606*^9, 
   3.910609098468686*^9}},ExpressionUUID->"39f6f9ab-a2c0-41e8-909d-\
5f621548e094"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "=", "\[CapitalSigma]nTETCUBE"}], ";"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9076877085226603`*^9, 3.907687710779949*^9}, 
   3.9095941888429117`*^9, 3.909594225458275*^9, {3.910609382862521*^9, 
   3.910609387199396*^9}},
 CellLabel->
  "In[1169]:=",ExpressionUUID->"8fde44f5-5e4a-4b5c-93d0-ec0cd251b98b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "=", "\[CapitalSigma]nTRIGCUBE"}], ";"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.907687712761743*^9, 3.90768771368064*^9}, 
   3.909594240462891*^9, {3.910609389052061*^9, 3.910609391351429*^9}},
 CellLabel->
  "In[1170]:=",ExpressionUUID->"bb3243c2-156d-41c0-9ffc-fa3f8773a302"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "=", "\[CapitalSigma]nTRIGXISO"}], ";"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.907687712761743*^9, 3.90768771368064*^9}, 
   3.909594240462891*^9, 3.9095942771126738`*^9, {3.910609393105723*^9, 
   3.910609395418893*^9}},
 CellLabel->
  "In[1171]:=",ExpressionUUID->"ec43fb3c-2d7a-4bf8-ba88-4311a5825e41"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "=", "\[CapitalSigma]nTETXISO"}], ";"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.9082246188763266`*^9, 3.9095941643035593`*^9, {3.9106093975134897`*^9, 
   3.9106094000036097`*^9}},
 CellLabel->
  "In[1172]:=",ExpressionUUID->"8f108b43-b961-43a6-b12b-164aa071818b"],

Cell[BoxData[
 RowBox[{"range", "[", "\[CapitalSigma]n", "]"}]], "Input",
 CellLabel->
  "In[1173]:=",ExpressionUUID->"4913f491-bfb4-45fd-9e08-b5c386e24f8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Choose nm or use the one from Cumulative.", "Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.910607399798849*^9, 3.9106074116470346`*^9}, {
   3.9106090269884443`*^9, 3.910609027988559*^9}, {3.910609100088587*^9, 
   3.910609102634924*^9}},ExpressionUUID->"de6ca727-e7c1-4547-ab9a-\
af45733c5a70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nm", "=", "nm1"}], ";"}]], "Input",
 CellChangeTimes->{{3.907718101754574*^9, 3.90771810188236*^9}, {
  3.90779163989338*^9, 3.9077916403167095`*^9}, {3.91098563966286*^9, 
  3.910985639778504*^9}},
 CellLabel->
  "In[1174]:=",ExpressionUUID->"edca56e5-a111-4259-bcd0-e6eaefeb39e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nm", "=", "nm3"}], ";"}]], "Input",
 CellChangeTimes->{{3.907582618187471*^9, 3.907582618235037*^9}, {
  3.9077916389248695`*^9, 3.907791639445114*^9}},
 CellLabel->
  "In[1175]:=",ExpressionUUID->"f414560b-82e2-419a-963b-38a35b8a915d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nm", "=", "nm2"}], ";"}]], "Input",
 CellChangeTimes->{{3.907582618187471*^9, 3.907582618235037*^9}, {
  3.9076330136868553`*^9, 3.9076330137621307`*^9}, {3.907791640762042*^9, 
  3.9077916412097254`*^9}},
 CellLabel->
  "In[1176]:=",ExpressionUUID->"a9b3d4b3-bd8d-4e43-8534-99963bcae5d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elastic maps, not just at nodes:", "Subsubsection",
 CellChangeTimes->{{3.9068337413759727`*^9, 3.9068337627478924`*^9}, {
   3.906835309992379*^9, 3.906835311812465*^9}, {3.907519895393288*^9, 
   3.907519915027375*^9}, 3.9077908924392705`*^9, {3.9082398929648085`*^9, 
   3.9082400051068363`*^9}, {3.908741876439742*^9, 
   3.908741881706698*^9}},ExpressionUUID->"97f79a3f-73bc-4379-9c45-\
7335750d8918"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmatOfPt", "[", 
   RowBox[{
   "pt_", ",", "Tmat_", ",", "dt_", ",", "\[CapitalSigma]n_", ",", "nm_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"TofPt", "[", 
       RowBox[{"pt", ",", "dt", ",", "\[CapitalSigma]n"}], "]"}]}], ")"}], 
    " ", 
    RowBox[{"SmatOf\[CapitalSigma]", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]1ofPt", "[", 
       RowBox[{"pt", ",", "dt", ",", "\[CapitalSigma]n"}], "]"}], ",", "Tmat",
       ",", "\[CapitalSigma]n", ",", "nm"}], "]"}]}], "+", "   ", 
   "\[IndentingNewLine]", 
   "                                                                          \
              ", 
   RowBox[{
    RowBox[{"TofPt", "[", 
     RowBox[{"pt", ",", "dt", ",", "\[CapitalSigma]n"}], "]"}], 
    RowBox[{"SmatOf\[CapitalSigma]", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]2ofPt", "[", 
       RowBox[{"pt", ",", "dt", ",", "\[CapitalSigma]n"}], "]"}], ",", "Tmat",
       ",", "\[CapitalSigma]n", ",", "nm"}], "]"}], "     ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
      "\[CapitalSigma]n", " ", "plays", " ", "no", " ", "role", " ", "for", 
       " ", "nm2", " ", "or", " ", "nm1"}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.907203742901781*^9, 3.907203776099574*^9}, {
   3.9072038076034327`*^9, 3.907203808323533*^9}, {3.9072038420517845`*^9, 
   3.907203849123522*^9}, {3.907203897010912*^9, 3.907203924739702*^9}, {
   3.9072039786106653`*^9, 3.9072039817786274`*^9}, {3.907254817929777*^9, 
   3.9072548279611998`*^9}, {3.907263076624381*^9, 3.9072630772526035`*^9}, {
   3.907300024332246*^9, 3.9073000509842997`*^9}, {3.9073000814246817`*^9, 
   3.9073000838156357`*^9}, {3.907300126988325*^9, 3.9073001395010805`*^9}, {
   3.9073396780854526`*^9, 3.90733970814322*^9}, {3.9073700346849923`*^9, 
   3.907370076865093*^9}, {3.907370114029423*^9, 3.907370124492592*^9}, {
   3.9073715114114676`*^9, 3.9073715123669176`*^9}, {3.907416374216854*^9, 
   3.9074163919610767`*^9}, {3.907420712453953*^9, 3.9074207575921783`*^9}, {
   3.9074207928555765`*^9, 3.907420804309173*^9}, {3.907422494219184*^9, 
   3.907422527078791*^9}, {3.907595948250862*^9, 3.9075959524921336`*^9}, 
   3.9076188941889167`*^9, {3.9077908643670993`*^9, 3.9077908861645527`*^9}, {
   3.9082189645954056`*^9, 3.908218967528698*^9}, {3.908237663736796*^9, 
   3.9082376736262426`*^9}, {3.9089877875129843`*^9, 3.908987808171661*^9}, 
   3.9109856594000883`*^9},
 CellLabel->
  "In[1177]:=",ExpressionUUID->"a3218911-e412-40fb-9834-a5400db2a5dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check pre-saved variables", "Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.909920487343067*^9, 3.9099204909788094`*^9}, {
   3.909920617817049*^9, 3.909920619139233*^9}, {3.9102327180053177`*^9, 
   3.910232742411353*^9}, {3.910310142573998*^9, 3.9103101438521256`*^9}, {
   3.910560785303976*^9, 3.9105607921818943`*^9}, 
   3.910560829457304*^9},ExpressionUUID->"4b48ff2f-b0da-4364-9941-\
a0c2127d4558"],

Cell[BoxData[{
 RowBox[{"range", "[", "\[CapitalSigma]n", 
  "]"}], "\[IndentingNewLine]", "nm", "\[IndentingNewLine]", "dt", "\
\[IndentingNewLine]", 
 RowBox[{"PointsOnPath", "[", 
  RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}]}], "Input",
 CellChangeTimes->{{3.90991870046329*^9, 3.909918704577106*^9}, {
   3.909918928094699*^9, 3.9099189376099033`*^9}, 3.9099191467872553`*^9, {
   3.90991922225873*^9, 3.9099192560643063`*^9}, {3.909921219318756*^9, 
   3.909921228929463*^9}, {3.910311242558587*^9, 3.910311243501175*^9}},
 CellLabel->
  "In[1178]:=",ExpressionUUID->"3c4bae57-a70a-4223-ac85-cebe62a07d35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display the matrices", "Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.909920487343067*^9, 3.9099204909788094`*^9}, {
   3.909920617817049*^9, 3.909920619139233*^9}, {3.9102327180053177`*^9, 
   3.910232742411353*^9}, {3.910310142573998*^9, 3.9103101438521256`*^9}, {
   3.910560785303976*^9, 3.9105607921818943`*^9}, 3.910560829457304*^9, {
   3.9122787942837257`*^9, 
   3.912278796520657*^9}},ExpressionUUID->"a0462bd4-0a77-4a26-bdb3-\
6f01378d08c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numdig", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexedMatrices", "=", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"point", ",", "index"}], "}"}], ",", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SequenceForm", "[", 
             RowBox[{"\"\<i = \>\"", ",", 
              RowBox[{"index", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "point", ",", 
            RowBox[{"DispMat", "[", 
             RowBox[{
              RowBox[{"SmatOfPt", "[", 
               RowBox[{
               "point", ",", "Tmat", ",", "dt", ",", "\[CapitalSigma]n", ",", 
                "nm"}], "]"}], ",", "numdig"}], "]"}]}], "}"}], "}"}], ",", 
         RowBox[{"Spacings", "->", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]}], "]"}], ",", 
     RowBox[{"PointsOnPath", "[", 
      RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{"indexedMatrices", ",", 
   RowBox[{"Spacings", "->", "2"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.912278584076186*^9, 3.912278584081575*^9}, {
  3.9122786727752323`*^9, 3.912278682423992*^9}, {3.9122787810823603`*^9, 
  3.912278807590209*^9}},
 CellLabel->
  "In[1182]:=",ExpressionUUID->"06aa3bce-b597-4d26-bdf0-98932b4b2bd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot one ball.  ", "Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.909920487343067*^9, 3.9099204909788094`*^9}, {
   3.909920617817049*^9, 3.909920619139233*^9}, {3.9102327180053177`*^9, 
   3.910232742411353*^9}, {3.910310142573998*^9, 
   3.9103101438521256`*^9}},ExpressionUUID->"9adfc16c-c908-4f18-b691-\
272bf08c95ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ipick", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"cpMONO", "[", 
    RowBox[{
     RowBox[{"SmatOfPt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PointsOnPath", "[", 
         RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}], "[", 
        RowBox[{"[", "ipick", "]"}], "]"}], ",", "Tmat", ",", "dt", ",", 
       "\[CapitalSigma]n", ",", "nm"}], "]"}], ",", 
     RowBox[{"contours", "[", "Tmat", "]"}], ",", 
     RowBox[{"MaxForScaling", "[", "Tmat", "]"}]}], "]"}], ",", 
   RowBox[{"{", "options", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.909915101508584*^9, 3.909915113277608*^9}, {
   3.909915184597801*^9, 3.909915185230672*^9}, 3.909915241551073*^9, {
   3.9099154187186003`*^9, 3.909915426158187*^9}, {3.909915472402274*^9, 
   3.9099154741856422`*^9}, {3.9099163114747763`*^9, 3.909916311541988*^9}, {
   3.9099170132401752`*^9, 3.9099170153491917`*^9}, {3.909918670622444*^9, 
   3.909918694482162*^9}, {3.909918953053706*^9, 3.909918964520563*^9}, {
   3.90991937583851*^9, 3.909919381276278*^9}, {3.909920629410451*^9, 
   3.909920629475675*^9}, {3.90992088126929*^9, 3.9099208814553003`*^9}, {
   3.909921045671479*^9, 3.909921058590382*^9}, 3.910351258286077*^9, 
   3.910609514389556*^9},
 CellLabel->
  "In[1185]:=",ExpressionUUID->"b6a425cf-cbf8-4421-b238-dc6ef7c1978a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Check some settings; don\[CloseCurlyQuote]t set ShiftToEye to zero (see \
chooseTmat.nb)\
\>", "Subsubsection",
 CellChangeTimes->{{3.910213965446488*^9, 3.9102139821184273`*^9}, {
  3.9103103280391183`*^9, 3.9103103292516317`*^9}, {3.9103469928100767`*^9, 
  3.910346997693475*^9}, {3.910351290177184*^9, 3.910351291482637*^9}, {
  3.910351330852646*^9, 
  3.910351334252446*^9}},ExpressionUUID->"8de6a2d3-b1c1-407e-ae34-\
337e0ddc7f4c"],

Cell[BoxData[{"AngRadDisk", "\[IndentingNewLine]", "ShiftToEye", "\
\[IndentingNewLine]", "eye", "\[IndentingNewLine]", "tknsForGC", "\
\[IndentingNewLine]", "hueGreen", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", "0", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", ".05", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9103513125651827`*^9, 3.910351328150362*^9}, {
  3.910354575237857*^9, 3.910354575658884*^9}},
 CellLabel->
  "In[1187]:=",ExpressionUUID->"6437f30f-0d0a-4103-a023-cae924889bbf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["figure for paper (choose Sigma) - see also protractor figure", \
"Subsubsection",
 CellChangeTimes->{{3.910213965446488*^9, 3.9102139821184273`*^9}, {
  3.9103103280391183`*^9, 3.9103103292516317`*^9}, {3.9103469928100767`*^9, 
  3.910346997693475*^9}, {3.910351290177184*^9, 3.910351291482637*^9}, {
  3.910351330852646*^9, 3.910351334252446*^9}, {3.912338799545765*^9, 
  3.91233880100384*^9}, {3.912340321706935*^9, 3.912340323707621*^9}, {
  3.9123410798385553`*^9, 
  3.9123410838914843`*^9}},ExpressionUUID->"16fe82c5-0c7e-4f22-a510-\
739ca7e122ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lincrement", "=", "1"}], ";", 
  RowBox[{"loffset", "=", "2.0"}], ";", 
  RowBox[{"lfontsize", "=", "15"}], ";", 
  RowBox[{"lhw", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"p3x", "=", 
  RowBox[{"legends", "[", 
   RowBox[{
    RowBox[{"contours", "[", "Tmat", "]"}], ",", 
    RowBox[{"MaxForScaling", "[", "Tmat", "]"}], ",", 
    RowBox[{
     RowBox[{"SubscriptBox", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[Alpha]\>\"", ",", "28"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<MONO\>\"", ",", "10"}], "]"}]}], "]"}], "//", 
     "DisplayForm"}], ",", "lhw", ",", "lfontsize", ",", "lincrement", ",", 
    "loffset"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.912338932807748*^9, 3.912338945072023*^9}, {
  3.9123389861988163`*^9, 3.912338987076621*^9}, {3.912339166258707*^9, 
  3.9123391708295393`*^9}, {3.912339241858067*^9, 3.912339242355035*^9}},
 CellLabel->
  "In[1198]:=",ExpressionUUID->"5658b428-36f3-4bd5-8822-805779331e02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PaxesForLattice", "=", 
   RowBox[{"Paxes", "[", 
    RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.35", ",", "1", ",", 
     ".17", ",", ".009", ",", "\"\<Gray\>\"", ",", "ArrowColor"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.909177484061034*^9, 3.909177500790882*^9}, 
   3.9091775644071817`*^9, 3.9104514437104053`*^9},
 CellLabel->
  "In[1200]:=",ExpressionUUID->"555483c4-040d-4662-b747-5c941bff8db8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cpMONO", "[", 
        RowBox[{"Tmat", ",", 
         RowBox[{"contours", "[", "Tmat", "]"}], ",", 
         RowBox[{"MaxForScaling", "[", "Tmat", "]"}]}], "]"}], ",", 
       RowBox[{"Graphics3D", "[", "PaxesForLattice", "]"}]}], "}"}], ",", 
     "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "ORTH"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cpMONO", "[", 
        RowBox[{
         RowBox[{"SmatOf\[CapitalSigma]", "[", 
          RowBox[{
          "\[CapitalSigma]", ",", "Tmat", ",", "\[CapitalSigma]n", ",", 
           "nm"}], "]"}], ",", 
         RowBox[{"contours", "[", "Tmat", "]"}], ",", 
         RowBox[{"MaxForScaling", "[", "Tmat", "]"}]}], "]"}], ",", 
       RowBox[{"Graphics3D", "[", "PaxesForLattice", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"TwoFoldGraphics", "[", 
         RowBox[{"\[CapitalSigma]", ",", 
          RowBox[{"UTforTwoFoldGraphics", "[", 
           RowBox[{
           "\[CapitalSigma]", ",", "Tmat", ",", "\[CapitalSigma]n", ",", 
            "nm"}], "]"}], ",", "AngRadDisk", ",", "ShiftToEye", ",", "eye", 
          ",", "tknsForGC", ",", "hueGreen"}], "]"}], "]"}]}], "}"}], ",", 
     "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p3", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"p3x", ",", 
     RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pall", "=", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "1000"}], ",", 
     RowBox[{"Spacings", "->", 
      RowBox[{"-", "10"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.90992065741185*^9, 3.9099207231991673`*^9}, {
   3.9099207728651114`*^9, 3.909920800717663*^9}, 3.909920909843235*^9, 
   3.910310282488125*^9, 3.910351266192267*^9, 3.9103545837241077`*^9, {
   3.912338141285665*^9, 3.912338146089892*^9}, {3.9123382011170607`*^9, 
   3.9123383122750998`*^9}, {3.9123384254290733`*^9, 3.912338431837647*^9}, {
   3.912338485900351*^9, 3.912338585491034*^9}, {3.912338627890111*^9, 
   3.912338660459703*^9}, {3.9123387029517393`*^9, 3.912338748797961*^9}, {
   3.9123388272414083`*^9, 3.9123388323664494`*^9}, {3.91233893152022*^9, 
   3.912339042068139*^9}, 3.912339074593006*^9, {3.9123391447613077`*^9, 
   3.91233918065012*^9}, {3.912339300393721*^9, 3.91233933202026*^9}, {
   3.912339863521822*^9, 3.9123399141195*^9}, {3.912340174405603*^9, 
   3.9123401992624283`*^9}, {3.912340375864128*^9, 3.912340461217762*^9}, {
   3.912340523977088*^9, 3.912340527474606*^9}, {3.912340610244981*^9, 
   3.912340640100213*^9}},
 CellLabel->
  "In[1248]:=",ExpressionUUID->"93c5d17d-dec0-4fe9-b69b-1ed39bdf9d7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ofile", "=", 
   RowBox[{"otag", "<>", "\"\<_twoballs.pdf\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{"ofile", ",", "pall"}], "]"}], ",", "pall"}], "]"}]}], "Input",
 CellChangeTimes->{{3.912277997942766*^9, 3.912277999452622*^9}, {
   3.912340140296513*^9, 3.912340181116581*^9}, 3.912340655151557*^9},
 CellLabel->
  "In[1257]:=",ExpressionUUID->"44714f78-6dbb-47c5-a601-737e16b0719b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optional test of the TwoFoldGraphics.  ", "Subsubsection",
 CellChangeTimes->{{3.910217861940524*^9, 3.910217874901081*^9}, 
   3.9102179064350643`*^9, {3.9102224405275397`*^9, 3.9102224613002453`*^9}, {
   3.9102818960896473`*^9, 
   3.910281898474097*^9}},ExpressionUUID->"757e2139-18af-4a00-9aa0-\
fe645bba5d84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", ".04", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Point", "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Line", "[", "EquatorList", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"NodePts", ",", "#"}], "]"}], "&&", 
          RowBox[{"#", "!=", 
           RowBox[{"NodePt", "[", "TRIV", "]"}]}], "&&", 
          RowBox[{"#", "!=", 
           RowBox[{"NodePt", "[", "ISO", "]"}]}]}], ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TwoFoldGraphics", "[", 
            RowBox[{
             RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
             RowBox[{"UTforTwoFoldGraphics", "[", 
              RowBox[{
               RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
               "Tmat", ",", "\[CapitalSigma]n", ",", "nm"}], "]"}], ",", 
             RowBox[{
              StyleBox["2",
               FontColor->RGBColor[1, 0, 0]], "AngRadDisk"}], ",", 
             "ShiftToEye", ",", "eye", ",", "tknsForGC", ",", "hueGreen"}], 
            "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"options", ",", 
       RowBox[{"ImageSize", "->", "130"}]}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"PointsOnPath", "[", 
   RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.9102223344444194`*^9, 3.9102226048462677`*^9, {3.9102803260228143`*^9, 
   3.9102803319003224`*^9}, {3.9102803816449213`*^9, 
   3.9102803919991007`*^9}, {3.9102804261699915`*^9, 3.9102804298814588`*^9}, 
   3.910280498315425*^9, 3.910351369760404*^9, 3.9103545856987667`*^9},
 CellLabel->
  "In[10111]:=",ExpressionUUID->"9e349121-341a-4ee5-a9b5-73fb7aaf0742"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
If you want a green ISO ball instead of blue,  change ColorData[\
\[OpenCurlyDoubleQuote]TemperatureMap\[CloseCurlyDoubleQuote]][.03] to \
hueGreen.\
\>", "Subsubsection",
 CellChangeTimes->{{3.9102274742481847`*^9, 3.9102274949736357`*^9}, {
   3.9102802051577034`*^9, 3.910280250215039*^9}, 3.910280624660135*^9, {
   3.9102807320933094`*^9, 3.910280733403535*^9}, 3.910280786536502*^9, {
   3.910311087360703*^9, 3.9103111083016853`*^9}, 
   3.910354587050824*^9},ExpressionUUID->"65766d8a-5e14-4471-bd29-\
e6dfdc91a493"],

Cell[BoxData[
 RowBox[{"text", ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"MatrixNote", "[", "Tmat", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Path nodes are \>\"", ",", 
      RowBox[{"range", "[", "\[CapitalSigma]n", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"TextNodeMode", "[", "nm", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<dt = \>\"", ",", "dt"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"nm", "===", "nm1"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<U = \>\"", ",", 
        RowBox[{"MatrixForm", "[", "UforNM1", "]"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<contours = \>\"", ",", 
      RowBox[{"contours", "[", "Tmat", "]"}], ",", 
      "\"\<, MaxForScaling = \>\"", ",", 
      RowBox[{"MaxForScaling", "[", "Tmat", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<AngRadDisk = \>\"", ",", 
      RowBox[{"AngRadDisk", "/", "Degree"}], ",", "\"\<, ShiftToEye = \>\"", 
      ",", "ShiftToEye"}], "]"}], ";", "\[IndentingNewLine]", "PrintEye", 
    ";"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.910282060501962*^9, 3.9102820807770205`*^9}, {
  3.91098565048488*^9, 3.9109856609365892`*^9}},
 CellLabel->
  "In[10112]:=",ExpressionUUID->"d7f0747b-d463-4646-b50d-a9a37000736d"],

Cell[BoxData[{"text", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"textoffset", " ", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"voffset", "=", 
   RowBox[{"-", "8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isize", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", "==", 
            RowBox[{"NodePt", "[", "ISO", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"DummySphereGraphics", "[", 
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
              ".03", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"cpMONO", "[", 
            RowBox[{
             RowBox[{"SmatOfPt", "[", 
              RowBox[{
              "#", ",", "Tmat", ",", "dt", ",", "\[CapitalSigma]n", ",", 
               "nm"}], "]"}], ",", 
             RowBox[{"contours", "[", "Tmat", "]"}], ",", 
             RowBox[{"MaxForScaling", "[", "Tmat", "]"}]}], "]"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", ".01", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"textoffset", "+", "0.4"}], ")"}], "UnitRight"}], 
               "]"}]}], "}"}], ",", "  ", 
            RowBox[{
             StyleBox[
              RowBox[{"(", 
               StyleBox["*",
                FontColor->RGBColor[1, 0, 0]]}]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 0]], 
             StyleBox[
              RowBox[{
               RowBox[{"fake", " ", "point", " ", "for", " ", "alignment"}], 
               ",", " ", 
               RowBox[{"make", " ", "smaller", " ", "if", " ", "desired"}]}],
              FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"NodePts", ",", "#"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
                  "18"}], "]"}], ",", 
                RowBox[{"textoffset", " ", "UnitRight"}]}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"NodePts", ",", "#"}], "]"}], "&&", 
               RowBox[{"#", "!=", 
                RowBox[{"NodePt", "[", "TRIV", "]"}]}], "&&", 
               RowBox[{"#", "!=", 
                RowBox[{"NodePt", "[", "ISO", "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TwoFoldGraphics", "[", 
               RowBox[{
                RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
                RowBox[{"UTforTwoFoldGraphics", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
                  "Tmat", ",", "\[CapitalSigma]n", ",", "nm"}], "]"}], ",", 
                "AngRadDisk", ",", "ShiftToEye", ",", "eye", ",", "tknsForGC",
                 ",", "hueGreen"}], "]"}]}], "]"}]}], "}"}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"options", ",", 
         RowBox[{"ImageSize", "->", "isize"}]}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"PointsOnPath", "[", 
     RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}]}], ",", 
   RowBox[{"Spacings", "->", "voffset"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.9102134898144317`*^9, 3.910213726219949*^9, 3.910213862369362*^9, 
   3.9102140589226255`*^9, {3.9102173175970354`*^9, 3.9102173402719936`*^9}, {
   3.9102173840000796`*^9, 3.9102173984710817`*^9}, {3.9102174600736213`*^9, 
   3.91021748153786*^9}, {3.910217533309349*^9, 3.910217534221198*^9}, {
   3.9102180985423584`*^9, 3.9102182263417892`*^9}, 3.9102183686282196`*^9, 
   3.910222079202461*^9, {3.910222674585823*^9, 3.9102227167970686`*^9}, {
   3.9102227926363873`*^9, 3.9102228242186537`*^9}, {3.910222926049848*^9, 
   3.9102229279803696`*^9}, {3.910223011321374*^9, 3.910223028745227*^9}, {
   3.910225361961526*^9, 3.9102254551337156`*^9}, {3.9102255146864996`*^9, 
   3.9102255369991865`*^9}, 3.9102255746379027`*^9, {3.910225664631585*^9, 
   3.910225681221913*^9}, 3.9102257233469243`*^9, {3.9102257694597073`*^9, 
   3.910225774598987*^9}, {3.9102258485947795`*^9, 3.910225929474784*^9}, 
   3.910225963147916*^9, {3.9102260323388453`*^9, 3.910226037711991*^9}, {
   3.910226135225678*^9, 3.9102261369522943`*^9}, {3.9102261770622573`*^9, 
   3.9102262027186146`*^9}, {3.9102262368268695`*^9, 
   3.9102262865362816`*^9}, {3.9102264015091653`*^9, 3.9102265102533135`*^9}, 
   3.9102265511958337`*^9, {3.910226596396067*^9, 3.9102266290391645`*^9}, {
   3.9102791944024267`*^9, 3.910279276172321*^9}, {3.910279325626272*^9, 
   3.9102793484818172`*^9}, 3.9102794348355885`*^9, 3.9102795337800674`*^9, 
   3.910279745166574*^9, 3.910280014675644*^9, 3.910280134526968*^9, {
   3.9102807237172356`*^9, 3.910280724831089*^9}, 3.9102807773988*^9, {
   3.9102815061150494`*^9, 3.9102815272289762`*^9}, {3.910281652116247*^9, 
   3.910281661770794*^9}, {3.9102817376664567`*^9, 3.910281762807617*^9}, {
   3.910282112637251*^9, 3.9102821137396393`*^9}, {3.910347893952271*^9, 
   3.910347894095373*^9}, {3.91034794595459*^9, 3.91034804732031*^9}, {
   3.9103480861617317`*^9, 3.910348182028346*^9}, {3.910351226953203*^9, 
   3.910351236930416*^9}, 3.91035458830515*^9, 3.9122781795316133`*^9},
 CellLabel->
  "In[10113]:=",ExpressionUUID->"094b47d2-b410-4861-8728-f0c003173808"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Alternative code using MapThread (this figure will print to file if \
PrintFigures = True)\
\>", "Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.909920487343067*^9, 3.9099204909788094`*^9}, {
   3.90994373671786*^9, 3.909943815051064*^9}, {3.909943851214437*^9, 
   3.909943867758306*^9}, {3.909943910763205*^9, 3.9099439171401463`*^9}, {
   3.9103106166178446`*^9, 3.9103106359002595`*^9}, {3.910348258665557*^9, 
   3.910348262221698*^9}, {3.910350994556796*^9, 3.910350996398506*^9}, {
   3.910352064797062*^9, 3.9103520726360064`*^9}, {3.912278939467889*^9, 
   3.9122789537677794`*^9}},ExpressionUUID->"be391ede-9d1f-42b4-b06d-\
8f2c692c5a49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"voffset", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"textoffset", "=", "10"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontsize", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isize", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", "==", 
            RowBox[{"NodePt", "[", "ISO", "]"}]}], ",", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"DummySphereGraphics", "[", 
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
              ".03", "]"}], "]"}], "]"}], ",", 
           RowBox[{"cpMONO", "[", 
            RowBox[{
             RowBox[{"SmatOfPt", "[", 
              RowBox[{
              "#", ",", "Tmat", ",", "dt", ",", "\[CapitalSigma]n", ",", 
               "nm"}], "]"}], ",", 
             RowBox[{"contours", "[", "Tmat", "]"}], ",", 
             RowBox[{"MaxForScaling", "[", "Tmat", "]"}]}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"NodePts", ",", "#"}], "]"}], "&&", 
            RowBox[{"#", "!=", 
             RowBox[{"NodePt", "[", "TRIV", "]"}]}], "&&", 
            RowBox[{"#", "!=", 
             RowBox[{"NodePt", "[", "ISO", "]"}]}]}], ",", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"TwoFoldGraphics", "[", 
             RowBox[{
              RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
              RowBox[{"UTforTwoFoldGraphics", "[", 
               RowBox[{
                RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
                "Tmat", ",", "\[CapitalSigma]n", ",", "nm"}], "]"}], ",", 
              "AngRadDisk", ",", "ShiftToEye", ",", "eye", ",", "tknsForGC", 
              ",", "hueGreen"}], "]"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", "options", ",", 
       RowBox[{"ImageSize", "->", "200"}]}], "]"}], "&"}], "/@", 
    RowBox[{"PointsOnPath", "[", 
     RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"NodePts", ",", "#"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\[CapitalSigma]ofNodePt", "[", "#", "]"}], ",", 
           "\"\<Arial\>\"", ",", "fontsize"}], "]"}], ",", 
         RowBox[{"FrameMargins", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"textoffset", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", "\"\<\>\""}], 
      "]"}], "&"}], "/@", 
    RowBox[{"PointsOnPath", "[", 
     RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labeledPlots", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Labeled", "[", 
       RowBox[{"#1", ",", "#2", ",", "Right"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"plots", ",", "labels"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"px", "=", 
   RowBox[{"Column", "[", 
    RowBox[{"labeledPlots", ",", 
     RowBox[{"Spacings", "->", "voffset"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.910350859871414*^9, 3.9103509411559258`*^9}, {
   3.910351010143649*^9, 3.910351055951062*^9}, {3.9103510927871304`*^9, 
   3.910351105590006*^9}, {3.9103512418047953`*^9, 3.910351244419355*^9}, {
   3.910351485437759*^9, 3.91035151514666*^9}, 3.910351627722537*^9, {
   3.910351679756627*^9, 3.910351699769698*^9}, {3.9103518010414143`*^9, 
   3.910352034094154*^9}, 3.910354589552392*^9, {3.912278004099029*^9, 
   3.912278006646147*^9}, {3.912340104621962*^9, 
   3.912340116353582*^9}},ExpressionUUID->"9630b32e-15fd-42e6-abdb-\
4dfd7a4ce36e"],

Cell[BoxData[{
 RowBox[{"ofile", "=", 
  RowBox[{"otag", "<>", "\"\<_column.pdf\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"PrintFigures", ",", 
   RowBox[{"Export", "[", 
    RowBox[{"ofile", ",", "px"}], "]"}], ",", "px"}], "]"}]}], "Input",
 CellChangeTimes->{{3.912277997942766*^9, 3.912277999452622*^9}, {
  3.912340140296513*^9, 
  3.912340152815494*^9}},ExpressionUUID->"4636bff1-03ac-4a2e-9045-\
3fc113ca7c76"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Commands that are no longer used but might be useful later", \
"Subsubsection",
 CellChangeTimes->{{3.902019470892755*^9, 3.902019498690838*^9}, {
   3.9020195384193707`*^9, 3.902019601123226*^9}, {3.9020281971649103`*^9, 
   3.902028201510331*^9}, {3.9020287939677057`*^9, 3.9020289028438373`*^9}, 
   3.9020694570262427`*^9, {3.9020720695534945`*^9, 3.9020720728796167`*^9}, {
   3.903383296134802*^9, 3.9033833469637423`*^9}, {3.9033835568720837`*^9, 
   3.903383558466455*^9}, {3.903455436974758*^9, 3.903455456425185*^9}, {
   3.904140774713717*^9, 3.9041407850631433`*^9}, {3.9041467456541777`*^9, 
   3.904146746364055*^9}, {3.907284204795019*^9, 3.907284207467123*^9}, {
   3.907506077648287*^9, 3.907506148297345*^9}, {3.907582627966357*^9, 
   3.9075826359713917`*^9}, {3.9077916099149375`*^9, 
   3.9077916330245314`*^9}, {3.909920487343067*^9, 3.9099204909788094`*^9}, {
   3.90994373671786*^9, 3.909943815051064*^9}, {3.909943851214437*^9, 
   3.909943867758306*^9}, {3.909943910763205*^9, 3.9099439171401463`*^9}, {
   3.9103106166178446`*^9, 3.9103106359002595`*^9}, {3.910348258665557*^9, 
   3.910348262221698*^9}, {3.910351155706059*^9, 
   3.910351166723778*^9}},ExpressionUUID->"23fa5c11-2655-43a7-8d9d-\
704fcc2a9e6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SigsOnPath", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalSigma]ofJ", "[", 
      RowBox[{"#", ",", "\[CapitalSigma]n", ",", "dt"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"PointsOnPath", "[", 
       RowBox[{"\[CapitalSigma]n", ",", "dt"}], "]"}], "]"}], "]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"typeReport", "=", 
  RowBox[{"Tally", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"Head", ",", "SigsOnPath"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isValidElement", "[", "elem_", "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"elem", "===", "TRIV"}], "||", 
      RowBox[{"elem", "===", "ISO"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "elem", "]"}], "===", "String"}], "&&", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"elem", ",", 
        RowBox[{"WhitespaceCharacter", "..."}]}], "]"}]}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"filteredSigsOnPath", "=", 
  RowBox[{"Select", "[", 
   RowBox[{"SigsOnPath", ",", "isValidElement"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.909942997039596*^9, 3.909942997157463*^9}, {
   3.9099438097439547`*^9, 3.909943809852344*^9}, 3.9103112731614256`*^9, 
   3.9103131028133245`*^9},
 CellLabel->
  "In[6277]:=",ExpressionUUID->"06ce97fb-349b-43de-8984-4489ed9a85d7"]
}, Open  ]]
},
WindowSize->{1293, 961},
WindowMargins->{{55, Automatic}, {Automatic, 17}},
DockedCells->{},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"eab8d2de-b153-4cd1-be1f-28c8eb48bffb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 790, 16, 97, "Subsubsection",ExpressionUUID->"5c25582a-be7c-463e-aa6a-2a2707b8b3d4"],
Cell[CellGroupData[{
Cell[1373, 40, 796, 14, 89, "Subsubsection",ExpressionUUID->"75c4befc-3d39-40a7-b0e4-66960f463185"],
Cell[2172, 56, 285, 6, 30, "Input",ExpressionUUID->"3c011821-90ce-4277-b0d4-c7ea74d135f1"],
Cell[2460, 64, 1149, 26, 94, "Input",ExpressionUUID->"4f75e409-1f4d-4800-9c5e-20ec2e37e17f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3646, 95, 696, 10, 45, "Subsubsection",ExpressionUUID->"e271ad8f-1944-4318-b396-8df2b7aae628"],
Cell[4345, 107, 943, 21, 94, "Input",ExpressionUUID->"4457c713-ec46-41c2-a8d2-65b3ea8dce4f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5325, 133, 1132, 18, 45, "Subsubsection",ExpressionUUID->"39f6f9ab-a2c0-41e8-909d-5f621548e094"],
Cell[6460, 153, 395, 9, 30, "Input",ExpressionUUID->"8fde44f5-5e4a-4b5c-93d0-ec0cd251b98b"],
Cell[6858, 164, 365, 8, 30, "Input",ExpressionUUID->"bb3243c2-156d-41c0-9ffc-fa3f8773a302"],
Cell[7226, 174, 393, 9, 30, "Input",ExpressionUUID->"ec43fb3c-2d7a-4bf8-ba88-4311a5825e41"],
Cell[7622, 185, 352, 9, 30, "Input",ExpressionUUID->"8f108b43-b961-43a6-b12b-164aa071818b"],
Cell[7977, 196, 157, 3, 30, "Input",ExpressionUUID->"4913f491-bfb4-45fd-9e08-b5c386e24f8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8171, 204, 1027, 14, 45, "Subsubsection",ExpressionUUID->"de6ca727-e7c1-4547-ab9a-af45733c5a70"],
Cell[9201, 220, 317, 7, 30, "Input",ExpressionUUID->"edca56e5-a111-4259-bcd0-e6eaefeb39e1"],
Cell[9521, 229, 271, 6, 30, "Input",ExpressionUUID->"f414560b-82e2-419a-963b-38a35b8a915d"],
Cell[9795, 237, 324, 7, 30, "Input",ExpressionUUID->"a9b3d4b3-bd8d-4e43-8534-99963bcae5d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10156, 249, 412, 6, 45, "Subsubsection",ExpressionUUID->"97f79a3f-73bc-4379-9c45-7335750d8918"],
Cell[10571, 257, 2615, 53, 52, "Input",ExpressionUUID->"a3218911-e412-40fb-9834-a5400db2a5dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13223, 315, 1137, 16, 45, "Subsubsection",ExpressionUUID->"4b48ff2f-b0da-4364-9941-a0c2127d4558"],
Cell[14363, 333, 615, 11, 94, "Input",ExpressionUUID->"3c4bae57-a70a-4223-ac85-cebe62a07d35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15015, 349, 1184, 17, 45, "Subsubsection",ExpressionUUID->"a0462bd4-0a77-4a26-bdb3-6f01378d08c4"],
Cell[16202, 368, 1518, 39, 115, "Input",ExpressionUUID->"06aa3bce-b597-4d26-bdf0-98932b4b2bd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17757, 412, 1054, 15, 45, "Subsubsection",ExpressionUUID->"9adfc16c-c908-4f18-b691-272bf08c95ae"],
Cell[18814, 429, 1398, 28, 52, "Input",ExpressionUUID->"b6a425cf-cbf8-4421-b238-dc6ef7c1978a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20249, 462, 448, 9, 45, "Subsubsection",ExpressionUUID->"8de6a2d3-b1c1-407e-ae34-337e0ddc7f4c"],
Cell[20700, 473, 613, 12, 157, "Input",ExpressionUUID->"6437f30f-0d0a-4103-a023-cae924889bbf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21350, 490, 561, 9, 45, "Subsubsection",ExpressionUUID->"16fe82c5-0c7e-4f22-a510-739ca7e122ef"],
Cell[21914, 501, 1042, 24, 52, "Input",ExpressionUUID->"5658b428-36f3-4bd5-8822-805779331e02"],
Cell[22959, 527, 541, 12, 30, "Input",ExpressionUUID->"555483c4-040d-4662-b747-5c941bff8db8"],
Cell[23503, 541, 3063, 70, 136, "Input",ExpressionUUID->"93c5d17d-dec0-4fe9-b69b-1ed39bdf9d7a"],
Cell[26569, 613, 515, 12, 52, "Input",ExpressionUUID->"44714f78-6dbb-47c5-a601-737e16b0719b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27121, 630, 321, 5, 45, "Subsubsection",ExpressionUUID->"757e2139-18af-4a00-9aa0-fe645bba5d84"],
Cell[27445, 637, 2419, 58, 157, "Input",ExpressionUUID->"9e349121-341a-4ee5-a9b5-73fb7aaf0742"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29901, 700, 534, 10, 45, "Subsubsection",ExpressionUUID->"65766d8a-5e14-4471-bd29-e6dfdc91a493"],
Cell[30438, 712, 1537, 37, 178, "Input",ExpressionUUID->"d7f0747b-d463-4646-b50d-a9a37000736d"],
Cell[31978, 751, 6171, 127, 325, "Input",ExpressionUUID->"094b47d2-b410-4861-8728-f0c003173808"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38186, 883, 1383, 21, 45, "Subsubsection",ExpressionUUID->"be391ede-9d1f-42b4-b06d-8f2c692c5a49"],
Cell[39572, 906, 4294, 109, 304, "Input",ExpressionUUID->"9630b32e-15fd-42e6-abdb-4dfd7a4ce36e"],
Cell[43869, 1017, 440, 10, 52, "Input",ExpressionUUID->"4636bff1-03ac-4a2e-9045-3fc113ca7c76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44346, 1032, 1245, 18, 45, "Subsubsection",ExpressionUUID->"23fa5c11-2655-43a7-8d9d-704fcc2a9e6c"],
Cell[45594, 1052, 1466, 40, 94, "Input",ExpressionUUID->"06ce97fb-349b-43de-8984-4489ed9a85d7"]
}, Open  ]]
}
]
*)


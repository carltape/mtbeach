(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     15305,        330]
NotebookOptionsPosition[     14720,        307]
NotebookOutlinePosition[     15057,        322]
CellTagsIndexPosition[     15014,        319]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
First run common_funs, common_MTfuns, BBsWithOptions.\
\>", "Subsubsection",
 CellChangeTimes->{{3.857308419534755*^9, 3.857308439630834*^9}, {
  3.857509123699905*^9, 3.8575091474979973`*^9}}],

Cell["\<\
The following figure is for the beachball in Thurin, Tape, Modrak (2022).\
\>", "Text",
 CellChangeTimes->{{3.594590383473466*^9, 3.594590410065504*^9}, 
   3.600032812453096*^9, {3.744726172932863*^9, 3.744726201347736*^9}, {
   3.857380128583706*^9, 3.857380138861322*^9}, {3.875526607867197*^9, 
   3.8755266142830267`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MUSE", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"230.00", "45.935", 
       RowBox[{"-", "2.0487"}]},
      {"45.935", "118.32", "10.898"},
      {
       RowBox[{"-", "2.0487"}], "10.898", "109.59"}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.857324625302761*^9, 3.8573246291878123`*^9}, 
   3.857326280646971*^9, 3.857380876221672*^9}],

Cell[TextData[StyleBox["Permute from up-south-east to south-east-up",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.823011313104916*^9, 3.8230113906961527`*^9}, 
   3.829761199298924*^9, {3.8297618054993134`*^9, 3.829761810285828*^9}, {
   3.829824366685021*^9, 3.829824368773164*^9}, {3.829826840185865*^9, 
   3.829826852249213*^9}, {3.829915900384255*^9, 3.829915970548061*^9}, {
   3.829926554482009*^9, 3.8299265632449617`*^9}, 3.830022401257053*^9, {
   3.8303497435400352`*^9, 3.83034974459654*^9}, {3.857380776694426*^9, 
   3.857380789138212*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MSEU", " ", "=", 
   RowBox[{"rot111", ".", "MUSE", ".", 
    RowBox[{"Transpose", "[", "rot111", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MSEU", "]"}]}], "Input",
 CellChangeTimes->{{3.8573808591778584`*^9, 3.857380888401622*^9}}],

Cell["Eigenvalues", "Text",
 CellChangeTimes->{{3.823011313104916*^9, 3.8230113906961527`*^9}, 
   3.829761199298924*^9, {3.8297618054993134`*^9, 3.829761810285828*^9}, {
   3.829824366685021*^9, 3.829824368773164*^9}, {3.829826840185865*^9, 
   3.829826852249213*^9}, {3.829915900384255*^9, 3.829915970548061*^9}, {
   3.829926554482009*^9, 3.8299265632449617`*^9}, 3.830022401257053*^9, {
   3.8303497435400352`*^9, 3.83034974459654*^9}, {3.857380776694426*^9, 
   3.857380789138212*^9}, {3.857380942698436*^9, 3.857380944940198*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evals", ",", "Evecs"}], "}"}], "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Eigensystem", "[", "MSEU", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "Evals", "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Evecs", "]"}]}], "Input",
 CellChangeTimes->{{3.8230142368022685`*^9, 3.823014252527461*^9}, 
   3.82301431802474*^9, {3.829332013202524*^9, 3.829332023752008*^9}, {
   3.8303496753972187`*^9, 3.83034967583001*^9}, {3.8303497106152267`*^9, 
   3.830349711088723*^9}, {3.843909336070047*^9, 3.843909339876844*^9}, {
   3.857380929730094*^9, 3.8573809398763647`*^9}, {3.85738100560535*^9, 
   3.8573810737975817`*^9}, {3.857381217948812*^9, 3.8573812261996193`*^9}}],

Cell["Full plotting commands", "Text",
 CellChangeTimes->{{3.594590383473466*^9, 3.594590410065504*^9}, 
   3.600032812453096*^9, {3.744726172932863*^9, 3.744726201347736*^9}, {
   3.857380128583706*^9, 3.857380138861322*^9}, {3.857437614171047*^9, 
   3.857437672476219*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]", "=", "Evals"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", "Evecs"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "=", ".8"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Important", ";", " ", 
      RowBox[{
      "t", " ", "determines", " ", "how", " ", "much", " ", "of", " ", "the", 
       " ", "vector", " ", "field", " ", "to", " ", 
       RowBox[{"show", ".", " ", "If"}], " ", "the", " ", "diagram", " ", 
       "looks", " ", "screwy"}]}], ",", " ", 
     RowBox[{"try", " ", "changing", " ", "t"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10.", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"35", ",", "70"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
  RowBox[{"BBrad", "=", "1"}], ";", 
  RowBox[{"ArrowScale", "=", ".13"}], ";", 
  RowBox[{"tkns", "=", ".003"}], ";", 
  RowBox[{"ptsz", "=", ".006"}], ";", "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "probably", " ", "no", " ", "need", " ", "to", " ", "change", " ", 
     "these", " ", "much"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"PtsOnSphere", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"zrot", "[", "5", "]"}], ".", "u", ".", 
      RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"xyztp", "[", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]", ",", "30.", ",", "150", ",", "15"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "15.", ",", "360", ",", "15"}], "}"}]}], 
         "]"}], ",", "1"}], "]"}], ",", " ", "\[IndentingNewLine]", 
      "                                                  ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"xyztp", "[", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]", ",", "15.", ",", "165", ",", "150"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "15.", ",", "360", ",", "30"}], "}"}]}], 
         "]"}], ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
      "                                                  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RedAndWhite", "=", "False"}], ";", "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "False", " ", "gives", " ", "continuous", " ", "coloring", " ", "instead",
      " ", "of", " ", "binary"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"PrincipalAxesWithArrows", "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrincipalAxesNoArrows", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantNodalCurve", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntegralCurves", "=", "True"}], ";", "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "Integral", " ", "curves", " ", "of", " ", "the", " ", "vector", " ", 
      "field"}], ";", 
     RowBox[{
     "at", " ", "each", " ", "point", " ", "on", " ", "the", " ", "curve", 
      " ", "the", " ", "vector", " ", "field", " ", "is", " ", "tangent", " ",
       "to", " ", "the", " ", 
      RowBox[{"curve", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\[CapitalLambda] = \>\"", ",", "\[CapitalLambda]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PrintEye", ";"}], "\[IndentingNewLine]", 
 RowBox[{"BBwithOptions", "[", 
  RowBox[{"\[CapitalLambda]", ",", "u", ",", "PtsOnSphere"}], "]"}]}], "Input",
 CellChangeTimes->{{3.54674739262261*^9, 3.5467474555843196`*^9}, {
   3.546747489670379*^9, 3.5467474928059845`*^9}, {3.546747595204563*^9, 
   3.546747680115511*^9}, {3.5467477303943987`*^9, 3.5467477874436984`*^9}, {
   3.546749587452837*^9, 3.546749611523679*^9}, {3.546750355956977*^9, 
   3.546750360605785*^9}, {3.546751230847118*^9, 3.546751233218322*^9}, {
   3.5467520384430313`*^9, 3.5467520533435574`*^9}, {3.5468748239565516`*^9, 
   3.5468748266241565`*^9}, {3.546875127595481*^9, 3.546875160776739*^9}, {
   3.5468751958768005`*^9, 3.5468751963760014`*^9}, {3.5468819079343176`*^9, 
   3.546881911257123*^9}, {3.546881941271576*^9, 3.546881977869239*^9}, {
   3.5468828201523085`*^9, 3.5468828203707085`*^9}, {3.5468849456050315`*^9, 
   3.5468849741062813`*^9}, {3.546912390478277*^9, 3.5469124053607035`*^9}, 
   3.5469124934660573`*^9, 3.5469151993638725`*^9, 3.5469156234400225`*^9, 
   3.546964329241476*^9, 3.575683900754984*^9, {3.5756840574186583`*^9, 
   3.575684071396283*^9}, {3.5920787426770315`*^9, 3.5920787704170694`*^9}, {
   3.594259503154374*^9, 3.594259511424385*^9}, {3.5942596392645617`*^9, 
   3.59425964491457*^9}, {3.594261177246703*^9, 3.594261180126707*^9}, {
   3.594262020591875*^9, 3.5942620429119062`*^9}, 3.5942622089561377`*^9, {
   3.5943986471993985`*^9, 3.5943986603994164`*^9}, {3.594398747259038*^9, 
   3.5943987792105875`*^9}, {3.5943989261052914`*^9, 3.594398943007815*^9}, {
   3.5943995965352273`*^9, 3.5943995981752295`*^9}, {3.594399657047312*^9, 
   3.5943997006223726`*^9}, {3.594399837567063*^9, 3.5943998416170683`*^9}, {
   3.5943998720171103`*^9, 3.5943998759771156`*^9}, {3.5944009441541023`*^9, 
   3.5944009907941666`*^9}, 3.5944010451682453`*^9, {3.5944021044547358`*^9, 
   3.5944021232147617`*^9}, {3.5944027466946363`*^9, 
   3.5944027516066446`*^9}, {3.5944095672542257`*^9, 3.594409583274248*^9}, {
   3.5944099998503294`*^9, 3.594410001130331*^9}, {3.5944114206028137`*^9, 
   3.594411439749343*^9}, {3.594412150460837*^9, 3.5944121653408575`*^9}, {
   3.59441260379647*^9, 3.5944126483280344`*^9}, 3.5944128090682564`*^9, {
   3.594415019173047*^9, 3.5944150266905575`*^9}, 3.5944150968176575`*^9, 
   3.5944154244616137`*^9, 3.594415461474165*^9, {3.594416299283852*^9, 
   3.594416299993853*^9}, {3.5944184253348937`*^9, 3.5944184876549797`*^9}, {
   3.5944188272264557`*^9, 3.5944188583264985`*^9}, {3.5944196063055468`*^9, 
   3.5944196155255594`*^9}, {3.59443026047038*^9, 3.5944302998024354`*^9}, {
   3.5944303492125034`*^9, 3.594430359262518*^9}, 3.5944304475046406`*^9, {
   3.5944307350070467`*^9, 3.5944307395170527`*^9}, {3.5944321421305265`*^9, 
   3.5944321866125894`*^9}, {3.594432252752681*^9, 3.5944322975627427`*^9}, {
   3.5944323450028086`*^9, 3.5944324194304113`*^9}, {3.594432694994296*^9, 
   3.594432722944335*^9}, 3.5944327790864134`*^9, {3.5944328399564977`*^9, 
   3.594432864329032*^9}, {3.594432910221595*^9, 3.594432943436142*^9}, 
   3.594432980806194*^9, {3.594433236719056*^9, 3.594433269399101*^9}, 
   3.594433392225274*^9, {3.594433422255316*^9, 3.594433445405348*^9}, {
   3.594433681129675*^9, 3.594433685769682*^9}, {3.594434460384767*^9, 
   3.594434488394806*^9}, {3.5944346052889695`*^9, 3.594434658123045*^9}, {
   3.594435061455609*^9, 3.5944351248576975`*^9}, {3.5944352858039246`*^9, 
   3.594435288153928*^9}, {3.5944354887282066`*^9, 3.594435489618208*^9}, {
   3.5944355959083548`*^9, 3.5944355966583557`*^9}, {3.594435754512576*^9, 
   3.5944357986766396`*^9}, {3.594436144101119*^9, 3.5944361531811314`*^9}, {
   3.594436195593191*^9, 3.594436197113193*^9}, {3.5944362283752375`*^9, 
   3.5944362823253117`*^9}, {3.5944367347559423`*^9, 3.59443676839799*^9}, {
   3.5944368018380365`*^9, 3.5944368418600926`*^9}, {3.5944374692609725`*^9, 
   3.5944375667611065`*^9}, 3.594437644921215*^9, {3.5944379511796427`*^9, 
   3.594437963991661*^9}, {3.594437995251704*^9, 3.594438028911751*^9}, {
   3.5944380620717964`*^9, 3.594438144765913*^9}, {3.594438597088545*^9, 
   3.594438597798546*^9}, {3.5945040880708895`*^9, 3.594504115160927*^9}, {
   3.5945050002706623`*^9, 3.594505040670718*^9}, {3.5945051373728523`*^9, 
   3.594505138294855*^9}, {3.5945200830697126`*^9, 3.594520099969736*^9}, {
   3.59452046113824*^9, 3.5945205116223125`*^9}, {3.5945208103767276`*^9, 
   3.5945208156467347`*^9}, {3.594521036331042*^9, 3.5945210396610465`*^9}, 
   3.594521590459812*^9, {3.5945216374818783`*^9, 3.5945216384018793`*^9}, {
   3.594522119276552*^9, 3.594522199188665*^9}, {3.594522277912776*^9, 
   3.594522294542799*^9}, {3.5945223622628927`*^9, 3.594522508985096*^9}, {
   3.594522549495152*^9, 3.594522554595159*^9}, {3.594522611577239*^9, 
   3.5945226126472406`*^9}, {3.5945849825500765`*^9, 3.594585046672166*^9}, 
   3.5945850870947223`*^9, {3.5945852879320073`*^9, 3.5945852912720118`*^9}, {
   3.594588171170535*^9, 3.5945881889305596`*^9}, 3.594589987985413*^9, 
   3.594590299018349*^9, {3.5945905174706526`*^9, 3.5945905223406596`*^9}, {
   3.5945906096872826`*^9, 3.594590663624359*^9}, {3.5945907290869493`*^9, 
   3.5945907666745014`*^9}, {3.594590839527102*^9, 3.594591025620865*^9}, {
   3.6015754535794735`*^9, 3.601575454399474*^9}, {3.7111306530433006`*^9, 
   3.7111306541473603`*^9}, {3.7111310832369366`*^9, 3.711131114339717*^9}, {
   3.7111385560954313`*^9, 3.7111385627338195`*^9}, {3.7111402983022146`*^9, 
   3.7111403204294815`*^9}, {3.7111583319623795`*^9, 
   3.7111583329311314`*^9}, {3.711159018323083*^9, 3.711159019151223*^9}, {
   3.711159527542842*^9, 3.7111595319178157`*^9}, 3.7111595620897493`*^9, {
   3.711159662683731*^9, 3.7111596963712482`*^9}, {3.7111627380425787`*^9, 
   3.7111627389056244`*^9}, {3.7112078384534693`*^9, 3.711207839109723*^9}, {
   3.711208086000866*^9, 3.7112081337353344`*^9}, {3.7112085223454695`*^9, 
   3.7112085291267195`*^9}, {3.7112085930331078`*^9, 3.711208702455197*^9}, 
   3.7112088323147974`*^9, {3.7392028967538834`*^9, 3.7392028975663815`*^9}, 
   3.7392036082833633`*^9, {3.73920548460824*^9, 3.739205491811331*^9}, {
   3.857437606535944*^9, 3.857437607093391*^9}, {3.8574376587289963`*^9, 
   3.8574376614744167`*^9}, {3.857509233198649*^9, 3.857509235660762*^9}, {
   3.857509529460949*^9, 3.857509530122566*^9}}]
}, Open  ]]
},
WindowSize->{1122, 948},
WindowMargins->{{Automatic, 107}, {0, Automatic}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 203, 4, 35, "Subsubsection"],
Cell[773, 28, 383, 8, 31, "Text"],
Cell[1159, 38, 411, 11, 63, "Input"],
Cell[1573, 51, 573, 8, 31, "Text"],
Cell[2149, 61, 300, 7, 55, "Input"],
Cell[2452, 70, 536, 7, 31, "Text"],
Cell[2991, 79, 751, 14, 77, "Input"],
Cell[3745, 95, 322, 6, 31, "Text"],
Cell[4070, 103, 10634, 201, 429, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

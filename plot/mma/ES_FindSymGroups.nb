(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84383,       2141]
NotebookOptionsPosition[     82383,       2075]
NotebookOutlinePosition[     82721,       2090]
CellTagsIndexPosition[     82678,       2087]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "1", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "2", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", "0", "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "3", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {
       FractionBox["1", 
        SqrtBox["2"]], "0", "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "4", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";", 
   RowBox[{
    RowBox[{"BB", "[", "5", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["6"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", 
         RowBox[{"-", "2"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], ";", 
   " ", 
   RowBox[{
    RowBox[{"BB", "[", "6", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["3"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   ";"}], "     "}]}], "Input",
 CellChangeTimes->{{3.792971206733848*^9, 3.7929713022003465`*^9}, {
   3.792971408071004*^9, 3.792971440387087*^9}, {3.792971498549478*^9, 
   3.792971499440118*^9}, 3.792972692948264*^9, {3.7929727241080465`*^9, 
   3.7929727262955894`*^9}, {3.792972763426332*^9, 3.7929727864596667`*^9}, {
   3.793302127686242*^9, 3.793302210883026*^9}, {3.793452169745813*^9, 
   3.793452205234699*^9}, {3.7934534711802993`*^9, 3.793453503105508*^9}, {
   3.7934875097186317`*^9, 3.7934875184076557`*^9}, {3.7940628516347594`*^9, 
   3.794062915122757*^9}, 3.7940668797157593`*^9, {3.794303579755892*^9, 
   3.794303673207573*^9}, 3.7946837182844687`*^9, {3.794683831532472*^9, 
   3.7946838327474766`*^9}, {3.795368427569252*^9, 3.795368457449376*^9}, {
   3.7954159482798815`*^9, 3.7954159499048824`*^9}, {3.7998533351296206`*^9, 
   3.7998534017979136`*^9}, {3.7998594859163437`*^9, 
   3.7998594916854353`*^9}, {3.7998596087056255`*^9, 
   3.7998596116364765`*^9}, {3.7999471922765937`*^9, 
   3.7999472010435143`*^9}, {3.799947251311059*^9, 3.7999472826775537`*^9}, {
   3.7999474305174685`*^9, 3.79994753957263*^9}, {3.7999477903421464`*^9, 
   3.7999478574073067`*^9}, {3.8303041767764983`*^9, 3.83030423992684*^9}, {
   3.8303043151804295`*^9, 3.8303043233750134`*^9}, {3.8357041787967825`*^9, 
   3.8357042083327866`*^9}, 3.835706536000112*^9, {3.835708619117347*^9, 
   3.835708621723645*^9}, {3.8357086642253847`*^9, 3.8357087005133877`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DateSequence", "[", 
    RowBox[{"date_", ",", "WantTime_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WantTime", "\[Equal]", "\"\<yes\>\""}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\"\< \>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
        "\"\<:\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "M", "]"}], ".", 
    RowBox[{"Flatten", "[", "N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMatrix", "[", "M_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{"M", ",", "M"}], "]"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"   ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0", 
       RowBox[{"Sin", "[", "t", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0", 
       RowBox[{"Cos", "[", "t", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0"},
      {"0", "0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UsHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
     RowBox[{
      StyleBox["YRot",
       FontColor->GrayLevel[0]], "[", "\[Phi]", "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matrixL", "[", "L_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "j", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "i", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixUbar", "[", "U_", "]"}], ":=", 
    RowBox[{"matrixL", "[", 
     RowBox[{
      RowBox[{"U", ".", "#", ".", 
       RowBox[{"Transpose", "[", "U", "]"}]}], "&"}], "]"}]}], ";"}], 
  "  "}]}], "Input",
 CellChangeTimes->{{3.8357039212458153`*^9, 3.8357039223007507`*^9}, {
   3.835703992348759*^9, 3.83570399702076*^9}, {3.8357040638209357`*^9, 
   3.835704086621888*^9}, {3.8357046159648385`*^9, 3.835704617053875*^9}, 
   3.835704928124878*^9, {3.8357054888769493`*^9, 3.835705497326971*^9}, {
   3.835707612017251*^9, 3.8357076837732277`*^9}, {3.8357077779012394`*^9, 
   3.8357077802732315`*^9}, {3.835707831982522*^9, 3.835707877890067*^9}, {
   3.8357079111492567`*^9, 3.8357079161617813`*^9}, {3.835707951485262*^9, 
   3.8357080432469664`*^9}, {3.835708249679347*^9, 3.835708259615336*^9}, {
   3.8375230482235036`*^9, 3.8375230493595037`*^9}, {3.837540061976939*^9, 
   3.8375400950953417`*^9}, {3.8375423564567285`*^9, 3.837542357566089*^9}, {
   3.8375427703430943`*^9, 3.837542772046219*^9}, {3.837542814429597*^9, 
   3.8375428636075673`*^9}, {3.837542909222314*^9, 3.837542910159814*^9}, {
   3.838308629193669*^9, 3.8383086347096825`*^9}, 3.838308821850387*^9, {
   3.838315371007059*^9, 3.8383154080262575`*^9}, {3.8385134507096677`*^9, 
   3.838513451892892*^9}, {3.838513518438653*^9, 3.8385135221642294`*^9}, {
   3.8385135652668605`*^9, 3.8385135659419465`*^9}, {3.8385136594605*^9, 
   3.8385136616545105`*^9}, {3.838514819535391*^9, 3.8385148207092237`*^9}, {
   3.8473829008383565`*^9, 3.847382927155428*^9}, {3.847382967814706*^9, 
   3.8473829736857033`*^9}, {3.847469599712659*^9, 3.847469600513344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "SymClass_"}], "]"}], ":=", "     ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"This", " ", "is", " ", "d", 
      RowBox[{"(", 
       RowBox[{"T", ",", 
        RowBox[{
         SubscriptBox["V", "\[CapitalSigma]"], 
         RowBox[{"(", "U", ")"}]}]}], ")"}], " ", "in", " ", "the", " ", 
      "2022", " ", "paper"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"NormMatrix", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
      RowBox[{"MatrixUbar", "[", "U", "]"}]}], "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
        RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "SymClass"}], "]"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[TextData[{
 "RefMatrix is a reference matrix for P(T, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalV]", "\[CapitalSigma]"], "(", "U", ")"}], 
    ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  It is a reference matrix for T if the symmetry of T is at least Sigma \
and if ",
 StyleBox["U",
  FontSlant->"Italic"],
 " is a \[CapitalSigma]-minimizer."
}], "Subsubsection",
 CellChangeTimes->{{3.8435752812023726`*^9, 3.843575328712101*^9}, {
  3.847468056526307*^9, 3.8474680838709745`*^9}, {3.8474681231202993`*^9, 
  3.847468172553614*^9}, {3.847468232168193*^9, 3.8474683044480705`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefMatrix", "[", 
     RowBox[{"Tmat_", ",", "U_", ",", "Sigma_"}], "]"}], ":=", 
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
       RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", "id", ",", "Sigma"}], 
     "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"U", " ", "should", " ", "be", " ", "a", " ", "Sigma"}], "-", 
     RowBox[{"minimizer", " ", "for", " ", "T"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.843253283063239*^9, 3.843253398215254*^9}, {
   3.8435743070154686`*^9, 3.8435743153535213`*^9}, 3.8435752451019926`*^9, 
   3.843589994670141*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "Sigma_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixUbar", "[", "U", "]"}], ".", 
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
       RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", "id", ",", "Sigma"}], 
     "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.837707973295394*^9, 3.837707999043233*^9}, {
  3.837708047967713*^9, 3.837708133270465*^9}, {3.8377081670288773`*^9, 
  3.837708182094732*^9}, {3.838315519596882*^9, 3.838315527532865*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{"Tmat_", ",", "id", ",", "TRIV"}], "]"}], ":=", "Tmat"}], ";"}], 
  "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"These", " ", "are", " ", "the", " ", "P", 
     RowBox[{"(", 
      RowBox[{"T", ",", 
       RowBox[{
        SubscriptBox["V", "\[CapitalSigma]"], 
        RowBox[{"(", "I", ")"}]}]}], ")"}], " ", "in", " ", "the", " ", 
     "2022", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "id", ",", "MONO"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "0", "0", "0", "0"},
       {"g", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "i", "o", "s"},
       {"0", "0", "i", "d", "j", "p"},
       {"0", "0", "o", "j", "e", "k"},
       {"0", "0", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "id", ",", "ORTH"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0", "0", "0", "0", "0"},
       {"0", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "0", "0", "0"},
       {"0", "0", "0", "d", "j", "p"},
       {"0", "0", "0", "j", "e", "k"},
       {"0", "0", "0", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "id", ",", "TRIG"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", "0"},
        {
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"m", "+", "n"}], "2"], "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "id", ",", "TET"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0"},
        {"0", "0", "c", "0", "0", "0"},
        {"0", "0", "0", "d", "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "id", ",", "CUBE"}], "]"}], ":=", 
   TagBox[
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0", "0"},
        {"0", "0", 
         FractionBox[
          RowBox[{"a", "+", "b", "+", "c"}], "3"], "0", "0", "0"},
        {"0", "0", "0", 
         FractionBox[
          RowBox[{"d", "+", "e"}], "2"], "0", "0"},
        {"0", "0", "0", "0", 
         FractionBox[
          RowBox[{"d", "+", "e"}], "2"], "0"},
        {"0", "0", "0", "0", "0", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"a_", "g_", "m_", "q_", "t_", "v_"},
          {"gdum_", "b_", "h_", "n_", "r_", "u_"},
          {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
          {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
          {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
          {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", "id", ",", "XISO"}], "]"}], ":=", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0", "0"},
        {"0", 
         FractionBox[
          RowBox[{"a", "+", "b"}], "2"], "0", "0", "0", "0"},
        {"0", "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0", "0"},
        {"0", "0", "0", 
         FractionBox[
          RowBox[{"c", "+", "d"}], "2"], "0", "0"},
        {"0", "0", "0", "0", "e", "k"},
        {"0", "0", "0", "0", "k", "f"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";", 
   RowBox[{
    RowBox[{"ProjToVSigOfU", "[", 
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"a_", "g_", "m_", "q_", "t_", "v_"},
          {"gdum_", "b_", "h_", "n_", "r_", "u_"},
          {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
          {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
          {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
          {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", "id", ",", "ISO"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0", "0", "0"},
       {"0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0", "0"},
       {"0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0", "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0", 
        "0"},
       {"0", "0", "0", "0", 
        FractionBox[
         RowBox[{"a", "+", "b", "+", "c", "+", "d", "+", "e"}], "5"], "0"},
       {"0", "0", "0", "0", "0", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.8365909720971985`*^9, 3.83659100273319*^9}, {
   3.836591362316605*^9, 3.836591369832106*^9}, {3.837537582893462*^9, 
   3.8375376419816647`*^9}, {3.837537681816289*^9, 3.8375377605041833`*^9}, {
   3.8375381993641057`*^9, 3.837538212538134*^9}, {3.837538755170615*^9, 
   3.837538794523321*^9}, {3.8375388308072205`*^9, 3.8375389016620283`*^9}, {
   3.8375389425372505`*^9, 3.8375389432091637`*^9}, {3.837540045005973*^9, 
   3.8375400469122224`*^9}, {3.838315531679864*^9, 3.838315537160882*^9}, 
   3.838315656107436*^9, 3.843934250463087*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{"Tmat_", ",", "Sigma_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp", "=", " ", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ",", "Sigma"}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "\[LessEqual]", "\[Sigma]", "\[LessEqual]",
            "\[Pi]"}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "/.", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["ISO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
         RowBox[{"Tmat", ",", "id", ",", 
          StyleBox["ISO",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", " ", "\[Rule]", "0"}], ",", 
         RowBox[{"\[Sigma]", "->", "0"}], ",", 
         RowBox[{"\[Phi]", "->", "0"}]}], "}"}]}], 
      RowBox[{"(*", " ", 
       StyleBox["dummy",
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", "0"}], ";"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["XISO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["XISO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{"temp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{"temp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
   RowBox[{
    StyleBox["Tmat_",
     FontColor->GrayLevel[0]], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["MONO",
     FontColor->RGBColor[1, 0, 0]]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
          RowBox[{"Tmat", ",", 
           RowBox[{"UsHat", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              StyleBox["0.",
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[",",
               FontColor->RGBColor[1, 0, 0]], "\[Phi]"}], "}"}], "]"}], ",", 
           StyleBox["MONO",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", 
           RowBox[{"2", "\[Pi]"}]}], "&&", 
          RowBox[{
          "0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", "\[Pi]"}]}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
       StyleBox[
        RowBox[{"Method", "\[Rule]", "\"\<RandomSearch\>\""}],
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Theta]", "/.", 
      RowBox[{"temp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{"temp", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.8432638002966256`*^9, 3.843263848587617*^9}, {
   3.843263901498243*^9, 3.8432639249045906`*^9}, {3.843264035112605*^9, 
   3.843264049384597*^9}, {3.8432640820756454`*^9, 3.8432641113867397`*^9}, {
   3.8432641575126195`*^9, 3.843264176600622*^9}, 3.8432642092735014`*^9, {
   3.85800443755595*^9, 3.858004508964686*^9}, {3.8580045492990336`*^9, 
   3.8580046084862204`*^9}, {3.8580046498167143`*^9, 
   3.8580046922574406`*^9}, {3.8580047386393414`*^9, 
   3.8580047519394045`*^9}, {3.858004893375312*^9, 3.858004901820363*^9}, {
   3.858008522332718*^9, 3.858008531919662*^9}, {3.8580086348792405`*^9, 
   3.8580086378895903`*^9}, {3.8580089489322834`*^9, 
   3.8580089933041143`*^9}, {3.8597262185704365`*^9, 3.8597262225626307`*^9}, 
   3.8597627035076723`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OutputFor", "[", 
   RowBox[{"Tmat_", ",", "Sigma_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"DateSequence", "[", 
      RowBox[{
       RowBox[{"DateList", "[", "]"}], ",", "\"\<yes\>\""}], "]"}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"GetTempAnd\[Theta]0\[Sigma]0\[Phi]0", "[", 
     RowBox[{"Tmat", ",", "Sigma"}], "]"}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "temp", ",", 
      "\"\<  ( minimizing the function  (\[Theta],\[Sigma],\[Phi]) \>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\[LongRightArrow]\>\"", " ", ",", "Bold", ",", "14"}], 
       "]"}], ",", "\"\< d\>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<(\>\"", ",", "18"}], "]"}], ",", "\"\<T, \>\"", ",", 
      RowBox[{
       RowBox[{"SubscriptBox", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", "14", ",", "Bold"}], 
          "]"}], ",", 
         StyleBox["Sigma",
          FontColor->GrayLevel[0]]}], "]"}], "//", "DisplayForm"}], ",", 
      "\"\<(U)\>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<)\>\"", ",", "18"}], "]"}], ",", 
      "\"\<, U = \!\(\*SubscriptBox[OverscriptBox[\(U\), \(^\)], \(S\)]\)(\
\[Theta],\[Sigma],\[Phi]) )\>\""}], " ", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"UT", "[", 
      RowBox[{"Tmat", ",", "Sigma"}], "]"}], "=", 
     RowBox[{"UsHat", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dT", "[", 
      RowBox[{"Tmat", ",", "Sigma"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{"NormMatrix", "[", "Tmat", "]"}], " ", "removed", " ", "Oct", 
       " ", "2021"}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]T", "[", 
      RowBox[{"Tmat", ",", "Sigma"}], "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"ArcSin", "[", 
        FractionBox[
         RowBox[{"temp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"NormMatrix", "[", "Tmat", "]"}]], "]"}], ",", "ChopTol"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<       ( {\[Theta], \[Sigma], \[Phi]} in degrees are \>\"", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]0", ",", "\[Sigma]0", ",", "\[Phi]0"}], "}"}], "/", 
       "Degree"}], " ", ",", "\"\< )\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<d(T, \>\"", ",", 
      RowBox[{
       RowBox[{"SubscriptBox", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[ScriptCapitalT]\>\"", ",", "Bold"}], "]"}], ",", 
         "Sigma"}], "]"}], "//", "DisplayForm"}], ",", "\"\<) = \>\"", ",", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "ChopTol"}], "]"}], ",", 
      "\"\< ( distance from T to \>\"", ",", 
      RowBox[{
       RowBox[{"SubscriptBox", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[ScriptCapitalT]\>\"", ",", "Bold"}], "]"}], ",", 
         "Sigma"}], "]"}], "//", "DisplayForm"}], ",", "\"\< )\>\""}], "]"}], 
    ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox["dT",
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SubsuperscriptBox", "[", 
        RowBox[{"\"\<\[Beta]\>\"", ",", "Sigma", ",", "\"\<T\>\""}], "]"}], "//",
        "DisplayForm"}], ",", "\"\< = \>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\[Angle]", ",", "18"}], "]"}], ",", "\"\<(T, \>\"", ",", " ", 
      RowBox[{
       RowBox[{"SubscriptBox", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[ScriptCapitalT]\>\"", ",", "Bold"}], "]"}], ",", 
         "Sigma"}], "]"}], "//", "DisplayForm"}], ",", "\"\<) = \>\"", ",", 
      RowBox[{"\[Beta]T", "[", 
       RowBox[{"Tmat", ",", "Sigma"}], "]"}], ",", "\"\< = \>\"", ",", 
      SuperscriptBox[
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]T", "[", 
           RowBox[{"Tmat", ",", "Sigma"}], "]"}], "/", "Degree"}], ",", 
         ".01"}], "]"}], "o"], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Beta]T", "[", 
             RowBox[{"Tmat", ",", "Sigma"}], "]"}], "/", "Degree"}], ",", 
           ".01"}], "]"}], "==", "0"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{"\"\<, so T has symmetry at least \>\"", ",", "Sigma"}], 
           "]"}], ",", "Red"}], "]"}], ",", "\"\< \>\""}], "]"}]}], "]"}], 
    ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox["BETA",
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<U = \!\(\*SubscriptBox[OverscriptBox[\(U\), \(^\)], \(S\)]\)(\
\[Theta],\[Sigma],\[Phi]) = \>\"", ",", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Chop", "[", " ", 
        RowBox[{
         RowBox[{"UT", "[", 
          RowBox[{"Tmat", ",", "Sigma"}], "]"}], ",", "ChopTol"}], "]"}], 
       "]"}], ",", "  ", 
      RowBox[{"(*", " ", 
       StyleBox["minimizer",
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
      "\"\<  ( minimizes the function  U \>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<\[LongRightArrow]\>\"", " ", ",", "Bold", ",", "14"}], 
       "]"}], ",", "\"\< d\>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<(\>\"", ",", "18"}], "]"}], ",", "\"\<T, \>\"", ",", 
      RowBox[{
       RowBox[{"SubscriptBox", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", "14", ",", "Bold"}], 
          "]"}], ",", 
         StyleBox["Sigma",
          FontColor->GrayLevel[0]]}], "]"}], "//", "DisplayForm"}], ",", 
      "\"\<(U)\>\"", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<)\>\"", ",", "18"}], "]"}], ",", "\"\< )\>\""}], "]"}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "Sigma"}], "]"}], "/", "Degree"}], ">", ".01"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<P\>\"", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(\>\"", ",", "18"}], "]"}], ",", "\"\<T, \>\"", ",", 
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\[ScriptCapitalV]\>\"", ",", "14", ",", "Bold"}], 
            "]"}], ",", 
           StyleBox["Sigma",
            FontColor->GrayLevel[0]]}], "]"}], "//", "DisplayForm"}], ",", 
        "\"\<(U)\>\"", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<)\>\"", ",", "18"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"SequenceForm", "[", 
         RowBox[{"\"\< = \>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"ProjToVSigOfU", "[", 
              RowBox[{"Tmat", ",", 
               RowBox[{"UT", "[", 
                RowBox[{"Tmat", ",", 
                 StyleBox["Sigma",
                  FontColor->GrayLevel[0]]}], "]"}], ",", 
               StyleBox["Sigma",
                FontColor->GrayLevel[0]]}], "]"}], ",", ".001"}], "]"}], 
           "]"}]}], "]"}], ",", 
        "\"\<  (a closest elastic map to T having symmetry at least \>\"", 
        ",", "Sigma", ",", "\"\<)\>\""}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]T", "[", 
         RowBox[{"Tmat", ",", "Sigma"}], "]"}], "/", "Degree"}], "<", ".01"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{"\"\<T\>\"", ",", "Sigma"}], "]"}], "//", "DisplayForm"}], 
        ",", "\"\< = [\!\(\*OverscriptBox[\(U\), \
\(_\)]\)\!\(\*SuperscriptBox[\(]\), \(T\)]\) T [\!\(\*OverscriptBox[\(U\), \
\(_\)]\)] = \>\"", ",", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"RefMatrix", "[", 
            RowBox[{"Tmat", ",", 
             RowBox[{"UT", "[", 
              RowBox[{"Tmat", ",", 
               StyleBox["Sigma",
                FontWeight->"Plain",
                FontColor->GrayLevel[0]]}], "]"}], ",", "Sigma"}], "]"}], ",",
            ".001"}], "]"}], "]"}], ",", "\"\<  ( a \>\"", ",", "Sigma", ",", 
        "\"\<-ref matrix for T )\>\""}], "]"}]}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.838816725963194*^9, 3.838816881281695*^9}, 
   3.8388169161073084`*^9, 3.8388172423383355`*^9, {3.8388174538902965`*^9, 
   3.8388174643868694`*^9}, {3.838817649748008*^9, 3.8388177312967*^9}, 
   3.838817828115161*^9, {3.838818247780265*^9, 3.8388182595232644`*^9}, 
   3.838818461586613*^9, {3.838823975283159*^9, 3.838824013539116*^9}, {
   3.8389054551296883`*^9, 3.838905465509371*^9}, {3.8389054972170954`*^9, 
   3.838905525024954*^9}, {3.838905617068334*^9, 3.83890567171142*^9}, {
   3.838907007015088*^9, 3.838907009281518*^9}, {3.8389253321337857`*^9, 
   3.8389253503897104`*^9}, {3.839074017622334*^9, 3.839074051880118*^9}, {
   3.839074085048066*^9, 3.839074111364107*^9}, {3.8390753702962866`*^9, 
   3.839075416183073*^9}, 3.839075596838152*^9, {3.839075741912668*^9, 
   3.8390757981268835`*^9}, {3.8390758413843603`*^9, 
   3.8390758433669596`*^9}, {3.839075874391024*^9, 3.8390759257843695`*^9}, {
   3.839076253476379*^9, 3.8390763153342743`*^9}, {3.839076585061388*^9, 
   3.8390766000539975`*^9}, {3.839078828521459*^9, 3.8390788323607388`*^9}, 
   3.8398797372343597`*^9, {3.8416740069313283`*^9, 3.8416740149943824`*^9}, {
   3.843143012042697*^9, 3.8431430657834077`*^9}, {3.8431431590783415`*^9, 
   3.8431431825317516`*^9}, {3.843143214021452*^9, 3.843143237196582*^9}, {
   3.843143323484751*^9, 3.8431433344377365`*^9}, 3.8431558687993107`*^9, 
   3.843157297565833*^9, 3.8431575030199633`*^9, {3.8431579272050896`*^9, 
   3.8431580081740217`*^9}, {3.843158320007517*^9, 3.843158321757513*^9}, {
   3.843158394517685*^9, 3.843158396064559*^9}, {3.8432632904925423`*^9, 
   3.8432632951459084`*^9}, {3.843264343034833*^9, 3.843264356987213*^9}, {
   3.8432643871946836`*^9, 3.843264406124892*^9}, {3.843264773516732*^9, 
   3.843264822027796*^9}, 3.8435225800924253`*^9, 3.843525315338416*^9, {
   3.843532629466859*^9, 3.843532633701269*^9}, 3.843533441802493*^9, {
   3.843574850324317*^9, 3.8435748866583214`*^9}, 3.843575524738406*^9, 
   3.843590008010985*^9, {3.8439147973368692`*^9, 3.843914809968131*^9}, {
   3.8439149524091415`*^9, 3.8439149672951336`*^9}, {3.843915064452213*^9, 
   3.8439150925162015`*^9}, 3.8439155299042215`*^9, {3.843915695200239*^9, 
   3.843915780860218*^9}, {3.8439160489082527`*^9, 3.843916101152295*^9}, {
   3.8439161363642635`*^9, 3.8439161380602636`*^9}, {3.8439163108468432`*^9, 
   3.843916329340288*^9}, {3.8439166969893136`*^9, 3.8439166987359877`*^9}, 
   3.843917864082238*^9, 3.8439179200325255`*^9, {3.8439183443245783`*^9, 
   3.8439183893597803`*^9}, 3.84391865081855*^9, 3.843918942240654*^9, 
   3.843919663401228*^9, {3.843920075476799*^9, 3.843920103168639*^9}, {
   3.843920935827218*^9, 3.84392093918467*^9}, {3.843921614004985*^9, 
   3.843921620000994*^9}, 3.8439221105158453`*^9, 3.8439221712650614`*^9, {
   3.8439331613283978`*^9, 3.8439332234272623`*^9}, 3.8439334090784917`*^9, {
   3.8446170235111876`*^9, 3.8446170437287197`*^9}, {3.8446170949303017`*^9, 
   3.8446171181325893`*^9}, {3.844617193587243*^9, 3.8446172302913456`*^9}, {
   3.84461733941376*^9, 3.8446173478769293`*^9}, {3.8446176469697733`*^9, 
   3.8446176512666492`*^9}, 3.8446225759678802`*^9, {3.8446392803451796`*^9, 
   3.8446392978728976`*^9}, 3.8447858493306055`*^9, 3.846945731317214*^9, {
   3.8469458223637075`*^9, 3.846945831865611*^9}, {3.8469461600591164`*^9, 
   3.8469461701564035`*^9}, {3.846946309834462*^9, 3.8469463327757387`*^9}, {
   3.846946387564884*^9, 3.846946392160483*^9}, 3.8469464596766963`*^9, {
   3.846946718902442*^9, 3.84694672457587*^9}, 3.8469469559106183`*^9, {
   3.8469473146764116`*^9, 3.8469473688856516`*^9}, {3.846948603154036*^9, 
   3.8469486298003016`*^9}, {3.846948677652589*^9, 3.846948718223466*^9}, 
   3.846950266371421*^9, {3.8469503219472466`*^9, 3.8469503243065643`*^9}, {
   3.846950468368929*^9, 3.846950469556486*^9}, {3.8469505796090794`*^9, 
   3.8469506207016563`*^9}, {3.846950668691991*^9, 3.84695067524047*^9}, {
   3.8469507369831295`*^9, 3.846950739139336*^9}, {3.846950794518769*^9, 
   3.846950796208602*^9}, {3.8469508602361994`*^9, 3.8469508642525253`*^9}, {
   3.8469513975900817`*^9, 3.8469514123575706`*^9}, 3.846962767060589*^9, 
   3.8469654327244024`*^9, 3.8470061370824575`*^9, 3.847022425267502*^9, 
   3.847027742885198*^9, 3.8470437868119135`*^9, {3.8473815216827283`*^9, 
   3.847381544666728*^9}, 3.847381921577861*^9, {3.847382391449973*^9, 
   3.84738239453885*^9}, {3.847382537260126*^9, 3.8473825398171253`*^9}, {
   3.853519913096917*^9, 3.853519939739993*^9}, {3.853520246066271*^9, 
   3.8535202725525312`*^9}, {3.8535203080075827`*^9, 3.85352031808785*^9}, 
   3.853520462435667*^9, {3.853520509453504*^9, 3.853520513619234*^9}, {
   3.8535205869985514`*^9, 3.853520680550354*^9}, {3.8535207199762774`*^9, 
   3.8535207557506714`*^9}, 3.853520817425362*^9, {3.8535208964464397`*^9, 
   3.8535209385501633`*^9}, {3.8535209990324965`*^9, 
   3.8535210232644377`*^9}, {3.853773404561138*^9, 3.8537734151904616`*^9}, {
   3.853773457129304*^9, 3.8537735029243803`*^9}, {3.853773537948598*^9, 
   3.853773543415995*^9}, {3.8537736502150707`*^9, 3.8537737092202053`*^9}, {
   3.853773749628911*^9, 3.8537737786776886`*^9}, {3.85377382307673*^9, 
   3.853773828219431*^9}, {3.853773905678814*^9, 3.8537739355638285`*^9}, 
   3.853773967211937*^9, {3.853774009151683*^9, 3.853774058597478*^9}, {
   3.8537741639728985`*^9, 3.85377417170465*^9}, {3.853774205258111*^9, 
   3.853774206748891*^9}, {3.8537742803854446`*^9, 3.8537743014703417`*^9}, 
   3.85377437852361*^9, {3.853774503625136*^9, 3.853774531339212*^9}, {
   3.853774748343277*^9, 3.8537747632438617`*^9}, {3.8537748634356823`*^9, 
   3.853774918629639*^9}, 3.8537754638382683`*^9, {3.8537755230157204`*^9, 
   3.8537755253240376`*^9}, {3.8537755637238364`*^9, 3.853775574370835*^9}, 
   3.8537756607880216`*^9, 3.853775716452773*^9, {3.853775818750383*^9, 
   3.8537758311594887`*^9}, {3.8537758898358536`*^9, 3.85377598196447*^9}, {
   3.8537761006846523`*^9, 3.8537761101187754`*^9}, {3.8537761637687387`*^9, 
   3.8537761787611856`*^9}, {3.8537765874854655`*^9, 3.853776630634557*^9}, {
   3.853776834406987*^9, 3.8537768581983604`*^9}, {3.8537769465442653`*^9, 
   3.853776950375338*^9}, {3.8537775258295355`*^9, 3.8537775541936665`*^9}, {
   3.853777593503098*^9, 3.8537776293540344`*^9}, {3.8537777409440193`*^9, 
   3.8537777442162743`*^9}, {3.859725367216591*^9, 3.859725367972559*^9}, {
   3.859725414607169*^9, 3.8597254449936438`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]T", "[", 
    RowBox[{"Tmat_", ",", "TRIV"}], "]"}], ":=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.8430576814256325`*^9, 3.8430576945637035`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RoundMaybe", "[", "dSig_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dSig", "==", "0"}], ",", "0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dSig", "==", "999"}], ",", "999", ",", 
        SuperscriptBox[
         RowBox[{"Round", "[", 
          RowBox[{"dSig", ",", ".1"}], "]"}], "\"\<o\>\""]}], "]"}]}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"change", " ", "the", " ", "rounding", " ", "if", " ", "desired"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.838936570177287*^9, 3.838936573472731*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"seq", "[", 
    RowBox[{"Sig_", ",", "dSig_"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{"Subsuperscript", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[Beta]\>\"", ",", "22"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"Sig", ",", "14"}], "]"}], ",", 
       RowBox[{"Overscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\< \>\"", ",", "5"}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<T\>\"", ",", "Bold", ",", "15"}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\< = \>\"", ",", "20"}], "]"}], ",", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"RoundMaybe", "[", "dSig", "]"}], ",", "20"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.838927018490902*^9, 3.838927177889958*^9}, 
   3.8389276347832165`*^9, {3.8389284349762273`*^9, 3.838928459426546*^9}, {
   3.8389365433529425`*^9, 3.838936560912919*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LatticeOfDTs", "[", "Tmat_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ww", "=", "1.7"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<ChopTol = \>\"", ",", "ChopTol"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", ".08", "]"}], ",", 
        RowBox[{"Thickness", "[", ".006", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "MONO"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", ".13"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", ".25"}], "]"}]}],
          "}"}], ",", "  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TRIV", " ", "to", " ", "MONO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ORTH"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "2"}], "}"}]}], "}"}], ",", ".5"}], 
           "]"}]}], "}"}], ",", "  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "MONO", " ", "to", " ", "ORTH"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TET"}], "]"}], "==", "0"}], ",", "Red"}], 
           "]"}], ",", "  ", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "1.9"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "3"}], "}"}]}], "}"}], ",", ".2"}], 
           "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "ORTH"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "CUBE"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "  ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "2.9"}], "}"}], ",", 
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "4"}], "}"}]}], "}"}], ",", ".2"}], 
           "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TET", " ", "to", " ", "CUBE"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "XISO"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "2.9"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}]}], "}"}], ",", 
            ".2"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TRIG", " ", "to", " ", "XISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "CUBE"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "3"}], "}"}], ",", 
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "4"}], "}"}]}], "}"}], ",", ".8"}], 
           "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TRIG", " ", "to", " ", "CUBE"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "XISO"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}]}], "}"}], ",", 
            ".7"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "TET", " ", "to", " ", "XISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TRIG"}], "]"}], "==", "0"}], ",", "Red"}],
            "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "3"}], "}"}]}], "}"}], ",", 
            ".3"}], "]"}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "MONO", " ", "to", " ", "TRIG"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ISO"}], "]"}], "==", "0"}], ",", "Red"}], 
           "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "   ", 
               RowBox[{
                RowBox[{"1", "ww"}], ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}]}], "}"}], ",", ".5"}], "]"}]}], 
         "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "CUBE", " ", "to", " ", "ISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ISO"}], "]"}], "==", "0"}], ",", "Red"}], 
           "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}]}], "}"}], ",", ".55"}], "]"}]}],
          "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"from", " ", "XISO", " ", "to", " ", "ISO"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"TRIV", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TRIV"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"MONO", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "MONO"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"ORTH", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ORTH"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "ww"}], ",", "2"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"TET", ",", "  ", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TET"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", "  ", 
          RowBox[{"{", "   ", 
           RowBox[{
            RowBox[{"1", "ww"}], ",", "3"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"CUBE", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "CUBE"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", "   ", 
           RowBox[{
            RowBox[{"1", "ww"}], ",", "4"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"XISO", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "XISO"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "ww"}], ",", "4"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"TRIG", ",", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "TRIG"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "ww"}], ",", "3"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"seq", "[", 
           RowBox[{"ISO", ",", "  ", 
            RowBox[{
             RowBox[{"\[Beta]T", "[", 
              RowBox[{"Tmat", ",", "ISO"}], "]"}], "/", "Degree"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "5"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.8370181463265653`*^9, 3.837018331394561*^9}, {
   3.8370184159015703`*^9, 3.837018617774561*^9}, {3.837018665119568*^9, 
   3.837018679678566*^9}, {3.837019003423561*^9, 3.837019191150567*^9}, {
   3.837019229358568*^9, 3.8370193182545714`*^9}, {3.8370195348035603`*^9, 
   3.8370195713915606`*^9}, {3.837019614399562*^9, 3.837019635567562*^9}, {
   3.837019874078582*^9, 3.837019883583565*^9}, {3.8370199490715604`*^9, 
   3.8370200623995695`*^9}, {3.83702009385457*^9, 3.8370200984305696`*^9}, {
   3.8370201335995684`*^9, 3.8370201968635693`*^9}, {3.8370202310395575`*^9, 
   3.8370204166235547`*^9}, {3.8370204553125553`*^9, 
   3.8370205099845676`*^9}, {3.837020541711568*^9, 3.837020579599554*^9}, {
   3.83702064283257*^9, 3.8370207176005697`*^9}, {3.8370252092485604`*^9, 
   3.837025384385552*^9}, {3.83702545188857*^9, 3.83702559219357*^9}, {
   3.837025632656565*^9, 3.8370258564815607`*^9}, {3.837025925506571*^9, 
   3.8370259577785735`*^9}, {3.8370260176025643`*^9, 3.837026084258566*^9}, {
   3.837026116529569*^9, 3.837026205602556*^9}, {3.837026368964576*^9, 
   3.837026572307558*^9}, {3.8370266411385746`*^9, 3.8370267484185658`*^9}, {
   3.8370268700335693`*^9, 3.8370268782895565`*^9}, {3.8370274312655663`*^9, 
   3.83702744773057*^9}, {3.8370275022905664`*^9, 3.83702753401758*^9}, {
   3.837027611138569*^9, 3.837027619522569*^9}, {3.837027809986557*^9, 
   3.837027858194584*^9}, {3.83703765894757*^9, 3.8370376595555606`*^9}, {
   3.837037695600587*^9, 3.8370377237305737`*^9}, {3.8370378154915733`*^9, 
   3.837037868418567*^9}, 3.837037944084566*^9, {3.8370382355413976`*^9, 
   3.83703829105939*^9}, {3.83703853300338*^9, 3.837038540169388*^9}, {
   3.8370386192833853`*^9, 3.83703862507438*^9}, {3.8370435973493958`*^9, 
   3.8370438373793945`*^9}, 3.8370452177333927`*^9, 3.8370854393101854`*^9, {
   3.83708548519386*^9, 3.8370855554802303`*^9}, {3.8370856595141125`*^9, 
   3.8370857006151133`*^9}, {3.8370857446087093`*^9, 
   3.8370857581014385`*^9}, {3.837085809449133*^9, 3.8370859290341606`*^9}, {
   3.8370859653677683`*^9, 3.8370859974028807`*^9}, {3.8370862677045383`*^9, 
   3.8370862770474625`*^9}, {3.837086623223106*^9, 3.837086837546943*^9}, {
   3.837086897641491*^9, 3.8370869569216814`*^9}, {3.837087019034116*^9, 
   3.8370872025533123`*^9}, {3.837087325226897*^9, 3.8370873320395966`*^9}, {
   3.8370874177851872`*^9, 3.8370878498003345`*^9}, {3.8370878881526523`*^9, 
   3.8370879475292873`*^9}, {3.8370880106831684`*^9, 3.837088071402605*^9}, 
   3.8370881162336016`*^9, {3.837092876636677*^9, 3.8370929389705143`*^9}, 
   3.8370929698480234`*^9, {3.837094458261659*^9, 3.837094478452037*^9}, 
   3.8370945127760625`*^9, {3.8370945941238813`*^9, 3.837094695801298*^9}, {
   3.83709472898483*^9, 3.837094801271778*^9}, 3.8370948408707285`*^9, 
   3.8372629428776703`*^9, {3.83850767953935*^9, 3.83850768066162*^9}, {
   3.8385078036056275`*^9, 3.838507824246597*^9}, 3.8385079155474553`*^9, {
   3.838508135734826*^9, 3.8385081363442755`*^9}, {3.8385083491767097`*^9, 
   3.8385083541087723`*^9}, {3.838508581407811*^9, 3.8385086336273775`*^9}, {
   3.8385086674783897`*^9, 3.83850866769039*^9}, {3.83850872775138*^9, 
   3.838508790328144*^9}, {3.8385089779269457`*^9, 3.8385089855065985`*^9}, {
   3.8385090957347593`*^9, 3.838509115589082*^9}, {3.838509261080325*^9, 
   3.8385092662323713`*^9}, {3.838509440359363*^9, 3.838509440919798*^9}, {
   3.838513025829235*^9, 3.8385130379766145`*^9}, {3.8385580495807962`*^9, 
   3.8385580746369934`*^9}, 3.8385617383805847`*^9, {3.8388205838742495`*^9, 
   3.838820610978253*^9}, {3.838820647667348*^9, 3.838820655523256*^9}, {
   3.8388208879103208`*^9, 3.838820911030321*^9}, {3.8388215309713645`*^9, 
   3.838821591895434*^9}, {3.838821707899458*^9, 3.8388217287359962`*^9}, {
   3.8388218487569017`*^9, 3.83882192752324*^9}, {3.838824224565867*^9, 
   3.8388242615251737`*^9}, {3.8388249564068375`*^9, 3.838824961570805*^9}, {
   3.8388249997022595`*^9, 3.8388250206003895`*^9}, {3.83882507497882*^9, 
   3.83882507832282*^9}, {3.8388251401348505`*^9, 3.8388251424517107`*^9}, {
   3.8388263590619807`*^9, 3.8388263740829844`*^9}, 3.838828445176153*^9, {
   3.8388285804232984`*^9, 3.838828585991289*^9}, {3.8388286271113033`*^9, 
   3.8388286302773767`*^9}, {3.838828807847303*^9, 3.838828846919343*^9}, 
   3.838828931925268*^9, {3.8388289927793493`*^9, 3.83882900037537*^9}, {
   3.838830635223561*^9, 3.8388306355755615`*^9}, {3.838842570393077*^9, 
   3.8388425713212423`*^9}, {3.838905176465457*^9, 3.838905215472639*^9}, {
   3.838905738913064*^9, 3.838905767294829*^9}, {3.8389058918250694`*^9, 
   3.838905936177064*^9}, {3.838906333993126*^9, 3.8389063463113184`*^9}, 
   3.8389064337221856`*^9, {3.8389070786252155`*^9, 3.8389070792332134`*^9}, {
   3.838907122129212*^9, 3.838907122847023*^9}, {3.8389074524889526`*^9, 
   3.838907499869239*^9}, {3.838922355763171*^9, 3.8389223596555543`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dT", "[", 
   RowBox[{"Tmat_", ",", "Sigma_"}], "]"}], ":=", 
  "999"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]T", "[", 
   RowBox[{"Tmat_", ",", "Sigma_"}], "]"}], ":=", 
  RowBox[{"999", "Degree"}]}]}], "Input",
 CellChangeTimes->{{3.8388247420699863`*^9, 3.8388247631547327`*^9}, {
   3.8389058151153984`*^9, 3.838905822678522*^9}, 3.8389063656451283`*^9, {
   3.8389066589746017`*^9, 3.8389066660929866`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The TET example from Section 15.3 of TapeTape2021. Change Tmat to suit \
yourself.\
\>", "Subsubsection",
 CellChangeTimes->{{3.830909843969966*^9, 3.83090998960639*^9}, {
   3.8309100669819593`*^9, 3.830910086755868*^9}, {3.830964986637933*^9, 
   3.8309649944139333`*^9}, {3.8309676404808874`*^9, 3.830967668461239*^9}, {
   3.830969122125424*^9, 3.830969130973489*^9}, {3.8312004564763107`*^9, 
   3.8312004706510944`*^9}, 3.83139588745473*^9, 3.8346736712522235`*^9, {
   3.838513165538992*^9, 3.838513178913588*^9}, {3.838557970490553*^9, 
   3.8385580093052435`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<yes\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tmat", "=", 
   RowBox[{
    FractionBox["1", "64"], 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"168", 
        RowBox[{"4", " ", 
         SqrtBox["6"]}], 
        RowBox[{"-", "40"}], 
        RowBox[{"6", " ", 
         SqrtBox["6"]}], 
        RowBox[{"6", " ", 
         SqrtBox["2"]}], "0"},
       {
        RowBox[{"4", " ", 
         SqrtBox["6"]}], "324", 
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SqrtBox["6"]}], 
        RowBox[{"-", "42"}], 
        RowBox[{
         RowBox[{"-", "14"}], " ", 
         SqrtBox["3"]}], 
        RowBox[{"16", " ", 
         SqrtBox["3"]}]},
       {
        RowBox[{"-", "40"}], 
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SqrtBox["6"]}], "168", 
        RowBox[{
         RowBox[{"-", "6"}], " ", 
         SqrtBox["6"]}], 
        RowBox[{
         RowBox[{"-", "6"}], " ", 
         SqrtBox["2"]}], "0"},
       {
        RowBox[{"6", " ", 
         SqrtBox["6"]}], 
        RowBox[{"-", "42"}], 
        RowBox[{
         RowBox[{"-", "6"}], " ", 
         SqrtBox["6"]}], "233", 
        RowBox[{"35", " ", 
         SqrtBox["3"]}], 
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         SqrtBox["3"]}]},
       {
        RowBox[{"6", " ", 
         SqrtBox["2"]}], 
        RowBox[{
         RowBox[{"-", "14"}], " ", 
         SqrtBox["3"]}], 
        RowBox[{
         RowBox[{"-", "6"}], " ", 
         SqrtBox["2"]}], 
        RowBox[{"35", " ", 
         SqrtBox["3"]}], "163", 
        RowBox[{"-", "8"}]},
       {"0", 
        RowBox[{"16", " ", 
         SqrtBox["3"]}], "0", 
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         SqrtBox["3"]}], 
        RowBox[{"-", "8"}], "352"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denominator", "=", "64"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8309061266534777`*^9, 3.830906133969482*^9}, {
   3.8309062190635004`*^9, 3.830906221446493*^9}, 3.830906251928503*^9, {
   3.830906578416277*^9, 3.8309065870774727`*^9}, {3.830910192501975*^9, 
   3.8309101937979746`*^9}, {3.830910230520008*^9, 3.8309102956720214`*^9}, {
   3.830967614453266*^9, 3.8309676320138445`*^9}, {3.8312006236605325`*^9, 
   3.831200627780481*^9}, {3.8351251965667324`*^9, 3.8351251974157286`*^9}, {
   3.8351252802747736`*^9, 3.835125280774743*^9}, {3.8385574842191*^9, 
   3.8385574866271043`*^9}, {3.847383461094881*^9, 3.8473834616367064`*^9}, {
   3.8474693464162264`*^9, 3.8474693708648596`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChopTol", "=", ".00001"}], ";"}], "    ", 
  RowBox[{"(*", "  ", 
   StyleBox[
    RowBox[{
     RowBox[{"d", 
      RowBox[{"(", 
       RowBox[{"T", ",", " ", 
        SubscriptBox["\[ScriptCapitalT]", "\[CapitalSigma]"]}], ")"}], "is", 
      " ", "set", " ", "to", " ", "zero", " ", "if", " ", "it", " ", "is", 
      " ", "less", " ", "than", " ", "ChopTol"}], ";", " ", 
     RowBox[{"change", " ", "if", " ", "desired"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.838557532733788*^9, 3.838557618426202*^9}, {
   3.83855765552918*^9, 3.83855765937204*^9}, 3.8385581015761747`*^9, {
   3.8474685251482983`*^9, 3.8474685299682817`*^9}, {3.8474685843037415`*^9, 
   3.847468635645314*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
In what follows, only \[Beta] and U are needed if only the symmetry group of \
T is wanted.\
\>", "Section",
 CellChangeTimes->{{3.8474697177193985`*^9, 3.8474697381206017`*^9}, {
  3.8474697916485386`*^9, 3.8474698141615524`*^9}, {3.8474698468485518`*^9, 
  3.8474698568965564`*^9}}],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = MONO", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9, {3.847465888431259*^9, 3.8474658899987445`*^9}}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "MONO"}], "]"}]], "Input",
 CellChangeTimes->{{3.847383512965294*^9, 3.8473835197018547`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = ORTH", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9, {3.8474659279186954`*^9, 3.8474659288307657`*^9}}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "ORTH"}], "]"}]], "Input",
 CellChangeTimes->{{3.8473835478931985`*^9, 3.8473835494771986`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = TET", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "TET"}], "]"}]], "Input",
 CellChangeTimes->{{3.838820719330266*^9, 3.838820722034267*^9}, 
   3.8469469543932877`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = CUBE", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9, {3.8474659537422743`*^9, 3.8474659545748*^9}}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "CUBE"}], "]"}]], "Input",
 CellChangeTimes->{{3.847383598132439*^9, 3.8473836000513563`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = TRIG", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9, {3.847465975054532*^9, 3.8474659759660044`*^9}}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "TRIG"}], "]"}]], "Input",
 CellChangeTimes->{{3.8473836049655914`*^9, 3.8473836065335913`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = XISO", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9, {3.847465979918194*^9, 3.8474659810204673`*^9}}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "XISO"}], "]"}]], "Input",
 CellChangeTimes->{{3.8473836103896775`*^9, 3.8473836123256693`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalSigma] = ISO", "Subsubsection",
 CellChangeTimes->{{3.838513797013299*^9, 3.8385138124723115`*^9}, 
   3.8474658580485945`*^9, {3.847465984206537*^9, 3.8474659850863657`*^9}}],

Cell[BoxData[
 RowBox[{"OutputFor", "[", 
  RowBox[{"Tmat", ",", "ISO"}], "]"}]], "Input",
 CellChangeTimes->{3.853778549079392*^9}],

Cell[BoxData[{
 RowBox[{"LatticeOfDTs", "[", "Tmat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<[T] = \>\"", ",", 
   FractionBox["1", "denominator"], ",", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"denominator", " ", "Tmat"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8388290082793417`*^9, 3.8388290096673193`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"From", " ", "the", " ", "lattice", " ", "and", " ", "the", " ", 
  "appropriate", " ", "U", " ", "you", " ", "get", " ", "the", " ", 
  "symmetry", " ", "group", " ", "of", " ", 
  RowBox[{"T", ".", " ", "See"}], " ", "Theorem", " ", "3", "of", " ", 
  RowBox[{"TapeTape2022", "."}]}]], "Subsubsection",
 CellChangeTimes->{{3.83855837890737*^9, 3.8385584512677436`*^9}, {
   3.847469407376854*^9, 3.847469420928855*^9}, 3.8474695098243237`*^9, {
   3.853778629736019*^9, 3.8537786314937043`*^9}, 3.853778662866192*^9},
 FontFamily->"Arial"]
}, Open  ]]
},
WindowSize->{1074, 883},
WindowMargins->{{157, Automatic}, {Automatic, 19}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5945, 158, 455, "Input"],
Cell[6506, 180, 5683, 151, 362, "Input"],
Cell[12192, 333, 1065, 29, 77, "Input"],
Cell[CellGroupData[{
Cell[13282, 366, 654, 17, 59, "Subsubsection"],
Cell[13939, 385, 822, 21, 55, "Input"],
Cell[14764, 408, 772, 18, 77, "Input"],
Cell[15539, 428, 15897, 405, 1350, "Input"],
Cell[31439, 835, 7046, 182, 473, "Input"],
Cell[38488, 1019, 15839, 324, 871, "Input"],
Cell[54330, 1345, 206, 5, 32, "Input"],
Cell[54539, 1352, 684, 19, 57, "Input"],
Cell[55226, 1373, 1065, 28, 77, "Input"],
Cell[56294, 1403, 17130, 407, 473, "Input"],
Cell[73427, 1812, 463, 11, 55, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73927, 1828, 583, 10, 35, "Subsubsection"],
Cell[74513, 1840, 3132, 96, 240, "Input"],
Cell[77648, 1938, 781, 18, 55, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78466, 1961, 294, 6, 117, "Section"],
Cell[CellGroupData[{
Cell[78785, 1971, 191, 2, 35, "Subsubsection"],
Cell[78979, 1975, 159, 3, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79175, 1983, 193, 2, 35, "Subsubsection"],
Cell[79371, 1987, 161, 3, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79569, 1995, 142, 2, 35, "Subsubsection"],
Cell[79714, 1999, 184, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79935, 2008, 189, 2, 35, "Subsubsection"],
Cell[80127, 2012, 159, 3, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80323, 2020, 191, 2, 35, "Subsubsection"],
Cell[80517, 2024, 161, 3, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80715, 2032, 191, 2, 35, "Subsubsection"],
Cell[80909, 2036, 161, 3, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81107, 2044, 190, 2, 35, "Subsubsection"],
Cell[81300, 2048, 132, 3, 32, "Input"],
Cell[81435, 2053, 353, 7, 79, "Input"]
}, Open  ]],
Cell[81803, 2063, 564, 9, 35, "Subsubsection"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

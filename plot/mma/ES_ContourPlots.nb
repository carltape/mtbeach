(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     22698,        618]
NotebookOptionsPosition[     21579,        577]
NotebookOutlinePosition[     22211,        601]
CellTagsIndexPosition[     22168,        598]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "1", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "2", "]"}], "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", "0", "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "3", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {
       FractionBox["1", 
        SqrtBox["2"]], "0", "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB", "[", "4", "]"}], "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}], "0", "0"},
      {"0", 
       FractionBox["1", 
        SqrtBox["2"]], "0"},
      {"0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BB", "[", "5", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["6"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", 
         RowBox[{"-", "2"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], ";", 
   " ", 
   RowBox[{
    RowBox[{"BB", "[", "6", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["3"]], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
   ";"}], "     "}]}], "Input",
 CellChangeTimes->{{3.792971206733848*^9, 3.7929713022003465`*^9}, {
   3.792971408071004*^9, 3.792971440387087*^9}, {3.792971498549478*^9, 
   3.792971499440118*^9}, 3.792972692948264*^9, {3.7929727241080465`*^9, 
   3.7929727262955894`*^9}, {3.792972763426332*^9, 3.7929727864596667`*^9}, {
   3.793302127686242*^9, 3.793302210883026*^9}, {3.793452169745813*^9, 
   3.793452205234699*^9}, {3.7934534711802993`*^9, 3.793453503105508*^9}, {
   3.7934875097186317`*^9, 3.7934875184076557`*^9}, {3.7940628516347594`*^9, 
   3.794062915122757*^9}, 3.7940668797157593`*^9, {3.794303579755892*^9, 
   3.794303673207573*^9}, 3.7946837182844687`*^9, {3.794683831532472*^9, 
   3.7946838327474766`*^9}, {3.795368427569252*^9, 3.795368457449376*^9}, {
   3.7954159482798815`*^9, 3.7954159499048824`*^9}, {3.7998533351296206`*^9, 
   3.7998534017979136`*^9}, {3.7998594859163437`*^9, 
   3.7998594916854353`*^9}, {3.7998596087056255`*^9, 
   3.7998596116364765`*^9}, {3.7999471922765937`*^9, 
   3.7999472010435143`*^9}, {3.799947251311059*^9, 3.7999472826775537`*^9}, {
   3.7999474305174685`*^9, 3.79994753957263*^9}, {3.7999477903421464`*^9, 
   3.7999478574073067`*^9}, {3.8303041767764983`*^9, 3.83030423992684*^9}, {
   3.8303043151804295`*^9, 3.8303043233750134`*^9}, {3.8357041787967825`*^9, 
   3.8357042083327866`*^9}, 3.835706536000112*^9, {3.835708619117347*^9, 
   3.835708621723645*^9}, {3.8357086642253847`*^9, 3.8357087005133877`*^9}, {
   3.855860100047233*^9, 3.855860105003227*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "M", "]"}], ".", 
    RowBox[{"Flatten", "[", "N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMatrix", "[", "M_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{"M", ",", "M"}], "]"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"   ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0", 
       RowBox[{"Sin", "[", "t", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0", 
       RowBox[{"Cos", "[", "t", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0"},
      {"0", "0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matrixL", "[", "L_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"BB", "[", "j", "]"}], "]"}], ",", 
        RowBox[{"BB", "[", "i", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixUbar", "[", "U_", "]"}], ":=", 
    RowBox[{"matrixL", "[", 
     RowBox[{
      RowBox[{"U", ".", "#", ".", 
       RowBox[{"Transpose", "[", "U", "]"}]}], "&"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjToVSigOfU", "[", 
    RowBox[{
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"a_", "g_", "m_", "q_", "t_", "v_"},
         {"gdum_", "b_", "h_", "n_", "r_", "u_"},
         {"mdum_", "hdum_", "c_", "i_", "o_", "s_"},
         {"qdum_", "ndum_", "idum_", "d_", "j_", "p_"},
         {"tdum_", "rdum_", "odum_", "jdum_", "e_", "k_"},
         {"vdum_", "udum_", "sdum_", "pdum_", "kdum_", "f_"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], ",", "id", ",", "MONO"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "g", "0", "0", "0", "0"},
       {"g", "b", "0", "0", "0", "0"},
       {"0", "0", "c", "i", "o", "s"},
       {"0", "0", "i", "d", "j", "p"},
       {"0", "0", "o", "j", "e", "k"},
       {"0", "0", "s", "p", "k", "f"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "is", " ", "P", 
     RowBox[{"(", 
      RowBox[{"T", ",", 
       RowBox[{
        SubscriptBox["V", "MONO"], 
        RowBox[{"(", "I", ")"}]}]}], ")"}], " ", "in", " ", "the", " ", 
     "2022", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
    RowBox[{"Tmat_", ",", "U_", ",", "SymClass_"}], "]"}], ":=", "     ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"This", " ", "is", " ", "d", 
      RowBox[{"(", 
       RowBox[{"T", ",", 
        RowBox[{
         SubscriptBox["V", "\[CapitalSigma]"], 
         RowBox[{"(", "U", ")"}]}]}], ")"}], " ", "in", " ", "the", " ", 
      "2022", " ", "paper"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"NormMatrix", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
      RowBox[{"MatrixUbar", "[", "U", "]"}]}], "-", 
     RowBox[{"ProjToVSigOfU", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], ".", "Tmat", ".", 
        RowBox[{"MatrixUbar", "[", "U", "]"}]}], ",", 
       StyleBox["id",
        FontColor->RGBColor[1, 0, 0]], ",", "SymClass"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fOnSphere", "[", 
    RowBox[{"Tmat_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"DistToV\[CapitalSigma]ofU", "[", 
    RowBox[{"Tmat", ",", 
     RowBox[{
      RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
      RowBox[{"YRot", "[", "\[Phi]", "]"}]}], ",", "MONO"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8357039212458153`*^9, 3.8357039223007507`*^9}, {
   3.835703992348759*^9, 3.83570399702076*^9}, {3.8357040638209357`*^9, 
   3.835704086621888*^9}, {3.8357046159648385`*^9, 3.835704617053875*^9}, 
   3.835704928124878*^9, {3.8357054888769493`*^9, 3.835705497326971*^9}, {
   3.835707612017251*^9, 3.8357076837732277`*^9}, {3.8357077779012394`*^9, 
   3.8357077802732315`*^9}, {3.835707831982522*^9, 3.835707877890067*^9}, {
   3.8357079111492567`*^9, 3.8357079161617813`*^9}, {3.835707951485262*^9, 
   3.8357080432469664`*^9}, {3.835708249679347*^9, 3.835708259615336*^9}, {
   3.8375230482235036`*^9, 3.8375230493595037`*^9}, {3.837540061976939*^9, 
   3.8375400950953417`*^9}, {3.8375423564567285`*^9, 3.837542357566089*^9}, {
   3.8375427703430943`*^9, 3.837542772046219*^9}, {3.837542814429597*^9, 
   3.8375428636075673`*^9}, {3.837542909222314*^9, 3.837542910159814*^9}, {
   3.838308629193669*^9, 3.8383086347096825`*^9}, 3.838308821850387*^9, {
   3.838315371007059*^9, 3.8383154080262575`*^9}, {3.847470323760597*^9, 
   3.84747032534461*^9}, {3.8474703849366097`*^9, 3.847470419503902*^9}}],

Cell["", "PageBreak",
 PageBreakBelow->True],

Cell[CellGroupData[{

Cell["\<\
This is the cubic example from Section 15.5 of the beachball paper. 
Change Tmat to suit yourself, but make sure Tmat is symmetric.\
\>", "Subsection",
 CellChangeTimes->{{3.8357043320214396`*^9, 3.835704411592018*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", "=", 
   RowBox[{
    FractionBox["1", "36"], 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"52", "4", "16", 
        RowBox[{"-", "6"}], 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SqrtBox["3"]}], "0"},
       {"4", "64", "4", "12", 
        RowBox[{"4", " ", 
         SqrtBox["3"]}], "0"},
       {"16", "4", "52", 
        RowBox[{"-", "6"}], 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SqrtBox["3"]}], "0"},
       {
        RowBox[{"-", "6"}], "12", 
        RowBox[{"-", "6"}], "45", 
        RowBox[{"3", " ", 
         SqrtBox["3"]}], "0"},
       {
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SqrtBox["3"]}], 
        RowBox[{"4", " ", 
         SqrtBox["3"]}], 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SqrtBox["3"]}], 
        RowBox[{"3", " ", 
         SqrtBox["3"]}], "39", "0"},
       {"0", "0", "0", "0", "0", "108"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell["cpFprelim will take a couple minutes:", "Subsubsection",
 CellChangeTimes->{{3.830967787665286*^9, 3.830967826365259*^9}, {
   3.8309679138852606`*^9, 3.8309679191490145`*^9}, {3.8357045071165*^9, 
   3.835704512091894*^9}, 3.8357056349729676`*^9, 3.83754257770775*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cpFprelim", "=", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"fOnSphere", "[", 
      RowBox[{"Tmat", ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8307404826107855`*^9, 3.8307404844726195`*^9}, {
   3.830740636772833*^9, 3.8307406399236965`*^9}, 3.830742022877826*^9, {
   3.830742332690978*^9, 3.8307423338915358`*^9}, {3.8307813747299585`*^9, 
   3.8307813809059916`*^9}, 3.8307821945050936`*^9, {3.8307828857051497`*^9, 
   3.8307828906661816`*^9}, 3.8307831503121867`*^9, {3.830783419527887*^9, 
   3.830783441464215*^9}, {3.8307849249387474`*^9, 3.8307849261993756`*^9}, {
   3.8307854114190917`*^9, 3.8307854888724904`*^9}, 3.8307858914805355`*^9, {
   3.8307864939146433`*^9, 3.830786517208615*^9}, {3.8307865959126244`*^9, 
   3.830786603721655*^9}, 3.830788041784808*^9, {3.8307880977848153`*^9, 
   3.8307881566794662`*^9}, 3.8307883801068797`*^9, {3.830788641704441*^9, 
   3.8307886448094635`*^9}, {3.8307889951443653`*^9, 
   3.8307889959769297`*^9}, {3.830791748297279*^9, 3.8307917705692387`*^9}, {
   3.83081381055977*^9, 3.8308138595828776`*^9}, {3.8308139208960466`*^9, 
   3.8308139697437935`*^9}, 3.830814032847931*^9, {3.8308152692950563`*^9, 
   3.8308152702533083`*^9}, 3.8308153275670643`*^9, {3.830815422290104*^9, 
   3.830815431056112*^9}, 3.830815506991087*^9, {3.8308158111371593`*^9, 
   3.8308158183681583`*^9}, 3.8308158949461727`*^9, {3.8308163631687202`*^9, 
   3.8308163844471984`*^9}, 3.830816446207206*^9, 3.830816582383227*^9, {
   3.830817773857409*^9, 3.830817775568406*^9}, {3.8308178434254117`*^9, 
   3.8308178454884176`*^9}, 3.8308181536634226`*^9, {3.8308249626727247`*^9, 
   3.830824970407138*^9}, {3.8308250009744797`*^9, 3.830825008054211*^9}, {
   3.8308253061828117`*^9, 3.8308253075577974`*^9}, 3.830825363266446*^9, {
   3.8308266239296885`*^9, 3.830826658356307*^9}, 3.830899618011363*^9, 
   3.83089974979665*^9, {3.830899783461685*^9, 3.830899786549697*^9}, {
   3.830900045350721*^9, 3.830900053286253*^9}, {3.8309007340687747`*^9, 
   3.830900770436779*^9}, {3.8309010245982437`*^9, 3.8309010320698442`*^9}, {
   3.830903465573121*^9, 3.830903466405121*^9}, 3.830906277620013*^9, {
   3.830906632309523*^9, 3.8309066328382196`*^9}, {3.8309106143440685`*^9, 
   3.8309106153680525`*^9}, 3.8312203743248744`*^9, 3.8312586194837365`*^9, 
   3.837542483290023*^9, 3.837542579895265*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 9 and ",
 StyleBox["Mathematica10 ",
  FontSlant->"Italic"],
 "can cope with this. Not sure about other versions."
}], "Subsubsection",
 CellChangeTimes->{{3.830967787665286*^9, 3.830967826365259*^9}, {
   3.830968037549286*^9, 3.8309680607012844`*^9}, {3.830968225709302*^9, 
   3.8309682458693123`*^9}, {3.835704687884847*^9, 3.835704716380851*^9}, 
   3.835704955900882*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cpF", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"GraphicsComplex", "[", 
     RowBox[{
      RowBox[{"xyzTP", "/@", 
       RowBox[{"cpFprelim", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"cpFprelim", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8375425892255645`*^9, 3.8375425903349404`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Next you are not Recomputing cpFprelim or cpF, so make sure they have already \
been computed for the Tmat that you want.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8558533425343294`*^9, 3.855853445337247*^9}, {
  3.8558601301428022`*^9, 3.855860132541664*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyzTP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"30", "Degree"}], ",", 
       RowBox[{"75", "Degree"}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"cpFprelim", ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}], ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "\[Pi]", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"cpF", ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8308256899916716`*^9, 3.8308256960557985`*^9}, {
   3.8309006441307974`*^9, 3.830900646682798*^9}, {3.8309091994298496`*^9, 
   3.8309092154138513`*^9}, {3.830909502581888*^9, 3.830909526485076*^9}, {
   3.8309108101176558`*^9, 3.8309108249180555`*^9}, {3.8309626838383913`*^9, 
   3.830962754780615*^9}, {3.830968160589302*^9, 3.830968214717308*^9}, {
   3.8312586210197315`*^9, 3.8312586222677183`*^9}, {3.835704822380864*^9, 
   3.8357048234068995`*^9}, {3.8357049782848845`*^9, 
   3.8357050110387487`*^9}, {3.8357052711048613`*^9, 3.835705272620922*^9}, {
   3.8357053570249696`*^9, 3.8357053606849327`*^9}, 3.837542593069315*^9, {
   3.8557833499478216`*^9, 3.855783367670948*^9}, {3.855853074798052*^9, 
   3.855853078875066*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{900, 860},
WindowMargins->{{Automatic, 98}, {Automatic, 15}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{36., 7.2}, {7.2, 36.}}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6011, 161, 518, "Input"],
Cell[6572, 183, 7277, 194, 513, "Input"],
Cell[13852, 379, 44, 1, 4, "PageBreak",
 PageBreakBelow->True],
Cell[CellGroupData[{
Cell[13921, 384, 229, 4, 71, "Subsection"],
Cell[14153, 390, 1426, 47, 159, "Input"],
Cell[CellGroupData[{
Cell[15604, 441, 275, 3, 35, "Subsubsection"],
Cell[15882, 446, 2675, 44, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18594, 495, 445, 11, 59, "Subsubsection"],
Cell[19042, 508, 479, 14, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19558, 527, 273, 5, 59, "Subsubsection"],
Cell[19834, 534, 1717, 39, 99, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

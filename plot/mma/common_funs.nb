(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    153914,       4416]
NotebookOptionsPosition[    150651,       4318]
NotebookOutlinePosition[    151843,       4361]
CellTagsIndexPosition[    151800,       4358]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Changed for Mathematica 7     07 - 27 - 2010\nApparently needed no changes \
for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10  11-21-2015"
}], "Text",
 CellChangeTimes->{{3.4892616449648027`*^9, 3.4892616872876763`*^9}, {
  3.4892635901517944`*^9, 3.4892635921953983`*^9}, {3.6571673188845243`*^9, 
  3.6571673455605707`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DateSequence", "[", 
    RowBox[{"date_", ",", "WantTime_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WantTime", "\[Equal]", "\"\<yes\>\""}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\"\< \>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
        "\"\<:\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"DateSequence", "[", 
  RowBox[{
   RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sind", "[", "t_", "]"}], ":=", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cosd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tand", "[", "t_", "]"}], ":=", 
   RowBox[{"Tan", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cotd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"secd", "[", "t_", "]"}], ":=", 
   RowBox[{"Sec", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cscd", "[", "t_", "]"}], ":=", 
   RowBox[{"Csc", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arccosd", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcCos", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arcsind", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcSin", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arctand", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcTan", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"length", "[", "v_", "]"}], ":=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{"v", ".", "v"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], "                "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], "       ", ":=", 
   RowBox[{"N", "[", 
    RowBox[{"arccosd", "[", 
     RowBox[{
      RowBox[{"u", ".", "v"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"length", "[", "u", "]"}], " ", 
        RowBox[{"length", "[", "v", "]"}]}], ")"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"Apt_", ",", "Bpt_", ",", "Cpt_"}], "]"}], ":=", 
   RowBox[{"angle", "[", 
    RowBox[{
     RowBox[{"Apt", "-", "Bpt"}], ",", 
     RowBox[{"Cpt", "-", "Bpt"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"u", ".", "v"}], 
      RowBox[{
       RowBox[{"length", "[", "u", "]"}], " ", 
       RowBox[{"length", "[", "v", "]"}]}]], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "used", " ", "to", " ", "be", " ", "AngleRad"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "   "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UU", "[", 
     RowBox[{"A_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"A", ",", 
       RowBox[{"Cross", "[", 
        RowBox[{"N", ",", "A"}], "]"}], ",", "N"}], "}"}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"A", " ", "and", " ", "N", " ", "must", " ", "be", " ", 
     RowBox[{"orthonormal", ".", " ", "The"}], " ", "first", " ", "and", " ", 
     "third", " ", "columns", " ", "of", " ", "UU", " ", "are", " ", "A", " ",
      "and", " ", 
     RowBox[{"N", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SignedAngle", "[", 
    RowBox[{"A_", ",", "B_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{"Theta", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"UU", "[", 
       RowBox[{"A", ",", "N"}], "]"}], "]"}], ".", "B"}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "A", " ", "and", " ", "B", " ", "must", " ", "be", " ", "orthogonal", 
      " ", "to", " ", "N"}], ",", " ", 
     RowBox[{
     "and", " ", "N", " ", "must", " ", "be", " ", "a", " ", "unit", " ", 
      "vector"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.734628431840602*^9, 3.734628477450066*^9}, {
  3.734628913185296*^9, 3.734628918091556*^9}, {3.7346317198290963`*^9, 
  3.734631725641618*^9}, {3.7460429495891056`*^9, 3.7460429506773715`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"{", 
    RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", 
   RowBox[{"{", 
    RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"SignedAngle", "[", 
    RowBox[{"AA", ",", "BB", ",", "NN"}], "]"}], "\[Equal]", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"AA", ".", "BB"}], ",", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"NN", ",", "AA"}], "]"}], ".", "BB"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SignedAngle", "[", 
     RowBox[{"AA", ",", "BB", ",", "NN"}], "]"}], "==", 
    RowBox[{"SignedAngle", "[", 
     RowBox[{"AA", ",", 
      RowBox[{"t", " ", "BB"}], ",", "NN"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ">", "0"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.734628542028308*^9, 3.7346285794502687`*^9}, {
  3.7346286135128355`*^9, 3.7346286463097715`*^9}, {3.7346286764035807`*^9, 
  3.7346287799350357`*^9}, {3.7346288171382337`*^9, 3.7346288952165117`*^9}, {
  3.734628930294702*^9, 3.734628945950986*^9}, {3.7346313030001593`*^9, 
  3.7346314218285146`*^9}, {3.7346314919536543`*^9, 3.7346315158755755`*^9}, {
  3.734631620750781*^9, 3.734631707610323*^9}}],

Cell[BoxData[
 RowBox[{"SignedAngle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.734651160060381*^9, 3.7346512273573875`*^9}, {
  3.73465373134128*^9, 3.7346537359194264`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"AA", ",", "BB", ",", "NN"}], "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"area", "[", "rect_", "]"}], ":=", 
    RowBox[{"length", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"rect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "-", 
        RowBox[{"rect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", ".", "b"}], "/", 
    RowBox[{"length", "[", "b", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VectorProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"a", ".", "b"}], 
     RowBox[{"b", ".", "b"}]], "b"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlaneProj", "[", 
    RowBox[{"a_", ",", "normal_"}], "]"}], ":=", 
   RowBox[{"a", "-", 
    RowBox[{"VectorProj", "[", 
     RowBox[{"a", ",", "normal"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RightAngle", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"a", "-", "b"}], "]"}]}]}], ",", 
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"a", "-", "b"}], "]"}]}], "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"c", "-", "b"}], "]"}]}]}], ",", 
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"c", "-", "b"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0", "0"},
      {"0", 
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {"0", 
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"   ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0", 
       RowBox[{"Sin", "[", "t", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0", 
       RowBox[{"Cos", "[", "t", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0"},
      {"0", "0", "1"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xrot", "[", "t_", "]"}], ":=", 
   RowBox[{"XRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yrot", "[", "t_", "]"}], ":=", 
   RowBox[{"YRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zrot", "[", "t_", "]"}], ":=", 
   RowBox[{"ZRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rot111", "=", 
   RowBox[{"(", GridBox[{
      {"0", "0", "1"},
      {"1", "0", "0"},
      {"0", "1", "0"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["w", "2"], "+", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "-", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "+", 
           RowBox[{"w", " ", "y"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "+", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "-", 
           RowBox[{"w", " ", "x"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "-", 
           RowBox[{"w", " ", "y"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "+", 
           RowBox[{"w", " ", "x"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]}
      }], "\[NoBreak]", ")"}]}], " ", ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"RotMatrix2", ".", "  ", 
      StyleBox[
       RowBox[{"Q", 
        StyleBox["u",
         FontColor->RGBColor[1, 0, 0]]}]]}], "aternion", " ", 
     RowBox[{"{", 
      RowBox[{"w", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], " ", "must", " ", 
     "have", " ", "unit", " ", "length"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rot", "[", 
    RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"RotMatrixQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cosd", "[", 
       RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
      RowBox[{
       RowBox[{"sind", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], 
       RowBox[{"unit", "[", "v", "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", "v_", "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"v", ".", "v"}]}]], ",", "v"}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "is", " ", 
     SubscriptBox["U", "B"], " ", "in", " ", "some", " ", "of", " ", "the", 
     " ", "tex", " ", "files"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", 
     RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]", "/", "2"}], "]"}], 
        FractionBox["v", 
         SqrtBox[
          RowBox[{"v", ".", "v"}]]]}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rot", "[", 
       RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", "v", "]"}], "]"}], ".", 
       RowBox[{"zrot", "[", "\[Xi]", "]"}], ".", 
       RowBox[{"vertical", "[", "v", "]"}]}]}], ";", "  ", "old"}], ",", " ", 
    RowBox[{
    "but", " ", "the", " ", "two", " ", "rots", " ", "are", " ", 
     "equivalent"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rot2D", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rot2d", "[", "t_", "]"}], ":=", 
   RowBox[{"Rot2D", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROTe3e1toOrthonormalv3v1", "[", 
    RowBox[{"v3_", ",", "v1_"}], "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"v1", ",", 
      RowBox[{"Cross", "[", 
       RowBox[{"v3", ",", "v1"}], "]"}], ",", "v3"}], "}"}], "]"}]}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "v3", " ", "and", " ", "v1", " ", "must", " ", "be", " ", "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UswapVandK", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    TagBox[
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        RowBox[{"z", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}]}]], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["y", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"x", " ", "y"}], 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", "y"}], 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["x", "2"]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]},
         {
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], 
          RowBox[{"z", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], " ", "must", " ", "be", " ", 
     "unit", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CircleOnSphere", "[", 
    RowBox[{"center_", ",", "radius_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ROT", "[", 
       RowBox[{"\[Pi]", ",", 
        RowBox[{"Unit", "[", 
         RowBox[{"center", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ".", 
      RowBox[{"ZRot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "radius", "]"}], ",", "0", ",", 
        RowBox[{"Cos", "[", "radius", "]"}]}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
      RowBox[{".01", "\[Pi]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UsHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
     RowBox[{
      StyleBox["YRot",
       FontColor->RGBColor[1, 0, 0]], "[", "\[Phi]", "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "not", " ", "the", " ", "same", " ", "as", " ", "in", " ", "Section", " ",
      "S4", " ", "of", " ", "Supp", " ", "Info", " ", "for", " ", "TapeTape", 
     " ", "2015"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Us", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", 
      RowBox[{"ArcCos", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UgHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"G", " ", "for", " ", 
      RowBox[{"geology", ".", " ", "Used"}], " ", "to", " ", "be", " ", 
      RowBox[{"U\[Kappa]\[Sigma]\[Phi]", ".", " ", "Inputs"}], " ", "in", " ",
       "radians"}], ";", " ", 
     RowBox[{
      RowBox[{"basis", " ", "should", " ", "be", " ", "north"}], "-", "west", 
      "-", 
      RowBox[{
      "up", " ", "for", " ", "coords", " ", "to", " ", "have", " ", "meaning",
        " ", "strike"}], "-", "rake", "-", "dip"}], ";", " ", 
     RowBox[{"Eq", " ", 
      RowBox[{"(", "26", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2012beach", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ug", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "h_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]h", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "h"}], "}"}], "]"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"G", " ", "for", " ", 
       RowBox[{"geology", ".", " ", "Basis"}], " ", "should", " ", "be", " ", 
       "north"}], "-", "west", "-", 
      RowBox[{
      "up", " ", "for", " ", "coords", " ", "to", " ", "have", " ", "meaning",
        " ", "strike"}], "-", "rake", "-", 
      RowBox[{"cos", 
       RowBox[{"(", "dip", ")"}]}]}], ";"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"yref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefWithUnitNormal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["u", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "w"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["v", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "v", " ", "w"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "w"}], 
        RowBox[{
         RowBox[{"-", "2"}], "v", " ", "w"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["w", "2"]}]}]}
      }], ")"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "'"}], 
     RowBox[{"Reflection", "'"}], " ", 
     RowBox[{"to", " ", "'"}], 
     RowBox[{"Ref", "'"}], " ", "April", " ", "2012"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefWithUnitNormal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["u", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["v", "2"]}]}]}
      }], ")"}]}], ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"changed", " ", "'"}], 
      RowBox[{"Reflection", "'"}], " ", 
      RowBox[{"to", " ", "'"}], 
      RowBox[{"Ref", "'"}], " ", "April", " ", "2012"}], ";", " ", 
     RowBox[{"added", " ", "2", "D", " ", "March", " ", "2016"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"id", "=", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sign", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "<", "0"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyztp", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"cosd", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"sind", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"sind", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"sind", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"cosd", "[", "\[Phi]", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"arccosd", "[", 
    FractionBox["z", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]]], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi", "[", "v_", "]"}], ":=", 
   RowBox[{"Angle", "[", 
    RowBox[{"v", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "==", "0"}], ",", "0", ",", 
      "               ", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"arcsind", "[", 
         FractionBox["y", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]]], "]"}], ",", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", ">=", "0"}], ",", 
          RowBox[{"180", "-", 
           RowBox[{"arcsind", "[", 
            FractionBox["y", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"]}]]], "]"}]}], ",", "\n", 
          "\t\t\t\t           ", 
          RowBox[{
           RowBox[{"-", "180"}], "-", 
           RowBox[{"arcsind", "[", 
            FractionBox["y", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"]}]]], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "changed", " ", "Feb", " ", "2009", " ", "also", " ", "eliminated", " ", 
     "carets"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Theta", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], "==", "0"}], ",", "0", ",", 
       "               ", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"ArcCos", "[", 
          FractionBox["x", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}]]], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           FractionBox["x", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"]}]]], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "*)"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"used", " ", "for", " ", "lune", " ", "coordinates"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"theta2d", "[", "v_", "]"}], ":=", 
  RowBox[{"theta", "[", 
   RowBox[{"Append", "[", 
    RowBox[{"v", ",", "0"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"phitheta", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", "[", "v", "]"}], ",", 
     RowBox[{"theta", "[", "v", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TPxyz", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Theta", "[", "v", "]"}], ",", 
     RowBox[{"Phi", "[", "v", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertical", "[", "p_", "]"}], ":=", 
    RowBox[{
     RowBox[{"zrot", "[", 
      RowBox[{"theta", "[", "p", "]"}], "]"}], ".", 
     RowBox[{"yrot", "[", 
      RowBox[{"-", 
       RowBox[{"phi", "[", "p", "]"}]}], "]"}], ".", 
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", "p", "]"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Changed", " ", "Aug", " ", "2002"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertical", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", 
        RowBox[{
         RowBox[{"vertical", "[", "a", "]"}], ".", "b"}], "]"}]}], "]"}], ".", 
     RowBox[{"vertical", "[", "a", "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "makes", " ", "a", " ", "vertical", " ", "and", " ", "gives", " ", "b", 
    " ", "a", " ", "theta", " ", "coordinate", " ", "of", " ", "zero"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"verticalViaXAxis", "[", "p_", "]"}], ":=", 
    RowBox[{
     RowBox[{"yrot", "[", 
      RowBox[{"-", 
       RowBox[{"phi", "[", "p", "]"}]}], "]"}], ".", 
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", "p", "]"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Changed", " ", "Aug", " ", "2002"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"range", "[", 
    RowBox[{"domain_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"f", "/@", "domain"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListComplement", "[", 
     RowBox[{"universe_", ",", "set_"}], "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"universe", ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"set", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "Mathematica", " ", "Complement", " ", "no", " ", "good", " ", "for", " ", 
    "lists"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"set_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"part", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"remaining", "=", "set"}], ";", "\n", "     ", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"remaining", "!=", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t   ", 
       RowBox[{
        RowBox[{"EqCl", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"remaining", ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{
              RowBox[{"First", "[", "remaining", "]"}], ",", "#"}], "]"}], 
            " ", "&"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"part", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"part", ",", 
           RowBox[{"{", "EqCl", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"remaining", "=", 
         RowBox[{"ListComplement", "[", 
          RowBox[{"remaining", ",", "EqCl"}], "]"}]}]}]}], "]"}], ";", 
     "part"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"QuotientTopology", "[", 
    RowBox[{"domain_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Rangef", "=", 
      RowBox[{"range", "[", 
       RowBox[{"domain", ",", "f"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"Clear", "[", "EqCl", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"EqCl", "[", "RangeValue_", "]"}], ":=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EqCl", "[", 
         RowBox[{"f", "[", 
          RowBox[{"domain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EqCl", "[", 
           RowBox[{"f", "[", 
            RowBox[{"domain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"domain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "domain", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "     ", 
     RowBox[{"EqCl", "/@", "Rangef"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MyFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnsortedUnion", "[", "list_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Union", "[", "list", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "#1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "#2"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CartesianProduct", "[", "ListOfSets_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "ListOfSets", "]"}], "==", "2"}], ",", "\t\t", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListOfSets", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"ListOfSets", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "1"}], "]"}], "]"}], ",", "\n", 
     RowBox[{"MyFlatten", "/@", 
      RowBox[{"CartesianProduct", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"ListOfSets", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"CartesianProduct", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"ListOfSets", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ForSomeMine", "[", 
    RowBox[{"domain_", ",", "predicate_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"predicate", "/@", "domain"}], ",", "True"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ForAllMine", "[", 
    RowBox[{"domain_", ",", "predicate_"}], "]"}], ":=", 
   RowBox[{"!", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"predicate", "/@", "domain"}], ",", "False"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ListIsComplex", "[", "v_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"Head", "/@", "v"}], ",", "Complex"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqualNumbers", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"x", "-", "y"}], "]"}], "<", ".00001"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqualVectors", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"length", "[", 
     RowBox[{"x", "-", "y"}], "]"}], "<", ".00001"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentList", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"EquatorList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"zrot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "181"}], ",", "179", ",", "2"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapEyeward", "[", 
     RowBox[{"x_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"x", "+", 
     RowBox[{"distance", "*", 
      RowBox[{"unit", "[", "eye", "]"}]}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"usually", " ", "distance"}], " ", "=", " ", 
    RowBox[{".01", " ", "is", " ", "enough"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapListEyeward", "[", 
    RowBox[{"list_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapEyeward", "[", 
      RowBox[{"#", ",", "distance", ",", "eye"}], "]"}], "&"}], "/@", 
    "list"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeReal", "[", "z_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "z", "]"}], "==", "0"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "z", "]"}], "]"}], "<", ".00001"}], ",", 
       RowBox[{"Re", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"MakeReal", "/@", "z"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPoly", "[", 
    RowBox[{"i_", ",", "j_", ",", "RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "       ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RangeX", "[", 
         RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
        RowBox[{"RangeY", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "*)"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPolys", "[", 
    RowBox[{"RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BasicPoly", "[", 
        RowBox[{"i", ",", "j", ",", "RangeX", ",", "RangeY"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeX", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeY", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myRange", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "Nsubintervals_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x2", "<=", "x1"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"x1", ",", "x2", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "/", "Nsubintervals"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"myRangeNoSign", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "Nsubintervals_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", "x1", "]"}], "!=", "0"}], "||", 
      RowBox[{
       RowBox[{"Im", "[", "x2", "]"}], "!=", "0"}]}], ",", 
     RowBox[{"myRange", "[", 
      RowBox[{"x1", ",", "x2", ",", "Nsubintervals"}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x1", "<=", "x2"}], ",", 
       RowBox[{"myRange", "[", 
        RowBox[{"x1", ",", "x2", ",", "Nsubintervals"}], "]"}], ",", 
       RowBox[{"myRange", "[", 
        RowBox[{"x2", ",", "x1", ",", "Nsubintervals"}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BothSigns", "[", "list_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"-", "list"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inject", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "nPts_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"i", "/", "nPts"}]}], ")"}], "p1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "/", "nPts"}], ")"}], "p2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "nPts"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintEye", ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<eye = \>\"", ",", 
     RowBox[{"Round", "[", 
      RowBox[{"eye", ",", ".01"}], "]"}], ",", 
     "\"\<;  (\[Theta], \[Phi]\!\(\*SubscriptBox[\()\), \(eye\)]\) = \>\"", 
     ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "[", "eye", "]"}], ",", 
        RowBox[{"phi", "[", "eye", "]"}]}], "}"}], "]"}], ",", 
     "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(eye\)]\) = \>\"", ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"length", "[", "eye", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CubeVertices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CubeEdges", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "  ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xCubeFace", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xrot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"90", ",", "360", ",", "90"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CubeFacePolys", "=", 
    RowBox[{"Union", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MatrixPower", "[", 
             RowBox[{"rot111", ",", "i"}], "]"}], ".", "#"}], "&"}], "/@", 
          "xCubeFace"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"MatrixPower", "[", 
              RowBox[{"rot111", ",", "i"}], "]"}], ".", "#"}]}], "&"}], "/@", 
          "xCubeFace"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}], "]"}]}],
    ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"added", " ", "Union", " ", "Dec", " ", "2016"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomDirection", ":=", 
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomDirectionFixed", "=", "RandomDirection"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomRotation", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"tt", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pp", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotMatrixQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"ss", "/", "2"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"ss", "/", "2"}], "]"}], 
          RowBox[{
           RowBox[{"ZRot", "[", "tt", "]"}], ".", 
           RowBox[{"YRot", "[", "pp", "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "}"}], "]"}], ".", 
      RowBox[{"ZRot", "[", "tt", "]"}], ".", 
      RowBox[{"YRot", "[", "pp", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomUnitMT", ":=", 
    RowBox[{"MatrixFromONcoords", "[", 
     RowBox[{"unit", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", "6"}], "]"}], "]"}], "]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"random", " ", "unit", " ", "moment", " ", "tensor"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uG", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["2"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["6"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], 
       SqrtBox["3"]]}], "}"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"arc", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RotMatrixQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"#", "/", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"#", "/", "2"}], "]"}], 
           RowBox[{"unit", "[", 
            RowBox[{"Cross", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "}"}], "]"}], ".", 
       "a"}], "&"}], "/@", 
     RowBox[{"myRange", "[", 
      RowBox[{
       RowBox[{"0", "+", 
        RowBox[{"0", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", 
       RowBox[{
        RowBox[{"Angle", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "-", 
        RowBox[{"0", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", "31"}], "]"}]}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Change", " ", "0", " ", "to", " ", "1", " ", "or", " ", "2", " ", "so", 
     " ", "endpoints", " ", "are", " ", "visible"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "M", "]"}], ".", 
    RowBox[{"Flatten", "[", "N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMatrix", "[", "M_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{"M", ",", "M"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitMatrix", "[", "M_", "]"}], ":=", 
   FractionBox["M", 
    RowBox[{"NormMatrix", "[", "M", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AngleMatrix", "[", 
     RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{"M", ",", "N"}], "]"}], 
      RowBox[{
       RowBox[{"NormMatrix", "[", "M", "]"}], 
       RowBox[{"NormMatrix", "[", "N", "]"}]}]], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox["radians",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixAbs", "[", "V_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"Abs", ",", "V", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"MatrixAbs", "[", "V", "]"}], " ", "is", " ", 
     SubscriptBox["\[CapitalPi]", "V"]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpherePolyList", "[", 
     RowBox[{
     "\[Rho]_", ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "\[Phi]1_", ",", 
      "\[Phi]2_", ",", "\[CapitalDelta]\[Theta]_", ",", 
      "\[CapitalDelta]\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{"xyztp", "[", "#", "]"}]}], "&"}], ",", " ", 
      RowBox[{"BasicPolys", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
         "\[Theta]1", ",", "\[Theta]2", ",", "\[CapitalDelta]\[Theta]"}], 
         "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"\[Phi]1", ",", "\[Phi]2", ",", "\[CapitalDelta]\[Phi]"}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarText", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[GreaterEqual]", "0"}], ",", "x", ",", 
       OverscriptBox[
        RowBox[{"-", "x"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "y", ",", 
       OverscriptBox[
        RowBox[{"-", "y"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[GreaterEqual]", "0"}], ",", "z", ",", 
       OverscriptBox[
        RowBox[{"-", "z"}], "_"]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "AinRadians_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"AinRadians", "/", "Degree"}], ",", ".01"}], "]"}], ",", 
      "o"}], "]"}], "//", "DisplayForm"}]}], ";"}]}], "Input",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic,
 CellChangeTimes->{
  3.4892780789458637`*^9, 3.4892781537179947`*^9, 3.489278185963251*^9, {
   3.4950345922209835`*^9, 3.4950346018774004`*^9}, {3.5011818616296425`*^9, 
   3.5011818626904445`*^9}, {3.520005149614954*^9, 3.520005186743019*^9}, {
   3.5228787025265994`*^9, 3.522878716086618*^9}, {3.523572395586929*^9, 
   3.5235725065031223`*^9}, {3.5235726199309196`*^9, 
   3.5235726788522224`*^9}, {3.523573043268858*^9, 3.523573114982183*^9}, {
   3.523913723635171*^9, 3.5239137509196186`*^9}, {3.523913805878515*^9, 
   3.523913806065715*^9}, {3.52415771607572*^9, 3.5241577374165573`*^9}, {
   3.5245987606895313`*^9, 3.5245988112024193`*^9}, {3.5246041379147077`*^9, 
   3.524604143889518*^9}, {3.5275223122177277`*^9, 3.5275223131381297`*^9}, {
   3.5278961648661757`*^9, 3.5278961685761805`*^9}, {3.531153615164811*^9, 
   3.531153615984812*^9}, {3.5330552480452175`*^9, 3.533055281051276*^9}, {
   3.5359904583292646`*^9, 3.535990479217701*^9}, {3.536343561909086*^9, 
   3.5363435629386873`*^9}, {3.543292666839031*^9, 3.543292719379923*^9}, {
   3.5469924224625473`*^9, 3.5469924490318937`*^9}, {3.5519977604570932`*^9, 
   3.5519977614398947`*^9}, {3.557771274368308*^9, 3.5577712872851305`*^9}, {
   3.557771609737693*^9, 3.557771612483298*^9}, {3.55837231696457*^9, 
   3.558372325981386*^9}, {3.5583752865857487`*^9, 3.5583753000329723`*^9}, {
   3.558903374762436*^9, 3.5589033779604416`*^9}, {3.559264638214102*^9, 
   3.5592646392281036`*^9}, {3.56152558249544*^9, 3.5615255833378415`*^9}, {
   3.567712960903683*^9, 3.567712961808485*^9}, 3.57212065450091*^9, {
   3.5745725034873385`*^9, 3.5745725429211073`*^9}, {3.5745726368819714`*^9, 
   3.574572649926094*^9}, {3.5914556336639824`*^9, 3.5914556350939846`*^9}, {
   3.592708592645027*^9, 3.592708593975029*^9}, {3.5928584937596893`*^9, 
   3.592858725568514*^9}, {3.5940571577699823`*^9, 3.594057159789985*^9}, {
   3.5944926563063498`*^9, 3.5944926865583925`*^9}, {3.594492775988516*^9, 
   3.594492776368517*^9}, {3.594492837360602*^9, 3.594492837900603*^9}, {
   3.594492902030691*^9, 3.594492936992742*^9}, {3.594493034604878*^9, 
   3.594493069734926*^9}, {3.594493106114977*^9, 3.59449322455514*^9}, 
   3.59449358324364*^9, 3.594515431065692*^9, {3.5945158044122105`*^9, 
   3.594515805652213*^9}, {3.5947545896350193`*^9, 3.5947546197350607`*^9}, {
   3.594828417439077*^9, 3.594828449759122*^9}, {3.594926309197468*^9, 
   3.5949263218474855`*^9}, {3.594927514981152*^9, 3.5949275153411527`*^9}, {
   3.594929784751333*^9, 3.5949297858113346`*^9}, {3.59492992226153*^9, 
   3.594929926493537*^9}, {3.5949299683435946`*^9, 3.5949300347036858`*^9}, 
   3.5950188480312347`*^9, {3.595034990484455*^9, 3.5950349917844567`*^9}, {
   3.5956466336034193`*^9, 3.5956467549255886`*^9}, {3.5956470300339727`*^9, 
   3.5956470819260454`*^9}, {3.5956471788681808`*^9, 3.595647201638212*^9}, {
   3.595647312358365*^9, 3.5956473913904753`*^9}, {3.595715611870015*^9, 
   3.5957156407100554`*^9}, {3.5957156923101263`*^9, 3.595715708840149*^9}, 
   3.595716187234812*^9, {3.5957170337435017`*^9, 3.595717044763517*^9}, {
   3.597258178496549*^9, 3.5972581787265496`*^9}, {3.599261386127534*^9, 
   3.5992613871575356`*^9}, {3.5992772595141573`*^9, 
   3.5992772602741585`*^9}, {3.599277324544247*^9, 3.599277331914257*^9}, {
   3.603647041856326*^9, 3.603647081556381*^9}, {3.618611067270751*^9, 
   3.6186110728807583`*^9}, {3.6186111460108595`*^9, 3.618611158820877*^9}, {
   3.6186112106309485`*^9, 3.6186112148309546`*^9}, {3.6332226277838993`*^9, 
   3.6332226479739275`*^9}, {3.6332232680633373`*^9, 3.633223271203342*^9}, {
   3.6487904358208184`*^9, 3.648790525907971*^9}, {3.6684483212406683`*^9, 
   3.6684483397506933`*^9}, {3.668448371313237*^9, 3.6684483724032383`*^9}, {
   3.6833964238277674`*^9, 3.6833964249926825`*^9}, {3.6912539493321176`*^9, 
   3.6912539770821705`*^9}, 3.6921210127382526`*^9, {3.692498157175506*^9, 
   3.6924981572067585`*^9}, {3.692498188581808*^9, 3.6924982054881015`*^9}, {
   3.695618698451692*^9, 3.695618699407053*^9}, {3.6989476969098516`*^9, 
   3.6989477407249126`*^9}, {3.69894791067515*^9, 3.6989479132551003`*^9}, {
   3.698948249975572*^9, 3.6989482517006264`*^9}, 3.698948337170746*^9, 
   3.698948387285816*^9, {3.704659163921527*^9, 3.7046591660016465`*^9}, {
   3.7046603495084248`*^9, 3.704660372531743*^9}, {3.7110334365290008`*^9, 
   3.711033451294655*^9}, {3.711037659460438*^9, 3.711037663069871*^9}, {
   3.714850937910308*^9, 3.7148509695003376`*^9}, {3.7180645430460205`*^9, 
   3.718064570108611*^9}, {3.7180666054094276`*^9, 3.71806663069073*^9}, {
   3.722288161654131*^9, 3.7222881635447617`*^9}, {3.7222882068104715`*^9, 
   3.7222882083104744`*^9}, {3.722292009776352*^9, 3.7222920136513596`*^9}, {
   3.7262973003213577`*^9, 3.7262973017744856`*^9}, {3.731373845215251*^9, 
   3.7313738572602186`*^9}, {3.7323744228995304`*^9, 3.732374459087102*^9}, {
   3.734451137662434*^9, 3.7344511824145136`*^9}, {3.734451213118719*^9, 
   3.7344512199530644`*^9}, {3.7344512822894893`*^9, 3.734451306024126*^9}, {
   3.7346172811792326`*^9, 3.734617283601099*^9}, {3.7346177011331806`*^9, 
   3.7346177245082216`*^9}, {3.7346179000710773`*^9, 3.734617907211706*^9}, {
   3.7346179430399103`*^9, 3.734617955993041*^9}, {3.734628196652638*^9, 
   3.7346282214183187`*^9}, {3.734628275902807*^9, 3.734628299449718*^9}, {
   3.7346283505904465`*^9, 3.73462838573114*^9}, 3.734628420246833*^9, 
   3.7346284796375732`*^9, 3.734653704466226*^9, 3.7350941129877977`*^9, {
   3.7460429353723526`*^9, 3.7460429393171883`*^9}, {3.7576449198371625`*^9, 
   3.757644924040283*^9}, {3.7875080058443265`*^9, 3.787508006892823*^9}, {
   3.7875151727983875`*^9, 3.787515179298891*^9}, 3.7875944736793284`*^9, 
   3.7978629561501727`*^9, {3.79786348460015*^9, 3.7978634898001633`*^9}, 
   3.797972350692809*^9, 3.802206037420579*^9, 3.8022061516795697`*^9, 
   3.802301107500579*^9, {3.835511100274585*^9, 3.8355111363709936`*^9}, {
   3.8355114669365406`*^9, 3.8355114776833143`*^9}, {3.835706782705152*^9, 
   3.83570678393762*^9}, {3.840806924469942*^9, 3.8408069461340246`*^9}},
 AspectRatioFixed->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoordsWrtFrame", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "frame_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", "frame", "]"}], ".", "\[CapitalLambda]"}]}], 
   ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "The", " ", "frame", " ", "vectors", " ", "are", " ", "the", " ", 
      "COLUMNS", " ", "of", " ", "the", " ", "matrix", " ", "\"\<frame.\>\"", 
      " ", "I", " ", "changed", " ", "this", " ", "Nov", " ", "26"}], ",", 
     " ", "2013."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
    "\[Lambda]3"}], "]"}], ";", 
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "+", 
     RowBox[{"b", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "+", 
     RowBox[{"c", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Frame1", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Transpose", " ", "added", " ", "Nov", " ", "26"}], ",", " ", 
     "2013."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"CoordsWrtFrame", "[", 
  RowBox[{"\[CapitalLambda]", ",", "Frame1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5938130191244907`*^9, 3.59381310452661*^9}, {
  3.593813263512833*^9, 3.5938132661028366`*^9}, {3.5938234660811977`*^9, 
  3.5938234707032056`*^9}, {3.5945191585479183`*^9, 3.5945191911104636`*^9}, {
  3.594519344284678*^9, 3.5945193458346806`*^9}}],

Cell["\<\
RETRIEVING  \[Theta], \[Sigma] ,\[Phi]   FROM UsHat.  DONE JULY 2021, BUT \
SURELY THIS STUFF IS ELSEWHERE.\
\>", "SmallText",
 Evaluatable->False,
 CellChangeTimes->{{3.8364870800007386`*^9, 3.8364871394240236`*^9}, {
  3.8364879569921274`*^9, 3.8364879608641276`*^9}},
 AspectRatioFixed->True,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"TPxyz", "[", 
    RowBox[{"U", ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
   StyleBox[
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0", "<", "\[Phi]", "<", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "<", "\[Theta]", "<", "\[Pi]"}]}], "}"}]}],
    FontColor->RGBColor[1, 0, 0]]}], "]"}]}], "Input",
 CellChangeTimes->{{3.83648642992655*^9, 3.836486442571433*^9}, {
  3.8364865057271433`*^9, 3.8364865138181853`*^9}, {3.83648658537071*^9, 
  3.836486673601779*^9}, {3.8364879208201513`*^9, 3.8364879260160885`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"\[Theta]ofU", ",", "\[Sigma]ofU", ",", "\[Phi]ofU"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.836488122348678*^9, 3.836488131200139*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TPxyz", "[", 
     RowBox[{"U", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TPxyz", "[", 
     RowBox[{"U", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{"Theta", "[", 
    RowBox[{
     RowBox[{"YRot", "[", 
      RowBox[{"-", 
       RowBox[{"\[Phi]OfU", "[", "U", "]"}]}], "]"}], ".", 
     RowBox[{"ZRot", "[", 
      RowBox[{"-", 
       RowBox[{"\[Theta]OfU", "[", "U", "]"}]}], "]"}], ".", "U", ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Sigma]\[Phi]OfU", "[", "U_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]OfU", "[", "U", "]"}], ",", 
     RowBox[{"\[Sigma]OfU", "[", "U", "]"}], ",", 
     RowBox[{"\[Phi]OfU", "[", "U", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836486869359989*^9, 3.8364869089919844`*^9}, {
  3.836487876528364*^9, 3.8364878774081345`*^9}, {3.8364880514561396`*^9, 
  3.8364881574721527`*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"UsHat", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}], "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"U", "-", 
        RowBox[{"UsHat", "[", 
         RowBox[{"\[Theta]\[Sigma]\[Phi]OfU", "[", "U", "]"}], "]"}]}], "]"}],
       "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.836487240124071*^9, 3.8364874421120625`*^9}, 
   3.8364876067346945`*^9, {3.836487663232622*^9, 3.836487784128106*^9}, {
   3.836488166898188*^9, 3.836488171633182*^9}}],

Cell["ARROW2D IS FOR 2-DIMENSIONAL.  REDONE JUNE 2002", "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArrowBasic2D", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], " ", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], " ", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"arrow", "[", 
    RowBox[{"tip_", ",", "scale_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"tip", "+", 
      RowBox[{"scale", "\[Times]", 
       RowBox[{
        RowBox[{"rot2d", "[", "theta", "]"}], ".", "#"}]}]}], "&"}], "/@", 
    "ArrowBasic2D"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arrow2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", "scale_"}], "]"}], ":=", 
   RowBox[{"arrow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", "y2"}], "}"}], ",", "scale", ",", 
     RowBox[{"theta", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", "0"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Arrow2DonSphere", "[", 
    RowBox[{"v3_", ",", "v1_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ROTe3e1toOrthonormalv3v1", "[", 
       RowBox[{"v3", ",", "v1"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"scale", "\[Times]", "ArrowBasic2D"}], ")"}]}]}], 
  ";"}]}], "Input",
 PageBreakBelow->Automatic,
 CellChangeTimes->{{3.68338868201423*^9, 3.6833886979685235`*^9}, {
  3.683388799810652*^9, 3.683388831661496*^9}, {3.683388925031291*^9, 
  3.683388936627301*^9}, {3.683396547896555*^9, 3.6833965487526894`*^9}},
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"Line", "[", "ArrowBasic2D", "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.683388387359335*^9, 3.6833884115524797`*^9}, {
   3.6833885077237625`*^9, 3.683388533888088*^9}, {3.683388885507532*^9, 
   3.683388913453946*^9}, {3.683391790409665*^9, 3.683391797768368*^9}, 
   3.683396514650652*^9, {3.836487819693719*^9, 3.8364878351041117`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CirclePt", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], "+", 
     RowBox[{
      RowBox[{"xrot", "[", "i", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"1", "/", "3"}]}], "}"}]}]}]}], ";"}], "            ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Revised", " ", "July", " ", "2017"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePt", "[", "i", "]"}], ",", 
     RowBox[{"CirclePt", "[", 
      RowBox[{"i", "+", "30"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HalfDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "90"}], ",", "90", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WholeDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UofSN", "[", 
     RowBox[{"S_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"unit", "[", "S", "]"}], ",", 
       RowBox[{"unit", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"N", ",", "S"}], "]"}], "]"}], ",", 
       RowBox[{"unit", "[", "N", "]"}]}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Rotation", " ", "matrix", " ", "that", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}], " ", "to", " ", "S", " ", 
     "and", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}], " ", "to", " ", 
     RowBox[{"N", ".", "  ", "S"}], " ", "and", " ", "N", " ", "are", " ", 
     "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenForArrow", "[", 
    RowBox[{"vector_", ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"1.02", 
       FractionBox["ArrowScale", 
        RowBox[{"length", "[", "vector", "]"}]]}]}], ")"}], "vector"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenLineForArrow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"p1", ",", 
     RowBox[{"p2", "-", 
      RowBox[{"1.06", "ArrowScale", " ", 
       RowBox[{"unit", "[", 
        RowBox[{"p2", "-", "p1"}], "]"}]}]}]}], "}"}]}], ";", "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"maybe", " ", "change", " ", "1.06"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7107786899249983`*^9, 3.7107787639572253`*^9}, {
   3.7107788118280177`*^9, 3.7107788181643305`*^9}, {3.710778912245721*^9, 
   3.7107789321648617`*^9}, {3.7107789661808095`*^9, 3.7107790412041025`*^9}, 
   3.7107811120535154`*^9, {3.7107817359922495`*^9, 3.7107817406455126`*^9}, {
   3.71087483028846*^9, 3.710874838160901*^9}, {3.710874879680277*^9, 
   3.7108748932330556`*^9}, 3.7108756004805655`*^9, {3.736194997883952*^9, 
   3.7361950278057995`*^9}, {3.8250052839535685`*^9, 3.825005358245612*^9}, {
   3.8250053918168297`*^9, 3.8250054090252857`*^9}, {3.82500544572526*^9, 
   3.825005524949031*^9}, {3.825005688389964*^9, 3.8250056889926434`*^9}, {
   3.8250057325066743`*^9, 3.825005733949659*^9}, {3.825006716601698*^9, 
   3.8250067918226833`*^9}, {3.8250068912164707`*^9, 3.8250069090635386`*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "3"}]}], "}"}], "]"}]}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "WholeDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", ".02", "]"}], ",", "Green", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}]}],
        "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7108116645540957`*^9, 3.710811757531419*^9}, {
  3.710874044242437*^9, 3.710874146913313*^9}, {3.7108742293970375`*^9, 
  3.710874235408381*^9}, {3.7108742793288965`*^9, 3.7108743178241005`*^9}, {
  3.710874366080868*^9, 3.71087466840018*^9}, {3.7422518021341333`*^9, 
  3.7422518888995514`*^9}}],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"Arrow3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "ArrowScale"}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", ".03", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"ShortenLineForArrow", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
          "ArrowScale"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"10", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "90"}], ",", "70"}], "}"}], "]"}]}]}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8250048752904644`*^9, 3.825005150456607*^9}, {
   3.8250055882251663`*^9, 3.825005612758525*^9}, 3.8250057045144186`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3Dhalf", "[", 
     RowBox[{
     "TipPt_", ",", "Direction_", ",", "Normal_", ",", "ArrowScale_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"Polygon", "/@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TipPt", "+", 
           RowBox[{"ArrowScale", "*", 
            RowBox[{
             RowBox[{"UofSN", "[", 
              RowBox[{"Direction", ",", "Normal"}], "]"}], ".", "#"}]}]}], 
          "&"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Direction", " ", "and", " ", "Normal", " ", "vectors", " ", "must", " ", 
     "be", " ", "perpendicular"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"TipPt_", ",", "Direction_", ",", "ArrowScale_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"Direction", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sign", "[", 
                   RowBox[{"Direction", ".", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}]}]}], "&"}], 
           ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"ZRot", "[", 
                RowBox[{"Theta", "[", "Direction", "]"}], "]"}], ".", 
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "\[Pi]"}], "/", "2"}], "+", 
                 RowBox[{"Phi", "[", "Direction", "]"}]}], "]"}], ".", 
               "#"}]}]}], "&"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "}"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.710779889690693*^9, 3.710779919045374*^9}, {
   3.7107799708053384`*^9, 3.710779974964576*^9}, {3.710780028709654*^9, 
   3.7107800471567097`*^9}, {3.7107807853978124`*^9, 
   3.7107808081331143`*^9}, {3.710780838660859*^9, 3.710780839860928*^9}, {
   3.7107809423407965`*^9, 3.710780944388914*^9}, {3.7107811883588886`*^9, 
   3.7107811918130865`*^9}, 3.710781563014344*^9, {3.7107851253825755`*^9, 
   3.710785151318061*^9}, {3.7107862235734615`*^9, 3.7107862546782465`*^9}, {
   3.710786354039937*^9, 3.710786361413356*^9}, {3.7107864015606537`*^9, 
   3.7107864475902967`*^9}, 3.7107864923428593`*^9, {3.7108747054413085`*^9, 
   3.710874753537052*^9}, {3.7109019519823785`*^9, 3.7109019569566593`*^9}, 
   3.7422539345506487`*^9, {3.7447380617113123`*^9, 3.7447380638050575`*^9}, {
   3.744738109648678*^9, 3.7447381441486034`*^9}, 3.74473868850661*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"CirclePoint", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "3"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"zrot", "[", "i", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ")"}]}], "]"}]}], ";",
    " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"watch", " ", "out"}], ";", " ", 
      RowBox[{
      "there", " ", "is", " ", "another", " ", "CirclePoint", " ", "in", " ", 
       "the", " ", "streetlight_parhelia", " ", "file"}]}], ",", " ", 
     RowBox[{"for", " ", "Minnaert", " ", "cigar"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CirclePoint", "[", 
       RowBox[{"i", ",", "1"}], "]"}], ",", 
      RowBox[{"CirclePoint", "[", 
       RowBox[{
        RowBox[{"i", "+", "30"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"CenterDisk", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], " ", ":=", 
    RowBox[{"v2", "+", 
     RowBox[{"scale", "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CirclePoint", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "+", 
          RowBox[{"CirclePoint", "[", 
           RowBox[{"180", ",", "1"}], "]"}]}], ")"}], "/", "2"}]}]}]}]}], ";",
    "\n", 
   RowBox[{
    RowBox[{"ConeVertex", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], " ", ":=", 
    RowBox[{"v2", "+", 
     RowBox[{"scale", "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
       RowBox[{"CirclePoint", "[", 
        RowBox[{"0", ",", "0"}], "]"}]}]}]}]}], ";", 
   RowBox[{
    RowBox[{"DiskPoly", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", "#"}]}]}], " ", 
       "&"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"CirclePoint", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ConePolyList", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", "#"}]}]}], " ", 
       "&"}], ",", 
      RowBox[{"ConePoly", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"30", ",", "360", ",", "30"}], "]"}]}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"CircleList", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
          RowBox[{"CirclePoint", "[", 
           RowBox[{
            RowBox[{"#", "+", "30"}], ",", "j"}], "]"}]}]}]}], " ", "&"}], 
      ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "360", ",", "30"}], "]"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"ConePolyList", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"sign", " ", "added", " ", "April", " ", "2011"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
      "\t\t                                                                   \
                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"DiskPoly", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "]"}]}], "}"}], ",",
       "\n", "\t                                             ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"CircleList", "[", 
            RowBox[{"v1", ",", "v2", ",", "scale", ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", "7"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapEyeward", "[", 
              RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
            "                     ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "may", " ", "have", " ", "to", " ", "adjust", " ", "eyeward", 
               " ", "distance", " ", "here"}], ";", " ", 
              StyleBox[
               RowBox[{
               "I", " ", "took", " ", "this", " ", "out", " ", "March", " ", 
                "2011"}],
               FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "+", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"ConeVertex", "[", 
               RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], ",", "\n", 
              "\t\t\t      ", 
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "-", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{
     "v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_", ",", "1"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"ConePolyList", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"sign", " ", "added", " ", "April", " ", "2011"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
      "\t\t                                                                   \
                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"DiskPoly", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "]"}]}], "}"}], ",",
       "\n", "\t                                             ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"CircleList", "[", 
            RowBox[{"v1", ",", "v2", ",", "scale", ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", "7"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapEyeward", "[", 
              RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
            "                     ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "may", " ", "have", " ", "to", " ", "adjust", " ", "eyeward", 
               " ", "distance", " ", "here"}], ";", " ", 
              StyleBox[
               RowBox[{
               "I", " ", "took", " ", "this", " ", "out", " ", "March", " ", 
                "2011"}],
               FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "+", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"ConeVertex", "[", 
               RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], ",", "\n", 
              "\t\t\t      ", 
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "-", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_", ",", 
      RowBox[{"-", "1"}]}], "]"}], ":=", 
    RowBox[{"Arrow3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "v2"}], "-", "v1"}], ",", 
      RowBox[{"v2", "+", 
       RowBox[{"3.2", "scale", "*", 
        RowBox[{"unit", "[", 
         RowBox[{"v1", "-", "v2"}], "]"}]}]}], ",", "scale", ",", "tkns", ",",
       "eye", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfWayIndex", "[", "PtList_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"PtList", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "PtList", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"PtList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"PtList", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "2"]}], "]"}], "<", 
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"#2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"PtList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"PtList", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "2"]}], "]"}]}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfWayArrow", "[", 
     RowBox[{"PtList_", ",", "ArrowScale_", ",", "tkns_", ",", "sign_"}], 
     "]"}], ":=", 
    RowBox[{"Arrow3D", "[", 
     RowBox[{
      RowBox[{"PtList", "[", 
       RowBox[{"[", 
        RowBox[{"HalfWayIndex", "[", "PtList", "]"}], "]"}], "]"}], ",", 
      RowBox[{"PtList", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"HalfWayIndex", "[", "PtList", "]"}], "+", "1"}], "]"}], 
       "]"}], ",", "ArrowScale", ",", 
      RowBox[{".3", "tkns"}], ",", "eye", ",", "sign"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.5005816242648864`*^9, {3.5097430914250536`*^9, 3.5097431414351225`*^9}, {
   3.5123906340047293`*^9, 3.512390671264781*^9}, {3.512390746624885*^9, 
   3.512390747434886*^9}, 3.5123908159849806`*^9, {3.5123908557050357`*^9, 
   3.5123908569650373`*^9}, {3.513262578763157*^9, 3.5132626713805184`*^9}, {
   3.5132627439206448`*^9, 3.5132627869611197`*^9}, {3.513263055063187*^9, 
   3.5132630931116533`*^9}, {3.5132633850193624`*^9, 3.5132633855809636`*^9}, 
   3.5132634755307207`*^9, {3.5132635813145046`*^9, 3.513263610190155*^9}, {
   3.6009722049394665`*^9, 3.6009722059794683`*^9}, {3.7108738247978697`*^9, 
   3.7108738292011223`*^9}}],

Cell[TextData[{
 "POINT P ON THE SPHERE IS VISIBLE FROM THE VIEWPOINT ",
 StyleBox["EYE",
  FontSlant->"Italic"],
 " IFF ",
 StyleBox["SEE[P,EYE]",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["SEE",
  FontSlant->"Italic"],
 " IS NEEDED FOR LAST EXAMPLE IN NUMERAL FILE."
}], "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeeOnSphere", "[", 
    RowBox[{"p_", ",", "n_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ScalarProj", "[", 
     RowBox[{"p", ",", "eye"}], "]"}], ">", 
    FractionBox[
     SuperscriptBox["n", "2"], 
     RowBox[{"length", "[", "eye", "]"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VisibleSegments", "[", 
    RowBox[{"SegmentList_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"SegmentList", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"see", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&&", 
       RowBox[{"see", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ThirdSegments", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SegmentList", "[", "PointList", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VisibleCurve", "[", 
     RowBox[{
     "PointList_", ",", "n_", ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{"hue", ",", 
      RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
      RowBox[{"Line", "/@", 
       RowBox[{"VisibleSegments", "[", 
        RowBox[{
         RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
         RowBox[{
          RowBox[{"SeeOnSphere", "[", 
           RowBox[{"#1", ",", "n", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
     "}"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"no", " ", "longer", " ", "Graphics3D"}], ",", " ", 
     RowBox[{"May", " ", "2012"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WholeCurve", "[", 
    RowBox[{
    "PointList_", ",", "n_", ",", "eye_", ",", "ThicknessSolid_", ",", 
     "ThicknessDashed_", ",", "hue_"}], "]"}], ":=", "             ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"no", " ", "longer", " ", "Graphics3D"}], ",", " ", 
      RowBox[{"May", " ", "2012"}]}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"Thickness", "[", "ThicknessDashed", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"ThirdSegments", "[", "PointList", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"Thickness", "[", "ThicknessSolid", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"VisibleSegments", "[", 
         RowBox[{
          RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
          RowBox[{
           RowBox[{"SeeOnSphere", "[", 
            RowBox[{"#1", ",", "n", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tpGraphics", "[", 
    RowBox[{
    "v_", ",", "eye_", ",", "ThicknessSolid_", ",", "ThicknessDashed_"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"WholeCurve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zrot", "[", 
           RowBox[{"theta", "[", "v", "]"}], "]"}], ".", 
          RowBox[{"yrot", "[", 
           RowBox[{"-", "#"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"90", 
           RowBox[{"sign", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"sign", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "]"}]}], ",", "1", 
       ",", "eye", ",", "ThicknessSolid", ",", "ThicknessDashed"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", 
         RowBox[{".9", "ThicknessSolid"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"xyztp", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"theta", "[", "v", "]"}], ",", "90"}], "}"}], "]"}]}], 
          "}"}], "]"}]}], "}"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.508994997710577*^9, 3.508995003140585*^9}, {
   3.508995045550643*^9, 3.5089950596506624`*^9}, {3.5089952524409285`*^9, 
   3.508995259730939*^9}, {3.5118744273638315`*^9, 3.5118744292046347`*^9}, {
   3.5118747205039425`*^9, 3.511874734590767*^9}, {3.5118748654593954`*^9, 
   3.511874892166642*^9}, {3.511874992084816*^9, 3.5118750118344507`*^9}, 
   3.511875082190573*^9, 3.51187521798881*^9, {3.511878399458357*^9, 
   3.511878404684366*^9}, {3.546998714978611*^9, 3.5469987978266563`*^9}, {
   3.5469988311471148`*^9, 3.546998862156869*^9}, {3.546999511237503*^9, 
   3.546999533795142*^9}, {3.546999695380224*^9, 3.5469997008090334`*^9}, {
   3.546999780493973*^9, 3.5469998116784267`*^9}}]
}, Open  ]],

Cell["EXAMPLE:", "SmallText",
 CellChangeTimes->{{3.5947403421074266`*^9, 3.594740361376954*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1"}], "}"}]}]}], ";", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"WholeCurve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zrot", "[", "#", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "360", ",", "3"}], "]"}]}], ",", "1", ",", "eye", 
      ",", ".003", ",", ".002", ",", "Red"}], "]"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5469995769448175`*^9, 3.5469996772373924`*^9}, {
  3.546999727890681*^9, 3.5469997352070937`*^9}, {3.594740385729488*^9, 
  3.5947404707731094`*^9}}],

Cell[TextData[{
 "FOR DOTTING POLYGONAL CURVES. MAKE ",
 StyleBox["SEE",
  FontSlant->"Italic"],
 " = ",
 StyleBox["FALSE&",
  FontSlant->"Italic"],
 " TO DOT THE WHOLE THING. NEED VISIBLE SEGMENTS FOR THIS. \nA SEGMENT IS  \
DELETED IF ONE ENDPOINT FAILS TO SATISFY THE KEEP CONDITION.  MAKE ",
 StyleBox["KEEP",
  FontSlant->"Italic"],
 " = ",
 StyleBox["TRUE",
  FontSlant->"Italic"],
 " ",
 StyleBox["&",
  FontSlant->"Italic"],
 " FOR NO CHANGE."
}], "SmallText",
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubdivisionPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"npts", "=", 
      RowBox[{"1", "+", 
       RowBox[{"3", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"length", "[", 
           RowBox[{"x2", "-", "x1"}], "]"}], "/", "tol"}], "]"}]}]}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "+", 
        RowBox[{
         RowBox[{"#", "/", "npts"}], 
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}]}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "npts"}], "]"}]}]}], ")"}]}], ";", 
  RowBox[{
   RowBox[{"PartitionedSegmentList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{"SegmentList", "[", 
    RowBox[{"SubdivisionPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListVisible", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"VisibleSegments", "[", 
    RowBox[{
     RowBox[{"SegmentList", "[", 
      RowBox[{"SubdivisionPoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}], ",", 
     "see"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListThird", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], 
   "                  ", ":=", "     ", 
   RowBox[{"ThirdSegments", "[", 
    RowBox[{"SubdivisionPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListVisible", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DotLineListVisible", "[", 
         RowBox[{"#", ",", "tol", ",", "see"}], "]"}], " ", "&"}], ",", 
       RowBox[{"SegmentList", "[", "PointList", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListThird", "[", 
    RowBox[{"PointList_", ",", "tol_"}], "]"}], "                  ", ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DotLineListThird", "[", 
         RowBox[{"#", ",", "tol"}], "]"}], " ", "&"}], ",", "               ", 
       RowBox[{"SegmentList", "[", "PointList", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLine", "[", 
    RowBox[{
    "PointList_", ",", "tol_", ",", "see_", ",", "keep_", ",", 
     "ThicknessSolid_", ",", "ThicknessDot_"}], "]"}], ":=", 
   RowBox[{"{", " ", "\n", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ThicknessDot", "==", "0"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "ThicknessDot", "]"}], ",", "     ", 
         RowBox[{"Line", "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DotLineListThird", "[", 
             RowBox[{"PointList", ",", "tol"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"keep", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
              RowBox[{"keep", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
        "}"}]}], "]"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "ThicknessSolid", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"DotLineListVisible", "[", 
         RowBox[{"PointList", ",", "tol", ",", "see"}], "]"}]}]}], "}"}]}], 
    "         ", "}"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MinceSegment", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"v1", "+", 
       RowBox[{"#", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v2", "-", "v1"}], ")"}], "/", 
         RowBox[{"Ceiling", "[", 
          FractionBox[
           RowBox[{"length", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "tol"], "]"}]}]}]}], ")"}], 
     "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Ceiling", "[", 
       FractionBox[
        RowBox[{"length", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "tol"], "]"}]}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MinceCurve", "[", 
    RowBox[{"PointList_", ",", "tol_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MinceSegment", "[", 
        RowBox[{"#", ",", "tol"}], "]"}], "&"}], "/@", 
      RowBox[{"SegmentList", "[", "PointList", "]"}]}], ",", "1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Redistribute", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "dashlength_"}], "]"}], ":=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"MinceCurve", "[", 
      RowBox[{"PointList", ",", "tol"}], "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"MinceCurve", "[", 
         RowBox[{"PointList", ",", "tol"}], "]"}], "]"}], ",", 
       RowBox[{"Round", "[", 
        FractionBox["dashlength", "tol"], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input"],

Cell["\<\
A LIST OF SEGMENTS.  LENGTH OF POINTLIST MAKES A DIFFERENCE FOR ENDS OF \
CURVE. USED FOR CIRCULAR HALOS IN MONTE CARLO.\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{3.6184195825867977`*^9},
 AspectRatioFixed->True,
 FontSize->12,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DotCurveList", "[", "PointList_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], ",", "3"}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotCurveList", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "dashlength_"}], "]"}], ":=", 
   RowBox[{"DotCurveList", "[", 
    RowBox[{"Redistribute", "[", 
     RowBox[{"PointList", ",", "tol", ",", "dashlength"}], "]"}], "]"}]}], 
  ";"}]}], "Input"],

Cell["\<\
NEEDED FOR ATLAS DIAGRAMS, WHOLE SPHERE SIMULATIONS, ORIENTATION \
DISTRIBUTIONS.\
\>", "SmallText",
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PreCelSphereList", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eps3", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"length", "[", "eye", "]"}], "2"]]}], ")"}]}], 
    RowBox[{"unit", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eps4", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"length", "[", "eye", "]"}], "2"]]}], ")"}]}], 
    RowBox[{"unit", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"eye", ",", 
       RowBox[{"eps3", "[", "eye", "]"}]}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CenterCelSphere", "[", "eye_", "]"}], ":=", 
   FractionBox["eye", 
    SuperscriptBox[
     RowBox[{"length", "[", "eye", "]"}], "2"]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CelSpherePt", "[", 
    RowBox[{"t_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CenterCelSphere", "[", "eye", "]"}], "+", 
    RowBox[{
     RowBox[{"cosd", "[", "t", "]"}], " ", 
     RowBox[{"eps3", "[", "eye", "]"}]}], "+", 
    RowBox[{
     RowBox[{"sind", "[", "t", "]"}], " ", 
     RowBox[{"eps4", "[", "eye", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PreCelSphereList", "[", "eye_", "]"}], ":=", 
    RowBox[{
     RowBox[{"PreCelSphereList", "[", "eye", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"CelSpherePt", "[", 
        RowBox[{"#", ",", "eye"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "90."}], ",", "270"}], "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "180"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.500396498459106*^9, 3.500396681369425*^9}, {
   3.543325224153449*^9, 3.543325226087852*^9}, {3.6890501808053646`*^9, 
   3.6890501873250184`*^9}, 3.7322283707322245`*^9, {3.7322284095522814`*^9, 
   3.7322284315273*^9}}],

Cell[CellGroupData[{

Cell["Principal axes as vectors", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.7319457883590517`*^9}}],

Cell["\<\
WantArrowColor can be \"TriColor\", \"Custom\", or \"Gray\".
   ArrowColor is some Hue, but only relevant if WantArrowColor = \"Custom\".\
\>", "Text",
 CellChangeTimes->{{3.715714996393337*^9, 3.7157150016902084`*^9}, {
  3.715715819423092*^9, 3.7157159643609123`*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{"ShortenLineForArrow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.2", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   "ArrowScale"}], "]"}]], "Input",
 CellChangeTimes->{{3.8250073829437714`*^9, 3.825007394229742*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Paxes", "[", 
   RowBox[{
   "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
    ",", "BBrad_", ",", "ArrowScale_", ",", "tkns_", ",", "WantArrowColor_", 
    ",", "ArrowColor_"}], "]"}], ":=", 
  RowBox[{"{", "      ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"changed", " ", "Sept", " ", "2017"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"t1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"BBrad", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".01", ",", ".8", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "BBrad", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".6", ",", ".9", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"ShortenLineForArrow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "BBrad"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}], 
              ",", "ArrowScale"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<TriColor\>\""}], ",", 
            RowBox[{"Hue", "[", ".15", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Custom\>\""}], ",", 
            "ArrowColor"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WantArrowColor", "\[Equal]", "\"\<Gray\>\""}], ",", 
            RowBox[{"GrayLevel", "[", ".6", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.710884862433217*^9, 3.710885007042824*^9}, {
   3.710885057824211*^9, 3.710885080152393*^9}, {3.710885123496228*^9, 
   3.710885138761883*^9}, {3.710885295230939*^9, 3.710885325262247*^9}, {
   3.7148818954088717`*^9, 3.7148819325808067`*^9}, {3.7148820064247136`*^9, 
   3.7148820424560337`*^9}, {3.715712432333237*^9, 3.7157124636770716`*^9}, {
   3.715713383015217*^9, 3.715713383858967*^9}, {3.715713463359124*^9, 
   3.715713467265382*^9}, {3.715715040315297*^9, 3.7157150468622227`*^9}, 
   3.7157150782528715`*^9, {3.7157152995501757`*^9, 3.7157153238940125`*^9}, 
   3.7157154168004107`*^9, {3.7157155132068825`*^9, 3.7157155339725485`*^9}, {
   3.715715590832035*^9, 3.715715603816439*^9}, 3.7157157965324593`*^9, {
   3.825007157157131*^9, 3.825007194024397*^9}, {3.8250072260371356`*^9, 
   3.825007250068356*^9}, {3.8250072900112967`*^9, 3.8250073013836217`*^9}, {
   3.8250074433354797`*^9, 3.8250074816391563`*^9}, {3.8250075503475633`*^9, 
   3.8250075574354987`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{
     RowBox[{"xrot", "[", "20", "]"}], ".", 
     RowBox[{"zrot", "[", "30", "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"WantArrowColor", "=", "True"}], ";", 
   RowBox[{"lengthAxis", "=", "1.2"}], ";", 
   RowBox[{"c", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
   RowBox[{"tkns", "=", ".008"}], ";", 
   RowBox[{"BBrad", "=", ".3"}], ";", 
   RowBox[{"ArrowScale", "=", ".25"}], ";", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Paxes", "[", 
      RowBox[{
      "True", ",", "True", ",", "True", ",", "u", ",", "c", ",", "lengthAxis",
        ",", "BBrad", ",", "ArrowScale", ",", "tkns", ",", "\"\<TriColor\>\"",
        ",", "ArrowColor"}], "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "u", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7108754544001923`*^9, 3.71087548307283*^9}, 
   3.710875547888542*^9, {3.710875625632994*^9, 3.7108756517924924`*^9}, {
   3.71087568574444*^9, 3.7108756886566067`*^9}, {3.710875924482112*^9, 
   3.710875950783614*^9}, 3.7108850241054087`*^9, {3.710885449207987*^9, 
   3.7108855285831556`*^9}, 3.7157160585485964`*^9, {3.740767875026726*^9, 
   3.7407678796829767`*^9}, {3.74225050490302*^9, 3.74225050948112*^9}, {
   3.74225354975469*^9, 3.742253552895356*^9}, {3.7440452247291107`*^9, 
   3.744045249275935*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Principal axes as lines, no arrows.", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.731945812149082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalAxes", "[", 
    RowBox[{
    "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
     ",", "BBrad_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Thickness", "[", "tkns", "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"lines", ",", " ", 
        RowBox[{"no", " ", "arrows"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".01", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "lengthAxis"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".57", ",", "1", ",", "1"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "lengthAxis"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".15", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "lengthAxis"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504471849812714*^9, 3.5044718903327703`*^9}, {
   3.5044719323628283`*^9, 3.5044719941229134`*^9}, {3.5122275063263364`*^9, 
   3.5122275300227776`*^9}, {3.5122278033508544`*^9, 3.51222780634606*^9}, {
   3.512227916029851*^9, 3.51222798997398*^9}, {3.5122280516876874`*^9, 
   3.512228053700091*^9}, {3.512228085165346*^9, 3.5122281150705976`*^9}, {
   3.5123939753233414`*^9, 3.5123939753533416`*^9}, {3.5183042958838587`*^9, 
   3.518304332216322*^9}, {3.51830439414843*^9, 3.5183044095612564`*^9}, {
   3.522959570528062*^9, 3.522959584538081*^9}, {3.52295998940864*^9, 
   3.5229600030186586`*^9}, {3.5468753296470337`*^9, 
   3.5468753366358457`*^9}, {3.546875437568022*^9, 3.546875439268425*^9}, {
   3.546920669441621*^9, 3.5469206878652525`*^9}, {3.547069861331265*^9, 
   3.547069899816532*^9}, {3.5479172086508427`*^9, 3.547917209774045*^9}, {
   3.559264686152985*^9, 3.5592646885553894`*^9}, {3.5944937685858965`*^9, 
   3.594493777165909*^9}, {3.698767816765506*^9, 3.698767817358539*^9}, 
   3.6987687967186327`*^9, {3.698768832365678*^9, 3.6987688341737814`*^9}, 
   3.698777024974787*^9, {3.69877829283139*^9, 3.698778315407683*^9}, {
   3.7359402899442945`*^9, 3.7359403467568765`*^9}}]
}, Open  ]],

Cell["Delete:", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}, {3.731945785194048*^9, 
  3.731945812149082*^9}, {3.830224967765571*^9, 3.8302249714218426`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BoldU", "=", 
   RowBox[{"Orthogonalize", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "BoldU", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"BoldU", ".", 
   RowBox[{"Transpose", "[", "BoldU", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8301837159480176`*^9, 3.8301838720158873`*^9}, {
  3.8301839241003685`*^9, 3.83018394723411*^9}, {3.830183996261606*^9, 
  3.8301840079372077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoldU", "=", 
   RowBox[{"MatrixUbar", "[", 
    RowBox[{
     RowBox[{"ZRot", "[", 
      RowBox[{"30", "Degree"}], "]"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{"20", "Degree"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8301843596918344`*^9, 3.8301844082845087`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EE", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"BoldU", ".", 
   RowBox[{"BBcoords", "[", "EE", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoldUofEE", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"MatrixFromBBcoords", "[", "%", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "BoldUofEE", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", "BoldUofEE", "]"}]}], "Input",
 CellChangeTimes->{{3.830184039827965*^9, 3.830184265767336*^9}, {
  3.830184433449518*^9, 3.8301844395393744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Random6x6RotationMatrix", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"B1temp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B2temp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B3temp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B4temp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B5temp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B6temp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Orthogonal6x6", "=", 
      RowBox[{"Orthogonalize", "[", 
       RowBox[{"{", 
        RowBox[{
        "B1temp", ",", "B2temp", ",", "B3temp", ",", "B4temp", ",", "B5temp", 
         ",", "B6temp"}], "}"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", "Orthogonal6x6", "]"}], ">", "0"}], ",", 
       "Orthogonal6x6", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Orthogonal6x6", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal6x6", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal6x6", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal6x6", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal6x6", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal6x6", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], ")"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.835481239210951*^9, 3.835481311659586*^9}, {
  3.8354813513994083`*^9, 3.835481377887375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Random4x4RotationMatrix", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"B1temp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B2temp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B3temp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B4temp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "}"}]}]}], "}"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Orthogonal4x4", "=", 
      RowBox[{"Orthogonalize", "[", 
       RowBox[{"{", 
        RowBox[{"B1temp", ",", "B2temp", ",", "B3temp", ",", "B4temp"}], 
        "}"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", "Orthogonal4x4", "]"}], ">", "0"}], ",", 
       "Orthogonal4x4", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Orthogonal4x4", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal4x4", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal4x4", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"Orthogonal4x4", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], ")"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.835482211306888*^9, 3.835482358092782*^9}}]
},
WindowToolbars->"RulerBar",
CellGrouping->Manual,
WindowSize->{1231, 919},
WindowMargins->{{210, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}, {
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
PageHeaderLines->{False, Inherited},
PrintingOptions->{"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{21.5625, 21.5625}, {7.1875, 36}}},
PrivateNotebookOptions->{"ColorPalette"->{RGBColor, -1},
"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowCellLabel->True,
ShowCellTags->False,
RenderingOptions->{"ObjectDithering"->True,
"RasterDithering"->False},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 357, 9, 51, "Text"],
Cell[905, 31, 1448, 40, 77, "Input"],
Cell[2356, 73, 6246, 197, 500, "Input"],
Cell[8605, 272, 1570, 43, 121, "Input"],
Cell[10178, 317, 566, 16, 32, "Input"],
Cell[10747, 335, 113, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[10885, 342, 58003, 1706, 3789, "Input",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic],
Cell[68891, 2050, 2830, 82, 143, "Input"],
Cell[71724, 2134, 336, 8, 28, "SmallText",
 Evaluatable->False],
Cell[72063, 2144, 1039, 28, 77, "Input"],
Cell[73105, 2174, 188, 4, 32, "Input"],
Cell[73296, 2180, 1499, 43, 99, "Input"],
Cell[74798, 2225, 1123, 31, 55, "Input"],
Cell[75924, 2258, 145, 3, 28, "SmallText",
 Evaluatable->False],
Cell[76072, 2263, 2220, 69, 99, "Input",
 PageBreakBelow->Automatic],
Cell[78295, 2334, 561, 10, 32, "Input"],
Cell[78859, 2346, 3866, 103, 240, "Input"],
Cell[82728, 2451, 3862, 108, 143, "Input"],
Cell[86593, 2561, 1271, 35, 77, "Input"],
Cell[87867, 2598, 4558, 113, 209, "Input"],
Cell[92428, 2713, 14232, 370, 769, "Input"],
Cell[106663, 3085, 362, 14, 47, "SmallText",
 Evaluatable->False],
Cell[107028, 3101, 5526, 149, 330, "Input"]
}, Open  ]],
Cell[112569, 3253, 128, 2, 28, "SmallText"],
Cell[112700, 3257, 818, 22, 55, "Input"],
Cell[113521, 3281, 499, 19, 47, "SmallText"],
Cell[114023, 3302, 4133, 124, 231, "Input"],
Cell[118159, 3428, 1682, 54, 150, "Input"],
Cell[119844, 3484, 280, 8, 29, "Text",
 Evaluatable->False],
Cell[120127, 3494, 843, 25, 55, "Input"],
Cell[120973, 3521, 141, 4, 28, "SmallText"],
Cell[121117, 3527, 2313, 71, 260, "Input"],
Cell[CellGroupData[{
Cell[123455, 3602, 221, 3, 45, "Subsection"],
Cell[123679, 3607, 311, 6, 51, "Text"],
Cell[123993, 3615, 353, 10, 32, "Input"],
Cell[124349, 3627, 7460, 176, 451, "Input"],
Cell[131812, 3805, 1417, 30, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133266, 3840, 229, 3, 45, "Subsection"],
Cell[133498, 3845, 3748, 88, 99, "Input"]
}, Open  ]],
Cell[137261, 3936, 249, 3, 45, "Subsection"],
Cell[137513, 3941, 1189, 30, 93, "Input"],
Cell[138705, 3973, 328, 9, 32, "Input"],
Cell[139036, 3984, 726, 18, 121, "Input"],
Cell[139765, 4004, 6978, 201, 385, "Input"],
Cell[146746, 4207, 3901, 109, 187, "Input"]
}
]
*)

(* End of internal cache information *)

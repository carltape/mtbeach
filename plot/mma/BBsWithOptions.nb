(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     83282,       2029]
NotebookOptionsPosition[     80764,       1948]
NotebookOutlinePosition[     81101,       1963]
CellTagsIndexPosition[     81058,       1960]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Note that PolyListForBeachball[\[CapitalLambda], WantEllipsoids] is \
remembered; see the file AAcommonMomentTensorFns. You may have to clear it \
occasionally and reenter.\
\>", "Subsubsection",
 CellChangeTimes->{{3.857654530605132*^9, 3.8576545393985176`*^9}, {
  3.8576545738899393`*^9, 3.857654687242882*^9}, {3.8577607865023065`*^9, 
  3.8577608245012712`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "19", ",", 
     RowBox[{"-", "20"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", "id"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"35", ",", "70"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
  RowBox[{"BBrad", "=", "1"}], ";", " ", 
  RowBox[{"tkns", "=", ".006"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"BeachBall", "[", 
    RowBox[{"\[CapitalLambda]", ",", "u", ",", "c", ",", "BBrad"}], "]"}], 
   ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.54674739262261*^9, 3.5467474555843196`*^9}, {
   3.546747489670379*^9, 3.5467474928059845`*^9}, {3.546747595204563*^9, 
   3.546747680115511*^9}, {3.5467477303943987`*^9, 3.5467477874436984`*^9}, {
   3.546749587452837*^9, 3.546749611523679*^9}, {3.546750355956977*^9, 
   3.546750360605785*^9}, {3.546751230847118*^9, 3.546751233218322*^9}, {
   3.5467520384430313`*^9, 3.5467520533435574`*^9}, {3.5468748239565516`*^9, 
   3.5468748266241565`*^9}, {3.546875127595481*^9, 3.546875160776739*^9}, {
   3.5468751958768005`*^9, 3.5468751963760014`*^9}, {3.5468819079343176`*^9, 
   3.546881911257123*^9}, {3.546881941271576*^9, 3.546881977869239*^9}, {
   3.5468828201523085`*^9, 3.5468828203707085`*^9}, {3.5468849456050315`*^9, 
   3.5468849741062813`*^9}, {3.546912390478277*^9, 3.5469124053607035`*^9}, 
   3.5469124934660573`*^9, 3.5469151993638725`*^9, 3.5469156234400225`*^9, 
   3.546964329241476*^9, 3.575683900754984*^9, {3.5756840574186583`*^9, 
   3.575684071396283*^9}, {3.5920787426770315`*^9, 3.5920787704170694`*^9}, {
   3.594259503154374*^9, 3.594259511424385*^9}, {3.5942596392645617`*^9, 
   3.59425964491457*^9}, {3.594261177246703*^9, 3.594261180126707*^9}, {
   3.594262020591875*^9, 3.5942620429119062`*^9}, 3.5942622089561377`*^9, {
   3.5944819860373063`*^9, 3.594481994399319*^9}, {3.594482150757042*^9, 
   3.594482152497044*^9}, {3.5945031015865097`*^9, 3.5945031194665337`*^9}, {
   3.5945894616568804`*^9, 3.5945894730668964`*^9}, {3.85709602177164*^9, 
   3.857096036353712*^9}, {3.857403298357294*^9, 3.857403303073514*^9}, 
   3.8574033496365814`*^9, {3.85762115217535*^9, 3.8576211608003507`*^9}, {
   3.8576220798247085`*^9, 3.857622103184084*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"WantEllipsoids", "=", "False"}], ";"}],
  FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"BeachBall", "[", 
    RowBox[{"\[CapitalLambda]", ",", "u", ",", "c", ",", "BBrad"}], "]"}], 
   ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.857095594990717*^9, 3.8570955967660036`*^9}, {
   3.857096109349755*^9, 3.857096124156142*^9}, {3.857403362933255*^9, 
   3.8574033689005723`*^9}, 3.857403403407335*^9, {3.857621173568985*^9, 
   3.8576211988672905`*^9}, 3.857622124453504*^9, {3.8577613753140626`*^9, 
   3.8577613791738625`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"WantEllipsoids", "=", "True"}], ";"}],
  FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"BeachBall", "[", 
    RowBox[{"\[CapitalLambda]", ",", "u", ",", "c", ",", "BBrad"}], "]"}], 
   ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8576213777383976`*^9, 3.8576213786290474`*^9}, {
  3.857622140252664*^9, 3.8576221411589518`*^9}, {3.857761399759239*^9, 
  3.857761400330097*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["rot111 cycles the standard basis vectors :", "Subsubsection",
 CellChangeTimes->{{3.857308419534755*^9, 3.857308439630834*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rot111", ".", 
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.857308449422759*^9, 3.8573084788947625`*^9}, {
  3.8573244481207743`*^9, 3.8573245263917823`*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "rot111", "]"}]], "Input",
 CellChangeTimes->{{3.857221759321658*^9, 3.85722178113933*^9}, {
  3.857221863170643*^9, 3.8572218646586437`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The main picture.", "Subsubsection",
 CellChangeTimes->{{3.8574029655619497`*^9, 3.857403018929185*^9}, {
  3.8574030573214693`*^9, 3.8574030605642157`*^9}, {3.8576935674953313`*^9, 
  3.8576935724358163`*^9}, {3.857760852762308*^9, 3.8577608590847836`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MTpicture", "[", "M_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Mrot", "=", 
      RowBox[{"cycle", ".", "M", ".", 
       RowBox[{"Transpose", "[", "cycle", "]"}]}]}], ";", "   ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cycle", "\[NotEqual]", "id"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<cycle = \>\"", ",", 
         RowBox[{"MatrixForm", "[", "cycle", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      RowBox[{"\[CapitalLambda]ofM", "[", "M", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Uraw", "[", "Mrot", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{
          RowBox[{"Uraw", "[", "Mrot", "]"}], ".", 
          RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], ",", 
         RowBox[{"Uraw", "[", "Mrot", "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Uraw", "[", "Mrot", "]"}]}], ";", "\[IndentingNewLine]", 
     "PrintEye", ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[CapitalLambda] = \>\"", ",", 
       RowBox[{"Round", "[", 
        RowBox[{"\[CapitalLambda]", ",", ".01"}], "]"}], ",", 
       "\"\< (normalized)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cycle", "==", "id"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<u = \>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"u", ",", ".01"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"lengthPAs", ">", ".01"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Red", ",", "\"\< \>\"", ",", 
         RowBox[{"Hue", "[", ".57", "]"}], ",", "\"\< \>\"", ",", "Yellow", 
         ",", "\"\< = eigenvectors\>\""}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"e1e2e3", ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "Green", ",", "\"\< = coordinate vectors (standard basis)\>\""}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cycle", "==", "id"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<M = \>\"", ",", 
         RowBox[{"MatrixForm", "[", "M", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"ContinuousColoringOfBB", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"HueContinuous", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "u", "]"}], ".", 
                  RowBox[{"Mean", "[", "#", "]"}]}], ",", 
                 "\[CapitalLambda]"}], "]"}], ",", 
               RowBox[{"EdgeForm", "[", "]"}], ",", 
               RowBox[{"Polygon", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"u", ".", "#"}], "&"}], ",", 
              RowBox[{"SpherePolyList", "[", 
               RowBox[{
               "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5.", 
                ",", "5."}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"BeachBall", "[", 
            RowBox[{
             RowBox[{"1.", "\[CapitalLambda]"}], ",", "u", ",", "c", ",", 
             "BBrad"}], "]"}]}], "]"}], ",", "  ", 
         RowBox[{"(*", " ", 
          StyleBox[
           RowBox[{"standard", " ", "binary", " ", "coloring"}],
           FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"True", ",", 
           RowBox[{"Paxes", "[", 
            RowBox[{
            "True", ",", "True", ",", "True", ",", "u", ",", "   ", "c", ",", 
             "lengthPAs", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"WantEllipsoids", ",", "0", ",", "1"}], "]"}], 
              "BBrad"}], ",", "ArrowScale", ",", 
             RowBox[{"2", "tkns"}], ",", "\"\<TriColor\>\"", ",", 
             "ArrowColor"}], "]"}]}], "]"}], ",", "  ", 
         RowBox[{"(*", " ", 
          StyleBox["eigenvectors",
           FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"NodalCurve", ",", 
           RowBox[{"Line", "/@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"u", ".", "#"}], "&"}], ",", 
              RowBox[{"BeachBallZeroContour", "[", "\[CapitalLambda]", "]"}], 
              ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"e1e2e3", ",", 
           RowBox[{"Paxes", "[", 
            RowBox[{
            "True", ",", "True", ",", "True", ",", "id", ",", "c", ",", 
             RowBox[{"1.23", "BBrad"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"WantEllipsoids", ",", "0", ",", "1"}], "]"}], 
              "BBrad"}], ",", "ArrowScale", ",", 
             RowBox[{"2", "tkns"}], ",", "\"\<Custom\>\"", ",", "Green"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"e1e2e3", ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"cycle", ".", "Mcoords"}], ")"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"e1e2e3", ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"cycle", ".", "Mcoords"}], ")"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "18"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.4", ",", "0"}], "}"}]}], "]"}]}], "]"}], 
         ",", " ", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"e1e2e3", ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"cycle", ".", "Mcoords"}], ")"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "18"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1.4"}], "}"}]}], "]"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "ptsz", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Point", "[", 
              RowBox[{"MapEyeward", "[", 
               RowBox[{"#", ",", "ptsz", ",", "eye"}], "]"}], "]"}], "&"}], "/@",
             "PtsOnSphere"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegralCurve", "[", 
              RowBox[{"#", ",", 
               StyleBox[
                RowBox[{"unit", "[", "\[CapitalLambda]", "]"}],
                FontColor->RGBColor[1, 0, 0]], ",", "u", ",", "t", ",", 
               "ArrowScale"}], "]"}], "&"}], "/@", "PtsOnSphere"}]}], "}"}], 
         ",", "                                                         ", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GrayLevel", "[", ".7", "]"}], ",", 
           RowBox[{"Polygon", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SquareSizeFactor", "\[Times]", 
               RowBox[{
                RowBox[{"ZRot", "[", 
                 RowBox[{"#", " ", 
                  RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}]}], "&"}], "/@", 
             RowBox[{"Range", "[", "4", "]"}]}], "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
       RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "imagesize"}]}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8571604907192*^9, 3.857160516301972*^9}, {
   3.857160567742359*^9, 3.857160568962412*^9}, {3.8571606597097397`*^9, 
   3.85716068972365*^9}, 3.8571613617392526`*^9, {3.8571613966524754`*^9, 
   3.857161416172474*^9}, {3.857161459916419*^9, 3.8571614616284647`*^9}, {
   3.85716150580447*^9, 3.857161508252426*^9}, {3.857161552380366*^9, 
   3.8571615891964803`*^9}, {3.857161693917927*^9, 3.8571617826064672`*^9}, {
   3.857161851866131*^9, 3.8571618524925137`*^9}, 3.857161927756523*^9, {
   3.8571619815725613`*^9, 3.8571619835965304`*^9}, {3.857162144700551*^9, 
   3.857162145500551*^9}, {3.857162296604947*^9, 3.857162352062111*^9}, 
   3.8571623955188894`*^9, {3.857162439260578*^9, 3.8571625250045986`*^9}, {
   3.857162563628604*^9, 3.8571626576125193`*^9}, {3.85716268889262*^9, 
   3.857162694833438*^9}, {3.8571628824074755`*^9, 3.857162887070655*^9}, {
   3.857162960922331*^9, 3.857162997366878*^9}, {3.857163052374185*^9, 
   3.857163168234043*^9}, {3.8571635203203063`*^9, 3.8571636684056735`*^9}, {
   3.8571722394916925`*^9, 3.85717227555761*^9}, {3.8571723457306137`*^9, 
   3.857172386763933*^9}, {3.857172449853282*^9, 3.8571724583909383`*^9}, {
   3.8571726866197824`*^9, 3.8571726939241886`*^9}, {3.857173234415248*^9, 
   3.8571732505574894`*^9}, 3.8571737956996717`*^9, {3.8571741612427635`*^9, 
   3.8571742116216993`*^9}, {3.8573083421637545`*^9, 
   3.8573083502387457`*^9}, {3.8573086517107844`*^9, 3.857308714882827*^9}, {
   3.8573087766883197`*^9, 3.857308801214803*^9}, {3.8573088325427017`*^9, 
   3.8573088743688407`*^9}, {3.8573089835708537`*^9, 3.85730901838474*^9}, {
   3.857309057504343*^9, 3.8573090858566084`*^9}, 3.857309137234864*^9, {
   3.8573093349651814`*^9, 3.857309426444009*^9}, {3.8573094723191633`*^9, 
   3.857309487472377*^9}, {3.8573097181173987`*^9, 3.8573097249254217`*^9}, {
   3.8573098313946667`*^9, 3.8573098653275623`*^9}, 3.857309910683421*^9, {
   3.8573099792189417`*^9, 3.8573099948411336`*^9}, {3.857310099487892*^9, 
   3.8573101213611565`*^9}, {3.857310244611986*^9, 3.857310245862878*^9}, {
   3.857310279731593*^9, 3.857310280719612*^9}, {3.857310458256158*^9, 
   3.857310483874791*^9}, {3.857310539213973*^9, 3.857310564686597*^9}, {
   3.8573106937148714`*^9, 3.8573108146618156`*^9}, {3.8573108620124683`*^9, 
   3.857310869152486*^9}, {3.8573109577131424`*^9, 3.8573109589651113`*^9}, {
   3.8573135334961624`*^9, 3.8573135408043995`*^9}, {3.8573135933740377`*^9, 
   3.8573136591513653`*^9}, {3.857313696404767*^9, 3.857313834299969*^9}, 
   3.8573138846304584`*^9, {3.857315088107534*^9, 3.8573151312887583`*^9}, {
   3.8573152362952075`*^9, 3.85731525130886*^9}, {3.857315292890609*^9, 
   3.857315299697918*^9}, {3.857315433289036*^9, 3.8573154805949736`*^9}, {
   3.8573155107526026`*^9, 3.8573155818391314`*^9}, {3.8573156156238956`*^9, 
   3.857315634691348*^9}, {3.8573156711725235`*^9, 3.857315671335318*^9}, {
   3.8573157325469522`*^9, 3.8573157467474833`*^9}, {3.8573158648091974`*^9, 
   3.8573158728371816`*^9}, 3.8573159185265017`*^9, {3.857324997690056*^9, 
   3.857325028457257*^9}, {3.857325063273317*^9, 3.857325066454808*^9}, {
   3.8573253616148534`*^9, 3.8573253980068493`*^9}, {3.8573255064909077`*^9, 
   3.8573255678017006`*^9}, {3.8573256010311365`*^9, 3.857325608201672*^9}, 
   3.8573258167749124`*^9, 3.857325854870917*^9, {3.857423319124279*^9, 
   3.857423334852262*^9}, {3.8575123372871027`*^9, 3.8575123505996437`*^9}, 
   3.857512588516857*^9, {3.8575133514421425`*^9, 3.8575133551168766`*^9}, {
   3.857654866622966*^9, 3.857654868329142*^9}, {3.857654905176324*^9, 
   3.857655007139309*^9}, {3.8576550776059585`*^9, 3.8576550871391525`*^9}, {
   3.85766435815965*^9, 3.8576643729665155`*^9}, {3.8576644087803535`*^9, 
   3.8576644105179377`*^9}, 3.8576644954008503`*^9, {3.857664552708235*^9, 
   3.857664590184215*^9}, {3.857664638695225*^9, 3.8576646404324884`*^9}, {
   3.857665021842528*^9, 3.857665026574256*^9}, {3.857665329911373*^9, 
   3.857665363863894*^9}, {3.8576653950899115`*^9, 3.857665408735695*^9}, 
   3.857665501217641*^9, {3.8576656749486413`*^9, 3.857665686489683*^9}, {
   3.857665955680217*^9, 3.857666026141814*^9}, {3.8576663387022967`*^9, 
   3.857666342198863*^9}, {3.8576770640616274`*^9, 3.8576770711709995`*^9}, {
   3.8576774892483153`*^9, 3.857677500607691*^9}, {3.8576776480418167`*^9, 
   3.857677662573064*^9}, {3.8576873433566103`*^9, 3.8576873603445735`*^9}, {
   3.857687504940596*^9, 3.8576875659119067`*^9}, 3.857687964487654*^9, {
   3.857687996764659*^9, 3.8576880882325954`*^9}, {3.8576882167330904`*^9, 
   3.8576882208286867`*^9}, 3.857693509741342*^9, {3.8576942326081367`*^9, 
   3.8576942421614513`*^9}, {3.8576945907654953`*^9, 
   3.8576945959944997`*^9}, {3.857742154915057*^9, 3.8577421865913777`*^9}, {
   3.857742635791506*^9, 3.8577426427301397`*^9}, {3.857743054065094*^9, 
   3.8577430575075274`*^9}, {3.8577448515854535`*^9, 
   3.8577448823925343`*^9}, {3.8577464579939814`*^9, 3.857746459229015*^9}, 
   3.8577465783503923`*^9, 3.8577467675789137`*^9, {3.8577493606590652`*^9, 
   3.8577494041238623`*^9}, {3.8578266040222073`*^9, 
   3.8578266065936503`*^9}, {3.8578266692069006`*^9, 3.857826671768295*^9}, {
   3.8578268533850355`*^9, 3.857826858068601*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
   RowBox[{"BBrad", "=", "1"}], ";", 
   RowBox[{"ArrowScale", "=", ".12"}], ";", 
   RowBox[{"tkns", "=", ".005"}], ";", 
   RowBox[{"ptsz", "=", ".006"}], ";"}], " "}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "2", "0"},
      {"0", "0", "5"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cycle", "=", "id"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mcoords", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<up\>\"", ",", "\"\<S\>\"", ",", "\"\<E\>\""}], "}"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"right", "-", "handed"}], ",", " ", 
     RowBox[{
     "must", " ", "be", " ", "consistent", " ", "with", " ", "your", " ", 
      "given", " ", "M"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"20", ",", "65"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ContinuousColoringOfBB", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PtsOnSphere", "=", 
    RowBox[{"{", "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"IntegralCurve", " ", "is", " ", "defined", " ", 
     RowBox[{"later", ".", " ", "Do"}], " ", "not", " ", "set", " ", 
     "PtsOnSphere", " ", "other", " ", "than", " ", "empty", " ", "until", 
     " ", "then"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1e2e3", "=", "True"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "standard", " ", "basis", " ", "vectors", " ", "as", " ", "understood", 
     " ", "by", " ", "Mathematica"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SquareSizeFactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"1.43", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NodalCurve", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesize", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.857621546629805*^9, 3.857621559051715*^9}, {
   3.8576216425719643`*^9, 3.8576216434782505`*^9}, {3.857655171141938*^9, 
   3.8576551880482597`*^9}, {3.8576552277602954`*^9, 3.857655272882909*^9}, {
   3.857655404590947*^9, 3.8576554065446863`*^9}, {3.8576559757176857`*^9, 
   3.857656000022091*^9}, {3.8576644272587433`*^9, 3.857664452116145*^9}, 
   3.857664489866218*^9, {3.857664603854568*^9, 3.857664607514202*^9}, {
   3.8576646831526456`*^9, 3.857664702900834*^9}, {3.857665678175889*^9, 
   3.8576657078782773`*^9}, {3.8576657809581738`*^9, 
   3.8576657814599915`*^9}, {3.85767703996329*^9, 3.857677059153858*^9}, {
   3.857677164331679*^9, 3.857677208506496*^9}, {3.8576772608189955`*^9, 
   3.857677281272073*^9}, {3.857677459373317*^9, 3.8576775071701903`*^9}, 
   3.8576776548543143`*^9, 3.8576873472898684`*^9, 3.857687501708541*^9, 
   3.8576882051086845`*^9, 3.8576935034369755`*^9, 3.8576936260873384`*^9, {
   3.8576936812235775`*^9, 3.857693690391181*^9}, {3.857693739721407*^9, 
   3.857693794519552*^9}, {3.857693888985388*^9, 3.857693891479328*^9}, {
   3.8577422067603173`*^9, 3.857742239472324*^9}, {3.8577426733901753`*^9, 
   3.8577426796117067`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
cycle = Transpose[rot111]  rotates the previous picture, other than the \
horizontal square, about (1, 1, 1)\
\>", "Subsubsection",
 CellChangeTimes->{{3.8576960288156757`*^9, 3.8576960650216722`*^9}, {
  3.857742093637848*^9, 3.8577420964482985`*^9}, {3.8577429530142746`*^9, 
  3.8577429565482893`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "2", "0"},
      {"0", "0", "5"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cycle", "=", 
    RowBox[{"Transpose", "[", "rot111", "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.8576554136688347`*^9, 3.857655453065227*^9}, 
   3.857655497398098*^9, 3.857677655791848*^9, 3.857687348224315*^9, 
   3.8576882064244204`*^9, 3.85769350474934*^9, {3.8576939404553785`*^9, 
   3.8576939545353804`*^9}, {3.857693989159385*^9, 3.857693990102165*^9}, {
   3.8576940324233904`*^9, 3.8576940666796403`*^9}, {3.8576940975436573`*^9, 
   3.857694098246196*^9}, 3.857742559146197*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Illustrating continuous coloring. 
Includes nodal curve :\
\>", "Subsubsection",
 CellChangeTimes->{{3.8576960288156757`*^9, 3.8576960650216722`*^9}, {
  3.857696098071653*^9, 3.8576961232716556`*^9}, {3.857753601092494*^9, 
  3.857753612586097*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"5", "0", "0"},
      {"0", "1", "0"},
      {"0", "0", 
       RowBox[{"-", "3"}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"20", ",", "65"}], "}"}], "]"}]}]}], ";", 
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"50", ",", "65"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cycle", "=", "id"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mcoords", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1e2e3", "=", "False"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ContinuousColoringOfBB", "=", "True"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "ContinuousColoringOfBB", " ", "will", " ", "give", " ", "a", " ", 
     "spherical", " ", "BB", " ", "even", " ", "if", " ", "WantEllipsoids", 
     " ", "is", " ", "True"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NodalCurve", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SquareSizeFactor", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{
  3.857694719815615*^9, {3.8576948181834908`*^9, 3.857694832055492*^9}, {
   3.8576948985525284`*^9, 3.857694927016575*^9}, {3.857694986247512*^9, 
   3.8576949944075027`*^9}, {3.857695154375533*^9, 3.8576951639115343`*^9}, {
   3.8577423968186445`*^9, 3.857742401851754*^9}, {3.857742703239627*^9, 
   3.8577427131591983`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"%", ",", 
   StyleBox[
    RowBox[{"Lighting", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}],
    FontColor->RGBColor[1, 0, 0]]}], 
  StyleBox["]",
   FontColor->RGBColor[1, 0, 0]]}]], "Input",
 CellChangeTimes->{{3.8576951930288577`*^9, 3.8576952057035394`*^9}, {
  3.857695301192979*^9, 3.8576953039928493`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Julien\[CloseCurlyQuote]s:", "Subsection",
 CellChangeTimes->{{3.8571604187723184`*^9, 3.8571604313409023`*^9}, {
  3.857163766773038*^9, 3.857163801063141*^9}, {3.8573270701510715`*^9, 
  3.8573270737350717`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"230.00", "45.935", 
       RowBox[{"-", "2.0487"}]},
      {"45.935", "118.32", "10.898"},
      {
       RowBox[{"-", "2.0487"}], "10.898", "109.59"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cycle", "=", "id"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mcoords", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<up\>\"", ",", "\"\<S\>\"", ",", "\"\<E\>\""}], "}"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"right", "-", "handed"}], ",", " ", 
     RowBox[{
     "must", " ", "be", " ", "consistent", " ", "with", " ", "your", " ", 
      "given", " ", "M"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"20", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"20", ",", "65"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tkns", "=", ".0035"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ContinuousColoringOfBB", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PtsOnSphere", "=", 
    RowBox[{"{", "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"IntegralCurve", " ", "is", " ", "defined", " ", 
     RowBox[{"later", ".", " ", "Do"}], " ", "not", " ", "set", " ", 
     "PtsOnSphere", " ", "other", " ", "than", " ", "empty", " ", "until", 
     " ", "then"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1e2e3", "=", "True"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "standard", " ", "basis", " ", "vectors", " ", "as", " ", "understood", 
     " ", "by", " ", "Mathematica"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SquareSizeFactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"1.43", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NodalCurve", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesize", "=", "350"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{
  3.8576563226925707`*^9, 3.857677658198064*^9, 3.857687351404559*^9, 
   3.857688210677103*^9, 3.8576935059735174`*^9, 3.8576944502493935`*^9, 
   3.8576954460106044`*^9, {3.8576955823915777`*^9, 3.8576955849675875`*^9}, {
   3.857695650519596*^9, 3.857695672552065*^9}, {3.8576957115596037`*^9, 
   3.857695735751565*^9}, {3.857695792185034*^9, 3.8576958071097336`*^9}, {
   3.857742446624107*^9, 3.8577424505696597`*^9}, {3.8577427904830236`*^9, 
   3.8577427971531086`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"230.00", "45.935", 
       RowBox[{"-", "2.0487"}]},
      {"45.935", "118.32", "10.898"},
      {
       RowBox[{"-", "2.0487"}], "10.898", "109.59"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cycle", "=", 
   RowBox[{"Transpose", "[", "rot111", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.8573253327908506`*^9, 3.8573253412697554`*^9}, {
   3.8573256526148915`*^9, 3.857325685011279*^9}, {3.8573257343109016`*^9, 
   3.8573257407429028`*^9}, {3.857325922695198*^9, 3.8573259313834295`*^9}, {
   3.857656685723028*^9, 3.8576566905086164`*^9}, 3.85767765899494*^9, 
   3.8576873531883945`*^9, 3.857688211435507*^9, 3.8576935066933575`*^9, {
   3.857695868809568*^9, 3.8576958845846596`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"%", ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"20", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"50", ",", "65"}], "}"}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8573271226911125`*^9, 3.8573271642630835`*^9}, 
   3.857656974701629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Integral  curves of the vector field.  
At each point on the curve the vector field is tangent to the curve.\
\>", "Subsection",
 CellChangeTimes->{{3.857657321415196*^9, 3.8576573406687365`*^9}, {
  3.8577439474913454`*^9, 3.857743997332946*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RadialComponent", "[", 
    RowBox[{"v_", ",", "\[CapitalLambda]_", ",", "u_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"LamSubU", "[", 
       RowBox[{"\[CapitalLambda]", ",", "u"}], "]"}], ".", "v"}], ")"}], ".", 
    "v"}]}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"v", " ", "is", " ", "unit", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vSoln", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     ",", "v0_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]1", "*", "t"}], "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", "*", "t"}], "]"}], ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]3", "*", "t"}], "]"}]}], "}"}], "]"}], ".", 
    "v0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vSoln", "[", 
    RowBox[{"t_", ",", "\[CapitalLambda]_", ",", "u_", ",", "v0_"}], "]"}], ":=", 
   RowBox[{"u", ".", 
    RowBox[{"vSoln", "[", 
     RowBox[{"t", ",", "\[CapitalLambda]", ",", 
      RowBox[{
       RowBox[{"Transpose", "[", "u", "]"}], ".", "v0"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegralCurve", "[", 
    RowBox[{
    "v_", ",", "\[CapitalLambda]_", ",", "u_", ",", "t0_", ",", 
     "ArrowScale_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"length", "[", 
       RowBox[{
        RowBox[{"LamSubU", "[", 
         RowBox[{"\[CapitalLambda]", ",", "u"}], "]"}], ".", "v"}], "]"}], 
      ">", ".05"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RadialComponent", "[", 
         RowBox[{"v", ",", "\[CapitalLambda]", ",", "u"}], "]"}], ">", 
        ".000000001"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
           RowBox[{"Hue", "[", 
            RowBox[{".01", ",", "1", ",", ".4"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vSoln", "[", 
               RowBox[{"#", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], 
               "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"tMaxforOutgoingCurve", "[", 
                RowBox[{
                "v", ",", "\[CapitalLambda]", ",", "u", ",", "t0", ",", 
                 "ArrowScale"}], "]"}], ",", 
               RowBox[{".1", 
                RowBox[{"tMaxforOutgoingCurve", "[", 
                 RowBox[{
                 "v", ",", "\[CapitalLambda]", ",", "u", ",", "t0", ",", 
                  "ArrowScale"}], "]"}]}]}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Hue", "[", 
            RowBox[{".01", ",", ".9", ",", "1"}], "]"}], ",", 
           RowBox[{"Arrow3D", "[", 
            RowBox[{
             RowBox[{"vSoln", "[", 
              RowBox[{"t0", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], 
              "]"}], ",", 
             RowBox[{
              RowBox[{"LamSubU", "[", 
               RowBox[{"\[CapitalLambda]", ",", "u"}], "]"}], ".", 
              RowBox[{"vSoln", "[", 
               RowBox[{"t0", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], 
               "]"}]}], ",", "ArrowScale"}], "]"}]}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RadialComponent", "[", 
           RowBox[{"v", ",", "\[CapitalLambda]", ",", "u"}], "]"}], "<", 
          RowBox[{"-", ".000000001"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
             RowBox[{"Hue", "[", 
              RowBox[{".15", ",", "1", ",", ".7"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vSoln", "[", 
                 RowBox[{"#", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], 
                 "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"tMinforIncomingCurve", "[", 
                  RowBox[{
                  "v", ",", "\[CapitalLambda]", ",", "u", ",", "t0", ",", 
                   "ArrowScale"}], "]"}], ",", 
                 RowBox[{"-", "t0"}], ",", 
                 RowBox[{
                  RowBox[{"-", ".1"}], "t0"}]}], "]"}]}], "]"}]}], "}"}], ",",
            " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Hue", "[", 
              RowBox[{".15", ",", ".9", ",", "1"}], "]"}], ",", 
             RowBox[{"Arrow3D", "[", 
              RowBox[{"v", ",", 
               RowBox[{
                RowBox[{"LamSubU", "[", 
                 RowBox[{"\[CapitalLambda]", ",", "u"}], "]"}], ".", "v"}], 
               ",", "ArrowScale"}], "]"}]}], "}"}]}], "}"}]}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tMaxforOutgoingCurve", "[", 
    RowBox[{
    "v_", ",", "\[CapitalLambda]_", ",", "u_", ",", "t0_", ",", 
     "ArrowScale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{".02", "t0"}], ",", "t0", ",", 
        RowBox[{".02", "t0"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"length", "[", 
         RowBox[{
          RowBox[{"vSoln", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], "]"}], 
          "-", 
          RowBox[{"vSoln", "[", 
           RowBox[{"t0", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], 
           "]"}]}], "]"}], "<", "ArrowScale"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tMinforIncomingCurve", "[", 
     RowBox[{
     "v_", ",", "\[CapitalLambda]_", ",", "u_", ",", "t0_", ",", 
      "ArrowScale_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", ".4"}], "t0"}], ",", 
         RowBox[{
          RowBox[{"-", ".02"}], "t0"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"vSoln", "[", 
            RowBox[{"#", ",", "\[CapitalLambda]", ",", "u", ",", "v"}], "]"}],
            "-", "v"}], "]"}], "<", "ArrowScale"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "tMin", " ", "is", " ", "NEGATIVE", " ", "of", " ", "min", " ", "of", " ",
      "absolute", " ", "value"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5943976731330385`*^9, 3.594397826117751*^9}, {
   3.5943979088373675`*^9, 3.594397949287423*^9}, {3.594398245877341*^9, 
   3.594398247657343*^9}, {3.5943982782473855`*^9, 3.5943983121349325`*^9}, {
   3.594398454395129*^9, 3.594398501935195*^9}, {3.5943986017593355`*^9, 
   3.594398637679385*^9}, {3.594398889213239*^9, 3.5943989149932747`*^9}, {
   3.5943990269529305`*^9, 3.5943990830030084`*^9}, {3.594399136218082*^9, 
   3.5943993488638806`*^9}, 3.5943994375135045`*^9, {3.5943995692251897`*^9, 
   3.5943995713151927`*^9}, {3.5943997348224196`*^9, 3.594399735794921*^9}, {
   3.594399766794964*^9, 3.594399774774975*^9}, {3.594400168120524*^9, 
   3.5944002314626126`*^9}, {3.594400270862667*^9, 3.594400350777279*^9}, {
   3.5944003838873253`*^9, 3.5944004020093513`*^9}, 3.594400828996942*^9, {
   3.5944369235202055`*^9, 3.5944369928923025`*^9}, 3.5945040848608847`*^9, {
   3.5945231860845704`*^9, 3.5945231883145733`*^9}, {3.5945232274571276`*^9, 
   3.5945232799147005`*^9}, {3.711130025942385*^9, 3.711130038966134*^9}, {
   3.711130070613947*^9, 3.7111300720060263`*^9}, {3.7111301470133133`*^9, 
   3.7111301497644763`*^9}, {3.711130193189966*^9, 3.711130196006113*^9}, {
   3.7111302368374653`*^9, 3.7111302595567665`*^9}, {3.7111303189331665`*^9, 
   3.711130324900506*^9}, {3.711130376037434*^9, 3.711130377061493*^9}, {
   3.711130431076589*^9, 3.7111304485335855`*^9}, {3.71113049901348*^9, 
   3.7111305162604675`*^9}, 3.7111307753363037`*^9, {3.711130891140933*^9, 
   3.711130905028731*^9}, {3.711130977510882*^9, 3.7111309947098637`*^9}, {
   3.711131030373909*^9, 3.7111310697181587`*^9}, {3.7111312294453096`*^9, 
   3.7111312509645386`*^9}, {3.711131394517759*^9, 3.7111314520050545`*^9}, 
   3.7111315637824554`*^9, {3.71113162051871*^9, 3.711131689732665*^9}, {
   3.7111317199853973`*^9, 3.7111317528382826`*^9}, {3.711131934149665*^9, 
   3.7111319370448275`*^9}, 3.7111322732390804`*^9, 3.7111324168383036`*^9, {
   3.711132584710921*^9, 3.7111325857339664`*^9}, {3.7111326246652083`*^9, 
   3.711132628117403*^9}, {3.711136380160833*^9, 3.7111363877432666`*^9}, {
   3.711136463407603*^9, 3.711136470366001*^9}, 3.7111365319345326`*^9, {
   3.711136826975423*^9, 3.71113682871852*^9}, {3.711137063919989*^9, 
   3.71113707876784*^9}, {3.7111372905119705`*^9, 3.7111372911190033`*^9}, 
   3.7111374278558335`*^9, {3.7111395049597793`*^9, 3.711139560557966*^9}, {
   3.7111395963190136`*^9, 3.7111396086547174`*^9}, {3.711139942974863*^9, 
   3.711139944510951*^9}, {3.711139984079217*^9, 3.711140010494722*^9}, {
   3.7111400755344567`*^9, 3.7111401273594255`*^9}, {3.7111402580789013`*^9, 
   3.7111402603660417`*^9}, 3.7111412145756826`*^9, {3.711141263167469*^9, 
   3.711141266815675*^9}, {3.711141376959984*^9, 3.711141383247345*^9}, {
   3.7111414743035593`*^9, 3.7111414935986643`*^9}, 3.7111415240794106`*^9, {
   3.711160480254279*^9, 3.7111604877227097`*^9}, {3.711160918197362*^9, 
   3.711160923546668*^9}, {3.7111609776427565`*^9, 3.7111609972588897`*^9}, {
   3.7111621516259966`*^9, 3.7111622490825744`*^9}, 3.7111626374198213`*^9, {
   3.7111629788273673`*^9, 3.7111629799324226`*^9}, 3.7111630520275574`*^9, 
   3.711163206123372*^9, 3.711163351611712*^9, {3.7112082310636005`*^9, 
   3.7112082367199106`*^9}}],

Cell[CellGroupData[{

Cell["\<\
PtsOnSphere will be the points where the integral curves touch the sphere.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8577437314178123`*^9, 3.857743779139608*^9}}],

Cell["\<\
This paragraph is just a preliminary test to look at your points of the \
sphere.\
\>", "Text",
 CellChangeTimes->{{3.594590383473466*^9, 3.594590410065504*^9}, 
   3.600032812453096*^9},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"50.", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"90", ",", "70"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"LamSubU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"19", ",", "1", ",", 
       RowBox[{"-", "20"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"zrot", "[", "30", "]"}], ".", 
      RowBox[{"yrot", "[", "20.", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrePtsOnSphere", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xyztp", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "30.", ",", "150", ",", "15"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "15.", ",", "360", ",", "15"}], "}"}]}], 
        "]"}], ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
     "                           ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xyztp", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "15.", ",", "165", ",", "150"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "15.", ",", "360", ",", "30"}], "}"}]}], 
        "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsOnSphere", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Uraw", "[", "M", "]"}], ".", 
      RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
    "PrePtsOnSphere"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", "   ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BeachballForM", "[", 
      RowBox[{"M", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
       "This", " ", "diagram", " ", "is", " ", "just", " ", "to", " ", "see", 
        " ", "if", " ", "the", " ", "choice", " ", "of", " ", "PtsOnSphere", 
        " ", "is", " ", 
        RowBox[{"reasonable", ".", " ", "Change"}], " ", "as", " ", 
        "desired"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", ".011", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"MapEyeward", "[", 
           RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "]"}], "&"}], "/@", 
        "PtsOnSphere"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.594410861837532*^9, 3.594411111151382*^9}, {
   3.594411150473936*^9, 3.594411156053944*^9}, {3.594411215375529*^9, 
   3.5944112182555327`*^9}, {3.594411255825585*^9, 3.5944113426902065`*^9}, {
   3.594412173050868*^9, 3.5944121761108723`*^9}, 3.5944133008849387`*^9, {
   3.5944150414605784`*^9, 3.594415044550583*^9}, {3.594417024734932*^9, 
   3.5944170258749337`*^9}, {3.594417067248994*^9, 3.5944171110865545`*^9}, {
   3.594417164534129*^9, 3.5944171901661654`*^9}, {3.594417223126211*^9, 
   3.5944172297062197`*^9}, 3.5944173147883387`*^9, {3.5944173596244044`*^9, 
   3.5944173806044335`*^9}, {3.5944174115744762`*^9, 
   3.5944174449345226`*^9}, {3.5944174970265956`*^9, 3.5944175004166*^9}, {
   3.5944177390019364`*^9, 3.594417743781943*^9}, 3.5944177912340107`*^9, {
   3.5944182210131083`*^9, 3.5944183041832237`*^9}, {3.594418862796505*^9, 
   3.59441887386652*^9}, {3.594418926571593*^9, 3.5944189624616423`*^9}, {
   3.5944189925916843`*^9, 3.59441912612887*^9}, {3.5944191573014135`*^9, 
   3.5944192483065395`*^9}, {3.5944193864612317`*^9, 
   3.5944195176184225`*^9}, {3.5944305551087923`*^9, 
   3.5944305729488163`*^9}, {3.594430625722892*^9, 3.5944306687829514`*^9}, 
   3.594431580855241*^9, {3.594431929951727*^9, 3.5944319879153137`*^9}, {
   3.5944320548279057`*^9, 3.5944320986504664`*^9}, {3.5944325234565587`*^9, 
   3.594432538266579*^9}, {3.594433574719528*^9, 3.59443358302954*^9}, {
   3.594434183366378*^9, 3.5944342026864047`*^9}, {3.5944350179035473`*^9, 
   3.5944350243435564`*^9}, {3.5944358209566703`*^9, 3.594435840936698*^9}, {
   3.594437720025321*^9, 3.594437872245531*^9}, {3.5944385270764465`*^9, 
   3.5944385318184547`*^9}, {3.5945201805898476`*^9, 3.594520207009884*^9}, {
   3.594590426645527*^9, 3.5945904790430994`*^9}, {3.7111306006302853`*^9, 
   3.711130601540351*^9}, {3.711138330894548*^9, 3.711138333279684*^9}, {
   3.7111581408838806`*^9, 3.711158142008847*^9}, {3.711158400165638*^9, 
   3.711158435118831*^9}, {3.711207659828122*^9, 3.7112076696718845`*^9}, {
   3.739202991378652*^9, 3.7392030312066746`*^9}, 3.739203609642705*^9, {
   3.857657471302949*^9, 3.857657476568128*^9}, {3.8577460415802655`*^9, 
   3.857746058469271*^9}, {3.857747607800786*^9, 3.8577476369315276`*^9}, {
   3.8577476796957674`*^9, 3.857747715149359*^9}, 3.8577477452052164`*^9, {
   3.8577477826361675`*^9, 3.8577477947628336`*^9}, {3.8577480070923276`*^9, 
   3.8577480105731473`*^9}, {3.857748046271964*^9, 3.8577480510200853`*^9}, {
   3.8577480828581133`*^9, 3.857748084579836*^9}, 3.8577481199459896`*^9, {
   3.857748251295438*^9, 3.857748257717431*^9}, {3.857748296972351*^9, 
   3.8577483040418544`*^9}, {3.8577483447501926`*^9, 
   3.8577483510031223`*^9}, {3.857748400508767*^9, 3.8577484272390404`*^9}, {
   3.8577488321397724`*^9, 3.8577488433304615`*^9}, {3.8577537397946587`*^9, 
   3.8577537536262245`*^9}, {3.857754001111436*^9, 3.857754096004779*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"50.", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"90", ",", "70"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrowScale", "=", ".13"}], ";", 
   RowBox[{"tkns", "=", ".003"}], ";", 
   RowBox[{"ptsz", "=", ".006"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "probably", " ", "no", " ", "need", " ", "to", " ", "change", " ", 
     "these", " ", "much"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"LamSubU", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"19", ",", "1", ",", 
       RowBox[{"-", "20"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"zrot", "[", "30", "]"}], ".", 
      RowBox[{"yrot", "[", "20.", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cycle", "=", "id"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ContinuousColoringOfBB", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"2", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1e2e3", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SquareSizeFactor", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NodalCurve", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsOnSphere", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Uraw", "[", "M", "]"}], ".", 
      RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
    "PrePtsOnSphere"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "=", ".8"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Important", ";", " ", 
      RowBox[{
      "t", " ", "determines", " ", "how", " ", "much", " ", "of", " ", "the", 
       " ", "vector", " ", "field", " ", "to", " ", 
       RowBox[{"show", ".", " ", "If"}], " ", "the", " ", "diagram", " ", 
       "looks", " ", "screwy"}]}], ",", " ", 
     RowBox[{"try", " ", "changing", " ", "t"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesize", "=", "400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.857621546629805*^9, 3.857621559051715*^9}, {
   3.8576216425719643`*^9, 3.8576216434782505`*^9}, {3.857655171141938*^9, 
   3.8576551880482597`*^9}, {3.8576552277602954`*^9, 3.857655272882909*^9}, {
   3.857655404590947*^9, 3.8576554065446863`*^9}, {3.8576559757176857`*^9, 
   3.857656000022091*^9}, {3.857659799104785*^9, 3.8576598331390915`*^9}, {
   3.8576599140537863`*^9, 3.857659919896866*^9}, 3.857659956917735*^9, {
   3.8576640536180706`*^9, 3.857664104885334*^9}, {3.8576647504662066`*^9, 
   3.8576647902470927`*^9}, 3.857665683965366*^9, {3.8576660728236094`*^9, 
   3.8576661862964272`*^9}, {3.8576776597918243`*^9, 
   3.8576776609168105`*^9}, {3.8576873545411625`*^9, 3.857687356428342*^9}, {
   3.8576882133966856`*^9, 3.8576882153893113`*^9}, 3.8576935074453616`*^9, {
   3.8577425181380696`*^9, 3.857742522051055*^9}, 3.857743221556506*^9, {
   3.8577432658404493`*^9, 3.857743271297584*^9}, 3.8577433212579117`*^9, {
   3.857743542171318*^9, 3.857743557370613*^9}, 3.857744475556137*^9, 
   3.8577460888828554`*^9, {3.8577486197681284`*^9, 3.8577486208563404`*^9}, {
   3.8577486533843126`*^9, 3.8577486647228436`*^9}, 3.857748745022596*^9, 
   3.857748858210272*^9, {3.8577488983637295`*^9, 3.857748943230646*^9}, {
   3.8577537906071215`*^9, 3.8577538176982183`*^9}, {3.8577539206148105`*^9, 
   3.8577539284093695`*^9}, 3.8577541156174407`*^9, {3.857754146963763*^9, 
   3.8577541508390226`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", "0", "0"},
      {"0", "0", 
       RowBox[{"-", "1"}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"50.", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"60", ",", "70"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"2", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PtsOnSphere", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Uraw", "[", "M", "]"}], ".", 
       RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
     "PrePtsOnSphere"}]}], ";"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "=", ".8"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Important", ";", " ", 
      RowBox[{
      "t", " ", "determines", " ", "how", " ", "much", " ", "of", " ", "the", 
       " ", "vector", " ", "field", " ", "to", " ", 
       RowBox[{"show", ".", " ", "If"}], " ", "the", " ", "diagram", " ", 
       "looks", " ", "screwy"}]}], ",", " ", 
     RowBox[{"try", " ", "changing", " ", "t"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.857621546629805*^9, 3.857621559051715*^9}, {
   3.8576216425719643`*^9, 3.8576216434782505`*^9}, {3.857655171141938*^9, 
   3.8576551880482597`*^9}, {3.8576552277602954`*^9, 3.857655272882909*^9}, {
   3.857655404590947*^9, 3.8576554065446863`*^9}, {3.8576559757176857`*^9, 
   3.857656000022091*^9}, {3.857659799104785*^9, 3.8576598331390915`*^9}, {
   3.8576599140537863`*^9, 3.857659919896866*^9}, 3.857659956917735*^9, {
   3.8576640536180706`*^9, 3.857664104885334*^9}, {3.8576647504662066`*^9, 
   3.8576647902470927`*^9}, 3.857665683965366*^9, {3.8576660728236094`*^9, 
   3.8576661862964272`*^9}, {3.8576776597918243`*^9, 
   3.8576776609168105`*^9}, {3.8576873545411625`*^9, 3.857687356428342*^9}, {
   3.8576882133966856`*^9, 3.8576882153893113`*^9}, 3.8576935074453616`*^9, {
   3.8577425181380696`*^9, 3.857742522051055*^9}, 3.857743221556506*^9, {
   3.8577432658404493`*^9, 3.857743271297584*^9}, 3.8577433212579117`*^9, {
   3.857743542171318*^9, 3.857743557370613*^9}, 3.857744475556137*^9, {
   3.8577449955506897`*^9, 3.857745000921788*^9}, {3.8577450752268114`*^9, 
   3.8577450862167377`*^9}, {3.857745164829966*^9, 3.857745201541959*^9}, 
   3.8577461108340616`*^9, {3.8577497457442956`*^9, 3.857749774058262*^9}, {
   3.8577498387659273`*^9, 3.857749839483506*^9}, {3.8577541739718323`*^9, 
   3.8577541834187512`*^9}, {3.857761626546646*^9, 3.8577616307057867`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"3", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", 
        RowBox[{"-", "2"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"50.", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"50", ",", "70"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"2", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PtsOnSphere", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Uraw", "[", "M", "]"}], ".", 
       RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
     "PrePtsOnSphere"}]}], ";"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.5945899924854193`*^9, 3.5945900132554483`*^9}, {
   3.5945900763600364`*^9, 3.594590123810102*^9}, {3.594590163432657*^9, 
   3.59459016570266*^9}, {3.5945901992847075`*^9, 3.59459027052831*^9}, 
   3.5945903019683533`*^9, 3.594590694376901*^9, {3.711132122500448*^9, 
   3.711132149491994*^9}, {3.7111385309420033`*^9, 3.7111385355822663`*^9}, {
   3.711138601487047*^9, 3.7111386126386786`*^9}, 3.711139735315981*^9, {
   3.7111409623022394`*^9, 3.7111409839494753`*^9}, {3.711163633737869*^9, 
   3.71116363457092*^9}, {3.711208999237027*^9, 3.7112090244714513`*^9}, {
   3.857744642358847*^9, 3.8577446802861958`*^9}, 3.857744743650156*^9, {
   3.8577448171209407`*^9, 3.8577448238588963`*^9}, 3.8577461307569633`*^9, 
   3.8577498603076286`*^9, 3.857750022155719*^9, 3.85775419410015*^9, {
   3.8577616729576225`*^9, 3.8577616776267223`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"3", "0", "0"},
      {"0", "1", "0"},
      {"0", "0", 
       RowBox[{"-", "2"}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"50.", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"60", ",", "70"}], "}"}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", ".13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"2", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsOnSphere", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Uraw", "[", "M", "]"}], ".", 
      RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
    "PrePtsOnSphere"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", ".8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MTpicture", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.857750616223895*^9, 3.8577506776284885`*^9}, {
  3.857754209353773*^9, 3.8577542108746386`*^9}, {3.857754888369399*^9, 
  3.8577549292103324`*^9}, {3.857755056887823*^9, 3.857755061703581*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\"Radiation pattern\"
Compare with previous diagram.\
\>", "Subsection",
 CellChangeTimes->{{3.739232623554*^9, 3.7392326461164427`*^9}, {
  3.8577557294663916`*^9, 3.857755746710616*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"3", "0", "0"},
      {"0", "1", "0"},
      {"0", "0", 
       RowBox[{"-", "2"}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", "M", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", 
   RowBox[{".12", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PrintEye", ";", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"M", ".", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ">", "0"}], ",", 
            RowBox[{"Hue", "[", ".01", "]"}], ",", 
            RowBox[{"GrayLevel", "[", ".95", "]"}]}], "]"}], ",", 
          RowBox[{"Polygon", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"M", ".", "#"}], ")"}], ".", "#"}], ")"}], "#"}], "&"}],
          ",", 
         RowBox[{"SpherePolyList", "[", 
          RowBox[{
          "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5", ",", 
           "5"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Paxes", "[", 
       RowBox[{"True", ",", "True", ",", "True", ",", 
        RowBox[{"Uraw", "[", "M", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"1.25", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Abs", "[", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Abs", "[", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ",", "0", ",", 
        "ArrowScale", ",", 
        RowBox[{"1.5", "tkns"}], ",", "\"\<TriColor\>\"", ",", "ArrowColor"}],
        "]"}]}], "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
    RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7392042355019894`*^9, 3.739204353454818*^9}, {
   3.739204406235935*^9, 3.739204438548354*^9}, {3.739204494579469*^9, 
   3.7392045498918257`*^9}, {3.739204589688599*^9, 3.7392045990948257`*^9}, {
   3.7392047169539037`*^9, 3.739204749031948*^9}, {3.7392047899380956`*^9, 
   3.739204810547408*^9}, {3.739204889953469*^9, 3.739204896000328*^9}, {
   3.739204958031423*^9, 3.7392049852344785`*^9}, {3.7392050554530582`*^9, 
   3.739205066437388*^9}, {3.7392051021560607`*^9, 3.739205151312189*^9}, {
   3.7392052046557913`*^9, 3.7392053667960243`*^9}, {3.739205401889682*^9, 
   3.739205439264594*^9}, {3.7392055122644043`*^9, 3.7392055385299635`*^9}, {
   3.739205579373619*^9, 3.739205640092208*^9}, {3.739205864841647*^9, 
   3.739205874232253*^9}, 3.7392059122321367`*^9, {3.739206185418962*^9, 
   3.7392061874033327`*^9}, {3.7392062199813747`*^9, 3.739206240981311*^9}, 
   3.739206323637353*^9, {3.8577545111961136`*^9, 3.8577545175346155`*^9}, {
   3.857754553594881*^9, 3.8577545879443007`*^9}, {3.857754720735587*^9, 
   3.8577547450206175`*^9}, {3.857755081077404*^9, 3.8577550827458935`*^9}, {
   3.857755142936675*^9, 3.8577552782348876`*^9}, {3.8577553180029774`*^9, 
   3.857755327288993*^9}, {3.8577554899664173`*^9, 3.8577554909856215`*^9}, {
   3.8577555728891106`*^9, 3.857755579744961*^9}, 3.8577556750034695`*^9}],

Cell[CellGroupData[{

Cell["\<\
Relation between the ellipsoid and radiation pattern. If you rotate with the \
mouse, you will see that the two agree on the principal axes.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7392114824288254`*^9, 3.7392115768192244`*^9}, {
  3.8577602800862627`*^9, 3.8577602974315033`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"5", "0", "0"},
      {"0", "2", "0"},
      {"0", "0", "1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", "M", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"20", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{"80", ",", "80"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", 
   RowBox[{".13", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BeachBall", "[", 
      RowBox[{
       RowBox[{"1.", "\[CapitalLambda]"}], ",", "id", ",", "c", ",", 
       RowBox[{
        StyleBox[
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Abs", "[", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Abs", "[", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}],
         FontColor->RGBColor[1, 0, 0]], "BBrad"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FaceForm", "[", "]"}], ",", 
         RowBox[{"Polygon", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M", ".", "#"}], ")"}], ".", "#"}], ")"}], "#"}], "&"}], 
        ",", 
        RowBox[{"SpherePolyList", "[", 
         RowBox[{
         "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5", ",", 
          "5"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Paxes", "[", 
      RowBox[{"True", ",", "True", ",", "True", ",", 
       RowBox[{"Uraw", "[", "M", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"1.25", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Abs", "[", 
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ",", "0", ",", 
       "ArrowScale", ",", 
       RowBox[{"1.5", "tkns"}], ",", "\"\<TriColor\>\"", ",", "ArrowColor"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.857756871368402*^9, 3.857756887451557*^9}, {
   3.857756954018505*^9, 3.857757008255305*^9}, {3.8577570470275126`*^9, 
   3.857757048109309*^9}, {3.8577571048878937`*^9, 3.85775711390303*^9}, {
   3.857757174914645*^9, 3.857757206822857*^9}, 3.857757267233554*^9, {
   3.857757474366158*^9, 3.857757486238346*^9}, 3.857757648935012*^9, {
   3.8577583442177367`*^9, 3.857758346841996*^9}, 3.8577585115851936`*^9, {
   3.8577585879289017`*^9, 3.8577585888947554`*^9}, {3.857758623214216*^9, 
   3.8577586984087825`*^9}, {3.85775877376816*^9, 3.857758804110633*^9}, 
   3.8577588388041053`*^9, {3.857760312568614*^9, 3.857760347305328*^9}, {
   3.857760474081585*^9, 3.8577605868825417`*^9}, {3.8577618352141204`*^9, 
   3.857761835599901*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tonga moment tensor", "Subsubsection",
 CellChangeTimes->{{3.857823732925807*^9, 3.8578237562060905`*^9}, {
  3.8578277668198347`*^9, 3.8578277772549396`*^9}, {3.857930294768629*^9, 
  3.857930300690734*^9}, {3.857930358811859*^9, 3.857930362702778*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"20", 
    RowBox[{"xyztp", "[", 
     RowBox[{"{", 
      RowBox[{
       StyleBox["50",
        FontColor->RGBColor[1, 0, 0]], ",", "65"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "2.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScaleInt", "=", ".35"}], ";"}]}], "Input",
 CellChangeTimes->{{3.857930323089017*^9, 3.857930323567062*^9}, {
  3.8579307172673264`*^9, 3.8579307176681004`*^9}, {3.8579309528210773`*^9, 
  3.857930953306734*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"20", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "20"}], ",", "75"}], "}"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"t", "=", "0.8"}], ";", "\[IndentingNewLine]", 
   RowBox[{"ArrowScaleInt", "=", ".20"}], ";"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.857930323089017*^9, 3.857930323567062*^9}, {
  3.857930653011047*^9, 3.857930660254407*^9}, {3.857930720827942*^9, 
  3.8579307224851503`*^9}, {3.857930816867909*^9, 3.857930822585164*^9}, {
  3.8579308563302402`*^9, 3.8579308609115267`*^9}, {3.857930955774241*^9, 
  3.857930956093115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"230.00", "45.935", 
       RowBox[{"-", "2.0487"}]},
      {"45.935", "118.32", "10.898"},
      {
       RowBox[{"-", "2.0487"}], "10.898", "109.59"}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Julien example with integral curves.", "Subsubsection",
 CellChangeTimes->{{3.857823732925807*^9, 3.8578237562060905`*^9}, {
  3.8578277668198347`*^9, 3.8578277772549396`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cycle", "=", 
   RowBox[{"Transpose", "[", "rot111", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mcoords", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<up\>\"", ",", "\"\<S\>\"", ",", "\"\<E\>\""}], "}"}]}], ";", 
  " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"right", "-", "handed"}], ",", " ", 
     RowBox[{
     "must", " ", "be", " ", "consistent", " ", "with", " ", "your", " ", 
      "given", " ", "M"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ArrowScale", "=", ".13"}], ";", 
  RowBox[{"tkns", "=", ".003"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ContinuousColoringOfBB", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PtsOnSphere", "=", 
    RowBox[{"{", "}"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1e2e3", "=", "True"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "standard", " ", "basis", " ", "vectors", " ", "as", " ", "understood", 
     " ", "by", " ", "Mathematica"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SquareSizeFactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"1.43", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NodalCurve", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesize", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"JulienPicture", "=", 
  RowBox[{"MTpicture", "[", "M", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.8576563226925707`*^9, 3.857677658198064*^9, 3.857687351404559*^9, 
   3.857688210677103*^9, 3.8576935059735174`*^9, 3.8576944502493935`*^9, 
   3.8576954460106044`*^9, {3.8576955823915777`*^9, 3.8576955849675875`*^9}, {
   3.857695650519596*^9, 3.857695672552065*^9}, {3.8576957115596037`*^9, 
   3.857695735751565*^9}, {3.857695792185034*^9, 3.8576958071097336`*^9}, {
   3.857742446624107*^9, 3.8577424505696597`*^9}, {3.8577427904830236`*^9, 
   3.8577427971531086`*^9}, {3.857824017976507*^9, 3.857824026103939*^9}, {
   3.857824125854147*^9, 3.8578241363278527`*^9}, {3.8578242029117537`*^9, 
   3.857824203683429*^9}, {3.857824235390348*^9, 3.857824240385335*^9}, 
   3.857824285644906*^9, {3.85782434815893*^9, 3.857824349231361*^9}, {
   3.8578244040357*^9, 3.8578244081507497`*^9}, 3.857824448397726*^9, {
   3.8578245275768433`*^9, 3.8578245544171314`*^9}, {3.8578247835098634`*^9, 
   3.8578248152662764`*^9}, {3.8578256660042*^9, 3.8578257343536863`*^9}, {
   3.8578259486001186`*^9, 3.857825949503425*^9}, {3.857826273788209*^9, 
   3.8578262747917204`*^9}, {3.8578267581469045`*^9, 3.8578267647694263`*^9}, 
   3.85782694066337*^9, {3.857930310991639*^9, 3.857930311547658*^9}, {
   3.857930353378974*^9, 3.8579303662761927`*^9}, {3.857930885230382*^9, 
   3.85793089021377*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cycle", "=", 
   RowBox[{"Transpose", "[", "rot111", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mcoords", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<up\>\"", ",", "\"\<S\>\"", ",", "\"\<E\>\""}], "}"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"right", "-", "handed"}], ",", " ", 
     RowBox[{
     "must", " ", "be", " ", "consistent", " ", "with", " ", "your", " ", 
      "given", " ", "M"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", "ArrowScaleInt"}], ";", " ", 
  RowBox[{"tkns", "=", ".005"}], ";", 
  RowBox[{"ptsz", "=", ".01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WantEllipsoids", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ContinuousColoringOfBB", "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PtsOnSphere", "=", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Uraw", "[", "M", "]"}], ".", 
         RowBox[{"xrot", "[", "90", "]"}], ".", "#"}], "&"}], "/@", 
       "PrePtsOnSphere"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "PrePtsOnSphere", "]"}], ",", "2"}], "}"}]}], 
     "]"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e1e2e3", "=", "False"}], " ", ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SquareSizeFactor", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lengthPAs", "=", 
   RowBox[{"0", "BBrad"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NodalCurve", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesize", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"JulienPicture", ",", 
     RowBox[{"MTpicture", "[", "M", "]"}]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"-", "100"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.8576563226925707`*^9, 3.857677658198064*^9, 3.857687351404559*^9, 
   3.857688210677103*^9, 3.8576935059735174`*^9, 3.8576944502493935`*^9, 
   3.8576954460106044`*^9, {3.8576955823915777`*^9, 3.8576955849675875`*^9}, {
   3.857695650519596*^9, 3.857695672552065*^9}, {3.8576957115596037`*^9, 
   3.857695735751565*^9}, {3.857695792185034*^9, 3.8576958071097336`*^9}, {
   3.857742446624107*^9, 3.8577424505696597`*^9}, {3.8577427904830236`*^9, 
   3.8577427971531086`*^9}, {3.857824017976507*^9, 3.857824026103939*^9}, {
   3.857824125854147*^9, 3.8578241363278527`*^9}, {3.8578242029117537`*^9, 
   3.857824203683429*^9}, {3.857824235390348*^9, 3.857824240385335*^9}, 
   3.857824285644906*^9, {3.85782434815893*^9, 3.857824349231361*^9}, {
   3.8578244040357*^9, 3.8578244081507497`*^9}, 3.857824448397726*^9, {
   3.8578245275768433`*^9, 3.8578245544171314`*^9}, 3.857825088845604*^9, 
   3.8578251531939588`*^9, {3.8578251851993933`*^9, 3.857825185986644*^9}, 
   3.8578252206588984`*^9, {3.8578252736312456`*^9, 3.8578252931994004`*^9}, {
   3.8578255098559065`*^9, 3.8578255836491685`*^9}, {3.8578257983406954`*^9, 
   3.857825855322186*^9}, {3.8578259252831917`*^9, 3.8578259264028463`*^9}, {
   3.857825968802868*^9, 3.8578259892630105`*^9}, {3.8578262045130167`*^9, 
   3.857826226973682*^9}, 3.8578267103225822`*^9, {3.857826963789012*^9, 
   3.857826989256201*^9}, {3.8578270532941933`*^9, 3.857827053927288*^9}, {
   3.857827088880517*^9, 3.8578271271854067`*^9}, {3.8578278430474453`*^9, 
   3.857827864724588*^9}, {3.8578279253913136`*^9, 3.8578279333720236`*^9}, {
   3.8578279980036564`*^9, 3.8578280329434133`*^9}, {3.857930330878683*^9, 
   3.857930331026925*^9}, {3.857930379296976*^9, 3.857930383230186*^9}, 
   3.857930703981863*^9, {3.8579307444849358`*^9, 3.8579307468248158`*^9}, {
   3.8579309638940287`*^9, 3.857930969871657*^9}}],

Cell["No need to evaluate :", "Text",
 CellChangeTimes->{{3.594438491324396*^9, 3.5944384969944043`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{"\[CapitalLambda]", "=", 
  RowBox[{"{", 
   RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.857750231785424*^9, 3.857750256398361*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"vSoln", "[", 
     RowBox[{"t", ",", "\[CapitalLambda]", ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}], ",", "t"}], 
   "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"LamSubU", "[", 
    RowBox[{"\[CapitalLambda]", ",", "id"}], "]"}], ".", 
   RowBox[{"vSoln", "[", 
    RowBox[{"t", ",", "\[CapitalLambda]", ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.5944032101822853`*^9, 3.594403352532482*^9}, {
  3.8577617071126575`*^9, 3.857761708278541*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"XRot", "[", 
    RowBox[{"\[Pi]", "/", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"vSoln", "[", 
      RowBox[{"t", ",", "\[CapitalLambda]", ",", "u", ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}], ",", "t"}], 
    "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"LamSubU", "[", 
     RowBox[{"\[CapitalLambda]", ",", "u"}], "]"}], ".", 
    RowBox[{"vSoln", "[", 
     RowBox[{"t", ",", "\[CapitalLambda]", ",", "u", ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.59440350290269*^9, 3.5944035037326913`*^9}, {
  3.5944035350677347`*^9, 3.5944035516277575`*^9}, {3.857761721224078*^9, 
  3.8577617223124833`*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"vSoln", "[", 
    RowBox[{"0", ",", "\[CapitalLambda]", ",", "u", ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}], "==", 
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.594409759640994*^9, 3.5944097675960054`*^9}, {
  3.8577456244120083`*^9, 3.857745629814958*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1049, 809},
WindowMargins->{{232, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 377, 7, 59, "Subsubsection"],
Cell[947, 31, 2720, 52, 143, "Input"],
Cell[3670, 85, 985, 22, 99, "Input"],
Cell[4658, 109, 834, 20, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5529, 134, 133, 1, 35, "Subsubsection"],
Cell[5665, 137, 345, 8, 55, "Input"],
Cell[6013, 147, 184, 3, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6234, 155, 264, 3, 35, "Subsubsection"],
Cell[6501, 160, 14324, 292, 649, "Input"],
Cell[20828, 454, 310, 9, 32, "Input"],
Cell[21141, 465, 3413, 81, 352, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24591, 551, 315, 6, 59, "Subsubsection"],
Cell[24909, 559, 819, 19, 110, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25765, 583, 260, 6, 59, "Subsubsection"],
Cell[26028, 591, 1913, 52, 286, "Input"],
Cell[27944, 645, 432, 12, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28413, 662, 220, 3, 45, "Subsection"],
Cell[28636, 667, 2877, 76, 374, "Input"],
Cell[31516, 745, 894, 19, 110, "Input"],
Cell[32413, 766, 327, 9, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32777, 780, 257, 5, 71, "Subsection"],
Cell[33037, 787, 10467, 241, 407, "Input"],
Cell[CellGroupData[{
Cell[43529, 1032, 175, 3, 35, "Subsubsection"],
Cell[43707, 1037, 243, 7, 31, "Text"],
Cell[43953, 1046, 6168, 132, 253, "Input"],
Cell[50124, 1180, 3846, 90, 341, "Input"],
Cell[53973, 1272, 2798, 61, 198, "Input"],
Cell[56774, 1335, 1763, 42, 154, "Input"],
Cell[58540, 1379, 1206, 35, 198, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59795, 1420, 198, 5, 71, "Subsection"],
Cell[59996, 1427, 4567, 106, 264, "Input"],
Cell[CellGroupData[{
Cell[64588, 1537, 296, 5, 59, "Subsubsection"],
Cell[64887, 1544, 4381, 112, 264, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69305, 1661, 260, 3, 35, "Subsubsection"],
Cell[69568, 1666, 561, 16, 77, "Input"],
Cell[70132, 1684, 690, 16, 77, "Input"],
Cell[70825, 1702, 292, 9, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71154, 1716, 186, 2, 35, "Subsubsection"],
Cell[71343, 1720, 2999, 65, 275, "Input"],
Cell[74345, 1787, 4003, 87, 275, "Input"],
Cell[78351, 1876, 151, 3, 31, "Text"],
Cell[78505, 1881, 218, 5, 32, "Input"],
Cell[78726, 1888, 693, 18, 55, "Input"],
Cell[79422, 1908, 886, 24, 55, "Input"],
Cell[80311, 1934, 425, 10, 32, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
